{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8585193586570246, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.59083064599012, "policy_loss": -0.006990629337511207, "vf_loss": 5.596941822294205, "vf_explained_var": 0.011779138650843707, "kl": 0.004397278949963274, "entropy": 1.606581535162749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4301154106697709, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.988983920263865, "policy_loss": -0.008888091515532878, "vf_loss": 6.996870100939716, "vf_explained_var": 0.022403451689967404, "kl": 0.005009604459283529, "entropy": 1.605715732851987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 118.8974652502235, "num_env_steps_trained_throughput_per_sec": 118.8974652502235, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 33642.445, "restore_workers_time_ms": 0.035, "training_step_time_ms": 33642.361, "sample_time_ms": 6734.089, "learn_time_ms": 26866.094, "learn_throughput": 148.887, "synch_weights_time_ms": 39.234}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "60982_00000", "date": "2024-08-23_11-00-18", "timestamp": 1724391018, "time_this_iter_s": 33.698471784591675, "time_total_s": 33.698471784591675, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f742160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.698471784591675, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 51.82857142857143, "ram_util_percent": 83.67142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7427831492096029, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 3.98801993037027, "policy_loss": -0.012871977170466115, "vf_loss": 4.0002201314956425, "vf_explained_var": 0.06789458353052695, "kl": 0.006717727693640405, "entropy": 1.601480555912805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.032718907714521, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.186383329623591, "policy_loss": -0.01808787016198039, "vf_loss": 6.202886524906865, "vf_explained_var": 0.0718925499411487, "kl": 0.007923449876609815, "entropy": 1.5984577668406976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.3783851997819, "num_env_steps_trained_throughput_per_sec": 146.3783851997819, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 30484.452, "restore_workers_time_ms": 0.035, "training_step_time_ms": 30484.089, "sample_time_ms": 4514.658, "learn_time_ms": 25934.412, "learn_throughput": 154.235, "synch_weights_time_ms": 32.132}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "60982_00000", "date": "2024-08-23_11-00-48", "timestamp": 1724391048, "time_this_iter_s": 27.36432385444641, "time_total_s": 61.062795639038086, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f56e280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.062795639038086, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.681395348837206, "ram_util_percent": 83.32093023255813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.789182873188503, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 3.4981252768683055, "policy_loss": -0.013903095814148113, "vf_loss": 3.5111390033096233, "vf_explained_var": 0.10351787584799307, "kl": 0.008893513040144055, "entropy": 1.5962598047559224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.740184297195818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.049207519854187, "policy_loss": -0.01765837292655041, "vf_loss": 6.065089198521205, "vf_explained_var": 0.14801088514782135, "kl": 0.008883363239605117, "entropy": 1.5870856508376106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 39.023078358925794, "num_env_steps_trained_throughput_per_sec": 39.023078358925794, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 54490.795, "restore_workers_time_ms": 0.032, "training_step_time_ms": 54490.342, "sample_time_ms": 3757.647, "learn_time_ms": 50623.133, "learn_throughput": 79.015, "synch_weights_time_ms": 104.32}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "60982_00000", "date": "2024-08-23_11-02-30", "timestamp": 1724391150, "time_this_iter_s": 102.57685708999634, "time_total_s": 163.63965272903442, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f544040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 163.63965272903442, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.54558823529412, "ram_util_percent": 85.03529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8513004760262828, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.2549122143044045, "policy_loss": -0.011622357348265944, "vf_loss": 2.265685399058004, "vf_explained_var": 0.09533253624325706, "kl": 0.0084917654051746, "entropy": 1.5879395337331863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 485.2299999999999}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8203237207478318, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.371946791997032, "policy_loss": -0.015337961271562905, "vf_loss": 6.385131538229644, "vf_explained_var": 0.19720331663807864, "kl": 0.010766074154033233, "entropy": 1.5786562654707166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 485.2299999999999}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.4277623642333, "num_env_steps_trained_throughput_per_sec": 149.4277623642333, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 47560.299, "restore_workers_time_ms": 0.167, "training_step_time_ms": 47559.747, "sample_time_ms": 3429.383, "learn_time_ms": 44042.289, "learn_throughput": 90.822, "synch_weights_time_ms": 83.277}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "60982_00000", "date": "2024-08-23_11-02-57", "timestamp": 1724391177, "time_this_iter_s": 26.814524173736572, "time_total_s": 190.454176902771, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f770280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.454176902771, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.47692307692307, "ram_util_percent": 83.48461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0975201794079372, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.263933546076376, "policy_loss": -0.01329047432681792, "vf_loss": 2.2765009922956034, "vf_explained_var": 0.10881867068154472, "kl": 0.007230310393349519, "entropy": 1.5847306438224025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.410105595260701, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.739445531935919, "policy_loss": -0.017229298090749474, "vf_loss": 6.754341140625969, "vf_explained_var": 0.22534257722279383, "kl": 0.011668435359009044, "entropy": 1.564504491336762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 333.0933590954111, "episode_reward_min": 333.0933590954111, "episode_reward_mean": 333.0933590954111, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 400, "policy_reward_min": {"prey_policy": 53.12773835886295, "predator_policy": 11.31641771130239}, "policy_reward_max": {"prey_policy": 112.01673159868517, "predator_policy": 156.63247142656172}, "policy_reward_mean": {"prey_policy": 82.57223497877406, "predator_policy": 83.97444456893206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111], "episode_lengths": [400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.74945278825431, "mean_inference_ms": 3.2978134593744386, "mean_action_processing_ms": 0.7110480604500605, "mean_env_wait_ms": 6.852145578669405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025510787963867188, "StateBufferConnector_ms": 0.0033736228942871094, "ViewRequirementAgentConnector_ms": 0.07168054580688477}, "num_episodes": 1, "episode_return_max": 333.0933590954111, "episode_return_min": 333.0933590954111, "episode_return_mean": 333.0933590954111, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.2555996022205, "num_env_steps_trained_throughput_per_sec": 150.2555996022205, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 43372.519, "restore_workers_time_ms": 0.147, "training_step_time_ms": 43372.039, "sample_time_ms": 3181.485, "learn_time_ms": 40117.095, "learn_throughput": 99.708, "synch_weights_time_ms": 69.103}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "60982_00000", "date": "2024-08-23_11-03-24", "timestamp": 1724391204, "time_this_iter_s": 26.650586128234863, "time_total_s": 217.10476303100586, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f52be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 217.10476303100586, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.02162162162162, "ram_util_percent": 83.35945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7110635828719567, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.3560981166425834, "policy_loss": -0.013637808250588556, "vf_loss": 2.3688382951040117, "vf_explained_var": 0.1717260797187765, "kl": 0.008976281761738753, "entropy": 1.575076545230926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.199460749714463, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.139262577339455, "policy_loss": -0.012418476876521867, "vf_loss": 7.149675166417682, "vf_explained_var": 0.2738930413962672, "kl": 0.010029517367442764, "entropy": 1.5538875709765803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 333.0933590954111, "episode_reward_min": 288.2739863161097, "episode_reward_mean": 315.8560255152844, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 1200, "policy_reward_min": {"prey_policy": -49.50022575187842, "predator_policy": 9.165446881399223}, "policy_reward_max": {"prey_policy": 145.88142618236674, "predator_policy": 208.03488545140655}, "policy_reward_mean": {"prey_policy": 55.43322072855678, "predator_policy": 102.49479202908542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097], "episode_lengths": [400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.080985904631725, "mean_inference_ms": 3.637503304969813, "mean_action_processing_ms": 0.9074770126670314, "mean_env_wait_ms": 7.83524620726244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036636988321940103, "StateBufferConnector_ms": 0.0032504399617513022, "ViewRequirementAgentConnector_ms": 0.07228453954060872}, "num_episodes": 2, "episode_return_max": 333.0933590954111, "episode_return_min": 288.2739863161097, "episode_return_mean": 315.8560255152844, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.78950147050267, "num_env_steps_trained_throughput_per_sec": 157.78950147050267, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 40368.805, "restore_workers_time_ms": 0.125, "training_step_time_ms": 40368.382, "sample_time_ms": 2996.292, "learn_time_ms": 37306.549, "learn_throughput": 107.22, "synch_weights_time_ms": 61.532}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "60982_00000", "date": "2024-08-23_11-03-49", "timestamp": 1724391229, "time_this_iter_s": 25.358711004257202, "time_total_s": 242.46347403526306, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7a3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 242.46347403526306, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.897222222222222, "ram_util_percent": 83.25833333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.562186356322475, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.6311633704200625, "policy_loss": -0.01171080057987224, "vf_loss": 2.6418473405182046, "vf_explained_var": 0.15118436075392225, "kl": 0.010268220544679376, "entropy": 1.5649433220505085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.7587336339647806, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.21210709930097, "policy_loss": -0.0125956664502463, "vf_loss": 7.223089606673629, "vf_explained_var": 0.29474199581398536, "kl": 0.008065813008410038, "entropy": 1.5459076380603527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 310.1957857742231, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 18400, "policy_reward_min": {"prey_policy": -362.71420372844557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 300.0749562541195, "predator_policy": 408.0492728721587}, "policy_reward_mean": {"prey_policy": 13.84250172304133, "predator_policy": 141.2553911640704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097, 191.46798184929776, 126.00000000000003, 406.39999999999975, 283.2034625583003, 354.900000000001, 461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423, 28.03112081307127, -362.71420372844557, -330.8937639449946, -154.9096131527697, 278.10910934385504, 30.203498384415816, 35.729274548171745, 17.536719590564132, 260.85457886037113, 35.1166636789205, 72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655, 298.69561610337087, 227.45544866130209, 358.8937639450009, 252.90961315276897, 36.890890656145, 61.19650161558461, 158.50513406697516, 71.43233435258954, 0.0, 58.92875746070819, 152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.249419402953757, "mean_inference_ms": 4.066449142822613, "mean_action_processing_ms": 1.0025752343933652, "mean_env_wait_ms": 9.368669181005526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034029069154158883, "StateBufferConnector_ms": 0.0036573928335438604, "ViewRequirementAgentConnector_ms": 0.20957589149475098}, "num_episodes": 43, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 310.1957857742231, "episodes_this_iter": 43}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.59825662554474, "num_env_steps_trained_throughput_per_sec": 154.59825662554474, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 38298.051, "restore_workers_time_ms": 0.111, "training_step_time_ms": 38297.666, "sample_time_ms": 2868.754, "learn_time_ms": 35369.309, "learn_throughput": 113.092, "synch_weights_time_ms": 55.706}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "60982_00000", "date": "2024-08-23_11-04-15", "timestamp": 1724391255, "time_this_iter_s": 25.932507038116455, "time_total_s": 268.3959810733795, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f77bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 268.3959810733795, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.662162162162176, "ram_util_percent": 83.39459459459462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.451960673407903, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 3.88076522993663, "policy_loss": -0.01145675234033396, "vf_loss": 3.8911880051648176, "vf_explained_var": 0.14710919522734547, "kl": 0.010339814025622906, "entropy": 1.545109955091325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 485.2299999999996}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.192219389052618, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.172788857656812, "policy_loss": -0.014456991592136325, "vf_loss": 7.185237126123337, "vf_explained_var": 0.29406148018660366, "kl": 0.010043607732754142, "entropy": 1.500723430088588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 485.2299999999996}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 329.5525181277806, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28400, "policy_reward_min": {"prey_policy": -424.8631807641857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9000000000002, "predator_policy": 538.8224428658591}, "policy_reward_mean": {"prey_policy": 21.40967023483911, "predator_policy": 143.36658882905127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097, 191.46798184929776, 126.00000000000003, 406.39999999999975, 283.2034625583003, 354.900000000001, 461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423, 28.03112081307127, -362.71420372844557, -330.8937639449946, -154.9096131527697, 278.10910934385504, 30.203498384415816, 35.729274548171745, 17.536719590564132, 260.85457886037113, 35.1166636789205, 72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655, 298.69561610337087, 227.45544866130209, 358.8937639450009, 252.90961315276897, 36.890890656145, 61.19650161558461, 158.50513406697516, 71.43233435258954, 0.0, 58.92875746070819, 152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.24536604069047, "mean_inference_ms": 3.9993336583515178, "mean_action_processing_ms": 0.9940735236507009, "mean_env_wait_ms": 9.403443524113735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004016849356637874, "StateBufferConnector_ms": 0.0037680209522515957, "ViewRequirementAgentConnector_ms": 0.21433813471189686}, "num_episodes": 25, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 329.5525181277806, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.4337117080059, "num_env_steps_trained_throughput_per_sec": 157.4337117080059, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 36686.736, "restore_workers_time_ms": 0.099, "training_step_time_ms": 36686.388, "sample_time_ms": 2789.678, "learn_time_ms": 33840.259, "learn_throughput": 118.202, "synch_weights_time_ms": 52.794}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "60982_00000", "date": "2024-08-23_11-04-41", "timestamp": 1724391281, "time_this_iter_s": 25.44828987121582, "time_total_s": 293.84427094459534, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7299d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 293.84427094459534, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.775000000000002, "ram_util_percent": 83.42777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.349911548725512, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.389612566226374, "policy_loss": -0.01598534957165756, "vf_loss": 4.404355923839347, "vf_explained_var": 0.14293483918306057, "kl": 0.012419950175862858, "entropy": 1.5209167393427045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.515391989485927, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.960140102628678, "policy_loss": -0.01364390926125149, "vf_loss": 6.971922053988018, "vf_explained_var": 0.2462977134361469, "kl": 0.009309759602522252, "entropy": 1.5000641168109954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 332.3101220426726, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -424.8631807641857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9000000000002, "predator_policy": 538.8224428658591}, "policy_reward_mean": {"prey_policy": 24.298119563867644, "predator_policy": 141.8569414574687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097, 191.46798184929776, 126.00000000000003, 406.39999999999975, 283.2034625583003, 354.900000000001, 461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423, 28.03112081307127, -362.71420372844557, -330.8937639449946, -154.9096131527697, 278.10910934385504, 30.203498384415816, 35.729274548171745, 17.536719590564132, 260.85457886037113, 35.1166636789205, 72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655, 298.69561610337087, 227.45544866130209, 358.8937639450009, 252.90961315276897, 36.890890656145, 61.19650161558461, 158.50513406697516, 71.43233435258954, 0.0, 58.92875746070819, 152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.237672045628262, "mean_inference_ms": 3.9921178762807563, "mean_action_processing_ms": 0.9907410047892795, "mean_env_wait_ms": 9.38395540793463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00399980280134413, "StateBufferConnector_ms": 0.0037650267283121743, "ViewRequirementAgentConnector_ms": 0.21236936251322427}, "num_episodes": 1, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 332.3101220426726, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.04982446112663, "num_env_steps_trained_throughput_per_sec": 153.04982446112663, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 35514.355, "restore_workers_time_ms": 0.091, "training_step_time_ms": 35514.034, "sample_time_ms": 2795.476, "learn_time_ms": 32665.634, "learn_throughput": 122.453, "synch_weights_time_ms": 49.456}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "60982_00000", "date": "2024-08-23_11-05-07", "timestamp": 1724391307, "time_this_iter_s": 26.146734952926636, "time_total_s": 319.991005897522, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f789310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 319.991005897522, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.05945945945946, "ram_util_percent": 83.2972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.750746336563554, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.4245211091621846, "policy_loss": -0.01034665863872284, "vf_loss": 4.433779634495892, "vf_explained_var": 0.18173434866799248, "kl": 0.010881420066235242, "entropy": 1.5168893816609863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.328486421877745, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.868905470106337, "policy_loss": -0.014670010375736094, "vf_loss": 6.881526024127132, "vf_explained_var": 0.2878653873842229, "kl": 0.010247356539207792, "entropy": 1.4957562658521864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 332.3101220426726, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -424.8631807641857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9000000000002, "predator_policy": 538.8224428658591}, "policy_reward_mean": {"prey_policy": 24.298119563867644, "predator_policy": 141.8569414574687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097, 191.46798184929776, 126.00000000000003, 406.39999999999975, 283.2034625583003, 354.900000000001, 461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423, 28.03112081307127, -362.71420372844557, -330.8937639449946, -154.9096131527697, 278.10910934385504, 30.203498384415816, 35.729274548171745, 17.536719590564132, 260.85457886037113, 35.1166636789205, 72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655, 298.69561610337087, 227.45544866130209, 358.8937639450009, 252.90961315276897, 36.890890656145, 61.19650161558461, 158.50513406697516, 71.43233435258954, 0.0, 58.92875746070819, 152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.237672045628262, "mean_inference_ms": 3.9921178762807563, "mean_action_processing_ms": 0.9907410047892795, "mean_env_wait_ms": 9.38395540793463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00399980280134413, "StateBufferConnector_ms": 0.0037650267283121743, "ViewRequirementAgentConnector_ms": 0.21236936251322427}, "num_episodes": 0, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 332.3101220426726, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.322225370366, "num_env_steps_trained_throughput_per_sec": 159.322225370366, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 34473.558, "restore_workers_time_ms": 0.084, "training_step_time_ms": 34473.261, "sample_time_ms": 2715.052, "learn_time_ms": 31708.65, "learn_throughput": 126.149, "synch_weights_time_ms": 46.151}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "60982_00000", "date": "2024-08-23_11-05-32", "timestamp": 1724391332, "time_this_iter_s": 25.131541967391968, "time_total_s": 345.12254786491394, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f78d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 345.12254786491394, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.572222222222226, "ram_util_percent": 82.96944444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.391266441219067, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.020899656336144, "policy_loss": -0.013594345529884021, "vf_loss": 4.033354887886653, "vf_explained_var": 0.172260859340587, "kl": 0.011391241382807494, "entropy": 1.5156324491299018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.130836909284037, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.835893949882063, "policy_loss": -0.013924081749701627, "vf_loss": 6.847558632603398, "vf_explained_var": 0.3032862185801148, "kl": 0.01129687139123836, "entropy": 1.4883196323636978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 332.3101220426726, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -424.8631807641857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9000000000002, "predator_policy": 538.8224428658591}, "policy_reward_mean": {"prey_policy": 24.298119563867644, "predator_policy": 141.8569414574687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097, 191.46798184929776, 126.00000000000003, 406.39999999999975, 283.2034625583003, 354.900000000001, 461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423, 28.03112081307127, -362.71420372844557, -330.8937639449946, -154.9096131527697, 278.10910934385504, 30.203498384415816, 35.729274548171745, 17.536719590564132, 260.85457886037113, 35.1166636789205, 72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655, 298.69561610337087, 227.45544866130209, 358.8937639450009, 252.90961315276897, 36.890890656145, 61.19650161558461, 158.50513406697516, 71.43233435258954, 0.0, 58.92875746070819, 152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.237672045628262, "mean_inference_ms": 3.9921178762807563, "mean_action_processing_ms": 0.9907410047892795, "mean_env_wait_ms": 9.38395540793463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00399980280134413, "StateBufferConnector_ms": 0.0037650267283121743, "ViewRequirementAgentConnector_ms": 0.21236936251322427}, "num_episodes": 0, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 332.3101220426726, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.12970681295423, "num_env_steps_trained_throughput_per_sec": 151.12970681295423, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 33756.069, "restore_workers_time_ms": 0.082, "training_step_time_ms": 33755.733, "sample_time_ms": 2234.862, "learn_time_ms": 31472.112, "learn_throughput": 127.097, "synch_weights_time_ms": 45.179}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "60982_00000", "date": "2024-08-23_11-05-59", "timestamp": 1724391359, "time_this_iter_s": 26.534218072891235, "time_total_s": 371.6567659378052, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f781310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 371.6567659378052, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 49.059459459459454, "ram_util_percent": 83.37837837837837}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.438267626333489, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.349276874431227, "policy_loss": -0.0158916105260018, "vf_loss": 4.363918412173236, "vf_explained_var": 0.17353183939343408, "kl": 0.012500864302828199, "entropy": 1.477267519254533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.774787143929295, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.062059024528221, "policy_loss": -0.010499481135417545, "vf_loss": 7.070573928873375, "vf_explained_var": 0.22413105560988977, "kl": 0.009922880884358491, "entropy": 1.4708782397880755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 335.5733698815768, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 29200, "policy_reward_min": {"prey_policy": -424.8631807641857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9000000000002, "predator_policy": 538.8224428658591}, "policy_reward_mean": {"prey_policy": 27.13188624359081, "predator_policy": 140.65479869719766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097, 191.46798184929776, 126.00000000000003, 406.39999999999975, 283.2034625583003, 354.900000000001, 461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423, 28.03112081307127, -362.71420372844557, -330.8937639449946, -154.9096131527697, 278.10910934385504, 30.203498384415816, 35.729274548171745, 17.536719590564132, 260.85457886037113, 35.1166636789205, 72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655, 298.69561610337087, 227.45544866130209, 358.8937639450009, 252.90961315276897, 36.890890656145, 61.19650161558461, 158.50513406697516, 71.43233435258954, 0.0, 58.92875746070819, 152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.22995070363617, "mean_inference_ms": 3.983325217459496, "mean_action_processing_ms": 0.9877142743737231, "mean_env_wait_ms": 9.371043322335446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005508938880815898, "StateBufferConnector_ms": 0.004163670213255164, "ViewRequirementAgentConnector_ms": 0.21259082506780755}, "num_episodes": 1, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 335.5733698815768, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.8799741250624, "num_env_steps_trained_throughput_per_sec": 151.8799741250624, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 33657.089, "restore_workers_time_ms": 0.081, "training_step_time_ms": 33656.795, "sample_time_ms": 2226.722, "learn_time_ms": 31381.685, "learn_throughput": 127.463, "synch_weights_time_ms": 44.861}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "60982_00000", "date": "2024-08-23_11-06-25", "timestamp": 1724391385, "time_this_iter_s": 26.36793804168701, "time_total_s": 398.0247039794922, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f78d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 398.0247039794922, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 50.527027027027025, "ram_util_percent": 83.15135135135135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9623473152281745, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 3.4021654123982423, "policy_loss": -0.014377764125586187, "vf_loss": 3.415419257002533, "vf_explained_var": 0.21937522415130858, "kl": 0.011239150643013614, "entropy": 1.4473264422996965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.95365851821092, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.454263943465299, "policy_loss": -0.01173451147362511, "vf_loss": 6.46397667334824, "vf_explained_var": 0.28666780152648846, "kl": 0.010108826878337711, "entropy": 1.461793639294054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 336.29684239702635, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 32800, "policy_reward_min": {"prey_policy": -424.8631807641857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9000000000002, "predator_policy": 538.8224428658591}, "policy_reward_mean": {"prey_policy": 23.289337706683867, "predator_policy": 144.85908349182935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0933590954111, 326.20073113433233, 288.2739863161097, 191.46798184929776, 126.00000000000003, 406.39999999999975, 283.2034625583003, 354.900000000001, 461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [53.12773835886295, 112.01673159868517, 145.88142618236674, -49.50022575187842, 86.15192747231852, -15.07827348901423, 28.03112081307127, -362.71420372844557, -330.8937639449946, -154.9096131527697, 278.10910934385504, 30.203498384415816, 35.729274548171745, 17.536719590564132, 260.85457886037113, 35.1166636789205, 72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584], "policy_predator_policy_reward": [156.63247142656172, 11.31641771130239, 53.88474475333213, 175.93478595051045, 9.165446881399223, 208.03488545140655, 298.69561610337087, 227.45544866130209, 358.8937639450009, 252.90961315276897, 36.890890656145, 61.19650161558461, 158.50513406697516, 71.43233435258954, 0.0, 58.92875746070819, 152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.22438468774552, "mean_inference_ms": 3.9868219106126137, "mean_action_processing_ms": 0.992581248717275, "mean_env_wait_ms": 9.435238362118737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005345082864528749, "StateBufferConnector_ms": 0.0041586596791337175, "ViewRequirementAgentConnector_ms": 0.19957539511889946}, "num_episodes": 9, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 336.29684239702635, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.34995864531703, "num_env_steps_trained_throughput_per_sec": 137.34995864531703, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 26319.011, "restore_workers_time_ms": 0.08, "training_step_time_ms": 26318.771, "sample_time_ms": 2224.182, "learn_time_ms": 24062.695, "learn_throughput": 166.232, "synch_weights_time_ms": 28.956}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "60982_00000", "date": "2024-08-23_11-06-54", "timestamp": 1724391414, "time_this_iter_s": 29.237170934677124, "time_total_s": 427.2618749141693, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 427.2618749141693, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 51.36666666666666, "ram_util_percent": 83.29523809523809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.156192763268002, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.83807342569664, "policy_loss": -0.013155872971016579, "vf_loss": 4.849711327830319, "vf_explained_var": 0.18062462907619578, "kl": 0.01517945168805974, "entropy": 1.369049898531071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.926222800640833, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.778330894248195, "policy_loss": -0.01503225382141493, "vf_loss": 6.791190930522939, "vf_explained_var": 0.21981863105107868, "kl": 0.01086130546277793, "entropy": 1.4121550167679155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 704.8246648621848, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 337.49504427004933, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -424.8631807641857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 538.8224428658591}, "policy_reward_mean": {"prey_policy": 9.233465471359978, "predator_policy": 159.51405666366455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [461.9000000000001, 237.43097980579543, 412.0380663395476, 151.19999999999987, 704.8246648621848, 170.5999999999997, 433.39999999999964, 282.29999999999825, 392.03506740031617, 388.79999999999984, 98.2827732227775, 250.4999999999985, 216.20433372427485, 137.18910549818204, 389.4344139586742, 368.89999999999975, 369.80000000000206, 257.48065446273927, 296.6592515657029, 360.0693063387815, 61.99962975960529, 272.69999999999914, 349.1000000000001, 252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [72.82602932870688, 100.85878385275242, 54.55738959372702, 34.58301541726402, 185.5547925400534, 147.3844388215242, 42.21251211607705, 4.324882125952376, 273.4128304614704, 285.31092045904495, 133.21172927143664, -198.50642110024262, 62.78051545402662, 48.48831326851921, -52.17147898458865, 236.3394003623694, 101.75908959033576, -185.63077380877766, -34.57932563494988, 290.28748648509355, -38.15377914638109, -261.7962145115751, 25.09377439359931, -148.93927292733676, -151.2696259123176, -200.56732230597183, -69.42523398587903, -25.623612378105726, 62.705140792761185, 108.87693203367104, -24.382646919797125, 131.28083458833086, -9.543263126849526, 210.7094225164243, -48.28799719839079, -25.116011949657903, -43.45304417747302, -135.55941019403832, 64.18576573490908, -150.39005647898134, -189.23619584716945, -47.01432505099945, -107.27846924420801, 176.69666723714914, 44.59655011090718, 173.48856864592207, 44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017], "policy_predator_policy_reward": [152.2739706712926, 135.9412161472471, 80.16114695944269, 68.12942783536263, 29.71871071613749, 49.380124261832854, 71.28748788392298, 33.37511787404779, 76.26565702785189, 69.83525691381755, 6.088270728563258, 229.80642110024084, 207.11798295751507, 115.01318831993821, 87.59169899929647, 10.540379622921773, 70.87409532053552, 405.0326562982224, 115.27932563494944, 17.812513514906414, 158.79805183390442, 239.4347150468282, 52.01824332966299, 322.32725520407473, 291.1911653396295, 276.85011660293424, 5.710758007323523, 226.5271938548425, 87.93532484027517, 129.9170162919677, 147.91307181527708, 114.08874051618955, 45.5432631268499, 123.09057748357563, 194.190427443308, 136.69423616748108, 67.62243306505547, 408.0492728721587, 165.14869987363204, 281.12489720922383, 253.8523579688413, 44.39779268893133, 119.66458764954814, 83.6172143575098, 30.26669152455302, 100.74818971861816, 43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.301841343965815, "mean_inference_ms": 4.015018341806034, "mean_action_processing_ms": 1.0062513096971268, "mean_env_wait_ms": 9.69338965176631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005478024482727051, "StateBufferConnector_ms": 0.004543304443359375, "ViewRequirementAgentConnector_ms": 0.20452916622161865}, "num_episodes": 26, "episode_return_max": 704.8246648621848, "episode_return_min": 26.828115831948097, "episode_return_mean": 337.49504427004933, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 140.7874918339355, "num_env_steps_trained_throughput_per_sec": 140.7874918339355, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 26483.295, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26483.072, "sample_time_ms": 2452.08, "learn_time_ms": 23998.336, "learn_throughput": 166.678, "synch_weights_time_ms": 29.628}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "60982_00000", "date": "2024-08-23_11-07-23", "timestamp": 1724391443, "time_this_iter_s": 28.440917015075684, "time_total_s": 455.702791929245, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 455.702791929245, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 44.872499999999995, "ram_util_percent": 82.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.846119819053267, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.671917132473497, "policy_loss": -0.017854547648685715, "vf_loss": 4.688229489957214, "vf_explained_var": 0.21207134181229526, "kl": 0.015421849644432465, "entropy": 1.3184026030636338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.713256594491384, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.425398612148547, "policy_loss": -0.010172245313940698, "vf_loss": 6.433892343914698, "vf_explained_var": 0.3415266475980244, "kl": 0.008392556819315783, "entropy": 1.3639648703671006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 752.547858466753, "episode_reward_min": 26.828115831948097, "episode_reward_mean": 359.4770757070035, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -452.3157853004518, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 672.1218549038233}, "policy_reward_mean": {"prey_policy": 8.602517665749394, "predator_policy": 171.13602018775222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [252.9999999999989, 523.3054358923039, 26.828115831948097, 261.0133175564853, 394.17708412937304, 294.80000000000024, 299.7999999999994, 325.09999999999957, 284.0999999999996, 235.29999999999947, 325.1634021599799, 330.80000000000115, 377.5000000000002, 521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [44.9205373015355, 81.83225046629656, 158.94481561808186, 300.0749562541195, -54.74318020687946, -210.3024469957423, -210.5497646787128, -161.1472910444865, 165.96207818605797, -240.91706898135385, 192.16509296191938, -244.50973538818496, -8.04101881607991, 166.0752716802896, -24.879011240227825, 20.447684727692675, -163.1801667232256, 114.09245925404551, -104.717082178191, -25.445787459651527, -147.2275183896551, 150.16001036080914, 200.05576465125907, -23.223875714330447, -224.87877610401864, 167.77862112882372, 64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456], "policy_predator_policy_reward": [43.948161654276845, 82.299050577891, 42.97862591360671, 21.307038106496417, 3.8603013906872476, 288.0134416438814, 388.08452127294476, 244.62585200674243, 72.08543949149504, 397.04663543317633, 78.43490703808041, 268.7097353881843, 50.94101881607994, 90.82472831971046, 257.64450921770487, 71.8868172948303, 168.65738592489643, 164.53032154428354, 155.1170821781902, 210.3457874596509, 154.59350874224083, 167.63740144658502, 139.64362391726468, 14.324487145806454, 278.4787761040234, 156.12137887117623, 257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3218799558022685, "mean_inference_ms": 3.9666760925005224, "mean_action_processing_ms": 1.012361531005856, "mean_env_wait_ms": 9.812682045390344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005602240562438965, "StateBufferConnector_ms": 0.005712628364562988, "ViewRequirementAgentConnector_ms": 0.18929922580718994}, "num_episodes": 23, "episode_return_max": 752.547858466753, "episode_return_min": 26.828115831948097, "episode_return_mean": 359.4770757070035, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.92853345053464, "num_env_steps_trained_throughput_per_sec": 154.92853345053464, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 26402.994, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26402.782, "sample_time_ms": 2432.811, "learn_time_ms": 23937.471, "learn_throughput": 167.102, "synch_weights_time_ms": 29.593}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "60982_00000", "date": "2024-08-23_11-07-49", "timestamp": 1724391469, "time_this_iter_s": 25.833055019378662, "time_total_s": 481.53584694862366, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f78d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 481.53584694862366, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.016216216216215, "ram_util_percent": 80.63243243243242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.731728773520737, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.239827995703965, "policy_loss": -0.016625925765998622, "vf_loss": 5.254756052531893, "vf_explained_var": 0.17361096446476285, "kl": 0.016978637589802028, "entropy": 1.2269456741040345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.779624518641719, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.873357928240741, "policy_loss": -0.01408676412005825, "vf_loss": 6.885385037477685, "vf_explained_var": 0.1984270240894701, "kl": 0.010298287963603067, "entropy": 1.3329452915797158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 752.547858466753, "episode_reward_min": 54.92320410719262, "episode_reward_mean": 366.2729977832517, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -452.3157853004518, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 672.1218549038233}, "policy_reward_mean": {"prey_policy": 11.118561110284514, "predator_policy": 172.0179377813411}, "custom_metrics": {}, "hist_stats": {"episode_reward": [521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748], "policy_predator_policy_reward": [257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314915683058837, "mean_inference_ms": 3.976853338034946, "mean_action_processing_ms": 1.0162318270441915, "mean_env_wait_ms": 9.900353550270747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005554914474487305, "StateBufferConnector_ms": 0.0057756900787353516, "ViewRequirementAgentConnector_ms": 0.1890188455581665}, "num_episodes": 13, "episode_return_max": 752.547858466753, "episode_return_min": 54.92320410719262, "episode_return_mean": 366.2729977832517, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.63017305036553, "num_env_steps_trained_throughput_per_sec": 158.63017305036553, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 26389.559, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26389.342, "sample_time_ms": 2442.3, "learn_time_ms": 23913.52, "learn_throughput": 167.269, "synch_weights_time_ms": 30.562}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "60982_00000", "date": "2024-08-23_11-08-14", "timestamp": 1724391494, "time_this_iter_s": 25.251354217529297, "time_total_s": 506.78720116615295, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f729ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 506.78720116615295, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.32222222222223, "ram_util_percent": 82.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.875007749360705, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.577523257997301, "policy_loss": -0.016610156585063252, "vf_loss": 4.592568785803659, "vf_explained_var": 0.20493158392174535, "kl": 0.01564620923369177, "entropy": 1.2266632965632847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.362945212762822, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.272184663601022, "policy_loss": -0.014346904910746075, "vf_loss": 6.284626125154041, "vf_explained_var": 0.28083228295442286, "kl": 0.009527136402194778, "entropy": 1.3351314728852932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 752.547858466753, "episode_reward_min": 54.92320410719262, "episode_reward_mean": 366.2729977832517, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -452.3157853004518, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 672.1218549038233}, "policy_reward_mean": {"prey_policy": 11.118561110284514, "predator_policy": 172.0179377813411}, "custom_metrics": {}, "hist_stats": {"episode_reward": [521.7827009260207, 443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [64.19520762873466, 155.60112828853238, -225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748], "policy_predator_policy_reward": [257.3870134571022, 44.599351551651544, 387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.314915683058837, "mean_inference_ms": 3.976853338034946, "mean_action_processing_ms": 1.0162318270441915, "mean_env_wait_ms": 9.900353550270747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005554914474487305, "StateBufferConnector_ms": 0.0057756900787353516, "ViewRequirementAgentConnector_ms": 0.1890188455581665}, "num_episodes": 0, "episode_return_max": 752.547858466753, "episode_return_min": 54.92320410719262, "episode_return_mean": 366.2729977832517, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.80979737344265, "num_env_steps_trained_throughput_per_sec": 158.80979737344265, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 26320.945, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26320.737, "sample_time_ms": 2447.667, "learn_time_ms": 23840.353, "learn_throughput": 167.783, "synch_weights_time_ms": 29.918}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "60982_00000", "date": "2024-08-23_11-08-39", "timestamp": 1724391519, "time_this_iter_s": 25.234993934631348, "time_total_s": 532.0221951007843, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f789790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 532.0221951007843, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.71111111111111, "ram_util_percent": 82.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.094264209207403, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.431174016629577, "policy_loss": -0.014812675078532525, "vf_loss": 4.444259392773664, "vf_explained_var": 0.19179523174094146, "kl": 0.01727297556581636, "entropy": 1.1956340574082873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.246006959140616, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.814220693376329, "policy_loss": -0.014501624375029847, "vf_loss": 5.827059014133676, "vf_explained_var": 0.13420549208524996, "kl": 0.008316399958526725, "entropy": 1.3533022227110687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 752.547858466753, "episode_reward_min": 54.92320410719262, "episode_reward_mean": 363.901652995083, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -452.3157853004518, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 672.1218549038233}, "policy_reward_mean": {"prey_policy": 9.298698816287756, "predator_policy": 172.6521276812535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.9483212261259, 317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-225.4551850230207, 266.1581758725279, 109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433], "policy_predator_policy_reward": [387.4097471004974, 15.83558327612107, 138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3050285020164125, "mean_inference_ms": 3.970995917981351, "mean_action_processing_ms": 1.0147023419281505, "mean_env_wait_ms": 9.88574198122407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005547046661376953, "StateBufferConnector_ms": 0.005771756172180176, "ViewRequirementAgentConnector_ms": 0.18872296810150146}, "num_episodes": 1, "episode_return_max": 752.547858466753, "episode_return_min": 54.92320410719262, "episode_return_mean": 363.901652995083, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.19534508759347, "num_env_steps_trained_throughput_per_sec": 157.19534508759347, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 26324.798, "restore_workers_time_ms": 0.021, "training_step_time_ms": 26324.462, "sample_time_ms": 2465.761, "learn_time_ms": 23825.647, "learn_throughput": 167.886, "synch_weights_time_ms": 30.001}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "60982_00000", "date": "2024-08-23_11-09-05", "timestamp": 1724391545, "time_this_iter_s": 25.47412109375, "time_total_s": 557.4963161945343, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f780a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 557.4963161945343, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.952777777777783, "ram_util_percent": 82.07222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.713797737240161, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.80710169953644, "policy_loss": -0.007247600266857753, "vf_loss": 4.812760211803295, "vf_explained_var": 0.2589936844255558, "kl": 0.01589079850683452, "entropy": 1.158647126243228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.906202059700376, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.050823434698518, "policy_loss": -0.010805516536766417, "vf_loss": 6.059722965987271, "vf_explained_var": 0.10137624116170973, "kl": 0.00952988716837748, "entropy": 1.3551198385379932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 752.547858466753, "episode_reward_min": 54.92320410719262, "episode_reward_mean": 364.10729315436515, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -452.3157853004518, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 672.1218549038233}, "policy_reward_mean": {"prey_policy": 9.447148413340113, "predator_policy": 172.6064981638422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [317.20992052963584, 118.09536153444088, 494.6228446061742, 498.5017810439364, 385.8875599545833, 351.84508138574694, 259.2521346975889, 373.8202680815409, 327.8000000000002, 566.3999999999996, 335.3354504927672, 500.23830655009954, 59.30000000000057, 331.30197968584724, 608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [109.60505259668906, -32.249920754023606, -98.09838263167468, 5.169139838667602, -102.78728319973263, 151.30544000851023, 189.77953813101735, 24.01088755726908, -13.177575127194896, 218.0459066271517, 174.97707276243617, -133.72556325166354, -2.5718905432963233, 51.61609620016074, 99.55507328031429, 41.47195177310157, 225.6494507278575, -225.36023988610503, -22.7107844156601, 391.9000000000002, -61.46671700134212, 28.225644143954412, 119.48072708672825, 174.98131630706592, -146.7009407554989, -161.83544704972198, -121.896896958074, -24.71953979535757, 1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177], "policy_predator_policy_reward": [138.62705941758742, 101.22772926938288, 147.13310137474565, 63.891502952703235, 368.16143739647225, 77.94325040092426, 57.60666180322278, 227.1046935524269, 174.53986796903678, 6.479360485589012, 15.593486858742246, 295.00008501623114, 48.37588033543119, 161.8320487052944, 61.234164246606284, 171.55907878151896, 76.85054927214217, 250.6602398861037, 197.21078441566027, 0.0, 164.27397139026135, 204.30255195989193, 3.37199514717565, 202.40426800913008, 177.70094075549713, 190.1354470497204, 255.22775147712605, 222.6906649621525, 239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.300916746959804, "mean_inference_ms": 3.964977409086974, "mean_action_processing_ms": 1.017165491948724, "mean_env_wait_ms": 9.881739197181858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00554049015045166, "StateBufferConnector_ms": 0.005770206451416016, "ViewRequirementAgentConnector_ms": 0.18866240978240967}, "num_episodes": 1, "episode_return_max": 752.547858466753, "episode_return_min": 54.92320410719262, "episode_return_mean": 364.10729315436515, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.0296924513661, "num_env_steps_trained_throughput_per_sec": 154.0296924513661, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 26308.175, "restore_workers_time_ms": 0.021, "training_step_time_ms": 26307.81, "sample_time_ms": 2490.133, "learn_time_ms": 23784.171, "learn_throughput": 168.179, "synch_weights_time_ms": 30.28}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "60982_00000", "date": "2024-08-23_11-09-31", "timestamp": 1724391571, "time_this_iter_s": 26.01583170890808, "time_total_s": 583.5121479034424, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f77b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 583.5121479034424, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.38918918918919, "ram_util_percent": 82.82162162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.808281490411708, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.306416688646589, "policy_loss": -0.011488173072960562, "vf_loss": 5.3166442429577865, "vf_explained_var": 0.24148609057936088, "kl": 0.012606068039756446, "entropy": 1.0734598216556368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.411153606069151, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.413872599223303, "policy_loss": -0.012667434053032329, "vf_loss": 6.4248893132285465, "vf_explained_var": 0.14482304129020246, "kl": 0.00825355312215391, "entropy": 1.3116404086824447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 752.547858466753, "episode_reward_min": 36.96232089539465, "episode_reward_mean": 346.42183043797974, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -761.0469911804976, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 777.8533525534658}, "policy_reward_mean": {"prey_policy": -24.169337097425313, "predator_policy": 197.38025231641504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [608.6999999999999, 356.3000000000012, 404.77979419439606, 207.3195232153564, 325.2000000000006, 478.741230941515, 343.97140454453023, 343.69999999999965, 679.3000000000002, 340.40000000000083, 121.20000000000019, 528.0999999999995, 570.5272142826811, 310.20745994217475, 346.2919424553084, 449.97898731441705, 261.9858557391851, 464.7023933699624, 169.2642641101873, 250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.4707206819075793, 332.92548630842225, -104.7962630906957, 257.25771547142887, -63.0424411764048, -56.96632711559119, -5.0108379274042, -424.8631807641857, 140.39844836760523, 19.115713003108215, 262.4925312250596, 45.73220560225501, -23.32010613434722, 17.409853377557926, -93.78177955423854, 128.0701267629442, 263.78762027756227, 362.2690705254847, 177.2098529259749, -43.91776073228744, -210.80413936677397, -73.44560951160949, 250.39105625798723, 208.36498759179975, 199.76835626772754, 262.5578180995904, 54.30366640815342, 14.202942850923908, 146.20411816238828, -382.93321039595605, 4.602101177037596, 68.5158103759373, -39.98617326753902, -119.4072377210369, 247.1352908211284, -113.13068687966627, 31.207663779890545, -43.207247474723715, -44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977], "policy_predator_policy_reward": [239.52927931809216, 34.77451369157772, 139.49626309069376, 64.34228452857113, 256.1905480950194, 268.59801439137294, 98.37109904109056, 538.8224428658591, 145.70155163239477, 19.984286996891804, 71.97606750624857, 98.5404266079528, 36.87596264300965, 313.00569465831006, 174.58177955423855, 134.8298732370554, 48.8505162214009, 4.392792975552157, 129.2901470740251, 77.81776073228788, 240.30413936677238, 165.14560951160888, 51.00894374201288, 18.33501240820046, 12.054130933530473, 96.14690898183245, 41.04277750417339, 200.6580731789239, 343.3470450260149, 239.67398966286078, 303.70310085872757, 73.15797490271255, 243.56399040937183, 177.81527631838958, 303.5244284216956, 27.173361006805322, 62.6186543934444, 118.64519341157815, 217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3383411001387815, "mean_inference_ms": 3.97789170466038, "mean_action_processing_ms": 1.0574203705484209, "mean_env_wait_ms": 10.020991578308372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005234956741333008, "StateBufferConnector_ms": 0.005815386772155762, "ViewRequirementAgentConnector_ms": 0.1591484546661377}, "num_episodes": 14, "episode_return_max": 752.547858466753, "episode_return_min": 36.96232089539465, "episode_return_mean": 346.42183043797974, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.48546297213852, "num_env_steps_trained_throughput_per_sec": 153.48546297213852, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 26403.648, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26403.283, "sample_time_ms": 2544.051, "learn_time_ms": 23825.785, "learn_throughput": 167.885, "synch_weights_time_ms": 30.098}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "60982_00000", "date": "2024-08-23_11-09-57", "timestamp": 1724391597, "time_this_iter_s": 26.12188410758972, "time_total_s": 609.6340320110321, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a81f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 609.6340320110321, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.524324324324326, "ram_util_percent": 83.35945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.9703000429446105, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.857681905151044, "policy_loss": -0.012455939341868673, "vf_loss": 5.868722732987984, "vf_explained_var": 0.23731995411020107, "kl": 0.014151347950396556, "entropy": 0.9743396639823914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.875391246275927, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.563106022183857, "policy_loss": -0.015934403979332833, "vf_loss": 6.576582026607776, "vf_explained_var": 0.1413002957111944, "kl": 0.012292220800001391, "entropy": 1.254219940225914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 752.547858466753, "episode_reward_min": 36.96232089539465, "episode_reward_mean": 322.8895996739853, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1010.7411442562606, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 969.7269601982839}, "policy_reward_mean": {"prey_policy": -75.47583210656754, "predator_policy": 236.92063194356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.4043883042237, 534.3000000000033, 292.34978396559285, 455.922830106976, 289.0101656801594, 604.3244013239507, 448.39784853429524, 233.54168441109087, 478.99716581274004, 280.01611652351653, 257.8508551739048, 296.49999999999943, 375.8390648145433, 308.2567758758689, 263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-44.448471685004094, 33.627886926853485, 93.73312732045763, 282.47587698984904, -331.5125953228376, -43.186869733960584, 50.06670223464877, -41.84379033499521, -99.0052720342254, 44.44273197234149, 92.85012892295897, 33.08934894866851, 168.6906357526104, -172.63000475233528, -169.2112368076538, -189.51325629843097, 103.73435582211201, -61.0417532166099, 73.32076002237214, -99.48840132410642, 9.185938586419814, -302.7128736122081, -50.75999591387896, 112.72335989849782, -211.1207435606966, -65.66071896586544, 49.444018216272944, 9.968944479897463, -334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182], "policy_predator_policy_reward": [217.9268573801965, 43.298115682180274, 6.501832322336034, 151.58916336735587, 335.67458013803065, 331.37466888436103, 205.0053349128213, 242.69458329449998, 113.3714696380628, 230.2012361039739, 143.10455574363073, 335.28036770868863, 264.84089775582925, 187.49631977819186, 340.92358842982344, 251.34258908735202, 408.7894355682763, 27.51512763896057, 281.4654034204356, 24.718354404815308, 231.32764468439112, 320.0501455153066, 95.81323696138807, 138.7233990539936, 231.65013454771227, 420.9703927933909, 125.38764877490844, 123.4561644047896, 496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.325232204969632, "mean_inference_ms": 3.9720487328198355, "mean_action_processing_ms": 1.0992942422014433, "mean_env_wait_ms": 10.072229270861094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004250884056091309, "StateBufferConnector_ms": 0.0056421756744384766, "ViewRequirementAgentConnector_ms": 0.16311275959014893}, "num_episodes": 19, "episode_return_max": 752.547858466753, "episode_return_min": 36.96232089539465, "episode_return_mean": 322.8895996739853, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.23685073741137, "num_env_steps_trained_throughput_per_sec": 157.23685073741137, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 26300.828, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26300.465, "sample_time_ms": 2575.832, "learn_time_ms": 23691.158, "learn_throughput": 168.839, "synch_weights_time_ms": 30.202}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "60982_00000", "date": "2024-08-23_11-10-23", "timestamp": 1724391623, "time_this_iter_s": 25.469043970108032, "time_total_s": 635.1030759811401, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f780160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 635.1030759811401, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.899999999999995, "ram_util_percent": 83.26111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.49932210615703, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.981109684232681, "policy_loss": -0.009674984504463812, "vf_loss": 6.989617537442969, "vf_explained_var": 0.2477073376771634, "kl": 0.01167125041897177, "entropy": 0.8490111371196767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.854524209827343, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.047543127574618, "policy_loss": -0.0138838827299575, "vf_loss": 7.059175928307589, "vf_explained_var": 0.1162498428077294, "kl": 0.01125535791463874, "entropy": 1.1966007971889758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 782.5, "episode_reward_min": 36.96232089539465, "episode_reward_mean": 306.83060598304576, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1077.8297796171883, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1201.2507812984672}, "policy_reward_mean": {"prey_policy": -117.26481475025511, "predator_policy": 270.68011774177796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [263.18976623328797, 494.428914377531, 205.4999999999992, 408.79175347954094, 149.35947968349112, 194.09999999999914, 54.92320410719262, 209.24570800532146, 244.86282125664079, 434.3000000000027, 341.7027670874981, 416.49999999999966, 445.0628117606224, 266.90000000000003, 325.1787371540506, 471.28990336053835, 327.18444577018056, 148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-334.25369004115254, -99.24358338862042, -82.19420506807474, 205.1518083584951, -78.02010927071495, -203.3995504793341, 12.17884228821004, -8.188909214474974, 2.334365982205044, -137.88518178492598, 2.906001527770755, -55.938485359727984, 8.495054015673631, -116.79005976244574, -50.97365199860436, -174.91785137489273, 35.38452096659558, -207.32346823116373, 14.660968287352183, 396.4, -143.3895967852495, 56.581298705824395, -76.83060250394341, 221.75002511224403, -126.37679518171586, 196.6633976733218, -39.51078321691321, -64.86041435401346, -185.15670012911724, -54.87710366806017, 176.4648417425492, 62.53275214872933, -452.3157853004518, 57.84534343953161, -186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785], "policy_predator_policy_reward": [496.3877790672977, 200.29926059576252, 342.8256586325542, 28.645652454555396, 139.72010927071352, 347.199550479334, 115.79713144562608, 289.00468896017645, 159.83186085240763, 125.07843463380613, 157.89399847222927, 89.23848535972704, 13.591870300030685, 149.62633955393224, 99.87535262301006, 335.26185875580893, 118.61636799441985, 298.18540052678946, 23.239031712647826, 0.0, 210.45780202270575, 218.05326314421447, 25.925966887477685, 245.65461050422186, 362.673929686544, 12.102279582471411, 361.3646254778215, 9.906572093105765, 448.3808738661313, 116.83166708509422, 180.69276612864195, 51.59954334061821, 672.1218549038233, 49.533032727276215, 275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.318753222223275, "mean_inference_ms": 3.931578404777191, "mean_action_processing_ms": 1.1348277493413166, "mean_env_wait_ms": 10.108060974878578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003909945487976074, "StateBufferConnector_ms": 0.005486726760864258, "ViewRequirementAgentConnector_ms": 0.15076124668121338}, "num_episodes": 14, "episode_return_max": 782.5, "episode_return_min": 36.96232089539465, "episode_return_mean": 306.83060598304576, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.0555318045615, "num_env_steps_trained_throughput_per_sec": 158.0555318045615, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 26197.921, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26197.573, "sample_time_ms": 2569.324, "learn_time_ms": 23595.491, "learn_throughput": 169.524, "synch_weights_time_ms": 29.472}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "60982_00000", "date": "2024-08-23_11-10-48", "timestamp": 1724391648, "time_this_iter_s": 25.366551876068115, "time_total_s": 660.4696278572083, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a6670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 660.4696278572083, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.569444444444443, "ram_util_percent": 82.62500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.443166820775895, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.104957677952196, "policy_loss": -0.011806126278899019, "vf_loss": 7.115663756516875, "vf_explained_var": 0.2065640930145506, "kl": 0.011000353946946758, "entropy": 0.7989934843684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.13471199955259, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.476753095596556, "policy_loss": -0.014699630920957557, "vf_loss": 7.489387760465108, "vf_explained_var": 0.11961365238068596, "kl": 0.010324834266963302, "entropy": 1.1501606924823984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 782.5, "episode_reward_min": 22.020079995554497, "episode_reward_mean": 288.15874251383406, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1077.8297796171883, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1201.2507812984672}, "policy_reward_mean": {"prey_policy": -178.51911522435145, "predator_policy": 322.59848648126865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [148.69305901260333, 371.39999999999986, 564.566177994213, 180.8999999999971, 687.4311349589238, 445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-186.41383242883512, -130.9819820166881, -71.64953774337918, 155.49029698764363, 332.77889243049685, 51.06180766308691, 13.476882624819257, 8.054299151547518, 355.9, 300.2546901437568, 239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547], "policy_predator_policy_reward": [275.08050379966835, 191.0083696584587, 100.3781344720943, 187.18110628364138, 6.825919752075079, 173.89955814855435, 158.26051020424947, 1.1083080193838435, 21.50047724573622, 9.77596756943072, 116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.252348801121274, "mean_inference_ms": 3.913712546869192, "mean_action_processing_ms": 1.1638943149402599, "mean_env_wait_ms": 10.082145830391038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037387609481811523, "StateBufferConnector_ms": 0.005187392234802246, "ViewRequirementAgentConnector_ms": 0.12780308723449707}, "num_episodes": 17, "episode_return_max": 782.5, "episode_return_min": 22.020079995554497, "episode_return_mean": 288.15874251383406, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.6814868377104, "num_env_steps_trained_throughput_per_sec": 160.6814868377104, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 25775.069, "restore_workers_time_ms": 0.022, "training_step_time_ms": 25774.668, "sample_time_ms": 2554.806, "learn_time_ms": 23193.04, "learn_throughput": 172.466, "synch_weights_time_ms": 23.235}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "60982_00000", "date": "2024-08-23_11-11-13", "timestamp": 1724391673, "time_this_iter_s": 24.91657781600952, "time_total_s": 685.3862056732178, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f780af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 685.3862056732178, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.07777777777777, "ram_util_percent": 82.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.443013729494084, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.871604940626356, "policy_loss": -0.009421508707520034, "vf_loss": 7.880012031333156, "vf_explained_var": 0.21928441265903453, "kl": 0.01014406013169459, "entropy": 0.7232342238779421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.79379533535589, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.654474492552419, "policy_loss": -0.014558984303758259, "vf_loss": 7.666943913918955, "vf_explained_var": 0.21429090052054672, "kl": 0.010447934708464397, "entropy": 1.1383897584582132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 782.5, "episode_reward_min": 22.020079995554497, "episode_reward_mean": 278.37044990434435, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1077.8297796171883, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1201.2507812984672}, "policy_reward_mean": {"prey_policy": -194.54585365799124, "predator_policy": 333.73107861016365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.7558154527909, 398.67185147576936, 582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [239.142493001857, -269.01031594631297, -362.0591239032992, 40.02454214747253, 215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256], "policy_predator_policy_reward": [116.9700257929275, 358.6536126043197, 618.2300263188305, 102.47640691276497, 166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.23834017979658, "mean_inference_ms": 3.892550067370172, "mean_action_processing_ms": 1.1651229927386195, "mean_env_wait_ms": 10.063339468168722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.005133628845214844, "ViewRequirementAgentConnector_ms": 0.13379645347595215}, "num_episodes": 5, "episode_return_max": 782.5, "episode_return_min": 22.020079995554497, "episode_return_mean": 278.37044990434435, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.42231646025283, "num_env_steps_trained_throughput_per_sec": 157.42231646025283, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 25474.844, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25474.491, "sample_time_ms": 2302.983, "learn_time_ms": 23145.395, "learn_throughput": 172.821, "synch_weights_time_ms": 22.674}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "60982_00000", "date": "2024-08-23_11-11-38", "timestamp": 1724391698, "time_this_iter_s": 25.46163296699524, "time_total_s": 710.847838640213, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f78d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 710.847838640213, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 32.07222222222222, "ram_util_percent": 83.39722222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.791958424780104, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.156726054539757, "policy_loss": -0.009679773149928128, "vf_loss": 8.165369117070759, "vf_explained_var": 0.2376416838358319, "kl": 0.010367160740126141, "entropy": 0.7063028633909881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.599566289104482, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.672818095595749, "policy_loss": -0.017153376046193654, "vf_loss": 7.68785064535797, "vf_explained_var": 0.2651875173604047, "kl": 0.010604177560736104, "entropy": 1.1094295239953138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 782.5, "episode_reward_min": 22.020079995554497, "episode_reward_mean": 273.4793387753786, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1077.8297796171883, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1201.2507812984672}, "policy_reward_mean": {"prey_policy": -204.77618532445962, "predator_policy": 341.5158547121492}, "custom_metrics": {}, "hist_stats": {"episode_reward": [582.1829377256242, 492.37906036424476, 401.0448623311576, 411.22404999901954, 371.52749356136917, 235.63225511300652, 270.85270326736355, 300.0052799908472, 105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [215.58558773820727, 73.25439180575084, 32.39116143281343, -52.110800823743745, -26.272135459912235, 287.1038424559863, 180.91873856112994, -335.6981538616877, -56.665391280614905, -129.56448270472868, 22.500528755162343, -84.57304922068747, -276.3698398646013, -70.00121390862321, -78.14855010583149, -15.861262213247944, 12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261], "policy_predator_policy_reward": [166.40009987960642, 126.94285830205993, 462.0903266812619, 50.00837307391146, 55.78151570500625, 84.43163963007561, 154.49276412517918, 411.51070117439804, 285.70327109687815, 272.0540964498288, 121.90362975858417, 175.80114581994926, 385.0319819401363, 232.19177510045037, 287.0799565009804, 106.93513580894484, 107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.229641305596158, "mean_inference_ms": 3.8812658955039363, "mean_action_processing_ms": 1.1648784075007397, "mean_env_wait_ms": 10.051597987232537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036481618881225586, "StateBufferConnector_ms": 0.005147099494934082, "ViewRequirementAgentConnector_ms": 0.13411366939544678}, "num_episodes": 2, "episode_return_max": 782.5, "episode_return_min": 22.020079995554497, "episode_return_mean": 273.4793387753786, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.65000261261974, "num_env_steps_trained_throughput_per_sec": 149.65000261261974, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 25565.912, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25565.527, "sample_time_ms": 2313.471, "learn_time_ms": 23223.685, "learn_throughput": 172.238, "synch_weights_time_ms": 24.568}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "60982_00000", "date": "2024-08-23_11-12-05", "timestamp": 1724391725, "time_this_iter_s": 26.7762930393219, "time_total_s": 737.6241316795349, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f789820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 737.6241316795349, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 42.94210526315789, "ram_util_percent": 83.1973684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.306559007003824, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.089306035622087, "policy_loss": -0.008843744334286799, "vf_loss": 8.097226489536347, "vf_explained_var": 0.2100597758141775, "kl": 0.009233115250540394, "entropy": 0.6968850078406157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.496495993427498, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.509950809377842, "policy_loss": -0.014188432310604387, "vf_loss": 7.5220698225435125, "vf_explained_var": 0.3446674341247195, "kl": 0.010347043219263908, "entropy": 1.135172668083635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 782.5, "episode_reward_min": 0.8112531574336507, "episode_reward_mean": 267.62361829903745, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1360.731440096938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1319.7726263925094}, "policy_reward_mean": {"prey_policy": -258.3964647901541, "predator_policy": 392.20827393967306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.92195976632968, 376.54587668127436, 396.9067480577438, 645.9086980395564, 322.4792192446895, 752.547858466753, 481.8217718996142, 316.87034221490234, 229.8127370043751, 627.5999999999995, 77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.030627971716346, -103.58418169355724, -214.31757653232083, -98.41001176872244, 41.402339038518775, -108.89096308033862, 240.00541254617642, 338.4997934873526, -83.51525133434512, 92.53048860763057, 400.0, 275.57543050621456, 179.3248575808976, -28.149715662196773, -8.497296245133553, -28.55911596591928, -53.092185382117016, -213.9464381347487, 372.7828853229844, 191.501361215374, 10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523], "policy_predator_policy_reward": [107.22350081767314, 90.25201267049806, 525.1142728338663, 164.15919214844973, 29.223294027007423, 435.1720780725558, 60.560955357457054, 6.842536648570883, 168.7652955374536, 144.69868643394884, 12.347858466753037, 64.62456949378556, 67.18135291211497, 263.4652770687983, 18.743517919585457, 335.1832365063637, 180.33674834822278, 316.51461217301943, 14.217114677015633, 49.09863878462623, 28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.201523851173873, "mean_inference_ms": 3.8614196323850916, "mean_action_processing_ms": 1.180281617031019, "mean_env_wait_ms": 10.063677967274147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003610849380493164, "StateBufferConnector_ms": 0.004038453102111816, "ViewRequirementAgentConnector_ms": 0.12617194652557373}, "num_episodes": 8, "episode_return_max": 782.5, "episode_return_min": 0.8112531574336507, "episode_return_mean": 267.62361829903745, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.12652370429586, "num_env_steps_trained_throughput_per_sec": 153.12652370429586, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 25656.544, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25656.139, "sample_time_ms": 2324.03, "learn_time_ms": 23303.434, "learn_throughput": 171.649, "synch_weights_time_ms": 24.919}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "60982_00000", "date": "2024-08-23_11-12-31", "timestamp": 1724391751, "time_this_iter_s": 26.16835880279541, "time_total_s": 763.7924904823303, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 763.7924904823303, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 35.997297297297294, "ram_util_percent": 82.4972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.275346857277804, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.498680405894285, "policy_loss": -0.007535510091111064, "vf_loss": 7.50537188494647, "vf_explained_var": 0.253687756591373, "kl": 0.008440514611789868, "entropy": 0.6971724828715047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.279376033752683, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.199722433847095, "policy_loss": -0.014191322402151488, "vf_loss": 7.211862337021601, "vf_explained_var": 0.362841765527372, "kl": 0.010257111353277372, "entropy": 1.1329406127727852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 782.5, "episode_reward_min": 0.8112531574336507, "episode_reward_mean": 244.77221766182504, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1360.731440096938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1319.7726263925094}, "policy_reward_mean": {"prey_policy": -321.097034942407, "predator_policy": 443.48314377331997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.99999999999984, 396.6438715016256, 512.5524097643049, 359.6000000000026, 356.15116287241716, 367.5660516115676, 280.6081038017104, 313.3531125243908, 289.89999999999975, 284.64822210914946, 464.51233715434773, 88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.776662011321148, 28.61963265512408, -56.96280657596734, -25.2773992593237, -50.17684002670353, 138.0468052633952, 273.96092196938173, -2.1829830191611532, 161.69336744881412, -410.73944405396844, -58.22334306059326, 52.349451181184875, -141.21240773304046, 102.55413722827392, -217.58999653870077, 118.46627301982245, 2.1032838685678787, 84.38584046964748, -109.17957725565003, -34.99654562643433, 325.8388555663801, -255.44594530640177, 40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399], "policy_predator_policy_reward": [28.123337988678962, 10.480367344876038, 0.0, 478.8840773369151, 113.4979799229749, 311.18446460463815, 16.937063498477713, 70.8849975513023, 69.94708277970363, 535.2501566978676, 67.18028692684526, 306.25965656412893, 290.535532651568, 28.730841654907483, 219.19497019718753, 193.28186584608014, 35.396716131432356, 168.01415953035226, 17.45508762190379, 411.3692573693276, 237.72483735821888, 156.3945895361474, 14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.19185732448586, "mean_inference_ms": 3.8345919735134077, "mean_action_processing_ms": 1.1946132789237522, "mean_env_wait_ms": 10.086130946573512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037848949432373047, "StateBufferConnector_ms": 0.004056572914123535, "ViewRequirementAgentConnector_ms": 0.1484527587890625}, "num_episodes": 10, "episode_return_max": 782.5, "episode_return_min": 0.8112531574336507, "episode_return_mean": 244.77221766182504, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.5861520065826, "num_env_steps_trained_throughput_per_sec": 157.5861520065826, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 25676.101, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25675.696, "sample_time_ms": 2315.511, "learn_time_ms": 23331.693, "learn_throughput": 171.441, "synch_weights_time_ms": 24.769}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "60982_00000", "date": "2024-08-23_11-12-57", "timestamp": 1724391777, "time_this_iter_s": 25.441672801971436, "time_total_s": 789.2341632843018, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a6280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 789.2341632843018, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.863888888888894, "ram_util_percent": 82.17222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.956793092419861, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.794982411621739, "policy_loss": -0.011815451328499765, "vf_loss": 7.805818406362382, "vf_explained_var": 0.22994216289469804, "kl": 0.009794457452174611, "entropy": 0.6420307103288236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.056588072120828, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.306552978293605, "policy_loss": -0.011251345520750397, "vf_loss": 7.31582249131783, "vf_explained_var": 0.3136911231373984, "kl": 0.00990925952545786, "entropy": 1.1229423903914355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 818.6127964124094, "episode_reward_min": 0.8112531574336507, "episode_reward_mean": 244.42281488293827, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1360.731440096938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1319.7726263925094}, "policy_reward_mean": {"prey_policy": -387.04663314382253, "predator_policy": 509.2580405852922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.29265168298635, 213.9373403958323, 36.96232089539465, 258.10420271953944, 206.31233298340598, 750.5, 56.200000000000465, 465.0999999999999, 127.61425083828446, 343.1471006109191, 143.9347188971108, 168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [40.0000000000003, -140.41205976634927, 33.74120536006598, -74.3849599033415, -490.65685164714125, -434.35681128557934, -333.1009199089486, -761.0469911804976, -584.0423372569446, -117.9046315944121, 362.4486156019362, 337.06316394216776, -649.6203531920198, -125.40430026673225, 172.88599979452908, -239.2579303238398, -642.8999688164407, -455.37713043720515, 135.97673780059299, -351.1591519818239, -272.7134903539344, -524.6820157471619, -58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714], "policy_predator_policy_reward": [14.192651682987071, 174.51205976634733, 132.4426350362174, 122.13845990289141, 507.219172542538, 454.7568112855825, 686.4420601804414, 665.8100536285451, 685.6973628387304, 222.56193899603264, 7.851384398063823, 43.136836057832234, 669.9203531920206, 161.304300266731, 93.86167590463668, 437.6102546246744, 448.037997538465, 777.8533525534658, 54.72533168579615, 503.6041831063532, 545.5964759779018, 395.73374902030827, 204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.149482749727122, "mean_inference_ms": 3.819347101979697, "mean_action_processing_ms": 1.2056430610315305, "mean_env_wait_ms": 10.059817248862943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004185914993286133, "StateBufferConnector_ms": 0.009354114532470703, "ViewRequirementAgentConnector_ms": 0.15939009189605713}, "num_episodes": 11, "episode_return_max": 818.6127964124094, "episode_return_min": 0.8112531574336507, "episode_return_mean": 244.42281488293827, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.8374318859748, "num_env_steps_trained_throughput_per_sec": 159.8374318859748, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 25634.042, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25633.719, "sample_time_ms": 2291.013, "learn_time_ms": 23315.013, "learn_throughput": 171.563, "synch_weights_time_ms": 24.047}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "60982_00000", "date": "2024-08-23_11-13-22", "timestamp": 1724391802, "time_this_iter_s": 25.094866275787354, "time_total_s": 814.3290295600891, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f78d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 814.3290295600891, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 37.71428571428571, "ram_util_percent": 82.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.232582966865055, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.332438523428781, "policy_loss": -0.008991712110028381, "vf_loss": 8.340610574288343, "vf_explained_var": 0.19847121219786387, "kl": 0.00819638940485973, "entropy": 0.5923239764713105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.65008941869887, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.777116476795661, "policy_loss": -0.012864910006503421, "vf_loss": 7.787986108991835, "vf_explained_var": 0.3111673464850774, "kl": 0.00997642400285239, "entropy": 1.1202102276383255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 818.6127964124094, "episode_reward_min": 0.8112531574336507, "episode_reward_mean": 248.7524450414156, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1360.731440096938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1319.7726263925094}, "policy_reward_mean": {"prey_policy": -430.91962348582075, "predator_policy": 555.2958460065291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.39999999999742, 127.06592753985365, 165.4935703604975, 121.22772340018275, 273.72198237771977, 209.43579936348024, 219.4769876364471, 362.97361387168945, 158.91274380284892, 677.6105188558249, 438.70000000000283, 140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-58.97859661040332, 19.750480668511084, -261.06893436810014, -325.11986965205307, -101.82906801025122, -22.674817346129977, -410.26238906827905, 36.95380619549695, -532.2490165813475, -235.17008683198438, -244.91272865718938, -111.77950755776135, -154.06024419036586, -241.36975438246836, 30.057267385381593, -347.9528336144414, -540.0220208628189, -111.20628313620988, 201.98644574155773, 325.69374409480946, 23.505669332699952, 400.0, -259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279], "policy_predator_policy_reward": [204.60097721996223, 3.027138721928234, 199.83696254643613, 513.4177690135713, 49.615030096949255, 240.3824256199319, 475.12849617563177, 19.407810097334156, 687.8673717871345, 353.2737140039163, 179.73789861224222, 386.39013696618696, 374.2714195959747, 240.63556661330645, 302.10526039650006, 378.7639197042487, 12.379530849141279, 797.7615169527381, 141.31305742543697, 8.617271594020831, 15.194330667300079, 0.0, 156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.113658299942079, "mean_inference_ms": 3.797886964767269, "mean_action_processing_ms": 1.1978812785865054, "mean_env_wait_ms": 10.065054482061866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004218697547912598, "StateBufferConnector_ms": 0.009340047836303711, "ViewRequirementAgentConnector_ms": 0.16008877754211426}, "num_episodes": 11, "episode_return_max": 818.6127964124094, "episode_return_min": 0.8112531574336507, "episode_return_mean": 248.7524450414156, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.0486138905593, "num_env_steps_trained_throughput_per_sec": 161.0486138905593, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 25520.858, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25520.568, "sample_time_ms": 2188.966, "learn_time_ms": 23304.973, "learn_throughput": 171.637, "synch_weights_time_ms": 23.169}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "60982_00000", "date": "2024-08-23_11-13-47", "timestamp": 1724391827, "time_this_iter_s": 24.860991954803467, "time_total_s": 839.1900215148926, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f780d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 839.1900215148926, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 37.02, "ram_util_percent": 82.48285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.017222866305598, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.389523221071435, "policy_loss": -0.008446044320112499, "vf_loss": 8.397207064855666, "vf_explained_var": 0.18239964303516207, "kl": 0.0076218127913615374, "entropy": 0.5607055080946161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.762870859216761, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.872695900145031, "policy_loss": -0.013393209062556111, "vf_loss": 7.883917423530861, "vf_explained_var": 0.35511290566631093, "kl": 0.010858429170080593, "entropy": 1.0795200959715263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 818.6127964124094, "episode_reward_min": 0.2733142082693816, "episode_reward_mean": 242.17713375946533, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1376.4069419592472, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1383.546156415991}, "policy_reward_mean": {"prey_policy": -513.4855910728164, "predator_policy": 634.5741579525497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.13845134535404, 185.56028052553316, 646.752861475669, 272.603181367526, 161.26035672464562, 244.79999999999922, 91.148561320046, 172.4734094435339, 72.22988102187509, 141.18891831333434, 367.2317228645516, 178.8156526282635, 782.5, 335.35190083805196, 91.55367089885712, 190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-259.79209613092326, -364.9432894484406, -490.72596907029606, -22.78881854864339, -13.54071218212534, -346.8242325517812, -625.0102576164946, -54.03085439547827, -1010.7411442562606, -119.95905333123582, -36.607669406553754, -363.54214578868044, -153.73325378809375, -23.58694323195987, -780.6165673075867, -154.2847400908531, -26.510583093941413, -965.3985159776548, -108.07070964746688, -183.5409089262784, 273.9129138141559, -823.3953635095182, -484.6490763067334, -524.7796956298166, 400.0, 364.8714669198229, -99.59219050158634, -793.3958972768093, -1077.8297796171883, -50.09220032319287, -834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797], "policy_predator_policy_reward": [156.63434138619274, 608.2394955385291, 29.10025926287001, 669.9748088816045, 335.18353811441693, 671.9342680951574, 572.3600178479678, 379.2842755315315, 504.09188429963484, 787.8686700125055, 567.0349733324192, 77.91484186281389, 214.34303876949784, 54.125719570601404, 728.0544306594744, 379.3202861824993, 94.41201989518909, 969.7269601982839, 221.85617325152992, 210.94436363554942, 49.3103464662274, 867.4038260936869, 589.6804761914476, 598.5639483733689, 0.0, 17.6285330801771, 449.1824599539975, 779.1575286624475, 18.224869540771635, 1201.2507812984672, 445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.0954363295786, "mean_inference_ms": 3.7652957053013956, "mean_action_processing_ms": 1.1827037089567456, "mean_env_wait_ms": 10.07291566147891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004292964935302734, "StateBufferConnector_ms": 0.0093153715133667, "ViewRequirementAgentConnector_ms": 0.15909099578857422}, "num_episodes": 11, "episode_return_max": 818.6127964124094, "episode_return_min": 0.2733142082693816, "episode_return_mean": 242.17713375946533, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.44897515241905, "num_env_steps_trained_throughput_per_sec": 160.44897515241905, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 25407.761, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25407.449, "sample_time_ms": 2145.015, "learn_time_ms": 23234.184, "learn_throughput": 172.16, "synch_weights_time_ms": 24.834}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "60982_00000", "date": "2024-08-23_11-14-12", "timestamp": 1724391852, "time_this_iter_s": 24.96743392944336, "time_total_s": 864.1574554443359, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f776940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 864.1574554443359, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 38.391666666666666, "ram_util_percent": 82.8138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.432112246972543, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.405201182794318, "policy_loss": -0.009889001046952905, "vf_loss": 8.41420764468965, "vf_explained_var": 0.16950098692424714, "kl": 0.008825454980297576, "entropy": 0.5462641038276531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000096}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.017878182098348, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.92110980351766, "policy_loss": -0.014540553253474177, "vf_loss": 7.933417140112983, "vf_explained_var": 0.35602764900399264, "kl": 0.011165979610036606, "entropy": 1.0552822977777512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000096}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 912.6675908560791, "episode_reward_min": 0.2733142082693816, "episode_reward_mean": 271.6241731110584, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1376.4069419592472, "predator_policy": 1.8446824360177985}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1383.546156415991}, "policy_reward_mean": {"prey_policy": -557.5208320329206, "predator_policy": 693.3329185884505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.39189180558932, 226.69262000726266, 151.89999999999816, 257.6748059278517, 143.18612056466262, 451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-834.4951202174595, -335.9213606026744, -140.7535318809143, -379.1130023927648, -541.07659720014, 7.631737056155668, -454.46033430152056, -402.94387451079336, -220.51519077236046, -278.22695495179386, 117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456], "policy_predator_policy_reward": [445.2814668614124, 915.5269057643138, 180.53255305419086, 566.0266012267505, 655.6765972001405, 29.668262943844468, 715.1032227391831, 399.9757920009825, 364.5603775945658, 277.36788869425664, 1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.047037399872081, "mean_inference_ms": 3.734830179058341, "mean_action_processing_ms": 1.1742746954184833, "mean_env_wait_ms": 10.060248984682485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004552483558654785, "StateBufferConnector_ms": 0.009372234344482422, "ViewRequirementAgentConnector_ms": 0.16944348812103271}, "num_episodes": 15, "episode_return_max": 912.6675908560791, "episode_return_min": 0.2733142082693816, "episode_return_mean": 271.6241731110584, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.3049564936993, "num_env_steps_trained_throughput_per_sec": 162.3049564936993, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 25328.327, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25328.045, "sample_time_ms": 2111.451, "learn_time_ms": 23188.815, "learn_throughput": 172.497, "synch_weights_time_ms": 24.657}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "60982_00000", "date": "2024-08-23_11-14-37", "timestamp": 1724391877, "time_this_iter_s": 24.65079402923584, "time_total_s": 888.8082494735718, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 888.8082494735718, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 36.98235294117647, "ram_util_percent": 81.95294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.538185121521117, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.513848183142445, "policy_loss": -0.008222785846837772, "vf_loss": 8.521214602233242, "vf_explained_var": 0.17235897388407792, "kl": 0.008563759589380531, "entropy": 0.518541349084289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.131320306359145, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.764841998064959, "policy_loss": -0.01369660517062854, "vf_loss": 7.776305347523361, "vf_explained_var": 0.39284331180431226, "kl": 0.011166403098672471, "entropy": 1.0073075925231612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 912.6675908560791, "episode_reward_min": 0.2733142082693816, "episode_reward_mean": 270.3025451905315, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1379.573744362276, "predator_policy": 1.8446824360177985}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1383.546156415991}, "policy_reward_mean": {"prey_policy": -588.8676792233643, "predator_policy": 724.0189518186309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [451.36370018526566, 285.0300458584928, 95.8426326483364, 65.4000000000002, 244.10867007027582, 178.36756416248468, 92.03651775492219, 227.98846155128004, 352.60212686868675, 22.020079995554497, 419.90660444754985, 184.0762263096773, 60.36393202250021, 292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [117.43732996982523, 75.8688297316796, -441.1684663328547, -531.6799701704614, 20.780934638500877, -339.5066333450974, -223.0720248585281, -618.3618116312073, -869.7810107784545, -427.75427091999785, 17.876485325021413, -731.4348299760795, -263.48873642406505, -464.7161423803176, -19.570586969778127, -440.0160154237092, -786.5681096512103, -12.330050530138465, -619.910589246205, -711.8585675734627, -282.3067473939227, -632.5621404615722, 16.688402708581204, 31.974315478543097, -1010.0480692092985, -804.8323469732012, -279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315], "policy_predator_policy_reward": [1.8446824360177985, 256.2128580477418, 696.2606941909005, 561.6177881709135, 130.26729931120047, 284.30103204373955, 263.3720248585268, 643.4618116312072, 661.7589728309233, 879.8849789378056, 371.0743216915905, 520.8515871219555, 125.21038374239005, 695.0310128169162, 530.7220580517978, 156.85300589297233, 747.3932126905468, 404.1070743594881, 497.45384311835056, 856.3353936968748, 440.4556950423437, 894.3197972607005, 65.42185974748797, 69.99164837506873, 1019.3480692092986, 855.8962789957021, 223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.024283472980777, "mean_inference_ms": 3.730064661938157, "mean_action_processing_ms": 1.1687811964468335, "mean_env_wait_ms": 10.05558094482418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004555463790893555, "StateBufferConnector_ms": 0.009375333786010742, "ViewRequirementAgentConnector_ms": 0.17028272151947021}, "num_episodes": 5, "episode_return_max": 912.6675908560791, "episode_return_min": 0.2733142082693816, "episode_return_mean": 270.3025451905315, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.5890595433441, "num_env_steps_trained_throughput_per_sec": 160.5890595433441, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 25288.398, "restore_workers_time_ms": 0.036, "training_step_time_ms": 25288.106, "sample_time_ms": 2100.581, "learn_time_ms": 23159.25, "learn_throughput": 172.717, "synch_weights_time_ms": 24.798}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "60982_00000", "date": "2024-08-23_11-15-02", "timestamp": 1724391902, "time_this_iter_s": 24.935976028442383, "time_total_s": 913.7442255020142, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7895e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 913.7442255020142, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.236111111111114, "ram_util_percent": 81.56944444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.122305257862838, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.823812344465306, "policy_loss": -0.00809016778853244, "vf_loss": 8.831257933157461, "vf_explained_var": 0.04219078121992646, "kl": 0.006446113831747973, "entropy": 0.4220780479214179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.721834712053733, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.567853504766232, "policy_loss": -0.015599273490625872, "vf_loss": 7.581303452183961, "vf_explained_var": 0.3903610698760502, "kl": 0.010746609230363179, "entropy": 0.9542946677359324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 912.6675908560791, "episode_reward_min": 0.2733142082693816, "episode_reward_mean": 288.14358608366695, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1379.573744362276, "predator_policy": 13.754945948496143}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1383.546156415991}, "policy_reward_mean": {"prey_policy": -636.0500511312588, "predator_policy": 780.1218441730927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.06529694337286, 215.69999999999828, 220.9602611920539, 116.4984778791568, 273.5458980337522, 131.54512211138555, 288.10718411911597, 237.6555425024299, 71.89466946080555, 124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-279.48950610781236, -125.66204018544244, -555.584806549211, 100.44942356078222, -694.0166205782955, -63.45198794111947, -579.126962136808, -294.55918791680034, -304.3875349402225, -69.08034526746212, -528.4949393303395, -771.5774453198078, -282.20884006440895, -671.9265273757836, 45.44132371265903, -567.9693312769367, -504.7364781561748, -634.4718671103547, -496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431], "policy_predator_policy_reward": [223.87675088676167, 473.3400923498674, 657.0804370399321, 13.754945948496143, 834.3386073463242, 144.090262365143, 404.54365819726667, 585.640969735503, 617.0246815854109, 29.98909665603007, 311.2350680873638, 1120.3824386741715, 666.8021656702202, 575.4403858890887, 713.171709369932, 47.01184069677501, 950.0712771464896, 261.03173758084785, 578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9820433501986114, "mean_inference_ms": 3.699642524283226, "mean_action_processing_ms": 1.1549837930885243, "mean_env_wait_ms": 10.032527184118853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004789113998413086, "StateBufferConnector_ms": 0.00951838493347168, "ViewRequirementAgentConnector_ms": 0.17291581630706787}, "num_episodes": 13, "episode_return_max": 912.6675908560791, "episode_return_min": 0.2733142082693816, "episode_return_mean": 288.14358608366695, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.82081072142316, "num_env_steps_trained_throughput_per_sec": 160.82081072142316, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 25286.221, "restore_workers_time_ms": 0.036, "training_step_time_ms": 25285.981, "sample_time_ms": 2099.46, "learn_time_ms": 23159.417, "learn_throughput": 172.716, "synch_weights_time_ms": 24.199}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "60982_00000", "date": "2024-08-23_11-15-26", "timestamp": 1724391926, "time_this_iter_s": 24.882741928100586, "time_total_s": 938.6269674301147, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f776790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 938.6269674301147, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 37.379999999999995, "ram_util_percent": 81.74285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.853155376419188, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.685568546113513, "policy_loss": -0.0075818838073660145, "vf_loss": 8.69252862728462, "vf_explained_var": 0.12016746524780515, "kl": 0.006217953287528227, "entropy": 0.4334782791200769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 485.2299999999996}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.417494765034428, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.634066542872676, "policy_loss": -0.015733780426332954, "vf_loss": 7.647419307850026, "vf_explained_var": 0.40884381280374277, "kl": 0.011905136703459359, "entropy": 0.9633771330591232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 485.2299999999996}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 912.6675908560791, "episode_reward_min": 0.2733142082693816, "episode_reward_mean": 283.93493141248257, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1483.0495830628354, "predator_policy": 35.06968749537663}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -696.9784401785505, "predator_policy": 838.9459058847924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.79999999999939, 162.7076807940318, 148.78055736760726, 354.40375957372527, 183.4691132814056, 271.7919426822731, 83.52461134971219, 0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-496.16403624761506, 7.230312504623498, 11.695198483747518, -468.0667388083916, 33.899171676094966, 17.117919165357314, -689.4207730588197, -432.32420016932286, 40.0000000000003, -401.34302346119256, -983.7606310813493, -412.81823114168714, -996.4299402245919, -4.959935546329261, -370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678], "policy_predator_policy_reward": [578.6640362476157, 35.06968749537663, 490.11393076716405, 128.96529035151315, 36.62441906566469, 61.13904746049333, 839.7576816675878, 636.3910511342789, 222.60016942409075, 322.2119673185081, 902.2505733849025, 766.120231520412, 91.0416535553028, 993.8728335653312, 180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.969825299258291, "mean_inference_ms": 3.67573056038102, "mean_action_processing_ms": 1.1521133577573381, "mean_env_wait_ms": 10.029536134117722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004673957824707031, "StateBufferConnector_ms": 0.009438514709472656, "ViewRequirementAgentConnector_ms": 0.1699845790863037}, "num_episodes": 9, "episode_return_max": 912.6675908560791, "episode_return_min": 0.2733142082693816, "episode_return_mean": 283.93493141248257, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.69718825484136, "num_env_steps_trained_throughput_per_sec": 159.69718825484136, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 25250.024, "restore_workers_time_ms": 0.035, "training_step_time_ms": 25249.79, "sample_time_ms": 2095.791, "learn_time_ms": 23126.32, "learn_throughput": 172.963, "synch_weights_time_ms": 24.711}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "60982_00000", "date": "2024-08-23_11-15-52", "timestamp": 1724391952, "time_this_iter_s": 25.0717351436615, "time_total_s": 963.6987025737762, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17115a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 963.6987025737762, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 38.36571428571428, "ram_util_percent": 81.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.369710780073095, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.633978223548365, "policy_loss": -0.006626176521201771, "vf_loss": 8.639948301971273, "vf_explained_var": 0.15062165752289788, "kl": 0.006560771172698686, "entropy": 0.4630217806372062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.526216374881684, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.591469890856869, "policy_loss": -0.012033676857217436, "vf_loss": 7.60146260387683, "vf_explained_var": 0.4284637592456959, "kl": 0.010204863476828134, "entropy": 0.9700725055245495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 912.6675908560791, "episode_reward_min": -1.1546319456101628e-14, "episode_reward_mean": 295.54084545549637, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1483.0495830628354, "predator_policy": 39.58404949981898}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -716.5727729279653, "predator_policy": 864.3431956557142}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8112531574336507, 474.53789224362316, 759.7069480244055, 472.1224792804162, 34.971059116453475, 346.31215511137634, 233.49668722299964, 157.3181205618034, 107.4462597320945, 226.67580393438863, 456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-370.18524556711816, -730.3913314262005, -283.15040943319303, 388.3, 171.0945738681582, -1149.1196214981198, -433.8148751542733, -1127.6296030451454, -1319.5726263925094, -118.68828387171254, -468.94596179427697, -1231.0164256427436, -919.4138394028284, -1076.7665225256578, -1360.731440096938, -1007.5349098509523, -804.7432422655174, -987.5363963141383, -971.8094381705931, -262.1432442367073, -640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461], "policy_predator_policy_reward": [180.60140947165013, 920.7864206791033, 208.61933871676928, 160.76896296004622, 1005.9168911063622, 731.8151045480056, 1022.2719304975878, 1011.2950269822514, 1319.7726263925094, 153.45934298816397, 822.7295789266215, 1223.5449636217736, 1230.3974450768592, 999.2796040746297, 1309.4020681530315, 1216.182402356664, 990.3563058377626, 909.3695924739894, 890.2030047671751, 570.4254815745221, 381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9525159546889217, "mean_inference_ms": 3.6670337149019194, "mean_action_processing_ms": 1.1528625038224964, "mean_env_wait_ms": 10.027829145049347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004684329032897949, "StateBufferConnector_ms": 0.009432554244995117, "ViewRequirementAgentConnector_ms": 0.16182518005371094}, "num_episodes": 7, "episode_return_max": 912.6675908560791, "episode_return_min": -1.1546319456101628e-14, "episode_return_mean": 295.54084545549637, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.2626338733096, "num_env_steps_trained_throughput_per_sec": 143.2626338733096, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 25369.194, "restore_workers_time_ms": 0.034, "training_step_time_ms": 25368.993, "sample_time_ms": 2168.36, "learn_time_ms": 23174.2, "learn_throughput": 172.606, "synch_weights_time_ms": 23.53}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "60982_00000", "date": "2024-08-23_11-16-20", "timestamp": 1724391980, "time_this_iter_s": 27.957283973693848, "time_total_s": 991.6559865474701, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 991.6559865474701, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 48.0875, "ram_util_percent": 83.08250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.216550027882612, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.464830140209703, "policy_loss": -0.0077767336088178495, "vf_loss": 8.471689389748548, "vf_explained_var": 0.15410345130496556, "kl": 0.009174415624143664, "entropy": 0.4332683299899732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.898204109403822, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.569170922072476, "policy_loss": -0.01155945643309563, "vf_loss": 7.5790132159278505, "vf_explained_var": 0.4276834190837921, "kl": 0.008585736064102362, "entropy": 0.9638400437970641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 912.6675908560791, "episode_reward_min": -1.1546319456101628e-14, "episode_reward_mean": 302.28058113325324, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1483.0495830628354, "predator_policy": 39.58404949981898}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -723.0090880124911, "predator_policy": 874.1493785791183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [456.33119334527146, 59.70000000000071, 40.29132350134036, 313.81259213827593, 93.09327494174556, 149.12903141701813, 339.34846755915913, 185.4472010847065, 307.042226250201, 183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-640.0551553164024, -235.48083128340454, -370.3361650921707, -25.309442191331293, -846.30196059533, 6.042633587711906, -926.2976309368828, -265.58249771352655, -240.66873227893183, -789.9476682688484, -877.7217914867396, -879.65272059104, 14.118304058042126, -922.9181363819735, -701.1556867514945, -609.9237677438399, -481.03058271479347, -60.63282877397742, -446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545], "policy_predator_policy_reward": [381.24653128903634, 950.6206486560433, 404.34884795525693, 50.99675932824381, 690.4755668745977, 190.07508363435974, 911.9785171108161, 593.7142036778696, 560.7809121411733, 562.9287633483547, 708.8159107747242, 1197.687632720078, 378.71740433055635, 869.4308955525368, 896.5066051268648, 600.020050453183, 462.7896332462922, 385.91600449267537, 479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9405787710569853, "mean_inference_ms": 3.6437654149635277, "mean_action_processing_ms": 1.1488067373896376, "mean_env_wait_ms": 10.02910172948603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00485992431640625, "StateBufferConnector_ms": 0.009444475173950195, "ViewRequirementAgentConnector_ms": 0.18764936923980713}, "num_episodes": 10, "episode_return_max": 912.6675908560791, "episode_return_min": -1.1546319456101628e-14, "episode_return_mean": 302.28058113325324, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.1106788963864, "num_env_steps_trained_throughput_per_sec": 158.1106788963864, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 25286.846, "restore_workers_time_ms": 0.033, "training_step_time_ms": 25286.668, "sample_time_ms": 2160.739, "learn_time_ms": 23099.603, "learn_throughput": 173.163, "synch_weights_time_ms": 23.144}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "60982_00000", "date": "2024-08-23_11-16-45", "timestamp": 1724392005, "time_this_iter_s": 25.38241410255432, "time_total_s": 1017.0384006500244, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1017.0384006500244, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 38.400000000000006, "ram_util_percent": 81.61944444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.676665547600498, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.699407078980139, "policy_loss": -0.0085586716857044, "vf_loss": 8.707247268838227, "vf_explained_var": 0.08592238482974825, "kl": 0.007184665860539233, "entropy": 0.4104388279574258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.067608539767997, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.044862058932189, "policy_loss": -0.015616606676300604, "vf_loss": 8.058315920451331, "vf_explained_var": 0.40581239026690286, "kl": 0.01081365912945734, "entropy": 0.9320862057347777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 912.6675908560791, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 313.69148544576615, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1483.0495830628354, "predator_policy": 39.58404949981898}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -741.5915838720294, "predator_policy": 898.437326594913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.8621242714189, 417.79287070133756, 197.11558215136802, 22.513633341456664, 702.4817848484662, 343.3812455118863, 818.6127964124094, 94.68248206631922, 76.54862275161788, 504.5616251443544, 267.2380345574354, 313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-446.6250476627509, -799.2575987323833, -212.46303963901326, -987.3075678006331, -894.8413858924949, -978.4796232939161, -1300.3246711576921, -920.6814052335582, 398.2, -1133.5908242365376, -1242.6103746406684, 277.7464007177397, 34.41076345867518, -1162.8778242763597, -182.8870876047347, -2.284049499818688, -1032.8004510543883, -891.3431048396837, -1065.116820100455, -168.31457507970714, -491.85165632529265, -520.2127337561232, -760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977], "policy_predator_policy_reward": [479.14182196137233, 950.6029487051835, 792.3931490129439, 825.1703291280384, 1147.5414077894466, 922.8951835483385, 1301.2383044991493, 942.281405233559, 399.0600686602772, 1038.8125404247257, 1243.0103746406683, 65.23484479414655, 877.2249200698682, 1069.8549371602235, 240.26956967105363, 39.58404949981898, 1022.1839664785414, 978.5082121671493, 645.2225915315518, 1092.7704287929628, 765.3603328467337, 513.942091792121, 1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.91989590942394, "mean_inference_ms": 3.6390604267911772, "mean_action_processing_ms": 1.1564084735139388, "mean_env_wait_ms": 10.035266433393048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004307746887207031, "StateBufferConnector_ms": 0.004094481468200684, "ViewRequirementAgentConnector_ms": 0.16436231136322021}, "num_episodes": 9, "episode_return_max": 912.6675908560791, "episode_return_min": -1.2420073843579864, "episode_return_mean": 313.69148544576615, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.56961972614815, "num_env_steps_trained_throughput_per_sec": 155.56961972614815, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 25319.753, "restore_workers_time_ms": 0.033, "training_step_time_ms": 25319.569, "sample_time_ms": 2166.9, "learn_time_ms": 23125.773, "learn_throughput": 172.967, "synch_weights_time_ms": 23.475}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "60982_00000", "date": "2024-08-23_11-17-11", "timestamp": 1724392031, "time_this_iter_s": 25.743134021759033, "time_total_s": 1042.7815346717834, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17115a430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1042.7815346717834, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 40.12222222222222, "ram_util_percent": 82.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.035949145675336, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.558132612137568, "policy_loss": -0.0071657901213420605, "vf_loss": 8.564710285550072, "vf_explained_var": 0.2045167572283871, "kl": 0.0058810346198105625, "entropy": 0.44688096374430986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.195976267731379, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.185190259842646, "policy_loss": -0.011657399679263117, "vf_loss": 8.194522326333182, "vf_explained_var": 0.41565107214387764, "kl": 0.011626577962722097, "entropy": 0.9261022866087616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 963.6792521843182, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 313.73788341569605, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1542.5090175429473, "predator_policy": 76.23086202617846}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -754.723214725644, "predator_policy": 911.5921564334925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.80914859019225, 642.8899268140177, 426.8640826626445, 25.600000000000037, 173.69330996455022, 257.5460304030999, 312.1335569625213, 180.52105834047083, 500.83973369593014, 21.933052880348036, 5.485527836582463, 493.2158838039218, 116.67407244804933, 507.04523764986567, 419.07320683504577, 28.243486954097314, 13.130830839410146, 381.21596335560014, 0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-760.4770590180796, -952.0476123386835, 360.8448577765936, -492.95023745551094, -994.9104240298439, -309.97838008369854, -990.8181023723395, -747.0719627093341, -905.234156845201, -632.5203028459042, -967.069932355783, -650.2902767080058, -74.07088616081639, -1093.2253886234885, -939.4085965139075, -157.72349153585813, -805.4089163402498, -535.7865272603875, -447.38552900867705, -781.9049350521279, -974.0800418001016, -1172.2971880880202, -504.8080891959072, -1154.0110841544679, -1028.844477876292, -1213.971740275815, -955.7151938258204, 137.76816666516777, -367.83047096817455, -923.4547951731864, -1128.5967307060166, -827.9836626659577, -1376.4069419592472, -950.5099440953184, -1214.0947119471818, -665.3415198895345, -1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863], "policy_predator_policy_reward": [1178.6995143454049, 847.6343056015545, 471.3735469100172, 303.621759582918, 905.9433230448136, 825.8095637313739, 992.9181023723395, 770.5719627093342, 1122.3555441003027, 589.0922255553562, 869.9138665977356, 1004.9923728691513, 424.3399903562145, 1055.0898413906104, 925.1489197580817, 352.5042266321559, 739.1568189914526, 1102.8783583051193, 113.33631820390713, 1137.8871987372488, 979.5655696366853, 1172.2971880880202, 1070.3392195065999, 1081.695837647699, 1132.3009166593285, 1227.1893739408272, 813.2588561199415, 511.73340869057336, 726.9345572610732, 983.4239157153307, 1109.3431648679368, 875.4807154581364, 1383.546156415991, 956.5015604779868, 1127.890557622132, 1132.761637570185, 1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9066437354157766, "mean_inference_ms": 3.6259851725917605, "mean_action_processing_ms": 1.1577297568106817, "mean_env_wait_ms": 10.037969321158997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004326939582824707, "StateBufferConnector_ms": 0.004127144813537598, "ViewRequirementAgentConnector_ms": 0.140869140625}, "num_episodes": 11, "episode_return_max": 963.6792521843182, "episode_return_min": -1.2420073843579864, "episode_return_mean": 313.73788341569605, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.30585508678922, "num_env_steps_trained_throughput_per_sec": 161.30585508678922, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 25296.969, "restore_workers_time_ms": 0.033, "training_step_time_ms": 25296.831, "sample_time_ms": 2156.726, "learn_time_ms": 23113.439, "learn_throughput": 173.059, "synch_weights_time_ms": 23.414}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "60982_00000", "date": "2024-08-23_11-17-36", "timestamp": 1724392056, "time_this_iter_s": 24.823469161987305, "time_total_s": 1067.6050038337708, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7993a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1067.6050038337708, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 38.911428571428566, "ram_util_percent": 82.00571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.802248908350707, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.805166265195009, "policy_loss": -0.010289116731041638, "vf_loss": 8.814617659049059, "vf_explained_var": 0.02663084306414165, "kl": 0.00837697364998459, "entropy": 0.415406196268778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.853845400658865, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.884187264417214, "policy_loss": -0.015871625592705434, "vf_loss": 7.898023943421702, "vf_explained_var": 0.43097175517410197, "kl": 0.01017485397187845, "entropy": 0.8705294898578099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 963.6792521843182, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 306.6783474805485, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 76.23086202617846}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -785.287723092722, "predator_policy": 938.6268968329969}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2733142082693816, 152.3466705569926, 148.78354452568308, 215.80191340244826, 388.4659275968121, 622.7489660628526, 495.69081262900835, 221.42155894172387, 912.6675908560791, 770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1159.71973476853, -1220.4045642713, -623.9408381513799, -312.722129642936, -1320.5899467760285, -216.34661528443797, -1169.8123891655973, -682.7432724016513, -77.3644127324111, -508.82984938698473, -94.95358630751375, -1070.8641628057944, -31.73429592825451, -1250.7377756034725, -857.8694457674491, -420.9005558978559, -1150.162570022367, 386.31334286062366, -972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974], "policy_predator_policy_reward": [1221.7045642713, 1158.6930489767997, 684.186909056595, 404.82272929472225, 1321.7899467760287, 363.9301598101243, 1059.5115254159723, 1008.8460495537292, 459.8427106827489, 514.817479033466, 1037.8385282179438, 750.7281869582168, 932.4594659779267, 845.7034181828141, 739.573993190276, 760.6175674167602, 1007.939231287492, 668.5775867303335, 908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8702882710303776, "mean_inference_ms": 3.606353845174138, "mean_action_processing_ms": 1.163313985831047, "mean_env_wait_ms": 10.028648159021037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041332244873046875, "StateBufferConnector_ms": 0.004096031188964844, "ViewRequirementAgentConnector_ms": 0.1425495147705078}, "num_episodes": 18, "episode_return_max": 963.6792521843182, "episode_return_min": -1.2420073843579864, "episode_return_mean": 306.6783474805485, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.4405754855675, "num_env_steps_trained_throughput_per_sec": 153.4405754855675, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 25420.123, "restore_workers_time_ms": 0.033, "training_step_time_ms": 25419.947, "sample_time_ms": 2195.619, "learn_time_ms": 23194.745, "learn_throughput": 172.453, "synch_weights_time_ms": 26.177}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "60982_00000", "date": "2024-08-23_11-18-02", "timestamp": 1724392082, "time_this_iter_s": 26.13253664970398, "time_total_s": 1093.7375404834747, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1093.7375404834747, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 43.27567567567568, "ram_util_percent": 82.71351351351349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.758661956004996, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.581356253951945, "policy_loss": -0.009022693982515385, "vf_loss": 8.589353419107104, "vf_explained_var": 0.09615320768305864, "kl": 0.010255325560226406, "entropy": 0.43409682203222205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.690186313977317, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.868864303165012, "policy_loss": -0.01342321842041596, "vf_loss": 7.8802718162536625, "vf_explained_var": 0.3658861962575761, "kl": 0.010078341168445096, "entropy": 0.8858574129917004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 963.6792521843182, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 297.3934934674107, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 76.23086202617846}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -800.7279748697904, "predator_policy": 949.4247216034961}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.3444581042289, 611.3841718310907, 24.000000000000075, 763.0780941429011, 387.95635868331124, 572.7191401022249, 301.87536817239595, 480.1513450369399, 60.007078364528304, 42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-972.9680871991715, -20.350500179044445, -72.40503006952423, -863.2980123464812, -996.3573330688974, -704.2936382237061, -1208.557373687253, 397.89258770344526, -206.88962651010053, -1247.9421834429616, 27.157704265485226, -1120.2447922740214, -1200.321749993259, -106.3748764705243, -190.34737195892853, -1160.2894582142312, -200.0593662575042, -950.9383981570456, -1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002], "policy_predator_policy_reward": [908.8908782710457, 854.7721672114001, 658.5787398469146, 888.5084744001838, 999.8573330688973, 724.7936382237108, 559.9173988953996, 1013.8254812313079, 1146.3598238353084, 696.4283448010611, 902.990045061369, 762.8161830493887, 714.7031186061085, 893.8688760300671, 768.3265325152089, 1062.461642694888, 251.9664446220304, 959.0383981570458, 1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8628339561158294, "mean_inference_ms": 3.589752842966448, "mean_action_processing_ms": 1.1623405794503292, "mean_env_wait_ms": 10.027416656354276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00410151481628418, "StateBufferConnector_ms": 0.004088759422302246, "ViewRequirementAgentConnector_ms": 0.1381678581237793}, "num_episodes": 9, "episode_return_max": 963.6792521843182, "episode_return_min": -1.2420073843579864, "episode_return_mean": 297.3934934674107, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.88079208418108, "num_env_steps_trained_throughput_per_sec": 158.88079208418108, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 25444.724, "restore_workers_time_ms": 0.035, "training_step_time_ms": 25444.561, "sample_time_ms": 2198.467, "learn_time_ms": 23217.858, "learn_throughput": 172.281, "synch_weights_time_ms": 24.946}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "60982_00000", "date": "2024-08-23_11-18-27", "timestamp": 1724392107, "time_this_iter_s": 25.210163116455078, "time_total_s": 1118.9477035999298, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a65e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1118.9477035999298, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 37.51944444444445, "ram_util_percent": 82.91944444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.536022116645935, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.40202606090162, "policy_loss": -0.006591011997233465, "vf_loss": 8.407905405539054, "vf_explained_var": 0.18114422256984408, "kl": 0.0071166094136301174, "entropy": 0.4186229316015092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 498.2237499999974}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.02556402203898, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.495556496312378, "policy_loss": -0.01519633204474178, "vf_loss": 7.509007407496215, "vf_explained_var": 0.4305144610228362, "kl": 0.008727226685978985, "entropy": 0.8648936182102829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 498.2237499999974}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 303.45399159044655, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 70.95429825793195}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -801.7540392134647, "predator_policy": 953.4810350086885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.85967504546261, 0.4779427156666136, 83.60460764378554, 59.79769056343069, 650.942730284329, 234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1365.1709428858292, -279.75285742330163, -1298.7201389520044, -1356.117371771623, -951.449117771386, -1379.573744362276, -1289.2200631371513, -767.2592728211016, 198.72424483838432, -1360.7044035767315, -348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235], "policy_predator_policy_reward": [1365.1709428858292, 322.61253246877027, 1298.198081667671, 1357.117371771623, 1036.9231467304721, 1377.7043230469778, 1289.7631950628077, 826.513831458876, 1293.9507502693552, 518.9721387533143, 1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8639244311197314, "mean_inference_ms": 3.5808947176612618, "mean_action_processing_ms": 1.1634080629783927, "mean_env_wait_ms": 10.033875606716032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851771354675293, "StateBufferConnector_ms": 0.004008173942565918, "ViewRequirementAgentConnector_ms": 0.12540781497955322}, "num_episodes": 9, "episode_return_max": 1070.0892747808343, "episode_return_min": -1.2420073843579864, "episode_return_mean": 303.45399159044655, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.8750031232257, "num_env_steps_trained_throughput_per_sec": 159.8750031232257, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 25482.177, "restore_workers_time_ms": 0.031, "training_step_time_ms": 25482.008, "sample_time_ms": 2207.491, "learn_time_ms": 23246.569, "learn_throughput": 172.068, "synch_weights_time_ms": 24.467}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "60982_00000", "date": "2024-08-23_11-18-52", "timestamp": 1724392132, "time_this_iter_s": 25.03017807006836, "time_total_s": 1143.9778816699982, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f799160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1143.9778816699982, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 37.337142857142865, "ram_util_percent": 82.50857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.042560630122189, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.411586040416092, "policy_loss": -0.006479192436943767, "vf_loss": 8.417445529453339, "vf_explained_var": 0.027856984718766794, "kl": 0.006196780454751754, "entropy": 0.40607697642038737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.622985182363521, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.653322275858077, "policy_loss": -0.012883634928357665, "vf_loss": 7.6645316376257195, "vf_explained_var": 0.4615642379200648, "kl": 0.008371413795514003, "entropy": 0.8402157644115428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 299.8669497303315, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 70.95429825793195}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -798.5077663235639, "predator_policy": 948.4412411887304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [234.4346706017895, 174.97629572167298, 439.68671491368406, 1.2443076544594334, 100.25641410170542, 492.5535027467286, 584.8890363613733, 175.3926408309502, 538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-348.7010230642576, -1293.8546315514902, -1254.865685709641, -759.1774149650811, -398.3359017995362, -833.2159114337373, -1233.3476115048325, -1140.9118282731295, -1274.8717824335358, -26.46622087023227, -370.5419404192147, -242.35848496694646, -227.7647851721781, -1099.9485928919114, -1115.7150686697796, -919.4094847491142, -183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916], "policy_predator_policy_reward": [1164.0588216581552, 712.9315035593886, 948.9751909327186, 1240.0442054636817, 1000.1138855128801, 671.1246426340829, 1234.291919159292, 1141.2118282731294, 1270.4580144608042, 131.13640294466924, 1029.2230661067094, 76.23086202617846, 922.7926621776495, 989.8097522478026, 1089.184461561663, 1121.3327326881815, 823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8616710084675065, "mean_inference_ms": 3.5710347648456144, "mean_action_processing_ms": 1.1610113566283033, "mean_env_wait_ms": 10.031631004173523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038878917694091797, "StateBufferConnector_ms": 0.004004836082458496, "ViewRequirementAgentConnector_ms": 0.12462019920349121}, "num_episodes": 5, "episode_return_max": 1070.0892747808343, "episode_return_min": -1.2420073843579864, "episode_return_mean": 299.8669497303315, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.97722211798865, "num_env_steps_trained_throughput_per_sec": 158.97722211798865, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 25507.434, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25507.273, "sample_time_ms": 2201.668, "learn_time_ms": 23277.106, "learn_throughput": 171.843, "synch_weights_time_ms": 25.014}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "60982_00000", "date": "2024-08-23_11-19-17", "timestamp": 1724392157, "time_this_iter_s": 25.20795488357544, "time_total_s": 1169.1858365535736, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1169.1858365535736, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 37.90555555555556, "ram_util_percent": 82.77777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.759771851257042, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.193035106558018, "policy_loss": -0.008533198821540706, "vf_loss": 8.20086936597471, "vf_explained_var": 0.18751717749096097, "kl": 0.006989761993964079, "entropy": 0.4252306785533037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.272737962606723, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.40066352470842, "policy_loss": -0.015334365377449012, "vf_loss": 7.414161210337644, "vf_explained_var": 0.4032985464605705, "kl": 0.00918329385991292, "entropy": 0.8463001637862473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 290.744095576501, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 70.95429825793195}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -795.3363373733988, "predator_policy": 940.7083851616501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [538.0902242050155, 390.34885054682184, 224.39210125370224, 609.9044252067453, 497.04146704392485, 78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-183.0139945217452, -1134.709461682931, -1045.813256705415, -177.31634312866157, -951.5748522567992, -265.0472577658927, -1122.3062632409305, -205.2260439523664, -1224.4439540693622, -537.8774081775431, -1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916], "policy_predator_policy_reward": [823.9314381694851, 1031.882242240205, 804.4811597870964, 808.9972905937994, 903.8015850405649, 537.2126262358369, 811.2483815869404, 1126.1883508130966, 1159.586107880475, 1099.7767214103587, 1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.869097881100183, "mean_inference_ms": 3.5675545044081374, "mean_action_processing_ms": 1.1626670490553093, "mean_env_wait_ms": 10.059857626409626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038590431213378906, "StateBufferConnector_ms": 0.0040361881256103516, "ViewRequirementAgentConnector_ms": 0.13107991218566895}, "num_episodes": 8, "episode_return_max": 1070.0892747808343, "episode_return_min": -1.2420073843579864, "episode_return_mean": 290.744095576501, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.23069976629387, "num_env_steps_trained_throughput_per_sec": 145.23069976629387, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 25774.432, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25774.154, "sample_time_ms": 2320.976, "learn_time_ms": 23423.221, "learn_throughput": 170.771, "synch_weights_time_ms": 25.477}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "60982_00000", "date": "2024-08-23_11-19-45", "timestamp": 1724392185, "time_this_iter_s": 27.592535972595215, "time_total_s": 1196.7783725261688, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a69d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1196.7783725261688, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 39.05897435897436, "ram_util_percent": 82.55384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.358274094642155, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.097784936491143, "policy_loss": -0.009667061534882695, "vf_loss": 8.106748462858654, "vf_explained_var": 0.15382279529773368, "kl": 0.007035464892981859, "entropy": 0.443008365706792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.589050149413013, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.611061271788582, "policy_loss": -0.01580246094091938, "vf_loss": 7.624505630876652, "vf_explained_var": 0.3807530931064061, "kl": 0.011790478282494757, "entropy": 0.8857911999894198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 285.9096448745221, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 70.95429825793195}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1584.4993857459067}, "policy_reward_mean": {"prey_policy": -800.0599634878344, "predator_policy": 943.0147859250959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.08691310646861, 244.4465659783251, 426.44357110255794, 252.10073479791566, 14.538837750343735, 0.40000000000001856, 138.70573246945546, 232.57940680373918, 39.80522311482603, -1.1546319456101628e-14, 587.8930441767111, 444.9118774082049, 207.7057889595401, 402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1184.5517180925758, -964.4720429797185, -1244.7018469888412, -1079.5417176628291, -664.96049567586, -1399.133469366184, -992.5038470125633, -655.465288585746, -888.9843802249429, -1483.0495830628354, -1364.2396160951555, -1107.2642754245865, -1113.7269167321995, -730.3080269544885, -1458.3672413137526, -854.0938444400119, -1256.8543772929322, -524.312794536678, -1276.6256622078563, -1416.0635396124894, -254.7735712361302, -415.72658073091594, 312.5228001463171, -939.9941965449577, -1433.153854377005, -531.4696949595838, -713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557], "policy_predator_policy_reward": [1184.6928636589873, 1042.41781051978, 1250.4144398924047, 1318.2756907375926, 1028.950541114334, 1461.586995030267, 969.0613178216026, 931.0085525746233, 903.3843802249432, 1483.1884208131792, 1364.2396160951555, 1107.664275424586, 906.1381546750403, 1076.6025214811066, 1584.4993857459067, 960.5411068116009, 1261.8543772929322, 559.1180176515086, 1276.6256622078563, 1416.0635396124894, 719.985330940821, 538.4078652029367, 141.77166171341426, 930.6116120934312, 1358.3531220863908, 813.9762162097443, 85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8585532906486026, "mean_inference_ms": 3.571299346650382, "mean_action_processing_ms": 1.1707894251527475, "mean_env_wait_ms": 10.06836392975627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036433935165405273, "StateBufferConnector_ms": 0.003975272178649902, "ViewRequirementAgentConnector_ms": 0.13591647148132324}, "num_episodes": 5, "episode_return_max": 1070.0892747808343, "episode_return_min": -1.2420073843579864, "episode_return_mean": 285.9096448745221, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.01798598735817, "num_env_steps_trained_throughput_per_sec": 148.01798598735817, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 25972.07, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25971.661, "sample_time_ms": 2353.046, "learn_time_ms": 23588.53, "learn_throughput": 169.574, "synch_weights_time_ms": 25.577}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "60982_00000", "date": "2024-08-23_11-20-12", "timestamp": 1724392212, "time_this_iter_s": 27.06989097595215, "time_total_s": 1223.848263502121, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1223.848263502121, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.973684210526315, "ram_util_percent": 83.12631578947371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.243394470340991, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.04725009575092, "policy_loss": -0.00632318876161383, "vf_loss": 8.052869076199002, "vf_explained_var": 0.21567957325587198, "kl": 0.007042019597806588, "entropy": 0.42451485663494737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.496698630045331, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.346358138795883, "policy_loss": -0.010712251877757135, "vf_loss": 7.355410593527335, "vf_explained_var": 0.44201617083221517, "kl": 0.008298988212589864, "entropy": 0.8275785921742677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -1.2420073843579864, "episode_reward_mean": 299.9879803116667, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 63.80039662730528}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1540.6963935412448}, "policy_reward_mean": {"prey_policy": -769.5474765846744, "predator_policy": 919.5414667405083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [402.2556115526038, 514.223233198326, 333.0795140547537, 315.6055175131186, 266.01215396292633, 1.7695609912022263, 899.1773945454709, 108.54544815619556, 455.92587560542154, 479.5603019549359, 416.9623180708641, 471.21540181072595, 72.59825354981415, 415.44908864422825, -1.2420073843579864, 553.5746983712006, 558.9180798693864, 217.44603448641425, 301.9009184515828, 313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-713.4891592654975, 2.32270614987101, 103.70607389146784, -514.8120832031293, -627.2058410669978, -989.4488547755461, -869.132338383913, -675.189414280809, -957.9875248889562, -790.5539915577303, -1221.0097528674746, -981.9821488887998, -645.0765613628888, 358.6, -1009.7780653530912, -1067.9922603639407, 275.7206649018326, -644.0371079601479, -1369.5935901811354, -768.1719019867185, -1309.9620386960353, -855.207690720123, -816.0058272132434, 215.06403780001327, -961.5350080057948, -1257.2313397166545, -445.54296074745133, -1240.1276413220833, -1224.7523389573678, -1155.3612275716923, -200.63010249321823, -1143.910993288152, -534.4765735621282, 39.48529727403093, -788.518034573872, -1100.6136880976737, -584.1066533905876, -1032.7060955284467, -882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182], "policy_predator_policy_reward": [85.14452766945031, 1028.2775369987805, 507.1573603892407, 418.17188212074603, 959.2108345085454, 990.523375388757, 987.3169506795624, 872.610319498284, 914.5764117397102, 1099.9772586699064, 1221.479313858677, 983.2821488887997, 553.2200363740652, 632.4339195342948, 1009.9646924501683, 1176.3510814230588, 286.9664796965949, 537.2758389671427, 1194.4441035936852, 1422.8816905291112, 1223.9082968229745, 1358.2237506640556, 729.2012531398811, 342.9559380840765, 1044.695089030098, 1246.6695122421656, 1114.662898077269, 986.4567926365008, 1223.5103315730098, 1155.3612275716923, 872.3683315624411, 1025.7474625901273, 229.90331482854765, 824.0060413289385, 1223.3295992325304, 883.2481579254311, 1112.3100808074337, 806.4035865631876, 455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8633214559365467, "mean_inference_ms": 3.566618573001737, "mean_action_processing_ms": 1.1709810004163914, "mean_env_wait_ms": 10.082386121106527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009839415550231934, "StateBufferConnector_ms": 0.0040128231048583984, "ViewRequirementAgentConnector_ms": 0.14027440547943115}, "num_episodes": 13, "episode_return_max": 1070.0892747808343, "episode_return_min": -1.2420073843579864, "episode_return_mean": 299.9879803116667, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 135.11367107654604, "num_env_steps_trained_throughput_per_sec": 135.11367107654604, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 26140.467, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26140.055, "sample_time_ms": 2312.411, "learn_time_ms": 23798.219, "learn_throughput": 168.08, "synch_weights_time_ms": 25.152}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "60982_00000", "date": "2024-08-23_11-20-42", "timestamp": 1724392242, "time_this_iter_s": 29.624301195144653, "time_total_s": 1253.4725646972656, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bd280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1253.4725646972656, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 47.17441860465116, "ram_util_percent": 82.39302325581394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.591808645308964, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.003249411103587, "policy_loss": -0.005738153647158354, "vf_loss": 8.008163618663001, "vf_explained_var": 0.2356779550118421, "kl": 0.008239631298633796, "entropy": 0.4429001759284388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.927227743845137, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.607432841245459, "policy_loss": -0.011968905687154759, "vf_loss": 7.617586203983852, "vf_explained_var": 0.45467770591614737, "kl": 0.009077721444899758, "entropy": 0.8005702455838521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": 7.105427357601002e-15, "episode_reward_mean": 277.43007783686636, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 63.80039662730528}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1540.6963935412448}, "policy_reward_mean": {"prey_policy": -760.4981519609811, "predator_policy": 899.2131908794146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.92675732129936, 278.49956914227323, 446.8126025869808, 608.7256563741516, 629.5572538678349, 262.28058468652785, 132.69272251433682, 963.6792521843182, 23.32307696858867, 78.95544535934356, 39.52562694923924, 893.7283017215416, 7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-882.7282644917049, -155.01307642676065, -548.0438942499816, -74.0234662293725, -473.46069084982264, -1024.8234278762977, -838.2102656259959, 249.31523021747654, 357.1038122069637, -575.2245679460739, -989.2464612414476, -774.4978540089519, -1237.0784838974766, -886.9544547935367, 400.0, -973.7055271485954, -1542.5090175429473, -771.5695498009858, 34.4441702630414, -1192.26361950606, -1029.5867335795756, -1146.0052864076142, 328.2079511975025, -1039.8198446875197, -1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843], "policy_predator_policy_reward": [455.77784932202223, 895.8902489177405, 463.1633827395102, 437.4035468821159, 1050.7158678077576, 894.3808535053489, 499.2974180231395, 698.3232737595307, 540.1098580982044, 307.5681515087406, 932.8394988138406, 1093.185401123095, 1224.0503453679548, 1032.675315837398, 605.598618951529, 931.7861603813834, 1540.6963935412448, 796.7052507712783, 886.3056358855, 350.4692587168634, 1030.7867335795756, 1184.3309133568484, 868.9613477570896, 736.3788474544557, 1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.851779523779253, "mean_inference_ms": 3.5728676196397906, "mean_action_processing_ms": 1.165746867261257, "mean_env_wait_ms": 10.087992399520255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009688258171081543, "StateBufferConnector_ms": 0.004137277603149414, "ViewRequirementAgentConnector_ms": 0.11030805110931396}, "num_episodes": 19, "episode_return_max": 1070.0892747808343, "episode_return_min": 7.105427357601002e-15, "episode_return_mean": 277.43007783686636, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.68017504602113, "num_env_steps_trained_throughput_per_sec": 149.68017504602113, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 26282.959, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26282.474, "sample_time_ms": 2316.784, "learn_time_ms": 23936.539, "learn_throughput": 167.109, "synch_weights_time_ms": 24.916}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "60982_00000", "date": "2024-08-23_11-21-09", "timestamp": 1724392269, "time_this_iter_s": 26.807997941970825, "time_total_s": 1280.2805626392365, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7cb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1280.2805626392365, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 37.31315789473683, "ram_util_percent": 81.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.778347584053321, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.7914145792602865, "policy_loss": -0.007729058488020821, "vf_loss": 7.798544221201902, "vf_explained_var": 0.23456739092630052, "kl": 0.005994174059938699, "entropy": 0.4380449244900355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.10652023446623, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.813340600836214, "policy_loss": -0.01368446247356515, "vf_loss": 7.825081801540637, "vf_explained_var": 0.4496195671419618, "kl": 0.009716211618589503, "entropy": 0.8481147151144725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": 7.105427357601002e-15, "episode_reward_mean": 261.61210950878626, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1612.8574591207748, "predator_policy": 63.80039662730528}, "policy_reward_max": {"prey_policy": 387.3332965164707, "predator_policy": 1525.9421603637406}, "policy_reward_mean": {"prey_policy": -783.4300068211518, "predator_policy": 914.2360615755455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.105427357601002e-15, 0.9626781251816658, 100.17565969236348, 309.68501660271096, 3.828072023798359, 0.029245305797002352, 480.5643415892303, 27.252438216180636, 214.31547380838938, 50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1275.7233319896043, -1226.6746154669572, -1096.574617617352, -1123.2657799969863, -1227.198135735582, -1117.0511856227017, -669.0438724334575, -1612.8574591207748, -1300.1050238794965, -989.9808440579615, -782.7599511716027, -1085.4948455691792, -574.235421947579, -1063.3158696182945, -984.5902141878812, -1090.778661358501, -815.8058945316459, -930.251791897926, -259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083], "policy_predator_policy_reward": [1275.7233319896043, 1226.6746154669572, 1096.5372957425336, 1124.2657799969863, 1345.860749228537, 1098.5642318221107, 1065.644187793203, 1525.9421603637406, 1300.3330959032949, 993.5808440579623, 424.6351437478715, 1443.6488982987016, 1097.464374204071, 1020.6512589510327, 998.7786889240156, 1103.8426248385451, 1039.7247013421036, 920.648458895861, 311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8606489135949857, "mean_inference_ms": 3.5782350303976567, "mean_action_processing_ms": 1.1693749802490352, "mean_env_wait_ms": 10.117066352248052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009783148765563965, "StateBufferConnector_ms": 0.004261016845703125, "ViewRequirementAgentConnector_ms": 0.11466598510742188}, "num_episodes": 12, "episode_return_max": 1070.0892747808343, "episode_return_min": 7.105427357601002e-15, "episode_return_mean": 261.61210950878626, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.33357585025567, "num_env_steps_trained_throughput_per_sec": 145.33357585025567, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 26464.052, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26463.554, "sample_time_ms": 2444.056, "learn_time_ms": 23990.423, "learn_throughput": 166.733, "synch_weights_time_ms": 24.841}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "60982_00000", "date": "2024-08-23_11-21-36", "timestamp": 1724392296, "time_this_iter_s": 27.56349015235901, "time_total_s": 1307.8440527915955, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bdee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1307.8440527915955, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 38.01538461538461, "ram_util_percent": 83.15897435897436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.038272391929828, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.741928334715505, "policy_loss": -0.007446510257031867, "vf_loss": 7.7486061822800405, "vf_explained_var": 0.2411080282201212, "kl": 0.007686734081753505, "entropy": 0.4635111628386079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.868521688034925, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.7808598770666375, "policy_loss": -0.01428362292597297, "vf_loss": 7.793125091027961, "vf_explained_var": 0.4055912436631621, "kl": 0.010092041947972523, "entropy": 0.8076119316948784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -27.529852517760084, "episode_reward_mean": 275.19952629499204, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.3332965164707, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -761.8704635758997, "predator_policy": 899.4702267233962}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.48758310120301, 342.7839174520071, 8.194357892122687, 943.8435215173675, 287.181821273517, 313.62733177153393, 0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-259.89239529759817, -1123.1340203593977, -1067.3149965625735, -321.0732599950827, -1383.1020990597524, -1139.7762683557503, 387.3332965164707, -1081.9917603653878, -1222.591054811638, -555.4531782472907, -1051.1910018560184, -434.95740701224054, -1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762], "policy_predator_policy_reward": [311.75798748178715, 1121.7560112764158, 873.0495045565578, 858.1226694531033, 1383.1020990597524, 1147.9706262478737, 717.7310145571997, 920.7709708090837, 1008.1394798630306, 1057.086574469422, 991.849713960981, 807.9260266788136, 1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.872843197794795, "mean_inference_ms": 3.5943008470583235, "mean_action_processing_ms": 1.165794608901735, "mean_env_wait_ms": 10.125556153838259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009834766387939453, "StateBufferConnector_ms": 0.004266619682312012, "ViewRequirementAgentConnector_ms": 0.11881804466247559}, "num_episodes": 9, "episode_return_max": 1070.0892747808343, "episode_return_min": -27.529852517760084, "episode_return_mean": 275.19952629499204, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.08135617802725, "num_env_steps_trained_throughput_per_sec": 152.08135617802725, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 26614.461, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26613.949, "sample_time_ms": 2528.135, "learn_time_ms": 24056.595, "learn_throughput": 166.275, "synch_weights_time_ms": 24.741}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "60982_00000", "date": "2024-08-23_11-22-03", "timestamp": 1724392323, "time_this_iter_s": 26.34245467185974, "time_total_s": 1334.1865074634552, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f799670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1334.1865074634552, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 35.762162162162156, "ram_util_percent": 82.23243243243245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.30038256632588, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.818063201601543, "policy_loss": -0.006541865277621481, "vf_loss": 7.8238572761495275, "vf_explained_var": 0.17475329612297988, "kl": 0.007477882938587634, "entropy": 0.3989980086132332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.770832061641431, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.976303041548956, "policy_loss": -0.012567140987369592, "vf_loss": 7.9871325396986865, "vf_explained_var": 0.40395077359739434, "kl": 0.008688197686538968, "entropy": 0.7631094781179276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -27.529852517760084, "episode_reward_mean": 268.78259737825925, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 384.6704110128678, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -750.4185059551173, "predator_policy": 884.8098046442476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4000000000000197, 526.3285649432368, 372.792341381239, 120.07082995089328, 12.399999999999995, 3.9999999999999907, 122.4677441118591, 612.5969020586498, 3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1101.5000985946733, -1183.6304564746238, -606.2805898454255, -924.9826687361452, -945.6801703238327, -321.46643375480807, -990.0045971297056, -1435.0116413355943, -1377.083148034253, -928.2648380848974, -1078.0745457045605, -1376.2476400300634, -700.3117776717514, -655.3155779440615, 75.10659675318558, -998.536439931701, -1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666], "policy_predator_policy_reward": [1101.7000985946731, 1183.8304564746238, 1011.0551959108969, 1046.5366276139152, 919.4176120782023, 720.5213333816788, 1249.1192236951908, 1295.9678447210058, 1378.1831480342532, 939.5648380848975, 1080.5745457045582, 1377.7476400300636, 525.8708171699483, 952.2242825577299, 1212.5898130643466, 323.4369321728145, 1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8822174181234494, "mean_inference_ms": 3.595682146149884, "mean_action_processing_ms": 1.1618760535237278, "mean_env_wait_ms": 10.130279155825784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00982964038848877, "StateBufferConnector_ms": 0.004279613494873047, "ViewRequirementAgentConnector_ms": 0.12083828449249268}, "num_episodes": 6, "episode_return_max": 1070.0892747808343, "episode_return_min": -27.529852517760084, "episode_return_mean": 268.78259737825925, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.8842485691805, "num_env_steps_trained_throughput_per_sec": 161.8842485691805, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 26478.487, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26478.007, "sample_time_ms": 2496.424, "learn_time_ms": 23955.162, "learn_throughput": 166.979, "synch_weights_time_ms": 22.074}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "60982_00000", "date": "2024-08-23_11-22-27", "timestamp": 1724392347, "time_this_iter_s": 24.717182874679565, "time_total_s": 1358.9036903381348, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f776d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1358.9036903381348, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.445714285714285, "ram_util_percent": 82.30285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.658035923185803, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.007461195648032, "policy_loss": -0.008152750130525972, "vf_loss": 8.01489291973215, "vf_explained_var": 0.09512118637246429, "kl": 0.007210358328102206, "entropy": 0.3946510217807911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.48445283382658, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.794191092031974, "policy_loss": -0.011960388039529481, "vf_loss": 7.8045049576532275, "vf_explained_var": 0.4548569769455642, "kl": 0.008232623326133878, "entropy": 0.7496483100154413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -27.529852517760084, "episode_reward_mean": 263.3445606498316, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 384.6704110128678, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -743.8326985156568, "predator_policy": 875.5049788405731}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.900000000000005, 1.4250040482208703, 586.393554130552, 67.9479821879275, 254.5247003263466, 576.4590106025385, 209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1094.9426996422876, -1076.598154084981, -997.9774370784775, -1316.0249253574368, 91.29128419689374, -955.3582367031281, -746.5408665885121, -1201.8079540523313, -1446.6952134379212, -693.363995168687, -806.6355750211975, 106.6000000000002, -1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441], "policy_predator_policy_reward": [1097.442699642288, 1077.9981540849815, 999.4024411266984, 1316.0249253574368, 315.5160470029491, 1134.9444596338385, 785.8777783665914, 1230.41902446218, 1225.8019250232123, 1168.7819839097488, 448.88260301827574, 827.6119826054581, 1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8911883525782587, "mean_inference_ms": 3.60570990075502, "mean_action_processing_ms": 1.1636753571171465, "mean_env_wait_ms": 10.146734557397101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009723901748657227, "StateBufferConnector_ms": 0.004244208335876465, "ViewRequirementAgentConnector_ms": 0.11987197399139404}, "num_episodes": 8, "episode_return_max": 1070.0892747808343, "episode_return_min": -27.529852517760084, "episode_return_mean": 263.3445606498316, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.12302342500544, "num_env_steps_trained_throughput_per_sec": 143.12302342500544, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 26755.673, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26755.198, "sample_time_ms": 2527.74, "learn_time_ms": 24200.184, "learn_throughput": 165.288, "synch_weights_time_ms": 22.283}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "60982_00000", "date": "2024-08-23_11-22-55", "timestamp": 1724392375, "time_this_iter_s": 28.005462884902954, "time_total_s": 1386.9091532230377, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7cb0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1386.9091532230377, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 41.485, "ram_util_percent": 82.6525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.224188822539395, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.797357123743289, "policy_loss": -0.007058869361897152, "vf_loss": 7.80374432114697, "vf_explained_var": 0.23099213012311826, "kl": 0.006716555753900182, "entropy": 0.4074184684210984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 485.23000000000326}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.398091935733008, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.8959190827828865, "policy_loss": -0.01235466607693563, "vf_loss": 7.90668639884424, "vf_explained_var": 0.4111334446876768, "kl": 0.007936617670452626, "entropy": 0.7378851015101034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 485.23000000000326}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 1070.0892747808343, "episode_reward_min": -27.529852517760084, "episode_reward_mean": 258.1304402168808, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 384.6704110128678, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -744.4203022714089, "predator_policy": 873.4855223798498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.40713526008346, 6.699999999999994, 992.6846295047724, 428.2018951615862, 391.1946774914805, 470.5088444271528, 464.24598921123385, 1070.0892747808343, 544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1294.9640912702164, 138.45283700215128, -1264.4063729906427, -1043.4732517669554, -1024.2872626806393, 247.97002788978585, -1141.74345377247, 179.36921510672042, -1006.8518308325038, -552.5565867749127, -1096.1614441895786, 125.99378370428684, -1130.7462651597818, -283.1050877092602, -1252.7001035139565, 384.6704110128678, -888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429], "policy_predator_policy_reward": [1294.9640912702164, 70.95429825793195, 1264.4063729906427, 1050.1732517669493, 910.3004512033243, 858.7014130923016, 1091.849478307842, 298.72665551949126, 1025.5870615684219, 925.0160335304769, 1066.4420282836952, 374.2344766287405, 856.2330801440895, 1021.86426193619, 913.4540650375737, 1024.6649022443473, 769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8985145121970275, "mean_inference_ms": 3.6124849828889, "mean_action_processing_ms": 1.1686515482994346, "mean_env_wait_ms": 10.156657707198748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009731173515319824, "StateBufferConnector_ms": 0.004325151443481445, "ViewRequirementAgentConnector_ms": 0.12103068828582764}, "num_episodes": 6, "episode_return_max": 1070.0892747808343, "episode_return_min": -27.529852517760084, "episode_return_mean": 258.1304402168808, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.1124979236435, "num_env_steps_trained_throughput_per_sec": 150.1124979236435, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 26918.426, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26917.825, "sample_time_ms": 2595.604, "learn_time_ms": 24293.736, "learn_throughput": 164.651, "synch_weights_time_ms": 22.855}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "60982_00000", "date": "2024-08-23_11-23-22", "timestamp": 1724392402, "time_this_iter_s": 26.690104722976685, "time_total_s": 1413.5992579460144, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17115aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1413.5992579460144, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 36.01315789473685, "ram_util_percent": 83.32894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.35716658307131, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.666852353615735, "policy_loss": -0.0062800934962021614, "vf_loss": 7.672347545623779, "vf_explained_var": 0.2885577983957119, "kl": 0.007849056051216191, "entropy": 0.4339448493782175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.056349363024273, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.706210108156557, "policy_loss": -0.011491546798103228, "vf_loss": 7.716025197064435, "vf_explained_var": 0.40261885602638203, "kl": 0.008382231964379865, "entropy": 0.764337930351338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 980.4269212584352, "episode_reward_min": -27.529852517760084, "episode_reward_mean": 242.9901608655222, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -738.849705721317, "predator_policy": 860.3447861540787}, "custom_metrics": {}, "hist_stats": {"episode_reward": [544.5333809040571, 0.5000000000000133, 58.11203350105524, 248.52411974831438, 100.30430687480809, 71.53800011698792, 344.8963359291197, 18.600000000000012, 31.62485422404307, 0.9000000000000066, 6.9713209206317295, 323.53481431168734, 468.39152155528257, 96.22932060855851, 731.2319757599744, 9.699999999999976, 1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-888.3465302427852, -98.91436863071235, -1013.9465825966129, -1130.1587184388677, -607.9933582591692, -1052.1123576595498, -446.2103171890976, -1171.3815187163996, -650.2063202188698, -1390.1743556188005, -940.0979152347206, -797.7076459507916, 88.73395505649819, -360.514069222933, -819.9242723084941, -920.0005517389524, -940.6432521675384, -823.210631513297, -1040.7785870191115, -1293.3986361362176, -1221.6844743527818, -1315.9490739904586, -932.8189703638132, -794.0577638569054, 18.291344454931824, -643.4294630676227, -318.7148022473078, -587.1013299675916, -1018.4596593562967, 207.99082384658752, -809.8474092522264, -1187.3563560592845, -1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665], "policy_predator_policy_reward": [769.7038025728781, 762.090477204676, 1014.446582596613, 1130.1587184388677, 649.1815712656028, 1069.0361781541758, 741.3170359334225, 1124.7989197203947, 807.0852106268628, 1333.5997720856208, 1027.3169307830954, 782.0266305194082, 498.62936774220736, 118.04708235335127, 834.9242723084975, 923.6005517389525, 960.4432521675393, 835.0354857373427, 1040.7785870191115, 1294.2986361362177, 1237.0538317303083, 1307.5510375335634, 864.1006691630237, 1186.310879369388, 472.30840453146976, 621.2212356364982, 171.2056931631126, 830.8397596603515, 824.3556370264682, 717.3451742432138, 816.8474092522279, 1190.0563560592848, 1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9028945119546576, "mean_inference_ms": 3.6214755165861003, "mean_action_processing_ms": 1.177237426302861, "mean_env_wait_ms": 10.168821087045693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0096665620803833, "StateBufferConnector_ms": 0.004274725914001465, "ViewRequirementAgentConnector_ms": 0.13035118579864502}, "num_episodes": 8, "episode_return_max": 980.4269212584352, "episode_return_min": -27.529852517760084, "episode_return_mean": 242.9901608655222, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.95095539752134, "num_env_steps_trained_throughput_per_sec": 146.95095539752134, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 27124.339, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27123.706, "sample_time_ms": 2647.324, "learn_time_ms": 24447.044, "learn_throughput": 163.619, "synch_weights_time_ms": 23.717}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "60982_00000", "date": "2024-08-23_11-23-49", "timestamp": 1724392429, "time_this_iter_s": 27.257075786590576, "time_total_s": 1440.856333732605, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bd700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1440.856333732605, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 37.71025641025641, "ram_util_percent": 83.16666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.873149288268316, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.534408446216078, "policy_loss": -0.0067933794864941215, "vf_loss": 7.540372769290177, "vf_explained_var": 0.24522084861836105, "kl": 0.008290152540726084, "entropy": 0.455980352371458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.964170347067414, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.657535692245241, "policy_loss": -0.01194672157948531, "vf_loss": 7.668009724188103, "vf_explained_var": 0.48540447843137874, "kl": 0.007363439856156234, "entropy": 0.7533000900001122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 980.4269212584352, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 238.65417324434225, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -731.6960356208161, "predator_policy": 851.0231222429877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1687944175328013, 443.66310092137917, 590.5681269594319, 55.6655900977821, 433.54198118344453, 481.45097922151564, 480.77193676542095, 244.46469367811653, 420.3699684336003, 123.86714847562061, 221.32561047118844, 34.800000000000175, 678.0385998649139, 3.4114431363590922, 582.1637707890917, 315.5795172654991, 27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1144.10886417222, -1321.4492806406695, -1219.8942391673777, 11.591043610362794, -226.1772903387481, -1084.3428268588557, -774.9769400131304, -1006.5696072315783, -974.3659286060215, -404.68023748735146, -576.446917839693, -715.4910149299587, -561.3748352293228, -1298.9397182295697, -1077.8989235380573, -401.5934162777844, -1113.4262797504034, 29.54541783344427, -493.2761042773569, -566.5184267449077, -242.14405873291807, -1330.2992172740096, -1122.2055448818176, -29.000396627304795, -260.4622770108342, -1017.7531974218891, -840.6699180991201, -888.8627170951638, -293.86790857677437, -1093.3186278930261, -969.5691970253656, -795.1524083726182, -957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906], "policy_predator_policy_reward": [1145.2776585897527, 1321.4492806406695, 1191.5306021306244, 460.43569434776526, 952.433001632976, 948.6552425240623, 830.1425301109127, 1007.0696072315783, 830.7576013642713, 981.8305459125461, 786.0516147277588, 987.3372972634083, 1195.4409257198026, 1145.6455645045148, 617.7254470700932, 1106.2315864238656, 970.3243373586645, 533.926492991896, 622.1260315202741, 561.535647977619, 560.5501470967255, 1233.218739381397, 1122.2055448818176, 63.80039662730528, 1078.7110660143592, 877.5430082832803, 859.1605050284226, 873.7835733022217, 994.4674994573122, 974.8828078015828, 932.9384894794598, 1147.3626331840344, 1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9181845430149265, "mean_inference_ms": 3.6420863417407623, "mean_action_processing_ms": 1.1829549472447978, "mean_env_wait_ms": 10.166085203815344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025507330894470215, "StateBufferConnector_ms": 0.004389524459838867, "ViewRequirementAgentConnector_ms": 0.12610530853271484}, "num_episodes": 16, "episode_return_max": 980.4269212584352, "episode_return_min": -50.2626318152753, "episode_return_mean": 238.65417324434225, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.92043275970877, "num_env_steps_trained_throughput_per_sec": 152.92043275970877, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 26985.864, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26985.321, "sample_time_ms": 2555.761, "learn_time_ms": 24402.293, "learn_throughput": 163.919, "synch_weights_time_ms": 22.476}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "60982_00000", "date": "2024-08-23_11-24-16", "timestamp": 1724392456, "time_this_iter_s": 26.20604109764099, "time_total_s": 1467.062374830246, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7809d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1467.062374830246, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 34.035135135135135, "ram_util_percent": 82.67027027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.961323837754588, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.993509752283652, "policy_loss": -0.007823592124792634, "vf_loss": 8.000548018097247, "vf_explained_var": 0.1389352661591989, "kl": 0.007853423063298342, "entropy": 0.39460059634592165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.303258952892646, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.669439887495899, "policy_loss": -0.011276839361107223, "vf_loss": 7.678981640729955, "vf_explained_var": 0.4783996583923461, "kl": 0.008675366013049685, "entropy": 0.687500674573202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 980.4269212584352, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 223.4008250170995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -712.4754204374877, "predator_policy": 824.1758329460383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.576640983565515, 279.14865504632576, 156.56614536368306, 182.1009612369667, 376.6240068186041, 85.33700671767087, 88.1265107007714, 356.3644985885042, 980.4269212584352, 264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-957.7411298386729, -968.8216900944584, -961.9813477545379, -144.6420145073515, -1278.6566419326302, -605.6359822306628, -927.6840168766413, -698.9908807379928, -25.17409911339233, -854.2360602466586, -16.628654794188282, -762.3064600154166, -124.48699641946294, -1219.6487657681887, 303.58289374167754, -1066.4927622631615, -1067.3679076654607, 244.77220143780332, -755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873], "policy_predator_policy_reward": [1010.8762862759639, 943.2631746407326, 527.1478803218242, 858.6241369863869, 1257.0998565325447, 783.758912994436, 927.6840168766413, 881.0918419749627, 567.8884304576112, 688.1457357210439, 646.6308342638106, 217.64128726346755, 206.89210551113484, 1225.3701673772866, 73.94522338691209, 1045.3291437230764, 780.146186158768, 1022.8764413273211, 377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.925886016178993, "mean_inference_ms": 3.656066383895518, "mean_action_processing_ms": 1.1927316567096347, "mean_env_wait_ms": 10.188254020477462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019429564476013184, "StateBufferConnector_ms": 0.004322171211242676, "ViewRequirementAgentConnector_ms": 0.13085925579071045}, "num_episodes": 16, "episode_return_max": 980.4269212584352, "episode_return_min": -50.2626318152753, "episode_return_mean": 223.4008250170995, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.1906181100713, "num_env_steps_trained_throughput_per_sec": 161.1906181100713, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 26765.019, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26764.61, "sample_time_ms": 2520.611, "learn_time_ms": 24217.791, "learn_throughput": 165.168, "synch_weights_time_ms": 21.657}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "60982_00000", "date": "2024-08-23_11-24-40", "timestamp": 1724392480, "time_this_iter_s": 24.82280397415161, "time_total_s": 1491.8851788043976, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7939d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1491.8851788043976, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 29.480555555555554, "ram_util_percent": 82.54166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.903058091925566, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.12701318528917, "policy_loss": -0.007459569414929738, "vf_loss": 8.133803686515364, "vf_explained_var": 0.15617970852624802, "kl": 0.006690215575262392, "entropy": 0.3489606147405332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.295556135530825, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.875455904259253, "policy_loss": -0.010674803434974617, "vf_loss": 7.8844754466304074, "vf_explained_var": 0.46742444278071166, "kl": 0.00827637592665654, "entropy": 0.6537016883728997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 932.2055288948751, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 210.26335224224533, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -722.7283017204696, "predator_policy": 827.8599778415929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.130176314536, 337.3844564115074, 56.08104075437085, 329.529467651447, 125.63004172374154, 778.2741488690353, 11.200000000000006, 0.5000000000000213, 75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-755.8028694312842, -260.2067813563178, -274.9212833610484, -1423.0913296822416, -839.5248198863425, -602.1320628689245, -874.4035602191082, -194.33545050931127, -1242.7037715448232, -104.41348314213614, 298.3250531023705, -1364.7775857430859, -602.1024976743644, -1270.1753414129687, -1218.1431672216615, -1112.2419720571172, -905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755], "policy_predator_policy_reward": [377.2577444899628, 902.8820826121754, 1257.6575165138938, 777.7395529409079, 840.0248198863427, 657.7131036232954, 815.6370032774397, 582.6314751024264, 1158.85707508074, 313.8902213299609, 626.6575699690313, 1218.0691115407205, 612.8024976743643, 1270.6753414129687, 1218.6431672216615, 1112.2419720571172, 905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9428845244090174, "mean_inference_ms": 3.6592413342926067, "mean_action_processing_ms": 1.1922817755276742, "mean_env_wait_ms": 10.195226722907389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01946890354156494, "StateBufferConnector_ms": 0.004284501075744629, "ViewRequirementAgentConnector_ms": 0.13035809993743896}, "num_episodes": 9, "episode_return_max": 932.2055288948751, "episode_return_min": -50.2626318152753, "episode_return_mean": 210.26335224224533, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.7534644095818, "num_env_steps_trained_throughput_per_sec": 160.7534644095818, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 26292.829, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26292.424, "sample_time_ms": 2495.322, "learn_time_ms": 23771.424, "learn_throughput": 168.269, "synch_weights_time_ms": 21.132}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "60982_00000", "date": "2024-08-23_11-25-05", "timestamp": 1724392505, "time_this_iter_s": 24.9086971282959, "time_total_s": 1516.7938759326935, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bd430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1516.7938759326935, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 28.768571428571427, "ram_util_percent": 81.7914285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.798055150521495, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.985202012743269, "policy_loss": -0.005990695842004642, "vf_loss": 7.990549808078342, "vf_explained_var": 0.24164206395073543, "kl": 0.006428803260334664, "entropy": 0.3351599052311882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.54455254292362, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.402206907827387, "policy_loss": -0.012496312299654597, "vf_loss": 7.413158282022628, "vf_explained_var": 0.43982007118759964, "kl": 0.00772464185554002, "entropy": 0.6286960073879787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 932.2055288948751, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 225.32995705792547, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -703.9769416760944, "predator_policy": 816.6419202050579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.03503027111518, 17.151441214493925, 5.300000000000001, 363.5393192544479, 1.4000000000000132, 461.7513133278177, 61.82602302568229, 119.85024568069986, 246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-905.3318273260464, -156.3033717595771, -998.9653327065299, -657.9933356354843, -1226.3477646268461, -744.3819268546519, -1214.6254722113272, -349.6882299440941, -975.8634756267136, -1469.5003518505962, -388.1129933312193, -130.81708816093976, -817.3104189865493, -1053.5935309749545, -629.4764281408272, -1054.6371186396445, -321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606], "policy_predator_policy_reward": [905.5318273260465, 231.13840203069043, 1044.2686080384885, 629.841501518023, 1226.7477646268462, 749.2819268546526, 886.7753359890847, 1041.0776854207893, 977.2634756267139, 1469.5003518505962, 92.2080905369427, 888.4733042830348, 871.8364420122335, 1060.8935309749545, 756.365086597479, 1047.5987058636929, 570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.944957741368922, "mean_inference_ms": 3.665229638690657, "mean_action_processing_ms": 1.1981855032237438, "mean_env_wait_ms": 10.195061594311955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024621129035949707, "StateBufferConnector_ms": 0.008107542991638184, "ViewRequirementAgentConnector_ms": 0.13516604900360107}, "num_episodes": 8, "episode_return_max": 932.2055288948751, "episode_return_min": -50.2626318152753, "episode_return_mean": 225.32995705792547, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.78113267043204, "num_env_steps_trained_throughput_per_sec": 160.78113267043204, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 26108.319, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26107.986, "sample_time_ms": 2477.592, "learn_time_ms": 23605.689, "learn_throughput": 169.451, "synch_weights_time_ms": 20.351}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "60982_00000", "date": "2024-08-23_11-25-30", "timestamp": 1724392530, "time_this_iter_s": 24.913968801498413, "time_total_s": 1541.707844734192, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f776670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1541.707844734192, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 30.025714285714287, "ram_util_percent": 81.98857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.130326053326723, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.837375732704445, "policy_loss": -0.009192025056355213, "vf_loss": 7.845861341082861, "vf_explained_var": 0.27079419061620397, "kl": 0.007064125992766724, "entropy": 0.36469479069192573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.417864515037133, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.802188469114758, "policy_loss": -0.014636630997574203, "vf_loss": 7.814950914231558, "vf_explained_var": 0.38110238338904406, "kl": 0.009371039303384288, "entropy": 0.6536594137312874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 932.2055288948751, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 223.31287071250023, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -704.07370418579, "predator_policy": 815.7301395420407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.1027084702458, 453.2365000946973, 409.9369727376233, 219.09018577445042, 252.735379448283, 495.141369054475, 546.5978455387759, 445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-321.2147513648767, -326.72528570288864, -1002.1598029507794, -522.6759248016865, -1183.2750962659154, -752.1730006003045, -1184.315905109284, -547.5722832276106, -1012.3695826151717, -1223.4908861400972, -1343.7361890650748, 101.99921273217083, -599.0274330531188, -145.48637418094992, -176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078], "policy_predator_policy_reward": [570.7947581393349, 323.24798739868254, 850.6938642479789, 1127.3783635991863, 1163.9282434093332, 1181.4568261945165, 1165.2793634304583, 785.6990106808885, 1311.391229709805, 1177.2046184937446, 1273.6020399430436, 463.276305444335, 587.3870801111242, 703.7245726617183, 631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.953831734014307, "mean_inference_ms": 3.665101950934186, "mean_action_processing_ms": 1.19305184229078, "mean_env_wait_ms": 10.1895251752387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024535655975341797, "StateBufferConnector_ms": 0.008080363273620605, "ViewRequirementAgentConnector_ms": 0.13502085208892822}, "num_episodes": 8, "episode_return_max": 932.2055288948751, "episode_return_min": -50.2626318152753, "episode_return_mean": 223.31287071250023, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.4486897444004, "num_env_steps_trained_throughput_per_sec": 160.4486897444004, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 25849.036, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25848.699, "sample_time_ms": 2348.403, "learn_time_ms": 23474.873, "learn_throughput": 170.395, "synch_weights_time_ms": 20.98}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "60982_00000", "date": "2024-08-23_11-25-55", "timestamp": 1724392555, "time_this_iter_s": 24.975097179412842, "time_total_s": 1566.6829419136047, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7930d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1566.6829419136047, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 30.033333333333328, "ram_util_percent": 82.19166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.992479540305162, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.395645901008889, "policy_loss": -0.006619439844446129, "vf_loss": 7.401468586290955, "vf_explained_var": 0.3027698035593386, "kl": 0.007967410675525942, "entropy": 0.3959510504884064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.527849969914351, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.221715224735321, "policy_loss": -0.012083830655843177, "vf_loss": 7.2319318327323465, "vf_explained_var": 0.4750887807084139, "kl": 0.009336055450575061, "entropy": 0.6983159508023943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 932.2055288948751, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 210.47666230948457, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1561.4012341747873, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1516.872254524466}, "policy_reward_mean": {"prey_policy": -703.7637022154609, "predator_policy": 809.0020333702037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0080311953519, 388.022988773953, 932.2055288948751, 4.099999999999998, 199.05006209903382, 2.8000000000000105, -27.529852517760084, 5.299999999999999, 231.90934397036065, 370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-176.50904527785917, -1204.7847986215133, 376.62298877395324, -658.7405224154031, 332.2017561502178, -861.7655212054498, -1399.5208762860316, -1458.298000799032, -538.0788996575778, -800.4576972103592, -1088.7472582415276, -1404.4119556811986, -1561.4012341747873, -1236.5324108476946, -1156.401342099159, -1072.4602423255762, -179.66428820531718, -23.08762339028037, -496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945], "policy_predator_policy_reward": [631.1745198670772, 1195.127355227648, 0.0, 670.140522415403, 676.344306621388, 785.4249873287182, 1399.5208762860316, 1462.3980007990322, 770.6069223446078, 766.9797366223684, 1089.0472582415273, 1406.9119556811984, 1253.531537980257, 1516.872254524466, 1156.401342099159, 1077.7602423255762, 297.67132474037726, 136.9899308255887, 342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.951246906605647, "mean_inference_ms": 3.6674822254139503, "mean_action_processing_ms": 1.2001516675183845, "mean_env_wait_ms": 10.206664308639578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469158172607422, "StateBufferConnector_ms": 0.007953047752380371, "ViewRequirementAgentConnector_ms": 0.13374745845794678}, "num_episodes": 7, "episode_return_max": 932.2055288948751, "episode_return_min": -50.2626318152753, "episode_return_mean": 210.47666230948457, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.45543721299072, "num_env_steps_trained_throughput_per_sec": 161.45543721299072, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 25696.331, "restore_workers_time_ms": 0.03, "training_step_time_ms": 25696.009, "sample_time_ms": 2264.419, "learn_time_ms": 23407.823, "learn_throughput": 170.883, "synch_weights_time_ms": 19.64}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "60982_00000", "date": "2024-08-23_11-26-20", "timestamp": 1724392580, "time_this_iter_s": 24.838470220565796, "time_total_s": 1591.5214121341705, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f78e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1591.5214121341705, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 29.831428571428567, "ram_util_percent": 82.38285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.293184486520353, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.08539222434715, "policy_loss": -0.007320106080757878, "vf_loss": 7.091905394054595, "vf_explained_var": 0.3224043374339109, "kl": 0.008069415785441245, "entropy": 0.4405333325661049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.912123438542482, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.058184106009347, "policy_loss": -0.009489835733202872, "vf_loss": 7.066007281611205, "vf_explained_var": 0.5500048108832546, "kl": 0.008333241812534945, "entropy": 0.6902699333019358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 840.0601976133178, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 200.42119492566556, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1464.8598825647475, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1465.1598825647477}, "policy_reward_mean": {"prey_policy": -694.2675390228763, "predator_policy": 794.4781364857097}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.68494772594204, 29.616116523517036, 157.74216272517145, 508.4730703894852, 6.000000000000006, 2.794306397448927, 417.30000000000166, -4.440892098500626e-15, 326.62998623761774, 25.717214679815157, 48.00000000000009, 412.6671839512429, -5.855981663015907, 358.7203219662192, 4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-496.4322467550763, -821.8091557117796, -716.296196156798, -521.2138576745772, -699.6676495175661, -886.576614238773, 342.2489392572338, -859.362825253275, -1081.5411222133362, -1019.3499813902666, -1116.8202813204684, -879.8778653911237, 363.1, 21.621683211455576, -1102.8341123773919, -1372.3697977262598, -452.106744554804, -1063.8605599364764, -1376.733433317774, -132.26389566087067, -256.6897526362342, -1455.5239059254125, -1319.01587961976, -960.5868599835063, -1055.3271003287452, -1070.834033383441, -539.1719921912131, -758.4335373097888, -1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271], "policy_predator_policy_reward": [342.3819954778527, 1346.5443547149462, 733.4123126803188, 533.7138576745765, 703.3736182610212, 1040.6128082204923, 828.6889324483722, 196.89802393715414, 1087.541122213336, 1019.3499813902666, 1129.0191385519515, 870.4733145570859, 0.0, 32.57831678854462, 1102.8341123773919, 1372.3697977262598, 993.207543357602, 849.3897473713032, 1376.733433317774, 157.98111034068407, 304.68975263623975, 1455.5239059254125, 1261.3020602504378, 1430.9678633040749, 1058.6344431219036, 1061.670708927267, 817.0453625674219, 839.2804888998111, 1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.948650500022282, "mean_inference_ms": 3.6590435870488216, "mean_action_processing_ms": 1.202334363565437, "mean_env_wait_ms": 10.209265288687538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469015121459961, "StateBufferConnector_ms": 0.007978320121765137, "ViewRequirementAgentConnector_ms": 0.1321810483932495}, "num_episodes": 9, "episode_return_max": 840.0601976133178, "episode_return_min": -50.2626318152753, "episode_return_mean": 200.42119492566556, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.96458462068006, "num_env_steps_trained_throughput_per_sec": 160.96458462068006, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 25710.446, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25710.107, "sample_time_ms": 2289.55, "learn_time_ms": 23395.404, "learn_throughput": 170.974, "synch_weights_time_ms": 20.94}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "60982_00000", "date": "2024-08-23_11-26-45", "timestamp": 1724392605, "time_this_iter_s": 24.884698152542114, "time_total_s": 1616.4061102867126, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f78d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1616.4061102867126, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 30.438888888888886, "ram_util_percent": 81.52777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.718449473254894, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.368169129588616, "policy_loss": -0.007291582146925586, "vf_loss": 7.374623548921454, "vf_explained_var": 0.22725587717439763, "kl": 0.008371858416302573, "entropy": 0.40590604382847983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.930651896088212, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.337576258119452, "policy_loss": -0.010373358598481567, "vf_loss": 7.3462482406979515, "vf_explained_var": 0.4516703488965514, "kl": 0.00850692060800693, "entropy": 0.6844468611258048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 840.0601976133178, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 200.633018398134, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1464.8598825647475, "predator_policy": 0.9951996643067283}, "policy_reward_max": {"prey_policy": 398.0048003356933, "predator_policy": 1465.1598825647477}, "policy_reward_mean": {"prey_policy": -683.6657171699126, "predator_policy": 783.9822263689802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.246309737636467, 5.995204332975845e-15, 388.7795361097962, 1.0282922223199975, 216.46374796454006, 619.1999999999997, 519.1237383073519, 63.36065607898383, 7.29999999999999, 228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1333.5472939892366, -617.361389518373, -1184.7541461871808, -1206.4503166547988, -251.13604016598717, -653.3753716473768, -1165.3402983413778, -1285.678438128343, -537.6461210211457, -722.6795789336429, 10.530476846522504, 398.0048003356933, -1088.8095844023878, 210.57310278114858, -30.910393535797276, -890.1309495830006, -1464.8598825647475, -923.4999468478766, 11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601], "policy_predator_policy_reward": [1333.5472939892366, 621.6076992560119, 1184.7541461871808, 1206.4503166547988, 707.9364278046444, 585.3545201185165, 1164.0733416009177, 1287.9736870911238, 769.3952084328796, 707.3942394864525, 209.6695231534772, 0.9951996643067283, 1041.1830821122035, 356.17713781639185, 113.6970385823789, 870.7049606154029, 1465.1598825647477, 930.4999468478765, 216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.937516865753362, "mean_inference_ms": 3.651616751049313, "mean_action_processing_ms": 1.20206510312953, "mean_env_wait_ms": 10.183006699233772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024831652641296387, "StateBufferConnector_ms": 0.008287668228149414, "ViewRequirementAgentConnector_ms": 0.1371924877166748}, "num_episodes": 14, "episode_return_max": 840.0601976133178, "episode_return_min": -50.2626318152753, "episode_return_mean": 200.633018398134, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.57354446159803, "num_env_steps_trained_throughput_per_sec": 161.57354446159803, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 25391.3, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25390.964, "sample_time_ms": 2256.895, "learn_time_ms": 23110.542, "learn_throughput": 173.081, "synch_weights_time_ms": 20.022}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "60982_00000", "date": "2024-08-23_11-27-10", "timestamp": 1724392630, "time_this_iter_s": 24.76289987564087, "time_total_s": 1641.1690101623535, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f799a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1641.1690101623535, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 29.02285714285714, "ram_util_percent": 81.31714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.643790252120407, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.397655838759488, "policy_loss": -0.007975666378945033, "vf_loss": 7.404736983082282, "vf_explained_var": 0.23458857239869538, "kl": 0.00894518051451693, "entropy": 0.3770687810643009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.99030135598763, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.300013441257376, "policy_loss": -0.015220522075379021, "vf_loss": 7.313545475813447, "vf_explained_var": 0.5017122870399838, "kl": 0.008442429328219049, "entropy": 0.6623978177706401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 840.0601976133178, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 198.5311832147629, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1530.4646034743841, "predator_policy": 1.7646349013744858}, "policy_reward_max": {"prey_policy": 378.4896298357128, "predator_policy": 1530.4646034743841}, "policy_reward_mean": {"prey_policy": -677.5277569367614, "predator_policy": 776.7933485441437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.44793293667286, 414.6270935856064, 666.9450897926667, 3.1086244689504383e-15, -3.070029537237377, -0.34289525178339986, 310.29636799676683, 6.799999999999999, 13.699999999999969, 390.286172195703, 306.97433814404087, 275.95957773934174, 36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [11.748088876280965, -789.8979521053185, -303.2510317242405, -806.6373768005393, 378.4896298357128, -1040.8350357524705, -1220.4083245070415, -1350.5257867786665, -915.2500528625071, -1392.362276890899, -1083.9852742400938, -1338.2051727806409, -506.13558850904053, -969.876759250665, -898.3251242972609, -1182.9204696127642, -1066.6282041826687, -376.70292950235785, -249.48475718755327, -577.9969381667353, -295.5331914328244, -283.6839409557915, -547.8514271294006, -956.0857451324907, 27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945], "policy_predator_policy_reward": [216.87020588729945, 789.7275902784119, 874.3874532098584, 650.1280489005309, 325.41593667434313, 1003.8745590350726, 1220.4083245070415, 1350.5257867786665, 916.8500528625073, 1387.6922473536617, 1083.8025180956001, 1338.0450336733513, 933.340900332967, 852.9678154235103, 905.1251242972618, 1182.9204696127642, 1068.4282041826687, 388.6029295023603, 564.1536993831572, 653.6141681668346, 862.7077813547903, 23.48368917786793, 854.2177878942233, 925.6789621070146, 7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.930173082666258, "mean_inference_ms": 3.653100920908793, "mean_action_processing_ms": 1.1978487133818476, "mean_env_wait_ms": 10.181862286012475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024834156036376953, "StateBufferConnector_ms": 0.008520245552062988, "ViewRequirementAgentConnector_ms": 0.13057053089141846}, "num_episodes": 9, "episode_return_max": 840.0601976133178, "episode_return_min": -50.2626318152753, "episode_return_mean": 198.5311832147629, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.48693818306268, "num_env_steps_trained_throughput_per_sec": 161.48693818306268, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 25203.573, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25203.368, "sample_time_ms": 2196.361, "learn_time_ms": 22984.562, "learn_throughput": 174.03, "synch_weights_time_ms": 19.521}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "60982_00000", "date": "2024-08-23_11-27-35", "timestamp": 1724392655, "time_this_iter_s": 24.8303701877594, "time_total_s": 1665.999380350113, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f780940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1665.999380350113, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 29.854285714285716, "ram_util_percent": 82.13428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.309929894139525, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.610133747322849, "policy_loss": -0.009879234784514343, "vf_loss": 7.618704411340138, "vf_explained_var": 0.13818313829482548, "kl": 0.013085629054093882, "entropy": 0.3966761900634362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 485.23000000000326}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.776482295106959, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.90078246707008, "policy_loss": -0.013737949761488136, "vf_loss": 6.912618659791493, "vf_explained_var": 0.6072258854038501, "kl": 0.0095088417863562, "entropy": 0.6667550306471567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 485.23000000000326}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 840.0601976133178, "episode_reward_min": -50.2626318152753, "episode_reward_mean": 191.01320675984104, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1530.4646034743841, "predator_policy": 1.7646349013744858}, "policy_reward_max": {"prey_policy": 371.6163817306015, "predator_policy": 1530.4646034743841}, "policy_reward_mean": {"prey_policy": -667.0776558756572, "predator_policy": 762.5842592555782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.348082534767116, 13.169343385038488, 127.84137890372973, 395.5649366420216, 32.28858285917284, -50.2626318152753, 492.4835671575091, 273.9564313827301, -1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [27.95424954549056, -947.6744764487718, -789.030553919532, -311.8743069915689, -1118.5503779401113, -692.1470779184771, -782.268468398428, -658.5500448800406, -860.6412728324765, -948.2934219264677, -918.9610593644043, -911.3907913667952, -235.3324190527158, -1151.1148551596095, -209.70319647948554, -320.7832226518906, -1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764], "policy_predator_policy_reward": [7.5991888528447, 948.4691205852035, 134.60174347644613, 979.4724608196957, 1227.0193966173554, 711.5194381449628, 838.4385705298076, 997.9448793906823, 934.3381497671663, 906.8851278509518, 844.1084717192907, 935.9807471966336, 934.1358976012032, 944.7949437686316, 5.363282348127177, 799.07956816598, 1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9210698693248047, "mean_inference_ms": 3.6415881668444587, "mean_action_processing_ms": 1.1934929175156774, "mean_env_wait_ms": 10.197532482818403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008955597877502441, "StateBufferConnector_ms": 0.008401274681091309, "ViewRequirementAgentConnector_ms": 0.12400937080383301}, "num_episodes": 12, "episode_return_max": 840.0601976133178, "episode_return_min": -50.2626318152753, "episode_return_mean": 191.01320675984104, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.61422280366872, "num_env_steps_trained_throughput_per_sec": 159.61422280366872, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 24987.617, "restore_workers_time_ms": 0.027, "training_step_time_ms": 24987.447, "sample_time_ms": 2176.047, "learn_time_ms": 22790.883, "learn_throughput": 175.509, "synch_weights_time_ms": 17.894}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "60982_00000", "date": "2024-08-23_11-28-00", "timestamp": 1724392680, "time_this_iter_s": 25.114176034927368, "time_total_s": 1691.1135563850403, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7e6040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1691.1135563850403, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 29.98055555555556, "ram_util_percent": 82.5361111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.11280059713535, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.635131913139706, "policy_loss": -0.0061633279369700525, "vf_loss": 7.640564132872082, "vf_explained_var": 0.23041518598637253, "kl": 0.0073109176224245434, "entropy": 0.3834791496001854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.8204505713528425, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.03862377701613, "policy_loss": -0.010634598378141328, "vf_loss": 7.047676270096391, "vf_explained_var": 0.5218889360074643, "kl": 0.00791039713461287, "entropy": 0.6660203647991968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 484.9937500000014}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 840.0601976133178, "episode_reward_min": -34.370543956342935, "episode_reward_mean": 189.3729249221817, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1530.4646034743841, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.2599339738565, "predator_policy": 1530.4646034743841}, "policy_reward_mean": {"prey_policy": -655.8094727214376, "predator_policy": 750.495935182529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.7763568394002505e-15, 533.8272405251813, 326.6681644027534, 840.0601976133178, 24.70000000000004, 295.4649431575016, 267.71185133644843, 31.483861250251117, 108.9331161662438, 458.23963268351133, 10.852605385573844, 78.53632714114858, 7.598776032869086, 5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1326.613042194402, -924.9004226636035, -86.73022235726188, -623.780864781181, 189.9578161785744, -349.1765252710069, 311.9922883099102, -1023.5350970739372, -1001.4164262310221, -627.3880207838647, 157.1313640986737, -1079.6109265853456, -642.6310836711234, -598.4102197827257, -821.5074109506961, -112.43181367442062, -945.1715392518255, -580.0103436426294, -1000.7802064299556, 284.9831540784596, -817.081172422181, -761.9826421640997, -1168.19897351367, -240.68861763249055, -842.8853671490898, -857.5748378549163, -1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599], "policy_predator_policy_reward": [1326.613042194402, 924.9004226636035, 595.1848809283376, 649.1534467352824, 112.01034822417864, 373.8765252710122, 608.4183091368504, 943.184697240494, 1006.4164262310221, 647.0880207838692, 138.13357905882782, 1079.8109265853457, 604.1143227297091, 904.6388320605939, 3.8466462738700997, 961.5764396014953, 940.7781409696238, 693.3368580910792, 994.6683760591524, 179.36830897585648, 823.9719155345036, 765.9445044373545, 1168.19897351367, 319.2249447736406, 844.48536714909, 863.5736138877855, 1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9176965625770612, "mean_inference_ms": 3.6385585177209787, "mean_action_processing_ms": 1.1923379201024795, "mean_env_wait_ms": 10.203134272121593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008899331092834473, "StateBufferConnector_ms": 0.008675098419189453, "ViewRequirementAgentConnector_ms": 0.12995588779449463}, "num_episodes": 8, "episode_return_max": 840.0601976133178, "episode_return_min": -34.370543956342935, "episode_return_mean": 189.3729249221817, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.08034757498132, "num_env_steps_trained_throughput_per_sec": 161.08034757498132, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 24855.086, "restore_workers_time_ms": 0.025, "training_step_time_ms": 24854.931, "sample_time_ms": 2171.507, "learn_time_ms": 22661.303, "learn_throughput": 176.512, "synch_weights_time_ms": 19.55}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "60982_00000", "date": "2024-08-23_11-28-25", "timestamp": 1724392705, "time_this_iter_s": 24.86793303489685, "time_total_s": 1715.9814894199371, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7803a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1715.9814894199371, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 30.959999999999997, "ram_util_percent": 82.86000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.569254336786017, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.488061220683749, "policy_loss": -0.005472814591315689, "vf_loss": 7.492855838997654, "vf_explained_var": 0.1572746513381837, "kl": 0.00678201545320609, "entropy": 0.38089647706223545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.199760511943273, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9623576774799005, "policy_loss": -0.013259426310717587, "vf_loss": 6.97406239585271, "vf_explained_var": 0.5491666603340674, "kl": 0.007773581532288402, "entropy": 0.6468706486086366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 808.662264638288, "episode_reward_min": -34.370543956342935, "episode_reward_mean": 193.95292498935135, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1530.4646034743841, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.2599339738565, "predator_policy": 1530.4646034743841}, "policy_reward_mean": {"prey_policy": -642.3870870714453, "predator_policy": 739.3635495661214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.699999999999992, 548.4197202436001, 47.320003018212304, 5.397497182495394, 287.4422567290016, 46.416889571615755, 5.741309303801305, 2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1024.5765275144424, -1190.6140584373913, 113.23137870769327, -1130.0909454535251, -954.6730107417503, -284.4125053791873, -1029.8123130245187, -1396.1018384487807, 68.6130882672584, -583.8934909123672, -1049.1459301757734, -978.6573331293253, -712.5847295525292, -841.7928427441597, -734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413], "policy_predator_policy_reward": [1027.8765275144422, 1193.0140584373914, 512.5226825155368, 1052.7566044738971, 955.3730107417502, 331.03250839740645, 1077.520856561576, 1353.790792094219, 637.1257504106313, 165.59690896348067, 1033.3124592154247, 1040.9076936612896, 712.2991431899592, 847.8197384105324, 735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9128768822297064, "mean_inference_ms": 3.631625137080868, "mean_action_processing_ms": 1.1840635398478752, "mean_env_wait_ms": 10.197531424150341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009273767471313477, "StateBufferConnector_ms": 0.008706212043762207, "ViewRequirementAgentConnector_ms": 0.12679052352905273}, "num_episodes": 13, "episode_return_max": 808.662264638288, "episode_return_min": -34.370543956342935, "episode_return_mean": 193.95292498935135, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.83215106031125, "num_env_steps_trained_throughput_per_sec": 159.83215106031125, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 24876.18, "restore_workers_time_ms": 0.024, "training_step_time_ms": 24876.0, "sample_time_ms": 2172.207, "learn_time_ms": 22681.246, "learn_throughput": 176.357, "synch_weights_time_ms": 19.655}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "60982_00000", "date": "2024-08-23_11-28-50", "timestamp": 1724392730, "time_this_iter_s": 25.07731819152832, "time_total_s": 1741.0588076114655, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f776dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1741.0588076114655, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 30.33055555555556, "ram_util_percent": 82.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.440351566688093, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.677644357227144, "policy_loss": -0.00848562094486422, "vf_loss": 7.685434574551053, "vf_explained_var": 0.18561545660886816, "kl": 0.0069541094588145376, "entropy": 0.3481103658360779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06865107294113, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.241331696384168, "policy_loss": -0.012716371156078167, "vf_loss": 7.252051983182392, "vf_explained_var": 0.5188174172683998, "kl": 0.009980455985558884, "entropy": 0.6583437293925614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 808.662264638288, "episode_reward_min": -34.370543956342935, "episode_reward_mean": 199.1843377988581, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1530.4646034743841, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.2599339738565, "predator_policy": 1530.4646034743841}, "policy_reward_mean": {"prey_policy": -629.95726008537, "predator_policy": 729.5494289847994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6744490681949635, 31.711491983232484, -4.613658502587015, 287.827009781992, 555.9268241113712, 14.199999999999967, 712.9848013965885, 301.6896477899011, 33.73130398368508, 329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-734.2023965924964, -712.8175312915805, -1242.8379142572314, -56.95474595308735, -1015.3368007747654, -1078.131992485548, -388.59474696157656, -808.881665053259, -271.68929820433624, -349.8940903816755, -812.0548856793947, -1364.0905772834285, 187.7443147143958, -1246.7779643101705, -284.76896084873556, 155.07086547771343, -908.3866515708344, -1006.7125258975676, -1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836], "policy_predator_policy_reward": [735.4052949275516, 714.2890820247231, 1243.4122033285141, 88.091948865037, 1008.9231422721781, 1079.9319924855479, 686.2459414618206, 799.0574803350079, 489.3780853309399, 688.1321273664439, 826.254885679398, 1364.0905772834285, 856.5006244014343, 915.5178265909306, 310.5689608487414, 120.8187823121873, 1036.5885321070823, 912.2419493450058, 397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.905012663956106, "mean_inference_ms": 3.62761121081364, "mean_action_processing_ms": 1.1813579880881446, "mean_env_wait_ms": 10.196347834108266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009268522262573242, "StateBufferConnector_ms": 0.00854802131652832, "ViewRequirementAgentConnector_ms": 0.12690973281860352}, "num_episodes": 7, "episode_return_max": 808.662264638288, "episode_return_min": -34.370543956342935, "episode_return_mean": 199.1843377988581, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.81760318557335, "num_env_steps_trained_throughput_per_sec": 159.81760318557335, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 24890.752, "restore_workers_time_ms": 0.024, "training_step_time_ms": 24890.571, "sample_time_ms": 2176.614, "learn_time_ms": 22690.25, "learn_throughput": 176.287, "synch_weights_time_ms": 20.689}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "60982_00000", "date": "2024-08-23_11-29-15", "timestamp": 1724392755, "time_this_iter_s": 25.082128286361694, "time_total_s": 1766.1409358978271, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f793b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1766.1409358978271, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.231428571428577, "ram_util_percent": 82.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.865374855515817, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.788870809948634, "policy_loss": -0.006940064072441408, "vf_loss": 7.795168053662335, "vf_explained_var": 0.09923649950632973, "kl": 0.00642831122081372, "entropy": 0.33065680990774166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.590684793613574, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4780719802493145, "policy_loss": -0.008613732326578683, "vf_loss": 7.484673519235439, "vf_explained_var": 0.5029806442361661, "kl": 0.010060923388868413, "entropy": 0.6293990381811031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 808.662264638288, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 197.59659712057496, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1530.4646034743841, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.2599339738565, "predator_policy": 1530.4646034743841}, "policy_reward_mean": {"prey_policy": -629.9702749116393, "predator_policy": 728.7685734719271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.61646304496054, 626.1714884596, 808.662264638288, 582.3338439796249, 2.500000000000001, -0.6290069487795742, 257.29337302378906, 197.58432370085052, 11.324764310471064, 254.2759825842786, -34.370543956342935, 216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1001.6102380924711, 14.892575989290883, -651.309774961964, 329.2358136775366, -1007.2289857388322, 63.32171692084633, 190.81778051745982, -748.5214170471606, -1087.6462653715066, -997.9008054311747, -1049.42808710663, -1063.8281547946865, -279.0387482891796, -810.0341240233474, -450.25714027602373, -865.226904890984, -1026.5836731784013, -887.0561866206085, -918.0411006404626, -283.4938302825822, -893.2995747116133, -1088.6435220097326, -911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552], "policy_predator_policy_reward": [397.78742177458787, 918.5467033735496, 612.871212187155, 335.37423755687246, 907.127566609245, 845.4419668470272, 699.6974962100859, 440.33998429923906, 1088.346265371506, 999.7008054311747, 1050.8696387814116, 1061.7575961711254, 544.1063902132267, 802.259855123094, 820.6544744067619, 692.4138944611009, 954.0263511391787, 970.938272970302, 922.8858444401111, 532.9250690672152, 1195.3690578052708, 752.2034949597297, 838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.902790248418236, "mean_inference_ms": 3.62838681661816, "mean_action_processing_ms": 1.1818063758292785, "mean_env_wait_ms": 10.21985170473328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009627103805541992, "StateBufferConnector_ms": 0.004808306694030762, "ViewRequirementAgentConnector_ms": 0.13563966751098633}, "num_episodes": 9, "episode_return_max": 808.662264638288, "episode_return_min": -54.064934672715246, "episode_return_mean": 197.59659712057496, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.7220776666646, "num_env_steps_trained_throughput_per_sec": 157.7220776666646, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 24939.004, "restore_workers_time_ms": 0.024, "training_step_time_ms": 24938.815, "sample_time_ms": 2260.425, "learn_time_ms": 22654.388, "learn_throughput": 176.566, "synch_weights_time_ms": 20.973}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "60982_00000", "date": "2024-08-23_11-29-41", "timestamp": 1724392781, "time_this_iter_s": 25.40412402153015, "time_total_s": 1791.5450599193573, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7e6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1791.5450599193573, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 31.444444444444443, "ram_util_percent": 82.89722222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.212641584810125, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.634796763223315, "policy_loss": -0.005826640553358528, "vf_loss": 7.639835162894435, "vf_explained_var": 0.17340517365743244, "kl": 0.007882216057331158, "entropy": 0.3255642526206516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.681384276082277, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.110283277400587, "policy_loss": -0.01400966058539414, "vf_loss": 7.122170498257591, "vf_explained_var": 0.4681777379500172, "kl": 0.010612239090420266, "entropy": 0.651010235592171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 742.8866555346874, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 184.5309356644488, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.2599339738565, "predator_policy": 1530.4646034743841}, "policy_reward_mean": {"prey_policy": -619.1721873242811, "predator_policy": 711.4376551565059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.16584551747107, 32.82217540359639, 87.3829710208438, 375.1705541129584, 600.2863790729879, 236.95804120659756, 3.552713678800501e-15, 6.6, 191.5246268020836, 388.6184486868272, 8.200000000000003, 136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-911.5718798644557, -180.25117122373078, -566.9535210280573, -1323.4520985367653, -740.1486058865061, -770.9907452827146, 371.6163817306015, -860.8513817118617, -1197.8115210820451, 30.36156980205804, -1105.5910777726613, 23.2881752303678, -808.3742864460844, -1189.7875907611392, -788.8302307258408, -1072.6979758090945, -320.395051499933, -1020.2866339544095, -474.9891689725265, 6.0226502606262615, -854.121630331729, -846.7613534063486, -413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809], "policy_predator_policy_reward": [838.694397887254, 469.29449871840217, 600.7658795494966, 1322.4619154189215, 744.7378709723998, 853.7844512176671, 1.7646349013744858, 862.6409191928443, 626.9462798555168, 1140.7900504974507, 1035.8275754888143, 283.433368260079, 808.3742864460844, 1189.7875907611392, 795.4302307258405, 1072.6979758090945, 669.890330775526, 862.3159814809101, 853.856001645889, 3.7289657528381692, 855.8216303317291, 853.2613534063486, 497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8916447582262648, "mean_inference_ms": 3.619354658386492, "mean_action_processing_ms": 1.1849348823164425, "mean_env_wait_ms": 10.207848934208489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009901762008666992, "StateBufferConnector_ms": 0.005452752113342285, "ViewRequirementAgentConnector_ms": 0.1396728754043579}, "num_episodes": 11, "episode_return_max": 742.8866555346874, "episode_return_min": -54.064934672715246, "episode_return_mean": 184.5309356644488, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.64815182398127, "num_env_steps_trained_throughput_per_sec": 154.64815182398127, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 25032.511, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25032.343, "sample_time_ms": 2359.325, "learn_time_ms": 22649.922, "learn_throughput": 176.601, "synch_weights_time_ms": 20.19}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "60982_00000", "date": "2024-08-23_11-30-07", "timestamp": 1724392807, "time_this_iter_s": 25.914975881576538, "time_total_s": 1817.4600358009338, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f793ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1817.4600358009338, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 44.68648648648649, "ram_util_percent": 83.2189189189189}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.800614908511047, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.269237572806222, "policy_loss": -0.004707515945845338, "vf_loss": 7.2733391312695055, "vf_explained_var": 0.25331897653599894, "kl": 0.006059456274539193, "entropy": 0.33889494710183016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.709462076394015, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.154923886092251, "policy_loss": -0.013462295847397948, "vf_loss": 7.1667980365652255, "vf_explained_var": 0.45035542066765843, "kl": 0.00794077957265828, "entropy": 0.6314214201200576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 202.51433127453157, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -604.3085205519869, "predator_policy": 705.5656861892529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.4546448316998, 28.64006441421496, 27.16915613386827, 392.6387724368255, -3.258148067873888, 5.331798796266187, 521.8938745877549, 9.600000000000005, 17.599999999999937, 4.892415148274571, 109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-413.24812232550516, -976.9245235663694, -472.73643633920693, -543.6003158085805, -310.4485808587554, -1207.2456498415834, -165.01027684174954, -653.5768144085406, -918.8766318985909, -948.6269532953168, -911.8802087427451, -1180.0986311664271, 286.84929514159506, -475.8731456050453, -933.8879316270559, -683.8726124659922, -1333.1031425060462, -541.701000499008, -812.690582741644, -1311.6431679182565, -503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956], "policy_predator_policy_reward": [497.55811891876743, 1029.0691718048042, 415.77246080932946, 629.2043557526731, 337.90001422206944, 1206.9633726121433, 136.45127541956938, 1074.774588267546, 915.1982995683225, 949.0471375577113, 1077.9233666486605, 1019.3872720567792, 328.18214760305636, 382.7355774481482, 933.8879316270559, 693.4726124659927, 1333.1031425060462, 559.3010004990116, 1311.6431679182565, 817.5829978899185, 1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8887883089861326, "mean_inference_ms": 3.6194034243856423, "mean_action_processing_ms": 1.1805788254944607, "mean_env_wait_ms": 10.206662056083344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009823799133300781, "StateBufferConnector_ms": 0.005484580993652344, "ViewRequirementAgentConnector_ms": 0.1460496187210083}, "num_episodes": 11, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 202.51433127453157, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.11080645498234, "num_env_steps_trained_throughput_per_sec": 162.11080645498234, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 25022.493, "restore_workers_time_ms": 0.022, "training_step_time_ms": 25022.313, "sample_time_ms": 2384.53, "learn_time_ms": 22613.191, "learn_throughput": 176.888, "synch_weights_time_ms": 21.647}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "60982_00000", "date": "2024-08-23_11-30-31", "timestamp": 1724392831, "time_this_iter_s": 24.70989990234375, "time_total_s": 1842.1699357032776, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f799b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1842.1699357032776, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 42.02571428571429, "ram_util_percent": 82.61714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.80722493116187, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.336261241145865, "policy_loss": -0.008230612339777134, "vf_loss": 7.3437205844455296, "vf_explained_var": 0.1876332052801021, "kl": 0.0077126032947538, "entropy": 0.34979952121222463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063266171097125, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.168829207445579, "policy_loss": -0.013550846408017807, "vf_loss": 7.180822297757265, "vf_explained_var": 0.4913216337325081, "kl": 0.007788702519117761, "entropy": 0.6148174481417136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 211.53426146152276, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -599.1776564465565, "predator_policy": 704.9447871773184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.2901734319414, 434.54742780542256, 158.34170326119946, 143.11130552463155, 30.976933192019686, 352.99302299356884, 4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-503.3322345040855, -802.1702483981868, 92.32994195583058, -701.6095328971994, -586.62471024995, -702.6522481498716, -698.8164474634834, -287.6229856181982, -268.50141367274824, -1369.0927745816798, -949.8987159192837, -240.65575489051878, -1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268], "policy_predator_policy_reward": [1013.1702521017287, 401.62240423249267, 348.18637653433296, 695.6406422124561, 755.295812222706, 692.3228494383169, 955.6724964153395, 173.8782421909758, 299.47834686477415, 1369.0927745816798, 534.8689736010946, 1008.6785202022726, 1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.892220392765331, "mean_inference_ms": 3.6192262719584067, "mean_action_processing_ms": 1.178813991708695, "mean_env_wait_ms": 10.223345910242813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00979757308959961, "StateBufferConnector_ms": 0.005283355712890625, "ViewRequirementAgentConnector_ms": 0.15204274654388428}, "num_episodes": 10, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 211.53426146152276, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.7116925166697, "num_env_steps_trained_throughput_per_sec": 161.7116925166697, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 25011.013, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25010.857, "sample_time_ms": 2335.259, "learn_time_ms": 22652.625, "learn_throughput": 176.58, "synch_weights_time_ms": 20.164}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "60982_00000", "date": "2024-08-23_11-30-56", "timestamp": 1724392856, "time_this_iter_s": 24.74495577812195, "time_total_s": 1866.9148914813995, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f78edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1866.9148914813995, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 40.21714285714285, "ram_util_percent": 81.74857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.70492588426701, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.524586565532381, "policy_loss": -0.00718453709114954, "vf_loss": 7.531039073479869, "vf_explained_var": 0.13808690952876257, "kl": 0.007320262466202534, "entropy": 0.32008553136278084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.68689138586559, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.941287157270644, "policy_loss": -0.013783778118649646, "vf_loss": 6.953230747344002, "vf_explained_var": 0.5105234373814215, "kl": 0.009200877428212495, "entropy": 0.6587064550667213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 202.42100173807887, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -605.1713798197939, "predator_policy": 706.3818806888336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.933882111802689, 0.10000000000002185, 148.50428258898523, 742.8866555346874, 370.20841646336396, 425.852273281185, 125.73613348924178, 91.92178316448009, 120.78001858837514, 17.200000000000028, 12.199999999999967, 3.091445008425903, 442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1393.1933758163334, -819.0500294874076, -1104.4431846886202, -1260.3670528682417, -890.7848482885998, 37.92908690418011, -1038.965783475734, 126.08019281829601, -751.7537678322826, -627.1609909980845, -432.56908266320187, 270.38450925971165, 29.67790189425684, -822.536118956908, -276.44319314077484, -474.2916574626792, -601.7808450205583, -786.4818408569424, -628.5906352013313, -1131.1370929567322, -1530.4646034743841, -839.0587908731452, -692.8043865532965, -1404.0496922824464, -724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096], "policy_predator_policy_reward": [1396.1084794954054, 821.0688079201389, 1104.4431846886202, 1260.4670528682418, 900.6001930565026, 100.7598509169065, 899.2991605325284, 756.4730856595976, 1036.2741162319944, 712.8490590617416, 166.42136884663185, 421.6154778380433, 89.85823159498489, 828.7361189569077, 543.0421703180701, 299.61446344987536, 841.7177127416544, 667.324991724226, 645.7906352013321, 1131.1370929567322, 1530.4646034743841, 851.258790873145, 695.8958315617226, 1404.0496922824464, 696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8934358720919344, "mean_inference_ms": 3.6169479639346798, "mean_action_processing_ms": 1.175974219040433, "mean_env_wait_ms": 10.218748794581204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009847044944763184, "StateBufferConnector_ms": 0.005208253860473633, "ViewRequirementAgentConnector_ms": 0.1466224193572998}, "num_episodes": 6, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 202.42100173807887, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.29839733522033, "num_env_steps_trained_throughput_per_sec": 149.29839733522033, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 25214.559, "restore_workers_time_ms": 0.022, "training_step_time_ms": 25214.381, "sample_time_ms": 2356.062, "learn_time_ms": 22833.046, "learn_throughput": 175.185, "synch_weights_time_ms": 21.977}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "60982_00000", "date": "2024-08-23_11-31-23", "timestamp": 1724392883, "time_this_iter_s": 26.83787989616394, "time_total_s": 1893.7527713775635, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7ce8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1893.7527713775635, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 50.699999999999996, "ram_util_percent": 82.58378378378379}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.63884854619465, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.046448775700161, "policy_loss": -0.007401781272951258, "vf_loss": 7.053178264476635, "vf_explained_var": 0.23393716339081053, "kl": 0.006723387243605598, "entropy": 0.3685789018396347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.89178585602493, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.85166732545883, "policy_loss": -0.011937452029811326, "vf_loss": 6.862021957881867, "vf_explained_var": 0.5081590036235789, "kl": 0.007914283212826207, "entropy": 0.7025286475817363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 207.8611543413026, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -580.1492212715633, "predator_policy": 684.079798442215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [442.32869208844164, 2.7020122831037225, 119.4865639000157, 0.5609444033910505, 35.27321346737178, 198.2974823593608, 151.95080956402867, 199.09137259511363, 174.35823626581276, 69.4673900167924, 521.0912580854563, 208.71100169468838, 177.83571747446464, 732.4126589363003, -6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-724.662881053172, -85.75615675572945, -667.9499753171989, -409.1492915306598, -486.28499778453744, -343.6891077885487, -1318.288765430745, -1172.5945139273902, -1233.5883705182284, -157.22423683808475, -222.50110873233527, -815.2737620088784, -790.6806703846821, -1066.953954430413, -19.748295046571748, -1123.6060496316068, -854.2576361529666, -618.1176262565137, -81.26683017835401, -821.5106893317193, -258.428919310503, -782.8857736988492, -260.6864795774192, -790.2700047871393, -228.1373062100055, -1149.231063995764, 383.2599339738565, -1062.199051351969, -645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113], "policy_predator_policy_reward": [696.8867228681577, 555.8610070291859, 676.6139073396996, 403.18737179126765, 176.4038464773552, 773.0568229957474, 1316.9892995023122, 1174.454924259214, 159.2927000946687, 1266.7931207290148, 426.3818318314691, 809.6905212691073, 791.6413819491344, 1217.9440524299864, 429.32488740917086, 913.1208298641213, 818.222590275013, 828.5109084002808, 850.2855261288697, 121.9593833979985, 770.9361129674163, 791.4698381273881, 922.8961051300563, 336.7713809291922, 992.9318114157287, 562.2722762645066, 421.3269196263209, 990.0248566880924, 718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.891367364813941, "mean_inference_ms": 3.6189706543782707, "mean_action_processing_ms": 1.1793663260886833, "mean_env_wait_ms": 10.238144585723612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009896397590637207, "StateBufferConnector_ms": 0.0052378177642822266, "ViewRequirementAgentConnector_ms": 0.14897966384887695}, "num_episodes": 12, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 207.8611543413026, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.35734448544997, "num_env_steps_trained_throughput_per_sec": 162.35734448544997, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 25201.282, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25201.09, "sample_time_ms": 2352.669, "learn_time_ms": 22822.587, "learn_throughput": 175.265, "synch_weights_time_ms": 22.412}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "60982_00000", "date": "2024-08-23_11-31-48", "timestamp": 1724392908, "time_this_iter_s": 24.676113843917847, "time_total_s": 1918.4288852214813, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1918.4288852214813, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 39.83714285714285, "ram_util_percent": 82.71714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.911067628608178, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.0227578566818645, "policy_loss": -0.0075913039026239875, "vf_loss": 7.029679092528328, "vf_explained_var": 0.33795541505964977, "kl": 0.006700957515991475, "entropy": 0.3781882058375727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.671975840210283, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.08937927377287, "policy_loss": -0.013879188735323844, "vf_loss": 7.101405297133027, "vf_explained_var": 0.5268407641264496, "kl": 0.00926578471685942, "entropy": 0.6469190823338019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 208.72326942802374, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -564.628365496809, "predator_policy": 668.9900002108211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.440191906901855, -34.140772834220684, 79.99999999999973, 2.5000000000000036, 21.97356515540639, 367.94158483174743, -6.885336898578139, 444.74652415395326, 628.9857623426609, 367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-645.6522832402837, -1005.966015036961, -907.0487178728006, -524.02048608401, 40.0000000000003, 40.0000000000003, -747.1153971909793, -1002.5096902157155, -986.6422776027226, 15.789211998576006, -805.5163483695977, 340.1214494855465, -1150.2637861296566, -556.9612073046599, -361.7777981256004, -431.60913228941513, 198.93102759975582, -846.4153954659423, -1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791], "policy_predator_policy_reward": [718.4336435042502, 926.7444628660925, 615.3873145493458, 781.5411165732465, 0.0, 0.0, 749.4153971909793, 1002.7096902157156, 986.6422776027226, 6.184353156830344, 812.1163483695992, 21.220135346199445, 548.0877324943062, 1152.2519240414322, 526.1605587770489, 711.9728957919187, 499.03644177882916, 777.4336884300205, 1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.889655152730458, "mean_inference_ms": 3.6163715834541965, "mean_action_processing_ms": 1.1790670784715984, "mean_env_wait_ms": 10.232550498737764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010026335716247559, "StateBufferConnector_ms": 0.007056236267089844, "ViewRequirementAgentConnector_ms": 0.14257359504699707}, "num_episodes": 14, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 208.72326942802374, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.9284317011038, "num_env_steps_trained_throughput_per_sec": 161.9284317011038, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 25165.468, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25165.274, "sample_time_ms": 2339.417, "learn_time_ms": 22799.889, "learn_throughput": 175.439, "synch_weights_time_ms": 22.454}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "60982_00000", "date": "2024-08-23_11-32-12", "timestamp": 1724392932, "time_this_iter_s": 24.733333110809326, "time_total_s": 1943.1622183322906, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f799700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1943.1622183322906, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 42.20285714285714, "ram_util_percent": 82.86285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.501036950015518, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.261855310611624, "policy_loss": -0.00602350608056421, "vf_loss": 7.267127758106858, "vf_explained_var": 0.35741078311173374, "kl": 0.007510543704308845, "entropy": 0.35965012619419706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.836545321550318, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.26535844096431, "policy_loss": -0.011161781394627517, "vf_loss": 7.27507385021795, "vf_explained_var": 0.49052847314763953, "kl": 0.00723189432863836, "entropy": 0.5922467053251922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 208.9836222833485, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -560.9073814245155, "predator_policy": 665.39919256619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.3098460361273, 29.800000000000168, 15.642989171063995, 344.26707155988834, 11.025766653460078, 398.10000000000247, 349.40441615255884, 10.69999999999998, 451.3097126865396, 284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1173.1697827797616, -54.503891977657986, -231.33374271714914, -1197.0673780987806, -654.0800666483079, -1018.3455854930694, -1256.6459667842753, -519.7588779391514, -892.6173529959128, -972.3495118395284, -301.6840181125873, 376.73242892001184, -435.39478274775246, -576.7419618861849, -992.8614384155248, -466.3564878670998, 33.11750266409234, -450.95148474707094, 34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167], "policy_predator_policy_reward": [1163.160574850389, 431.82294594315687, 258.83374271714837, 1199.3673780987806, 633.7361717990112, 1054.332469513432, 925.8497492271321, 1194.8221670561811, 892.8431196493727, 983.1495118395289, 319.18401811259025, 3.8675710799881564, 175.1684598891375, 1186.3727008973617, 994.2614384155252, 475.65648786710034, 393.9169122659327, 475.2267825035852, 321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.893453130182004, "mean_inference_ms": 3.6132588669594092, "mean_action_processing_ms": 1.1804794604773579, "mean_env_wait_ms": 10.243716124086015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010081052780151367, "StateBufferConnector_ms": 0.007068634033203125, "ViewRequirementAgentConnector_ms": 0.15370726585388184}, "num_episodes": 9, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 208.9836222833485, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.46652796359433, "num_env_steps_trained_throughput_per_sec": 162.46652796359433, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 25144.281, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25144.094, "sample_time_ms": 2329.216, "learn_time_ms": 22789.597, "learn_throughput": 175.519, "synch_weights_time_ms": 21.742}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "60982_00000", "date": "2024-08-23_11-32-37", "timestamp": 1724392957, "time_this_iter_s": 24.667975187301636, "time_total_s": 1967.8301935195923, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7e6e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1967.8301935195923, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 42.28857142857143, "ram_util_percent": 82.81999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.04511104462639, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.836221385128284, "policy_loss": -0.00846183430107813, "vf_loss": 6.843808836659426, "vf_explained_var": 0.3709541952799237, "kl": 0.008743797984003784, "entropy": 0.37876705837943564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.233425980270225, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1631927676932525, "policy_loss": -0.011618576782987153, "vf_loss": 7.173481407871953, "vf_explained_var": 0.44907508728996154, "kl": 0.00664963862518706, "entropy": 0.6220469281471596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 197.99319571512882, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -563.5640633194124, "predator_policy": 662.5606611769772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.30964429986494, 106.4749893556432, 32.26226312583684, 220.0496085725782, 599.0132004282522, 4.247750838563012, 13.099999999999973, 596.9061340341794, 4.0000000000000036, 122.08596211711466, 327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [34.02676621197622, -434.23506888952835, -176.0114161403906, -2.860606852508413, -724.0075834345932, -147.59655400039694, -284.32246787166804, -867.3559649632872, 378.34788139203346, -922.3967980425839, -728.4309353897912, -721.1084745148028, -1090.8177980438616, -626.5693129485651, -728.8477698976081, -34.384179158619695, -940.9777936461436, -1070.077910803836, -703.0994831409065, -201.72417947614753, -1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754], "policy_predator_policy_reward": [321.6245015369933, 362.8934454404243, 202.97751690554497, 82.36949544299816, 724.3075834345932, 179.55881712623201, 323.6360493020384, 1048.0919921054985, 743.2419058331793, 399.82021124562067, 729.3275222209182, 724.4596385222397, 1090.8177980438616, 639.6693129485648, 708.4043546954442, 651.7337283949626, 942.677793646144, 1072.3779108038364, 387.77079129552857, 639.1388334386418, 897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.884022685072107, "mean_inference_ms": 3.606001802021491, "mean_action_processing_ms": 1.1847107306882108, "mean_env_wait_ms": 10.24088571620705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00970470905303955, "StateBufferConnector_ms": 0.0070639848709106445, "ViewRequirementAgentConnector_ms": 0.1538776159286499}, "num_episodes": 9, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 197.99319571512882, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.09161653003096, "num_env_steps_trained_throughput_per_sec": 163.09161653003096, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 25094.263, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25094.096, "sample_time_ms": 2324.928, "learn_time_ms": 22743.995, "learn_throughput": 175.871, "synch_weights_time_ms": 21.932}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "60982_00000", "date": "2024-08-23_11-33-02", "timestamp": 1724392982, "time_this_iter_s": 24.537544012069702, "time_total_s": 1992.367737531662, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711cf4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1992.367737531662, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 40.38571428571428, "ram_util_percent": 82.5542857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.14778017493152, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.038416224686557, "policy_loss": -0.007841703760137082, "vf_loss": 7.045544531484129, "vf_explained_var": 0.3089060357008031, "kl": 0.007133934478566208, "entropy": 0.3532408343894141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.423705891200475, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.246586537739587, "policy_loss": -0.013966091477346641, "vf_loss": 7.258617671078475, "vf_explained_var": 0.5155371148119527, "kl": 0.009674678365182545, "entropy": 0.6184901959366269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -54.064934672715246, "episode_reward_mean": 195.22139318714486, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -568.9363129732508, "predator_policy": 666.5470095668236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.05146966583646, -0.31416755432655763, -54.064934672715246, 112.76450813853974, 341.93480132696254, 246.91655430467122, 64.58745403295804, 616.3961544250175, 64.32044587442081, 372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1044.481295731726, -618.3923064071913, -753.8542244928858, -770.1346751975515, -771.9948663553951, -862.447735122339, -221.53807023289193, -1384.636152339924, -667.2066278796996, -364.7419101774499, -53.672160916710766, -1159.0305213084832, -233.49379621185005, -772.3004734856904, -323.2211753467571, -1035.9508787838552, -247.7080984450842, -1119.0587517289778, -1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479], "policy_predator_policy_reward": [897.610295005858, 1092.3147767988933, 751.3400569385628, 772.334675197552, 885.9778434248698, 694.3998233801506, 334.3025783714304, 1384.636152339924, 543.4271095298318, 830.4562298542799, 300.7384181844025, 1158.8808183454632, 571.2117238542673, 499.16999987623075, 1004.5228278670995, 971.0453806885296, 524.1754552857492, 906.9118407627332, 604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.886865253578266, "mean_inference_ms": 3.6025637147658642, "mean_action_processing_ms": 1.1811216750636684, "mean_env_wait_ms": 10.234765552460932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011171340942382812, "StateBufferConnector_ms": 0.007126569747924805, "ViewRequirementAgentConnector_ms": 0.14597606658935547}, "num_episodes": 10, "episode_return_max": 977.584874824628, "episode_return_min": -54.064934672715246, "episode_return_mean": 195.22139318714486, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.81900228520988, "num_env_steps_trained_throughput_per_sec": 159.81900228520988, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 25094.239, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25094.074, "sample_time_ms": 2324.845, "learn_time_ms": 22744.893, "learn_throughput": 175.864, "synch_weights_time_ms": 21.215}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "60982_00000", "date": "2024-08-23_11-33-27", "timestamp": 1724393007, "time_this_iter_s": 25.077105045318604, "time_total_s": 2017.4448425769806, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7a6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2017.4448425769806, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 41.162857142857135, "ram_util_percent": 82.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.922558499644044, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.721733503493052, "policy_loss": -0.007655413246284874, "vf_loss": 6.728562387335238, "vf_explained_var": 0.35147134343152325, "kl": 0.008265298508014038, "entropy": 0.39498126156746394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 484.99374999999424}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.005848037628901, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.718192426489774, "policy_loss": -0.013250023968734596, "vf_loss": 6.729859701287809, "vf_explained_var": 0.6223202663123923, "kl": 0.007913783402551734, "entropy": 0.5938946061348789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 484.99374999999424}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -34.54511489837793, "episode_reward_mean": 198.91965085614757, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1586.026779703481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -554.8723030746364, "predator_policy": 654.3321285027107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.5220479658827, 108.60448944991316, 197.54388859894283, 89.76436909525295, 192.04658254228508, 49.82225966554901, 8.568073862421585, 154.1099142190942, 79.71393148434746, 411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1586.026779703481, 127.38431850602589, -789.6169602958909, -0.9512537391065893, -481.7284101909154, -170.768620820209, -634.1298012428116, -942.4447804410472, -649.851314198502, -28.239906096090273, -563.3975239023341, -524.7301090178087, -848.1956744858506, -642.9241388543986, -106.62153156665232, -781.3046056578786, -244.69275838400387, -961.2791786835713, 14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102], "policy_predator_policy_reward": [604.4210154512784, 1226.7434937120609, 711.6062133304367, 187.5664901544738, 515.9532009048844, 334.0877187051853, 769.7800819572518, 896.5588688218601, 285.9197094002571, 584.2180934366244, 509.15260256635855, 628.797290019337, 835.4618132596717, 664.2260739430002, 331.50184948685035, 710.5342019567762, 343.9450660429245, 941.7408025089996, 495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8821646542239523, "mean_inference_ms": 3.6013290585864812, "mean_action_processing_ms": 1.1803146284110138, "mean_env_wait_ms": 10.231782319900566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005547523498535156, "StateBufferConnector_ms": 0.007063031196594238, "ViewRequirementAgentConnector_ms": 0.14466071128845215}, "num_episodes": 9, "episode_return_max": 977.584874824628, "episode_return_min": -34.54511489837793, "episode_return_mean": 198.91965085614757, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.18781984529093, "num_env_steps_trained_throughput_per_sec": 155.18781984529093, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 25135.655, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25135.488, "sample_time_ms": 2283.247, "learn_time_ms": 22826.149, "learn_throughput": 175.238, "synch_weights_time_ms": 22.555}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "60982_00000", "date": "2024-08-23_11-33-53", "timestamp": 1724393033, "time_this_iter_s": 25.80541229248047, "time_total_s": 2043.250254869461, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f776dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2043.250254869461, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 45.72432432432432, "ram_util_percent": 82.89189189189187}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.851608415129324, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.360464256528824, "policy_loss": -0.0070438544196939025, "vf_loss": 7.366772948875629, "vf_explained_var": 0.16142448395017595, "kl": 0.007351600679830111, "entropy": 0.32408230907071833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.094326139379431, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.686678083611544, "policy_loss": -0.012519631003616033, "vf_loss": 7.69770207228484, "vf_explained_var": 0.49901088022050405, "kl": 0.007478111077878605, "entropy": 0.5793101780313663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 977.584874824628, "episode_reward_min": -34.54511489837793, "episode_reward_mean": 200.3248614325635, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1504.8280508754897, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1586.403595402618}, "policy_reward_mean": {"prey_policy": -555.3270867321266, "predator_policy": 655.4895174484088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [411.18080446601596, 562.1958403646744, 459.6956078949737, 122.675832562131, 4.599999999999996, 977.584874824628, 826.9423073435344, 4.799999999999995, 437.5000000000028, 137.02856855795366, 148.33523582067593, 260.7103354630699, 10.314003446460195, 11.884033467127589, 89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [14.312764634483488, -1169.2900145764809, -907.8373045654353, 200.03339296713781, 359.30124218207834, -1037.8247728269387, -1166.6214655820534, -28.847327874047554, -1239.4707941555685, -641.3023213660096, 305.4435858848232, -1123.6703660935405, -657.8965190308928, 388.19929780429516, -1301.2069664049075, -744.8478721990915, 29.747330330175433, 398.2, -1406.5450837374658, -752.210837055044, -231.63828836780587, -1048.0497435100788, -545.5328472113928, -477.26613200162956, -1180.8339084378263, -1015.376515140475, -446.80092587722584, -813.5237047531042, -957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522], "policy_predator_policy_reward": [495.04992474616944, 1071.1081296618438, 877.0857334082822, 392.9140185546891, 162.50442642178407, 975.71471211805, 145.07871003821336, 1173.0659159800205, 1239.7707941555684, 645.6023213660095, 826.2489202784348, 969.5627347549078, 658.8376562577728, 437.8018723123553, 1301.2069664049075, 749.6478721990926, 9.552669669824704, 0.0, 1586.403595402618, 709.3808939478456, 1064.8102188783057, 363.21304882024975, 596.6862217489872, 686.823092927108, 1186.389375568799, 1020.1350514559614, 778.4396853176322, 493.76897877983066, 980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8812554899531433, "mean_inference_ms": 3.60191603898297, "mean_action_processing_ms": 1.1746572648439857, "mean_env_wait_ms": 10.240401176690646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005341053009033203, "StateBufferConnector_ms": 0.006393313407897949, "ViewRequirementAgentConnector_ms": 0.13774895668029785}, "num_episodes": 9, "episode_return_max": 977.584874824628, "episode_return_min": -34.54511489837793, "episode_return_mean": 200.3248614325635, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.1033457906791, "num_env_steps_trained_throughput_per_sec": 154.1033457906791, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 25144.812, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25144.626, "sample_time_ms": 2185.408, "learn_time_ms": 22932.62, "learn_throughput": 174.424, "synch_weights_time_ms": 22.99}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "60982_00000", "date": "2024-08-23_11-34-19", "timestamp": 1724393059, "time_this_iter_s": 25.999653100967407, "time_total_s": 2069.2499079704285, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711cf5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2069.2499079704285, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 43.127027027027026, "ram_util_percent": 83.04054054054055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.41772359388846, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.541786685317913, "policy_loss": -0.00690546116530501, "vf_loss": 6.547851472683054, "vf_explained_var": 0.33606792291005455, "kl": 0.00840671332232733, "entropy": 0.39804696633071496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 484.99374999999424}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.345997995043557, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.225799886007158, "policy_loss": -0.012360632890667866, "vf_loss": 6.236907005310059, "vf_explained_var": 0.6109706941735807, "kl": 0.006267620432781913, "entropy": 0.5700992405414581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 484.99374999999424}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -34.54511489837793, "episode_reward_mean": 182.0680922669696, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1504.8280508754897, "predator_policy": 1.097833442203281}, "policy_reward_max": {"prey_policy": 391.9678642765658, "predator_policy": 1334.7995620153565}, "policy_reward_mean": {"prey_policy": -552.8007756323775, "predator_policy": 643.8348217658628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.25897554049224, 100.26931135854647, 206.21198236603612, 0.3158730035525992, 461.47139952424743, 638.7260036811382, 477.1718714946435, 47.33214309790463, 64.27245580616757, 134.95884310896392, 88.6818420322828, -9.278547083011611, 5.499999999999996, 33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-957.0425745231169, -374.2764497824702, -463.3241067667446, -492.76353890271776, -684.2220016364464, -1110.1028526583002, -930.7346919769708, -1086.0524854860782, -485.4024092082321, -477.664353526705, -933.503331827617, -55.309305088959455, -762.8475835849067, -73.25805334768137, -341.3063725104923, -797.67744719268, -1504.8280508754897, 17.6714880665332, -1394.9318217504488, 38.70521081500481, -1201.8315028432762, -479.70900537929407, -1100.398898668835, -409.4309715030083, -755.2237066788516, -633.8873114146777, -339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483], "policy_predator_policy_reward": [980.8047224651165, 439.77327738096284, 780.0071867145291, 276.3497703134934, 890.4352654963955, 1110.1015711643875, 934.5952765476746, 1082.5077739189276, 739.0943147496752, 685.4438475095112, 904.3072714687345, 723.2313691289745, 705.6354509398956, 607.6420574873351, 247.60884197976713, 938.7071208213113, 1334.7995620153565, 216.62945659976685, 1309.803746890216, 181.38170715418877, 1203.7870946304786, 566.4352556243782, 797.7900133721625, 702.7613097166727, 756.1237066788518, 638.4873114146787, 358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.876144185759916, "mean_inference_ms": 3.5927760177694283, "mean_action_processing_ms": 1.1743511870866064, "mean_env_wait_ms": 10.251832902000581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053234100341796875, "StateBufferConnector_ms": 0.00708317756652832, "ViewRequirementAgentConnector_ms": 0.1340247392654419}, "num_episodes": 14, "episode_return_max": 822.1253228931175, "episode_return_min": -34.54511489837793, "episode_return_mean": 182.0680922669696, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.8128991580564, "num_env_steps_trained_throughput_per_sec": 154.8128991580564, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 25261.128, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25260.935, "sample_time_ms": 2188.379, "learn_time_ms": 23044.52, "learn_throughput": 173.577, "synch_weights_time_ms": 23.895}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "60982_00000", "date": "2024-08-23_11-34-45", "timestamp": 1724393085, "time_this_iter_s": 25.880446910858154, "time_total_s": 2095.1303548812866, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711c01f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2095.1303548812866, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 42.047222222222224, "ram_util_percent": 83.3111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.125026263635625, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.641509867975952, "policy_loss": -0.006124784419973376, "vf_loss": 6.646783263090426, "vf_explained_var": 0.28186758926936556, "kl": 0.00851395886475171, "entropy": 0.3796091915438415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 497.9875000000029}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.71311586622208, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.042870421636672, "policy_loss": -0.013208713755504321, "vf_loss": 7.054806718372164, "vf_explained_var": 0.5593131291172492, "kl": 0.006362071073806238, "entropy": 0.5622998986925397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 497.9875000000029}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 178.84533614197503, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1393.036469563282, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -526.3766070703649, "predator_policy": 615.799275141353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.80000000000021, 45.613857111098, 103.38299873140727, 224.92840225847758, 278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-339.74215959868206, -453.7850692058096, -66.10325899468735, -577.6306616547321, -1042.8792833733903, -709.2637534487851, -752.5400149970146, -124.76370258522061, -615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048], "policy_predator_policy_reward": [358.4421595986863, 468.885069205813, 110.1692343814541, 579.1785433790604, 1023.6142488998241, 831.9117866537603, 700.5299803672618, 401.70213947345286, 571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8686972506201083, "mean_inference_ms": 3.5892664386938202, "mean_action_processing_ms": 1.1721090502260125, "mean_env_wait_ms": 10.25153516153383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00529325008392334, "StateBufferConnector_ms": 0.007579326629638672, "ViewRequirementAgentConnector_ms": 0.12724769115447998}, "num_episodes": 13, "episode_return_max": 822.1253228931175, "episode_return_min": -102.34391836524253, "episode_return_mean": 178.84533614197503, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.87453166375903, "num_env_steps_trained_throughput_per_sec": 158.87453166375903, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 25305.303, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25305.086, "sample_time_ms": 2205.892, "learn_time_ms": 23069.633, "learn_throughput": 173.388, "synch_weights_time_ms": 25.119}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "60982_00000", "date": "2024-08-23_11-35-10", "timestamp": 1724393110, "time_this_iter_s": 25.224908113479614, "time_total_s": 2120.3552629947662, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f793160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2120.3552629947662, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 39.54166666666667, "ram_util_percent": 82.99166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.34148496118172, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.342896747589111, "policy_loss": -0.008164722120596303, "vf_loss": 7.350237054673452, "vf_explained_var": 0.18548554333429487, "kl": 0.00824434108054019, "entropy": 0.3259575469941689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000466}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.25219640126304, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.51740997708033, "policy_loss": -0.011068090724034443, "vf_loss": 7.5268386906416955, "vf_explained_var": 0.5197358335767474, "kl": 0.008196812140553322, "entropy": 0.5361137027778323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000466}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 184.8014386976471, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1393.036469563282, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -530.5989724081952, "predator_policy": 622.9996917570191}, "custom_metrics": {}, "hist_stats": {"episode_reward": [278.937091244039, 204.9450402939803, 533.1193903355405, 165.06977923126743, 102.1098361418327, 1.7463841769063753, 262.08918020929895, 370.33821758700657, 315.1499732320642, 550.7202054723346, 315.16999779572234, 120.72984923125696, 221.310485339933, 102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-615.1347843672302, -156.18850693815693, -209.02958995869372, -419.4498881013647, -147.4445501862556, -712.6342065312297, -689.3331916523302, -56.69933917480488, -429.8875923483718, -1016.0285262242835, -1393.036469563282, -586.1024184783643, -560.3298210034243, -1091.484952224498, -142.63901477071727, 80.69147716662792, -521.5983365645932, -97.91318640037113, 377.5069613579382, -703.8619816901377, -1052.481688688061, -213.8568575695029, -712.2997495250859, 40.0000000000003, -960.0153668504018, -472.47375623832744, -736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922], "policy_predator_policy_reward": [571.6510811166756, 478.6093014327488, 402.2463693143994, 431.1781490396431, 697.7887564840984, 695.4093905689251, 268.51963150211424, 642.5826785562896, 543.4507779611109, 1004.5751767533802, 951.290949578186, 1029.5943226403663, 823.3216196763091, 1090.5823337609131, 172.49436525423988, 259.791389936853, 406.36658017101104, 528.2949160260199, 237.45260644281612, 639.6226193617172, 902.8762812836571, 678.6322627696262, 527.2158645706684, 265.81373418567944, 775.0864843555395, 878.7131240731287, 909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8664121066722577, "mean_inference_ms": 3.5897701789313525, "mean_action_processing_ms": 1.1708050106475503, "mean_env_wait_ms": 10.253482526055818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005237102508544922, "StateBufferConnector_ms": 0.007534623146057129, "ViewRequirementAgentConnector_ms": 0.12608706951141357}, "num_episodes": 4, "episode_return_max": 822.1253228931175, "episode_return_min": -102.34391836524253, "episode_return_mean": 184.8014386976471, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.79075783624242, "num_env_steps_trained_throughput_per_sec": 158.79075783624242, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 25145.145, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25144.941, "sample_time_ms": 2173.311, "learn_time_ms": 22943.586, "learn_throughput": 174.341, "synch_weights_time_ms": 24.005}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "60982_00000", "date": "2024-08-23_11-35-35", "timestamp": 1724393135, "time_this_iter_s": 25.22659707069397, "time_total_s": 2145.58186006546, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7e6040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2145.58186006546, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 39.831428571428575, "ram_util_percent": 83.1257142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.079995265713446, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.530631770280303, "policy_loss": -0.008410480348196216, "vf_loss": 7.538220063971464, "vf_explained_var": 0.21676741920451006, "kl": 0.008221692188086096, "entropy": 0.3143077227173659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000466}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.824312519648718, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.253081750112867, "policy_loss": -0.011297550480615683, "vf_loss": 7.263003345772072, "vf_explained_var": 0.5922968967881783, "kl": 0.006879798205638373, "entropy": 0.49969827034486036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000466}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 178.19333347812852, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1305.2018793860557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -528.8502702751931, "predator_policy": 617.946937014258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.06801539624077, 256.27491709100747, 11.220906769377597, 236.7931273307353, -14.668109744979427, 375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-736.4649398480126, -288.2327825475896, -931.9333946988086, -70.93409491458843, -215.15687273063372, -743.5861762073982, -1289.2733277613445, -48.15824705560377, -587.7441619738431, -473.71148626589587, 152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058], "policy_predator_policy_reward": [909.4492843117952, 217.31645348005546, 704.0900258173007, 555.0523808870995, 171.76839217176405, 798.1955635356461, 1231.909093805478, 342.3156083422059, 802.567367008811, 244.22017148595037, 458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8579813018105167, "mean_inference_ms": 3.5793731330170555, "mean_action_processing_ms": 1.1679922332048387, "mean_env_wait_ms": 10.255534044455334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005145072937011719, "StateBufferConnector_ms": 0.0050928592681884766, "ViewRequirementAgentConnector_ms": 0.15887105464935303}, "num_episodes": 13, "episode_return_max": 822.1253228931175, "episode_return_min": -102.34391836524253, "episode_return_mean": 178.19333347812852, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.88222040546475, "num_env_steps_trained_throughput_per_sec": 154.88222040546475, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 25264.051, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25263.864, "sample_time_ms": 2232.428, "learn_time_ms": 23003.861, "learn_throughput": 173.884, "synch_weights_time_ms": 23.687}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "60982_00000", "date": "2024-08-23_11-36-01", "timestamp": 1724393161, "time_this_iter_s": 25.852829933166504, "time_total_s": 2171.4346899986267, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711c03a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2171.4346899986267, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 42.21081081081081, "ram_util_percent": 83.05405405405406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.610539241064163, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.010123405254707, "policy_loss": -0.0077964426545554365, "vf_loss": 7.017138021459024, "vf_explained_var": 0.16023446081807374, "kl": 0.007818179390338994, "entropy": 0.34031400951758894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.252106840900645, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.135203513897285, "policy_loss": -0.010885163753603896, "vf_loss": 7.1449098753550695, "vf_explained_var": 0.555615828907679, "kl": 0.005893997853947064, "entropy": 0.46137838123967406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 190.46045297530642, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1305.2018793860557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -514.5634532326933, "predator_policy": 609.7936797203471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.3765084110095, 222.17934886310226, 459.15935634437494, 27.000000000000114, 236.44425350633702, 321.8554699800323, -30.74166360456399, 41.50000000000031, 242.1557429000508, 146.8231267594766, 392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [152.68861298325112, -684.0987627152206, -9.870192350706613, -983.3650476135017, -743.4214174564921, 8.028016309773928, -251.77510864798566, -876.9222393106734, -941.1301581396298, -644.9682089567791, -277.7608726932883, -897.0635755360973, -333.9358242416083, -369.23413410763595, -791.2724443827101, -162.70732994700347, -317.6481855866401, -954.1651330302157, -733.1310236451172, -682.0899009432355, -865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848], "policy_predator_policy_reward": [458.72761229939346, 448.059045843584, 476.30238399919494, 739.11220482811, 697.2521038581176, 497.30065363296984, 272.7751086479883, 882.9222393106746, 903.3482424135407, 919.1943781892065, 791.4645638523863, 705.2153543570319, 278.40319239153695, 394.02510235315003, 634.9962329418422, 360.4835413878744, 770.6290691065427, 743.3399924103674, 431.91214595668737, 1130.1319053911402, 197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8517973531356513, "mean_inference_ms": 3.576920103150868, "mean_action_processing_ms": 1.1682349756836283, "mean_env_wait_ms": 10.25647462783368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005198001861572266, "StateBufferConnector_ms": 0.005095481872558594, "ViewRequirementAgentConnector_ms": 0.15542447566986084}, "num_episodes": 5, "episode_return_max": 822.1253228931175, "episode_return_min": -102.34391836524253, "episode_return_mean": 190.46045297530642, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.86646799695043, "num_env_steps_trained_throughput_per_sec": 151.86646799695043, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 25427.716, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25427.531, "sample_time_ms": 2267.138, "learn_time_ms": 23131.991, "learn_throughput": 172.921, "synch_weights_time_ms": 24.661}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "60982_00000", "date": "2024-08-23_11-36-27", "timestamp": 1724393187, "time_this_iter_s": 26.372622966766357, "time_total_s": 2197.807312965393, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711c0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2197.807312965393, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 42.15945945945947, "ram_util_percent": 82.83783783783782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.91101063521451, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.7916014262608115, "policy_loss": -0.005999378212998626, "vf_loss": 6.796921300131177, "vf_explained_var": 0.2599007867000721, "kl": 0.006795044553776582, "entropy": 0.3423014518445131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 484.99374999999424}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.02720487281759, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.801639389361023, "policy_loss": -0.013321983289939386, "vf_loss": 6.813496005850494, "vf_explained_var": 0.4996074662637458, "kl": 0.007326747454880249, "entropy": 0.5045537453479868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 484.99374999999424}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 183.5447334348186, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1305.2018793860557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -509.0659195721609, "predator_policy": 600.8382862895709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [392.42536451791824, 35.49269141753346, 38.68303354652467, 336.5226548595644, 0.20000000000001017, 6.999999999999992, 201.53331294967143, 30.313714925617475, 88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-865.2043885823904, 93.0580301152003, -866.0248145694394, -12.17401924122039, -555.0902013987417, -210.39704421063374, -328.87277868186965, -328.7463907031167, -945.1810930222401, -1253.69759418722, -662.4723903406939, -880.6969986500651, -16.22542860294341, -196.92141571983888, -479.9111502712512, -931.2360956290564, -830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727], "policy_predator_policy_reward": [197.96831350278552, 966.6034094823243, 875.0989373550744, 38.592587873119705, 384.29624214151045, 419.87403701438814, 547.9852518536279, 446.15657239092155, 945.3810930222402, 1253.69759418722, 669.472390340694, 880.6969986500651, 195.62797608531267, 219.05218118714265, 412.9133192189273, 1028.547641607002, 1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.853003675109485, "mean_inference_ms": 3.5693459853409366, "mean_action_processing_ms": 1.163883636291047, "mean_env_wait_ms": 10.244005078714865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00518798828125, "StateBufferConnector_ms": 0.005149126052856445, "ViewRequirementAgentConnector_ms": 0.15929043292999268}, "num_episodes": 10, "episode_return_max": 822.1253228931175, "episode_return_min": -102.34391836524253, "episode_return_mean": 183.5447334348186, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.9243988916986, "num_env_steps_trained_throughput_per_sec": 154.9243988916986, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 25547.578, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25547.38, "sample_time_ms": 2301.714, "learn_time_ms": 23216.021, "learn_throughput": 172.295, "synch_weights_time_ms": 25.583}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "60982_00000", "date": "2024-08-23_11-36-53", "timestamp": 1724393213, "time_this_iter_s": 25.8636736869812, "time_total_s": 2223.6709866523743, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7ce8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2223.6709866523743, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 40.55945945945946, "ram_util_percent": 83.09459459459462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.180894347094984, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.562032842888403, "policy_loss": -0.0056553295650889, "vf_loss": 6.56709265481858, "vf_explained_var": 0.1716880480448405, "kl": 0.005955128978430318, "entropy": 0.33915943602720894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.629101569816548, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.434311887953016, "policy_loss": -0.010156802993721117, "vf_loss": 6.443071315402077, "vf_explained_var": 0.6580440383108835, "kl": 0.006986827682703733, "entropy": 0.515406650367868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 187.72024146412588, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1305.2018793860557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -496.87113675110317, "predator_policy": 590.7312574831667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.99782570139858, 67.23121563253703, 244.79898701708902, -34.54511489837793, 272.98720410973976, 560.8577154053346, 131.99460169707663, 41.53067440717524, 76.09689709273579, 297.1903885966344, 6.200000000000003, 0.5370263536854862, 122.76983377725371, 293.8267952578217, 174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-830.9019370492102, -1021.7057405497804, -808.6413000257286, -205.97564747428925, -508.78871504775407, -157.03550154229845, -1008.3830027553796, -251.3615610052086, -1054.7421494165762, -101.47105715554754, -590.4964446612213, 142.23107642193298, -981.6897207644759, -949.2095341982166, 26.831816485465946, -1254.6806905927403, -376.4377419931475, -393.78046090083524, -676.3122643021737, -637.1002115115034, -768.5852751782156, -592.6918368755416, -434.82703097674585, -1065.4006329564334, -197.32957592700515, -212.17367872018994, -442.8104330665713, -459.28632928958615, -474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926], "policy_predator_policy_reward": [1222.2451477906948, 719.3603555096922, 860.8646816824503, 220.98348145010473, 521.1877020648467, 389.43550154229854, 1074.4354610056457, 150.76398785656414, 1035.8398012648272, 393.36060941703806, 469.9756279191068, 539.1474557255148, 902.4653074005204, 1160.4285492592535, 12.198857921709081, 1257.1806905927401, 441.6896753209381, 404.62542466578736, 936.2813989653099, 674.3214654450022, 771.7852751782157, 595.6918368755418, 419.132742818595, 1081.631947468275, 304.9383230749806, 227.3347653494665, 669.0004619598823, 526.9230956540985, 650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8512126767868637, "mean_inference_ms": 3.5736128736474155, "mean_action_processing_ms": 1.1626011480940608, "mean_env_wait_ms": 10.2564558063121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005326390266418457, "StateBufferConnector_ms": 0.005136728286743164, "ViewRequirementAgentConnector_ms": 0.14960837364196777}, "num_episodes": 8, "episode_return_max": 822.1253228931175, "episode_return_min": -102.34391836524253, "episode_return_mean": 187.72024146412588, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.44462135918926, "num_env_steps_trained_throughput_per_sec": 156.44462135918926, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 25651.786, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25651.577, "sample_time_ms": 2320.813, "learn_time_ms": 23301.542, "learn_throughput": 171.662, "synch_weights_time_ms": 25.059}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "60982_00000", "date": "2024-08-23_11-37-19", "timestamp": 1724393239, "time_this_iter_s": 25.597030878067017, "time_total_s": 2249.2680175304413, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bd670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2249.2680175304413, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 39.761111111111106, "ram_util_percent": 83.03888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.527885980454702, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.611439577233854, "policy_loss": -0.006328501224163033, "vf_loss": 6.6170985247092275, "vf_explained_var": 0.1142703893323424, "kl": 0.006695574635353984, "entropy": 0.3653783331472407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.088411254731437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.633657770812826, "policy_loss": -0.014977641159018118, "vf_loss": 6.647300759572832, "vf_explained_var": 0.5869181660748033, "kl": 0.006673267386144116, "entropy": 0.5146357752027966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 822.1253228931175, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 190.46858371384687, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1305.2018793860557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -486.3583257051147, "predator_policy": 581.5926175620386}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.2653673859207, 459.0664051015037, 183.12635257386475, 10.644180450980777, 26.59687117074992, 13.199999999999969, 214.1466350471498, 285.90000000000293, 74.61228520427274, 822.1253228931175, 58.51163481104261, 297.0172463326873, 40.09489542738639, 639.1987893370365, 35.673030757885655, 299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-474.84047572485446, -728.3101356468479, -465.17782711054247, -981.6690396887628, -924.7604719614727, -281.25396496922593, -1141.3021460424336, -507.32975922612115, -766.9103822055198, -536.5032104521636, -701.7410384773575, -792.5337051095776, 1.5246886211915667, -184.6223082684479, -409.3609659714089, -72.15401672543821, -578.3387571095996, -499.9124529350778, -912.2036024413864, 163.18721963175102, -207.70237909749625, -111.50693680740949, -98.1708057880758, -655.0560785238292, -185.39983653653667, -410.6988742036113, -1101.7030784556507, -16.79677312694008, -1014.4741589963044, -796.4733136732868, -289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414], "policy_predator_policy_reward": [650.6192785988819, 726.796700158739, 825.8532875279776, 1080.0599843728364, 944.5510039676968, 444.5897855368712, 1141.3021460424336, 517.9739396771033, 770.7420623635819, 559.2684014648529, 712.0410384773598, 795.4337051095782, 114.57706399886487, 282.66719069554097, 766.3171492546479, 1.097833442203281, 715.2568088519413, 437.60668639701265, 719.5379670809176, 851.6037386218367, 246.5172306062808, 131.2037201096638, 392.02235197717334, 658.2217786674177, 23.05095337139153, 613.1426527961432, 905.1180142021846, 852.5806267174423, 1052.9331530165186, 793.6873504109594, 653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8421515116737157, "mean_inference_ms": 3.5712330812053192, "mean_action_processing_ms": 1.1658700264287545, "mean_env_wait_ms": 10.270086363134634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037935972213745117, "StateBufferConnector_ms": 0.006088614463806152, "ViewRequirementAgentConnector_ms": 0.1412065029144287}, "num_episodes": 14, "episode_return_max": 822.1253228931175, "episode_return_min": -102.34391836524253, "episode_return_mean": 190.46858371384687, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.47314986894756, "num_env_steps_trained_throughput_per_sec": 157.47314986894756, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 25689.071, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25688.83, "sample_time_ms": 2303.348, "learn_time_ms": 23353.539, "learn_throughput": 171.28, "synch_weights_time_ms": 27.467}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "60982_00000", "date": "2024-08-23_11-37-44", "timestamp": 1724393264, "time_this_iter_s": 25.454672813415527, "time_total_s": 2274.722690343857, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711cf790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2274.722690343857, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 41.32499999999999, "ram_util_percent": 82.58333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.74026444172733, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.294666831707828, "policy_loss": -0.009231475916587644, "vf_loss": 6.3030996504284085, "vf_explained_var": 0.3608782555060412, "kl": 0.007986603545705004, "entropy": 0.37056492639597133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.55318485340744, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.410361028096032, "policy_loss": -0.014299826813299978, "vf_loss": 6.423245810453223, "vf_explained_var": 0.5808393590664738, "kl": 0.00707507932770544, "entropy": 0.4990891665062576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 632.5840363640468, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 180.160923354203, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1305.2018793860557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -474.08324443656466, "predator_policy": 564.1637061136669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.2216394185066, 66.08660937409184, -21.29205620693674, -21.295174726423028, 318.7746575618989, 130.65051432526366, 62.75731202720233, 1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-289.1927640804408, -644.5690472260078, -832.5059242213529, -119.1941274886779, -1067.542802901337, -28.85315572593526, -1173.4004132536388, -1167.2352901660522, -186.4295070078948, -979.2119898797404, -435.1885351192317, -569.3875135218569, -869.1773341934057, -413.858273616877, -706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803], "policy_predator_policy_reward": [653.6327609033835, 579.3506898215717, 874.0059242213534, 143.78073686276775, 7.561099518998498, 1067.542802901337, 1228.946202482661, 1090.394326210605, 781.6844744870834, 702.7316799624507, 832.9490605481302, 302.27750241822673, 801.34214908831, 544.4507707491778, 706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.840344125526761, "mean_inference_ms": 3.5684370094159488, "mean_action_processing_ms": 1.162116012245501, "mean_env_wait_ms": 10.27137696910867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037745237350463867, "StateBufferConnector_ms": 0.006223082542419434, "ViewRequirementAgentConnector_ms": 0.14131057262420654}, "num_episodes": 15, "episode_return_max": 632.5840363640468, "episode_return_min": -102.34391836524253, "episode_return_mean": 180.160923354203, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.8817032078828, "num_env_steps_trained_throughput_per_sec": 155.8817032078828, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 25677.603, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25677.363, "sample_time_ms": 2303.794, "learn_time_ms": 23343.214, "learn_throughput": 171.356, "synch_weights_time_ms": 26.312}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "60982_00000", "date": "2024-08-23_11-38-10", "timestamp": 1724393290, "time_this_iter_s": 25.694775104522705, "time_total_s": 2300.4174654483795, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711a5af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2300.4174654483795, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 40.68055555555556, "ram_util_percent": 83.22777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.191838755178704, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.560802827562605, "policy_loss": -0.008466684140225568, "vf_loss": 6.568541900190727, "vf_explained_var": 0.2920009544917515, "kl": 0.007276015630898573, "entropy": 0.35894640909616277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.674638436080286, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.336032889633582, "policy_loss": -0.01085090547869051, "vf_loss": 6.345648740839075, "vf_explained_var": 0.5466421338616225, "kl": 0.006175204181905698, "entropy": 0.5308328192700784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 632.5840363640468, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 180.87350513548253, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1305.2018793860557, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1311.5018793860559}, "policy_reward_mean": {"prey_policy": -454.60591429064186, "predator_policy": 545.0426668583839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.700000000000008, 73.6000000000001, 538.854114895362, 629.2656727679757, 107.48359020199095, 9.199245151641565, 7.299999999999988, 6.300000000000002, 401.10000000000014, 190.1854207205224, 72.60000000000016, 2.6062108365085463, 95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-706.379738296566, -1124.8441978162327, -35.14115961539316, 1.6922673907375556, -1211.3621485808114, -350.99577765722904, -127.99259312582984, -1095.2785603172306, -978.2997427490538, -804.9800093719018, -819.2996170670575, -682.7413867468777, -788.0088201439751, -576.5553183277959, -1002.8906415510545, -1305.2018793860557, 391.9678642765658, -617.2005638712715, -214.36895573091516, -192.91769660223343, -80.22665896903064, 38.18461058402483, -658.3104400406037, -753.4862892638913, -547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085], "policy_predator_policy_reward": [706.779738296566, 1126.1441978162316, 35.350882801446105, 71.69800942321011, 934.9289752915613, 1166.2830658418445, 829.9270634250794, 1022.6097627859543, 1076.6596609396488, 814.1036813832999, 698.2017492131533, 813.0384997524274, 791.3088201439758, 580.555318327796, 1002.8906415510545, 1311.5018793860559, 4.032135723434157, 622.3005638712726, 63.949451993318135, 533.5226210603519, 113.02665896902877, 1.6153894159754434, 660.1104400406041, 754.2925001004004, 563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.842131631320196, "mean_inference_ms": 3.566180694114465, "mean_action_processing_ms": 1.1643760792188826, "mean_env_wait_ms": 10.284284608572479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003785848617553711, "StateBufferConnector_ms": 0.006248593330383301, "ViewRequirementAgentConnector_ms": 0.14692294597625732}, "num_episodes": 7, "episode_return_max": 632.5840363640468, "episode_return_min": -102.34391836524253, "episode_return_mean": 180.87350513548253, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.2187698895887, "num_env_steps_trained_throughput_per_sec": 157.2187698895887, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 25626.154, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25625.929, "sample_time_ms": 2306.339, "learn_time_ms": 23289.601, "learn_throughput": 171.75, "synch_weights_time_ms": 26.052}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "60982_00000", "date": "2024-08-23_11-38-36", "timestamp": 1724393316, "time_this_iter_s": 25.4709529876709, "time_total_s": 2325.8884184360504, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2325.8884184360504, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 39.63611111111111, "ram_util_percent": 82.76944444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.257504918335608, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.795454440545783, "policy_loss": -0.008736186913120999, "vf_loss": 6.803424252908696, "vf_explained_var": 0.16630462035930976, "kl": 0.007663493216279204, "entropy": 0.3339036389633461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.848060989884473, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.631484855167449, "policy_loss": -0.010296881792909175, "vf_loss": 6.640548689403231, "vf_explained_var": 0.5448470300467557, "kl": 0.0061651676114668295, "entropy": 0.5133834205607258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 632.5840363640468, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 178.12454743865922, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1236.917072244145, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1022.7721485886019}, "policy_reward_mean": {"prey_policy": -428.9951640126497, "predator_policy": 518.05743773198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.55278281764737, 32.72570809294872, 332.7251083508842, 36.23732187481857, 310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-547.8524003245857, -86.31857766911274, -365.03739013054417, -539.2252401938804, -327.4702963629282, -757.6664729635273, -100.40710204607701, -459.06228122760376, -564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447], "policy_predator_policy_reward": [563.5561565546166, 166.16760425673021, 386.23739013054893, 550.7509482868318, 546.5834381230736, 871.2784395542667, 463.991275112598, 131.71543003590048, 872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.839325074106768, "mean_inference_ms": 3.5629273249583546, "mean_action_processing_ms": 1.1629547655944328, "mean_env_wait_ms": 10.283020270191724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00411224365234375, "StateBufferConnector_ms": 0.005642294883728027, "ViewRequirementAgentConnector_ms": 0.14736056327819824}, "num_episodes": 12, "episode_return_max": 632.5840363640468, "episode_return_min": -102.34391836524253, "episode_return_mean": 178.12454743865922, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.2220571717134, "num_env_steps_trained_throughput_per_sec": 156.2220571717134, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 25602.85, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25602.553, "sample_time_ms": 2282.346, "learn_time_ms": 23290.769, "learn_throughput": 171.742, "synch_weights_time_ms": 25.959}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "60982_00000", "date": "2024-08-23_11-39-01", "timestamp": 1724393341, "time_this_iter_s": 25.65441918373108, "time_total_s": 2351.5428376197815, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711c00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2351.5428376197815, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 40.583333333333336, "ram_util_percent": 82.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.037357529130563, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.897790387572435, "policy_loss": -0.008073106880186412, "vf_loss": 6.904961265584149, "vf_explained_var": 0.21751079136732393, "kl": 0.009022247722180235, "entropy": 0.35302564536452924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.314041824567887, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.796706472124372, "policy_loss": -0.011510348225643159, "vf_loss": 6.806770428652486, "vf_explained_var": 0.4575486236779147, "kl": 0.007231826395555227, "entropy": 0.4753687542582315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 632.5840363640468, "episode_reward_min": -102.34391836524253, "episode_reward_mean": 179.29595270655514, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1236.917072244145, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.21102870096115, "predator_policy": 1022.7721485886019}, "policy_reward_mean": {"prey_policy": -430.0146199698598, "predator_policy": 519.6625963231381}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.9544661963169, 252.38147648940165, 89.53197466496412, 444.1084242577015, 17.709720081193883, 31.427266134353143, 439.00000000000284, -102.34391836524253, 523.5986059974415, 157.0563231865123, 138.38073892632008, 184.2998455579173, 189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-564.9713265542867, -179.13914387587897, -135.5903010823074, -507.05579857881077, -698.6644919619431, -846.8130475227191, -820.464046665504, -495.71298503007245, -589.3309199671734, -425.45532938756986, -609.1591502973224, -595.1818369508823, 40.0000000000003, 398.21102870096115, -693.3672482169725, -846.9873282367048, -286.5051557995039, -683.7082266150983, -765.1803561796622, -528.3584620485478, -194.52829240428105, -1082.5946045710116, -710.349130916472, -659.9567428897922, -133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074], "policy_predator_policy_reward": [872.4527406596884, 182.61219596679555, 452.3977177354052, 442.6298584151184, 966.1331302908858, 668.8763838587444, 962.5586833132993, 797.7267726399792, 653.0228197955036, 379.47314964043863, 626.4591502973248, 609.3091030852385, 0.0, 0.7889712990388643, 651.0617016363245, 786.948956452113, 868.9009256076173, 624.9110628044224, 890.2366793661758, 560.3584620485503, 973.354898091326, 442.14873781028405, 683.5937473675236, 871.01197199666, 312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8369505276025766, "mean_inference_ms": 3.5618278042913403, "mean_action_processing_ms": 1.1651617134126198, "mean_env_wait_ms": 10.290994057659145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004135727882385254, "StateBufferConnector_ms": 0.0056760311126708984, "ViewRequirementAgentConnector_ms": 0.14353764057159424}, "num_episodes": 4, "episode_return_max": 632.5840363640468, "episode_return_min": -102.34391836524253, "episode_return_mean": 179.29595270655514, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.7978199915272, "num_env_steps_trained_throughput_per_sec": 155.7978199915272, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 25652.57, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25652.288, "sample_time_ms": 2312.665, "learn_time_ms": 23311.509, "learn_throughput": 171.589, "synch_weights_time_ms": 24.759}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "60982_00000", "date": "2024-08-23_11-39-27", "timestamp": 1724393367, "time_this_iter_s": 25.725309133529663, "time_total_s": 2377.268146753311, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711c0430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2377.268146753311, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 39.85945945945945, "ram_util_percent": 82.3891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.106992689011587, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.534783864399744, "policy_loss": -0.00705217183321202, "vf_loss": 6.54103267558668, "vf_explained_var": 0.2365653231661156, "kl": 0.00803350362478307, "entropy": 0.3855817419195932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.300495243829394, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.9658575905693905, "policy_loss": -0.012446607699588177, "vf_loss": 5.97682991078291, "vf_explained_var": 0.5064416848162495, "kl": 0.007371427596758598, "entropy": 0.5743174171321607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 632.5840363640468, "episode_reward_min": -81.31873936764553, "episode_reward_mean": 189.03013410202738, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1236.917072244145, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1022.7721485886019}, "policy_reward_mean": {"prey_policy": -396.2607033235225, "predator_policy": 490.77577037453693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.71808611192574, 387.5536978256508, 366.07908214981114, 424.69191558352156, 1.3629857188528174, 160.19894211499374, 632.5840363640468, 20.221620988070285, 63.500000000000654, 192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-133.5345848589944, -345.2655362923578, -574.246350854602, -859.404220218464, -321.63400850024664, -495.0232575867466, -737.5853356218117, 137.70233281638838, -686.4922429982295, -90.13340321683476, -653.8536224260349, -731.1562201212994, -1029.1661070676987, 156.43358185762253, -135.09585997886845, -442.8343634964368, -242.35170821257552, 37.34072819006796, -415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167], "policy_predator_policy_reward": [312.5914011569234, 355.9268061063597, 911.8103535241264, 909.3939153745938, 552.1580167950989, 630.5783314417062, 502.7704426850999, 521.8044757038431, 3.6032608353919975, 774.3853710985237, 607.6392845576578, 937.5695001046741, 899.812772437612, 605.5037891365124, 0.0, 598.1518444633804, 0.0, 268.51098002250785, 748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8345100318528154, "mean_inference_ms": 3.5554171221046853, "mean_action_processing_ms": 1.1626466306835184, "mean_env_wait_ms": 10.28945331366541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004858136177062988, "StateBufferConnector_ms": 0.0054579973220825195, "ViewRequirementAgentConnector_ms": 0.1616230010986328}, "num_episodes": 12, "episode_return_max": 632.5840363640468, "episode_return_min": -81.31873936764553, "episode_return_mean": 189.03013410202738, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.545498042432, "num_env_steps_trained_throughput_per_sec": 156.545498042432, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 25688.696, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25688.365, "sample_time_ms": 2327.232, "learn_time_ms": 23331.029, "learn_throughput": 171.446, "synch_weights_time_ms": 26.601}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "60982_00000", "date": "2024-08-23_11-39-53", "timestamp": 1724393393, "time_this_iter_s": 25.600513219833374, "time_total_s": 2402.8686599731445, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711549d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2402.8686599731445, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 42.12777777777778, "ram_util_percent": 82.56944444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.69251184463501, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.2993182389193745, "policy_loss": -0.009430580892940126, "vf_loss": 6.30756765294958, "vf_explained_var": 0.06858518035323531, "kl": 0.011811638342847347, "entropy": 0.37797318797893625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.452398958408013, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.217624608801787, "policy_loss": -0.011044706884653322, "vf_loss": 6.227078766797585, "vf_explained_var": 0.5091563791825027, "kl": 0.007952726817512442, "entropy": 0.5578702661095473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 560.4121918566409, "episode_reward_min": -81.31873936764553, "episode_reward_mean": 186.99254967931702, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1236.917072244145, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1022.7721485886019}, "policy_reward_mean": {"prey_policy": -393.5877456162085, "predator_policy": 487.08402045586786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.55478619025217, 354.905823948166, -9.465260023592357, -3.2808086323710928, 341.6712811154605, 263.5961057296712, 359.5425278018165, 436.0000000000028, 417.5908919132233, -17.631901128246476, 262.92163017786197, 427.19863689952047, 42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-415.88427029679747, -791.7691109103246, -678.3711911139931, -360.3834350054112, -798.7133541666548, -571.521920955838, -483.4152469975593, -865.6262018908058, 22.428161949174637, -446.90781226029674, -727.3074949525746, -423.2192387770232, -879.1070432848435, 172.8070892293724, 40.0000000000003, 392.5195314790668, -594.058940887246, -84.9863279993848, -687.8269953178244, -534.196292164706, 24.654215319729442, -543.7771099609646, -763.3279484384701, 382.794794382615, -521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255], "policy_predator_policy_reward": [748.0992986787171, 652.1088687186584, 720.0896161125914, 673.5708339549788, 816.465833967561, 544.304181131343, 480.1344383651928, 865.6262018908058, 330.8429592373866, 435.30797218919594, 798.2924903228447, 615.8303491364331, 780.5968263223948, 285.2456555348932, 0.0, 3.4804685209331874, 429.33357546902926, 667.3025853308246, 736.5404671818834, 467.85091917240493, 322.3669631433845, 459.6775616757128, 764.019358205623, 43.71243274975179, 558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8282280376818405, "mean_inference_ms": 3.5596088183251493, "mean_action_processing_ms": 1.1610208480356294, "mean_env_wait_ms": 10.28566835004309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004875659942626953, "StateBufferConnector_ms": 0.005374908447265625, "ViewRequirementAgentConnector_ms": 0.12478673458099365}, "num_episodes": 9, "episode_return_max": 560.4121918566409, "episode_return_min": -81.31873936764553, "episode_return_mean": 186.99254967931702, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.70660382472647, "num_env_steps_trained_throughput_per_sec": 157.70660382472647, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 25642.446, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25642.113, "sample_time_ms": 2282.307, "learn_time_ms": 23330.172, "learn_throughput": 171.452, "synch_weights_time_ms": 26.187}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "60982_00000", "date": "2024-08-23_11-40-18", "timestamp": 1724393418, "time_this_iter_s": 25.383584022521973, "time_total_s": 2428.2522439956665, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711c0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2428.2522439956665, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 39.766666666666666, "ram_util_percent": 82.89722222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.646507159995023, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.4104889960516065, "policy_loss": -0.007302681914969254, "vf_loss": 6.416859493558369, "vf_explained_var": 0.12974911846181073, "kl": 0.00932197735630094, "entropy": 0.3769463231323888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.995687428227177, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.198515682119541, "policy_loss": -0.00813009559851948, "vf_loss": 6.205492169516427, "vf_explained_var": 0.5422471369385089, "kl": 0.005767926700270326, "entropy": 0.5372456886465588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 560.4121918566409, "episode_reward_min": -81.31873936764553, "episode_reward_mean": 170.1230709308764, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1236.917072244145, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1022.7721485886019}, "policy_reward_mean": {"prey_policy": -398.50666022870314, "predator_policy": 483.5681956941422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.49221918710044, -48.07935616197437, 147.85841874656865, 10.086432234150282, 388.51795272050225, 66.55648242866424, 70.25967400688575, 560.4121918566409, 13.433907782181512, 75.2, 136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-521.3347139864941, -837.0676726771211, -164.90176432871843, -729.6105803705095, -441.7298285459425, -425.91110721524205, -874.857207567842, -98.28760489018461, 60.251443367766555, -1236.917072244145, -505.1167480128455, -655.9466722443198, -487.0342177793088, -354.19311523052727, -352.3446986301829, -911.489656051037, -291.0054644455693, -591.6129354718297, -9.929809074480831, 28.046975805943088, -374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808], "policy_predator_policy_reward": [558.9406360070258, 841.9539698436901, 94.04615903732157, 752.3868294999297, 765.7106186438782, 249.78873586388065, 882.619238436047, 100.61200625612835, 730.7010050662241, 834.4825765306533, 666.8600639819234, 560.7598387039064, 265.1730449250974, 646.3139620916351, 885.2394514343334, 939.0070951035309, 262.75262178551463, 633.299685914066, 46.22980907448124, 10.85302419405702, 389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8268832379302933, "mean_inference_ms": 3.555827576180389, "mean_action_processing_ms": 1.1618269193726711, "mean_env_wait_ms": 10.300788285860735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007181525230407715, "StateBufferConnector_ms": 0.005540132522583008, "ViewRequirementAgentConnector_ms": 0.12800824642181396}, "num_episodes": 12, "episode_return_max": 560.4121918566409, "episode_return_min": -81.31873936764553, "episode_return_mean": 170.1230709308764, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.18199775231793, "num_env_steps_trained_throughput_per_sec": 157.18199775231793, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 25553.372, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25553.036, "sample_time_ms": 2237.239, "learn_time_ms": 23285.842, "learn_throughput": 171.778, "synch_weights_time_ms": 26.274}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "60982_00000", "date": "2024-08-23_11-40-44", "timestamp": 1724393444, "time_this_iter_s": 25.460973024368286, "time_total_s": 2453.713217020035, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7bd040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2453.713217020035, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 35.87222222222223, "ram_util_percent": 82.0138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.969212214404312, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.642653569216451, "policy_loss": -0.00814075861224737, "vf_loss": 6.650070965479291, "vf_explained_var": 0.18620628673563558, "kl": 0.007233620776730791, "entropy": 0.32769057965152476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.431072784353185, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.427357509148814, "policy_loss": -0.013088253828347045, "vf_loss": 6.438629134748348, "vf_explained_var": 0.39360377687625786, "kl": 0.009083249961228047, "entropy": 0.5807327134583993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 550.087885153107, "episode_reward_min": -81.31873936764553, "episode_reward_mean": 169.4931962846436, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1045.6145898850414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1022.7721485886019}, "policy_reward_mean": {"prey_policy": -400.4958475293622, "predator_policy": 485.24244567168483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.7999999999984, 243.35844048540545, 276.1897440446795, 153.70716530471796, 0.6201256739339831, 438.2697032442828, 341.26692784945055, 474.88276293844984, 11.606181158564402, 2.252738260719895, -0.6610339361580566, 294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-374.9013847232458, -103.12447055234115, -543.985852513833, -235.0907380108409, -98.97160265237756, -726.5874137810222, -480.44234552037506, -434.22683479575824, -448.3791430293056, -426.7918360376926, 171.19958722001536, -258.1939752432725, -653.5247357000666, -408.5859130245342, -488.1532783130965, 55.2580875370123, -144.03433010417731, -500.3787701704164, -709.0224587870108, -744.2395701094931, -341.358383591048, -856.141085821697, -95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563], "policy_predator_policy_reward": [389.0013847232473, 225.82447055234027, 552.0430261621897, 470.3920048478902, 346.95801813848624, 754.7907423395936, 817.705570912912, 250.6707747079413, 477.53205989124865, 398.25904484968703, 426.3043239955828, 98.95976727195473, 657.2372969495018, 746.1402796245484, 423.20008180949054, 484.5778719050427, 148.2468099595395, 507.77247147361663, 795.9911842925728, 659.523582864653, 810.6312433309974, 386.2071921455949, 398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8170082071946565, "mean_inference_ms": 3.5531638685097704, "mean_action_processing_ms": 1.1594791329623613, "mean_env_wait_ms": 10.30015243370375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071370601654052734, "StateBufferConnector_ms": 0.0055277347564697266, "ViewRequirementAgentConnector_ms": 0.12354624271392822}, "num_episodes": 10, "episode_return_max": 550.087885153107, "episode_return_min": -81.31873936764553, "episode_return_mean": 169.4931962846436, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.0708537803128, "num_env_steps_trained_throughput_per_sec": 158.0708537803128, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 25501.977, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25501.652, "sample_time_ms": 2180.602, "learn_time_ms": 23291.332, "learn_throughput": 171.738, "synch_weights_time_ms": 26.267}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "60982_00000", "date": "2024-08-23_11-41-09", "timestamp": 1724393469, "time_this_iter_s": 25.338173866271973, "time_total_s": 2479.0513908863068, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711540d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2479.0513908863068, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 36.17142857142857, "ram_util_percent": 82.75428571428569}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.154245215622836, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.848182788223186, "policy_loss": -0.0114976775044053, "vf_loss": 6.85841503799277, "vf_explained_var": 0.2869658107480044, "kl": 0.012654243168179636, "entropy": 0.34972214441766186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.695171241659335, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.73995676595698, "policy_loss": -0.012317317811939767, "vf_loss": 6.750501567093783, "vf_explained_var": 0.5178950643413281, "kl": 0.008862538518206705, "entropy": 0.5639249417832288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 699.7343058815451, "episode_reward_min": -86.49900554914603, "episode_reward_mean": 166.01072092030824, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1045.6145898850414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1022.7721485886019}, "policy_reward_mean": {"prey_policy": -404.20053526589714, "predator_policy": 487.2058957260521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [294.2588311170078, 65.94320544246168, 185.69802556047833, 27.95034539480554, 237.7263066512489, 23.194282106380776, 179.02477038757615, 163.8952289469321, 291.69926182182496, 11.81175687295401, 332.9032614684172, 187.92494340729462, 186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581, -32.00767934884794, 368.1795175756441, 248.25182337768334, 83.98664121427036, -40.696889404164374, -86.49900554914603, 1.132984208570161, 22.037249886607157, 186.97131327035603, 278.95495747798896, 699.7343058815451], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-95.72027192576836, -349.42311445247674, -427.5987500335388, -610.529834676525, -205.09773990182052, -560.6380017692735, -768.6881922237175, -858.3358499461234, -890.44952552557, 214.22945950516487, -945.4863216707766, -348.59289602321365, -455.27203152286563, -713.722159064187, -772.0787266077682, -1045.6145898850414, 266.3415375103988, -574.4252496772, -690.4700276544899, -606.8658825633188, -11.964311692372632, -413.86534065351253, -119.26508720295311, -339.52759779028906, -470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563, -381.2205944793153, -454.55928285601857, -148.6916300605951, 240.87022509907266, -385.797003995329, -397.4589646389331, -429.92369489421935, -638.8781425174238, -279.13105878994946, -185.82087159492505, -339.09376953390165, -836.9685274634752, -416.7892813943955, -692.5555527048227, -894.825847001374, -670.294761135386, -796.339262347617, -458.7445562022118, -309.3241337990654, -585.1454899272543, 367.83828645681115, -797.7600812512396], "policy_predator_policy_reward": [398.69651971765296, 340.70569777759476, 318.044633524347, 786.0271566281825, 558.9123354089236, 392.52143182265075, 796.6385376185234, 858.3358499461234, 899.1338373781441, 14.812535293509535, 957.1405801662313, 360.1329196341437, 833.9006713266526, 514.1182896479772, 958.8163968511429, 1022.7721485886019, 0.0, 599.7829739886272, 925.3251512856599, 383.8225158051071, 0.8031666127579454, 757.9297472015473, 455.3649893255813, 191.35263907495718, 633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921, 594.8857481461172, 208.88644984037214, 135.95625344123064, 140.04466909593262, 476.0071243764619, 555.5006676354866, 751.5437414100859, 401.24473721582996, 423.37115750422385, 0.8838834764831843, 244.82144448194816, 844.7418469662854, 219.01597083301004, 891.4618474747814, 899.8258470013751, 687.3320110219923, 690.1356496254521, 751.9194821947303, 586.4440318759116, 586.9805493283963, 443.83950370027003, 685.8165969757017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.818291194099801, "mean_inference_ms": 3.5498915970255167, "mean_action_processing_ms": 1.1558320727424098, "mean_env_wait_ms": 10.310032929711559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006996035575866699, "StateBufferConnector_ms": 0.004531145095825195, "ViewRequirementAgentConnector_ms": 0.14664161205291748}, "num_episodes": 11, "episode_return_max": 699.7343058815451, "episode_return_min": -86.49900554914603, "episode_return_mean": 166.01072092030824, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.30280714196078, "num_env_steps_trained_throughput_per_sec": 159.30280714196078, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 25456.101, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25455.797, "sample_time_ms": 2147.141, "learn_time_ms": 23279.338, "learn_throughput": 171.826, "synch_weights_time_ms": 26.038}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "60982_00000", "date": "2024-08-23_11-41-34", "timestamp": 1724393494, "time_this_iter_s": 25.114192962646484, "time_total_s": 2504.1655838489532, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x171135430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2504.1655838489532, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 36.230555555555554, "ram_util_percent": 82.66944444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.833793950963905, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.535069674537295, "policy_loss": -0.011401471852881725, "vf_loss": 6.54530222756522, "vf_explained_var": 0.23406811895824614, "kl": 0.011689152424938228, "entropy": 0.3573375981005411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.835464069073794, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.686686322550294, "policy_loss": -0.009959122267054029, "vf_loss": 6.695386888615038, "vf_explained_var": 0.4730167967932565, "kl": 0.006292898993367556, "entropy": 0.5436987965195267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 699.7343058815451, "episode_reward_min": -86.49900554914603, "episode_reward_mean": 172.5587609270581, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1191.122797606987, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 904.043775933585}, "policy_reward_mean": {"prey_policy": -372.605258664912, "predator_policy": 458.8846391284419}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.04334646685024, 175.8872071456881, 126.67286485639225, 419.9092356656103, 59.416295139652576, 36.66301462731377, 3.471407814656454, 407.5776472913352, -40.5686610104176, 20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581, -32.00767934884794, 368.1795175756441, 248.25182337768334, 83.98664121427036, -40.696889404164374, -86.49900554914603, 1.132984208570161, 22.037249886607157, 186.97131327035603, 278.95495747798896, 699.7343058815451, 50.36502398923061, 128.93204724768594, 110.09116692470158, 435.7000000000028, 59.641721734313585, 446.74710057273796, 113.72845356401116, 546.8174797239799, 113.97275315632994, 54.62972982652579, 114.2206339836445, 481.9881091292049], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-470.81519777794415, -573.9781916701548, -812.0561354134242, -132.3756216105589, -573.803926949684, -556.7009518915246, 364.9095794299308, -905.4881542773135, -646.2573419635752, -753.1707576386922, -411.4398781651463, -627.7495147353956, -400.32155203256707, -563.7381804224727, 378.57764729133294, -157.3861261980057, -557.4893275684093, -562.2476902413432, -469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563, -381.2205944793153, -454.55928285601857, -148.6916300605951, 240.87022509907266, -385.797003995329, -397.4589646389331, -429.92369489421935, -638.8781425174238, -279.13105878994946, -185.82087159492505, -339.09376953390165, -836.9685274634752, -416.7892813943955, -692.5555527048227, -894.825847001374, -670.294761135386, -796.339262347617, -458.7445562022118, -309.3241337990654, -585.1454899272543, 367.83828645681115, -797.7600812512396, -79.61514626585519, -212.3744053860886, 39.88254941703409, -568.957636786438, -8.766414563537083, -1191.122797606987, 20.230238969050028, 393.30955685968087, -107.53971894955333, 14.461229986414903, 400.0, -23.59102976523713, -273.1815139482446, -142.99240487282412, 214.66680755463256, -884.5281752133185, -440.6714006508857, -128.09079647026232, -695.2194944891203, -170.08087699919687, -369.1936765940216, -784.9054323971094, 368.9027414937941, -374.6273885721471], "policy_predator_policy_reward": [633.6728653946783, 597.1638705202749, 759.891301572874, 360.4276625967975, 518.6452531753592, 738.5324905222436, 705.0202757527001, 255.46753476029366, 884.7104846746433, 574.1339100672789, 431.1082647475765, 644.744142780282, 590.3571733859015, 377.1739668837991, 0.0, 186.38612619800406, 700.5230587578186, 378.6452980415222, 486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921, 594.8857481461172, 208.88644984037214, 135.95625344123064, 140.04466909593262, 476.0071243764619, 555.5006676354866, 751.5437414100859, 401.24473721582996, 423.37115750422385, 0.8838834764831843, 244.82144448194816, 844.7418469662854, 219.01597083301004, 891.4618474747814, 899.8258470013751, 687.3320110219923, 690.1356496254521, 751.9194821947303, 586.4440318759116, 586.9805493283963, 443.83950370027003, 685.8165969757017, 105.25803172204171, 237.09654391912912, 77.43546648646418, 580.5716681306263, 904.043775933585, 405.936603161642, 18.469761030949986, 3.690443140319115, 0.0, 152.7202106974498, 13.295117130987613, 57.043013206985, 282.2297986985713, 247.67257368651588, 549.3281010630786, 667.3507463195897, 558.6802156452095, 124.05473463226963, 270.11574743481714, 649.8143538800241, 638.6989002127244, 629.6208427620535, 401.6603411887298, 86.05241501882837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8065931962632664, "mean_inference_ms": 3.5432411402255006, "mean_action_processing_ms": 1.1538642414338345, "mean_env_wait_ms": 10.301650395100728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007021784782409668, "StateBufferConnector_ms": 0.004590034484863281, "ViewRequirementAgentConnector_ms": 0.14443433284759521}, "num_episodes": 12, "episode_return_max": 699.7343058815451, "episode_return_min": -86.49900554914603, "episode_return_mean": 172.5587609270581, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.42517334936437, "num_env_steps_trained_throughput_per_sec": 155.42517334936437, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 25489.574, "restore_workers_time_ms": 0.03, "training_step_time_ms": 25489.237, "sample_time_ms": 2159.047, "learn_time_ms": 23301.402, "learn_throughput": 171.663, "synch_weights_time_ms": 25.46}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "60982_00000", "date": "2024-08-23_11-42-00", "timestamp": 1724393520, "time_this_iter_s": 25.79220700263977, "time_total_s": 2529.957790851593, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f799040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2529.957790851593, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 40.327777777777776, "ram_util_percent": 82.5361111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.975670901808158, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.8881853663732135, "policy_loss": -0.007462168383170609, "vf_loss": 5.894764042909814, "vf_explained_var": 0.2014125215313422, "kl": 0.008834978205856507, "entropy": 0.40929387722696575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.184047342986656, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.011184186784048, "policy_loss": -0.011267346360784754, "vf_loss": 6.020920345266029, "vf_explained_var": 0.4689250088242627, "kl": 0.007655924366338661, "entropy": 0.5484153511032226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 699.7343058815451, "episode_reward_min": -86.49900554914603, "episode_reward_mean": 177.79288950393243, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1191.122797606987, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 904.043775933585}, "policy_reward_mean": {"prey_policy": -368.9814502136081, "predator_policy": 457.8778949655751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.98844255326438, 83.01295640838138, 107.54827185709229, 414.67879169329, 62.954121498849815, 57.70000000000055, 275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581, -32.00767934884794, 368.1795175756441, 248.25182337768334, 83.98664121427036, -40.696889404164374, -86.49900554914603, 1.132984208570161, 22.037249886607157, 186.97131327035603, 278.95495747798896, 699.7343058815451, 50.36502398923061, 128.93204724768594, 110.09116692470158, 435.7000000000028, 59.641721734313585, 446.74710057273796, 113.72845356401116, 546.8174797239799, 113.97275315632994, 54.62972982652579, 114.2206339836445, 481.9881091292049, 142.89013617402836, -0.8046969389597868, 34.100000000000236, 343.17451199061657, 172.1459588661286, 145.99451691416579, 537.6889170091337, 15.6061670587218, 507.6897046106803], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-469.32347924888893, -743.0884425759509, -725.4127699661328, -547.7803599627803, -588.3475337058234, -512.0444792569198, -749.992361136222, -113.27515073001038, 0.275127582077678, -301.1794703213373, -53.32986134059508, -351.07527278972276, -812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563, -381.2205944793153, -454.55928285601857, -148.6916300605951, 240.87022509907266, -385.797003995329, -397.4589646389331, -429.92369489421935, -638.8781425174238, -279.13105878994946, -185.82087159492505, -339.09376953390165, -836.9685274634752, -416.7892813943955, -692.5555527048227, -894.825847001374, -670.294761135386, -796.339262347617, -458.7445562022118, -309.3241337990654, -585.1454899272543, 367.83828645681115, -797.7600812512396, -79.61514626585519, -212.3744053860886, 39.88254941703409, -568.957636786438, -8.766414563537083, -1191.122797606987, 20.230238969050028, 393.30955685968087, -107.53971894955333, 14.461229986414903, 400.0, -23.59102976523713, -273.1815139482446, -142.99240487282412, 214.66680755463256, -884.5281752133185, -440.6714006508857, -128.09079647026232, -695.2194944891203, -170.08087699919687, -369.1936765940216, -784.9054323971094, 368.9027414937941, -374.6273885721471, -392.70243971996064, -83.70727226989395, -185.93029833701203, -584.5198792693571, -460.1255223136294, -411.9208868601221, -621.736747097598, 230.4448381850441, -368.40116753880693, -201.75762509589904, -405.02599417402115, -864.6226684258784, -741.1872548415215, -114.20068481162518, -453.76325533759456, -612.0121427675552, -829.7931836848153, -135.80744721391883], "policy_predator_policy_reward": [486.9119218021549, 746.4884425759515, 722.0131154395235, 634.1929708977698, 604.1970072385861, 603.7432775812545, 666.6641896762109, 611.2821138833116, 213.92011572788627, 149.9383485102266, 87.82986134059388, 374.27527278972804, 749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921, 594.8857481461172, 208.88644984037214, 135.95625344123064, 140.04466909593262, 476.0071243764619, 555.5006676354866, 751.5437414100859, 401.24473721582996, 423.37115750422385, 0.8838834764831843, 244.82144448194816, 844.7418469662854, 219.01597083301004, 891.4618474747814, 899.8258470013751, 687.3320110219923, 690.1356496254521, 751.9194821947303, 586.4440318759116, 586.9805493283963, 443.83950370027003, 685.8165969757017, 105.25803172204171, 237.09654391912912, 77.43546648646418, 580.5716681306263, 904.043775933585, 405.936603161642, 18.469761030949986, 3.690443140319115, 0.0, 152.7202106974498, 13.295117130987613, 57.043013206985, 282.2297986985713, 247.67257368651588, 549.3281010630786, 667.3507463195897, 558.6802156452095, 124.05473463226963, 270.11574743481714, 649.8143538800241, 638.6989002127244, 629.6208427620535, 401.6603411887298, 86.05241501882837, 244.7476239504497, 374.55222421343404, 160.44856107308937, 609.196919594319, 471.4255223136312, 434.7208868601257, 111.47341321925286, 622.9930076839183, 436.4498583923064, 305.8548931085313, 572.1955865975779, 843.4475929164886, 739.0958976613597, 653.9809590009133, 479.1851638724009, 602.1964012914722, 738.9708408575997, 734.3194946518156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8038353303213057, "mean_inference_ms": 3.5396762610764383, "mean_action_processing_ms": 1.1547517686330278, "mean_env_wait_ms": 10.309057478094804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007027983665466309, "StateBufferConnector_ms": 0.004470467567443848, "ViewRequirementAgentConnector_ms": 0.14384949207305908}, "num_episodes": 9, "episode_return_max": 699.7343058815451, "episode_return_min": -86.49900554914603, "episode_return_mean": 177.79288950393243, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.91719199079597, "num_env_steps_trained_throughput_per_sec": 156.91719199079597, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 25472.638, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25472.318, "sample_time_ms": 2133.118, "learn_time_ms": 23311.378, "learn_throughput": 171.59, "synch_weights_time_ms": 24.504}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "60982_00000", "date": "2024-08-23_11-42-26", "timestamp": 1724393546, "time_this_iter_s": 25.527749061584473, "time_total_s": 2555.4855399131775, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711a5a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2555.4855399131775, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 37.23611111111111, "ram_util_percent": 82.76666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.76652470846025, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.777746402397358, "policy_loss": -0.008710072992280835, "vf_loss": 5.7856093230070895, "vf_explained_var": 0.149070616815456, "kl": 0.008471722000835355, "entropy": 0.4163410774614445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000466}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.29198055216875, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.843090525632182, "policy_loss": -0.009653752903261828, "vf_loss": 5.8511524553652166, "vf_explained_var": 0.4245783601488386, "kl": 0.007959034835190448, "entropy": 0.6091812371892273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 498.22375000000466}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 715.8231129420093, "episode_reward_min": -86.49900554914603, "episode_reward_mean": 185.5918551082955, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1191.122797606987, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 904.043775933585}, "policy_reward_mean": {"prey_policy": -367.1704179735427, "predator_policy": 459.9663455276912}, "custom_metrics": {}, "hist_stats": {"episode_reward": [275.2503055435137, 69.3489286764511, -81.31873936764553, 93.39814022137759, 203.40286219824873, -18.342766385703445, 68.32995213828539, 167.9933934084672, 55.818500894974825, 103.58062778214969, 518.2074796173633, 394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581, -32.00767934884794, 368.1795175756441, 248.25182337768334, 83.98664121427036, -40.696889404164374, -86.49900554914603, 1.132984208570161, 22.037249886607157, 186.97131327035603, 278.95495747798896, 699.7343058815451, 50.36502398923061, 128.93204724768594, 110.09116692470158, 435.7000000000028, 59.641721734313585, 446.74710057273796, 113.72845356401116, 546.8174797239799, 113.97275315632994, 54.62972982652579, 114.2206339836445, 481.9881091292049, 142.89013617402836, -0.8046969389597868, 34.100000000000236, 343.17451199061657, 172.1459588661286, 145.99451691416579, 537.6889170091337, 15.6061670587218, 507.6897046106803, 89.38609535634502, 715.8231129420093, 50.21260951631444, 404.37947667843156, 135.34615283888184, 131.63169711520194], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-812.1246153013333, -153.29779606209607, -360.3823734845737, -335.50397787667714, -258.08556998118485, -291.91731481347085, -755.9417109649936, -247.88855096498804, -195.09749633544646, 135.17783268996823, -176.1595809759624, -672.7208108625899, -50.62002450991322, -728.3505611856938, -651.4567198102593, -271.5278105065569, -430.68057482252067, -403.71496932407376, -247.13722618166722, -113.92475534066418, -913.7161615433192, -135.37059998622226, -822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563, -381.2205944793153, -454.55928285601857, -148.6916300605951, 240.87022509907266, -385.797003995329, -397.4589646389331, -429.92369489421935, -638.8781425174238, -279.13105878994946, -185.82087159492505, -339.09376953390165, -836.9685274634752, -416.7892813943955, -692.5555527048227, -894.825847001374, -670.294761135386, -796.339262347617, -458.7445562022118, -309.3241337990654, -585.1454899272543, 367.83828645681115, -797.7600812512396, -79.61514626585519, -212.3744053860886, 39.88254941703409, -568.957636786438, -8.766414563537083, -1191.122797606987, 20.230238969050028, 393.30955685968087, -107.53971894955333, 14.461229986414903, 400.0, -23.59102976523713, -273.1815139482446, -142.99240487282412, 214.66680755463256, -884.5281752133185, -440.6714006508857, -128.09079647026232, -695.2194944891203, -170.08087699919687, -369.1936765940216, -784.9054323971094, 368.9027414937941, -374.6273885721471, -392.70243971996064, -83.70727226989395, -185.93029833701203, -584.5198792693571, -460.1255223136294, -411.9208868601221, -621.736747097598, 230.4448381850441, -368.40116753880693, -201.75762509589904, -405.02599417402115, -864.6226684258784, -741.1872548415215, -114.20068481162518, -453.76325533759456, -612.0121427675552, -829.7931836848153, -135.80744721391883, -234.41859233387888, -453.153080960089, 26.420352942370045, -625.0900781991511, -585.5823133501465, -246.98153035612435, -509.82449888519295, -218.60510063183557, -523.2742433803786, -270.8753029981853, -541.7631698232527, -609.2200474633665], "policy_predator_policy_reward": [749.6351528072444, 491.0375640996927, 318.2680570680818, 446.96722296962366, 468.68414542701555, 0.0, 387.476193533294, 709.7522086180672, 255.71920323778247, 7.603322605943552, 141.42407313059212, 689.1135523222567, 123.10231746903425, 724.1982203648585, 618.5491519400897, 472.4287717852031, 302.730485583141, 587.4835594584285, 268.5071442160073, 196.1354650884752, 798.2536156575044, 769.0406254893942, 639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921, 594.8857481461172, 208.88644984037214, 135.95625344123064, 140.04466909593262, 476.0071243764619, 555.5006676354866, 751.5437414100859, 401.24473721582996, 423.37115750422385, 0.8838834764831843, 244.82144448194816, 844.7418469662854, 219.01597083301004, 891.4618474747814, 899.8258470013751, 687.3320110219923, 690.1356496254521, 751.9194821947303, 586.4440318759116, 586.9805493283963, 443.83950370027003, 685.8165969757017, 105.25803172204171, 237.09654391912912, 77.43546648646418, 580.5716681306263, 904.043775933585, 405.936603161642, 18.469761030949986, 3.690443140319115, 0.0, 152.7202106974498, 13.295117130987613, 57.043013206985, 282.2297986985713, 247.67257368651588, 549.3281010630786, 667.3507463195897, 558.6802156452095, 124.05473463226963, 270.11574743481714, 649.8143538800241, 638.6989002127244, 629.6208427620535, 401.6603411887298, 86.05241501882837, 244.7476239504497, 374.55222421343404, 160.44856107308937, 609.196919594319, 471.4255223136312, 434.7208868601257, 111.47341321925286, 622.9930076839183, 436.4498583923064, 305.8548931085313, 572.1955865975779, 843.4475929164886, 739.0958976613597, 653.9809590009133, 479.1851638724009, 602.1964012914722, 738.9708408575997, 734.3194946518156, 339.88156074404645, 437.0762079062685, 620.5905692848012, 693.9022689139919, 556.1859174983344, 326.59053572425006, 574.2935465175742, 558.5155296778825, 503.5640240574054, 425.93167516004246, 575.6554188506396, 706.9594955511902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8075930215199647, "mean_inference_ms": 3.53353955278678, "mean_action_processing_ms": 1.1506163712003896, "mean_env_wait_ms": 10.305201163236259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007221817970275879, "StateBufferConnector_ms": 0.004635214805603027, "ViewRequirementAgentConnector_ms": 0.14561903476715088}, "num_episodes": 6, "episode_return_max": 715.8231129420093, "episode_return_min": -86.49900554914603, "episode_return_mean": 185.5918551082955, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.921989870548, "num_env_steps_trained_throughput_per_sec": 156.921989870548, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 25477.447, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25477.128, "sample_time_ms": 2128.526, "learn_time_ms": 23319.615, "learn_throughput": 171.529, "synch_weights_time_ms": 25.714}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "60982_00000", "date": "2024-08-23_11-42-51", "timestamp": 1724393571, "time_this_iter_s": 25.524054050445557, "time_total_s": 2581.009593963623, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711c0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2581.009593963623, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 38.13243243243244, "ram_util_percent": 82.13783783783786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.442318720035452, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.956639984423521, "policy_loss": -0.007972531468316755, "vf_loss": 4.963855373039447, "vf_explained_var": 0.302806973961926, "kl": 0.007571388566718688, "entropy": 0.43680532959403184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 497.9875000000029}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.036969527996405, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.003243334331209, "policy_loss": -0.012634199872001926, "vf_loss": 5.01437527616188, "vf_explained_var": 0.4984194191044601, "kl": 0.007511345236488278, "entropy": 0.704968989778448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 497.9875000000029}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 715.8231129420093, "episode_reward_min": -86.49900554914603, "episode_reward_mean": 183.40036827453153, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1191.122797606987, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 904.043775933585}, "policy_reward_mean": {"prey_policy": -364.40156532383133, "predator_policy": 456.1017494610979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.5383511687434, 85.69162181682535, 12.88032203094067, 79.79999999999974, 136.24958620161135, 57.54096971388395, 254.9340653126457, 165.6568266977521, 9.686326779167663, 550.087885153107, 534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581, -32.00767934884794, 368.1795175756441, 248.25182337768334, 83.98664121427036, -40.696889404164374, -86.49900554914603, 1.132984208570161, 22.037249886607157, 186.97131327035603, 278.95495747798896, 699.7343058815451, 50.36502398923061, 128.93204724768594, 110.09116692470158, 435.7000000000028, 59.641721734313585, 446.74710057273796, 113.72845356401116, 546.8174797239799, 113.97275315632994, 54.62972982652579, 114.2206339836445, 481.9881091292049, 142.89013617402836, -0.8046969389597868, 34.100000000000236, 343.17451199061657, 172.1459588661286, 145.99451691416579, 537.6889170091337, 15.6061670587218, 507.6897046106803, 89.38609535634502, 715.8231129420093, 50.21260951631444, 404.37947667843156, 135.34615283888184, 131.63169711520194, 447.1849942310126, 96.2443701718655, 118.70692735181173, 38.87345757371668, 120.80109053073761, -50.80804325046515, 135.7416695126038, 45.774008325448975, -41.63374195251962, -35.434363314966106, 361.06963217183954], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-822.7805172154465, -157.78389177602833, -363.2617732495998, -534.329287036274, -481.46639226388646, -431.95390422960133, 40.0000000000003, 38.21808901449447, -614.930135009905, -563.1939021028788, -371.926993223458, -347.5352541133437, -6.853589757621743, -723.1652916670192, -160.91199455296527, -598.413791933074, -500.88892978749567, -402.02980287372696, -403.04281888184096, -130.8261386810142, 26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563, -381.2205944793153, -454.55928285601857, -148.6916300605951, 240.87022509907266, -385.797003995329, -397.4589646389331, -429.92369489421935, -638.8781425174238, -279.13105878994946, -185.82087159492505, -339.09376953390165, -836.9685274634752, -416.7892813943955, -692.5555527048227, -894.825847001374, -670.294761135386, -796.339262347617, -458.7445562022118, -309.3241337990654, -585.1454899272543, 367.83828645681115, -797.7600812512396, -79.61514626585519, -212.3744053860886, 39.88254941703409, -568.957636786438, -8.766414563537083, -1191.122797606987, 20.230238969050028, 393.30955685968087, -107.53971894955333, 14.461229986414903, 400.0, -23.59102976523713, -273.1815139482446, -142.99240487282412, 214.66680755463256, -884.5281752133185, -440.6714006508857, -128.09079647026232, -695.2194944891203, -170.08087699919687, -369.1936765940216, -784.9054323971094, 368.9027414937941, -374.6273885721471, -392.70243971996064, -83.70727226989395, -185.93029833701203, -584.5198792693571, -460.1255223136294, -411.9208868601221, -621.736747097598, 230.4448381850441, -368.40116753880693, -201.75762509589904, -405.02599417402115, -864.6226684258784, -741.1872548415215, -114.20068481162518, -453.76325533759456, -612.0121427675552, -829.7931836848153, -135.80744721391883, -234.41859233387888, -453.153080960089, 26.420352942370045, -625.0900781991511, -585.5823133501465, -246.98153035612435, -509.82449888519295, -218.60510063183557, -523.2742433803786, -270.8753029981853, -541.7631698232527, -609.2200474633665, -459.0423734236959, -67.36937417344953, -422.20731148086725, -528.0858831904351, -265.4700955998914, -123.64418674139694, -443.60544734086477, 14.786034685592988, -197.48230709242512, -422.6801901162252, -530.4685874597078, -81.03424377974882, -570.17175297026, -424.5207464418137, 15.526438976791612, -274.30106681319006, -718.6956776589478, -432.3085008491184, -260.33778806202827, -193.7039475623812, -778.6343618524269, -353.2194692554626], "policy_predator_policy_reward": [639.7960288423458, 735.3067313178717, 527.6728663932702, 455.6098157094323, 577.4490045820785, 348.8516139423565, 0.0, 1.5819109855058116, 632.7301350099091, 681.6434883044906, 388.4523765951358, 388.55084045555805, 472.76422632025464, 512.1887204170355, 442.70192076005594, 482.28069242373516, 393.7485625667236, 518.8564968736729, 668.7107958867765, 415.2460468291868, 602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921, 594.8857481461172, 208.88644984037214, 135.95625344123064, 140.04466909593262, 476.0071243764619, 555.5006676354866, 751.5437414100859, 401.24473721582996, 423.37115750422385, 0.8838834764831843, 244.82144448194816, 844.7418469662854, 219.01597083301004, 891.4618474747814, 899.8258470013751, 687.3320110219923, 690.1356496254521, 751.9194821947303, 586.4440318759116, 586.9805493283963, 443.83950370027003, 685.8165969757017, 105.25803172204171, 237.09654391912912, 77.43546648646418, 580.5716681306263, 904.043775933585, 405.936603161642, 18.469761030949986, 3.690443140319115, 0.0, 152.7202106974498, 13.295117130987613, 57.043013206985, 282.2297986985713, 247.67257368651588, 549.3281010630786, 667.3507463195897, 558.6802156452095, 124.05473463226963, 270.11574743481714, 649.8143538800241, 638.6989002127244, 629.6208427620535, 401.6603411887298, 86.05241501882837, 244.7476239504497, 374.55222421343404, 160.44856107308937, 609.196919594319, 471.4255223136312, 434.7208868601257, 111.47341321925286, 622.9930076839183, 436.4498583923064, 305.8548931085313, 572.1955865975779, 843.4475929164886, 739.0958976613597, 653.9809590009133, 479.1851638724009, 602.1964012914722, 738.9708408575997, 734.3194946518156, 339.88156074404645, 437.0762079062685, 620.5905692848012, 693.9022689139919, 556.1859174983344, 326.59053572425006, 574.2935465175742, 558.5155296778825, 503.5640240574054, 425.93167516004246, 575.6554188506396, 706.9594955511902, 447.61847076841286, 525.9782710597381, 407.9100907228785, 638.6274741202906, 275.0371531989446, 232.78405649416092, 452.61627019680975, 15.076600032179197, 299.2294344537473, 441.7341532856412, 1.875091260832704, 558.8196967281576, 545.0539038837545, 585.3802650409352, 0.0, 304.548636161852, 231.91515979677328, 877.4552767587759, 1.81664026163498, 416.790732047809, 880.5780258928744, 612.3454373868545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8046437692626847, "mean_inference_ms": 3.5333055362177253, "mean_action_processing_ms": 1.1478556050710362, "mean_env_wait_ms": 10.304290525955015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007644295692443848, "StateBufferConnector_ms": 0.004650235176086426, "ViewRequirementAgentConnector_ms": 0.17880356311798096}, "num_episodes": 11, "episode_return_max": 715.8231129420093, "episode_return_min": -86.49900554914603, "episode_return_mean": 183.40036827453153, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.13686070650866, "num_env_steps_trained_throughput_per_sec": 157.13686070650866, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 25462.541, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25462.305, "sample_time_ms": 2166.491, "learn_time_ms": 23265.908, "learn_throughput": 171.925, "synch_weights_time_ms": 26.665}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "60982_00000", "date": "2024-08-23_11-43-17", "timestamp": 1724393597, "time_this_iter_s": 25.47344207763672, "time_total_s": 2606.4830360412598, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7e6430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2606.4830360412598, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 38.13333333333333, "ram_util_percent": 83.06388888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.951548216078017, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.886519817069725, "policy_loss": -0.00972526140028128, "vf_loss": 5.8953303180674395, "vf_explained_var": 0.28671848527968874, "kl": 0.009147566942271416, "entropy": 0.40886624950580497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.878077706836518, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.660560386899918, "policy_loss": -0.013398704098330603, "vf_loss": 5.672279357910156, "vf_explained_var": 0.5726822690988974, "kl": 0.008398558882375558, "entropy": 0.6423759866643834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 721.914131394269, "episode_reward_min": -86.49900554914603, "episode_reward_mean": 194.557094375233, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1191.122797606987, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 904.043775933585}, "policy_reward_mean": {"prey_policy": -354.47279243053396, "predator_policy": 451.751339618151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [534.2860928889063, 421.8782078754051, 212.67218989583938, 408.60000000000093, 1.1387017207429333, 548.9357097797757, 120.4443176173005, 400.4358076458833, 176.5548484857785, 74.80297483219526, 261.0571331436237, 250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581, -32.00767934884794, 368.1795175756441, 248.25182337768334, 83.98664121427036, -40.696889404164374, -86.49900554914603, 1.132984208570161, 22.037249886607157, 186.97131327035603, 278.95495747798896, 699.7343058815451, 50.36502398923061, 128.93204724768594, 110.09116692470158, 435.7000000000028, 59.641721734313585, 446.74710057273796, 113.72845356401116, 546.8174797239799, 113.97275315632994, 54.62972982652579, 114.2206339836445, 481.9881091292049, 142.89013617402836, -0.8046969389597868, 34.100000000000236, 343.17451199061657, 172.1459588661286, 145.99451691416579, 537.6889170091337, 15.6061670587218, 507.6897046106803, 89.38609535634502, 715.8231129420093, 50.21260951631444, 404.37947667843156, 135.34615283888184, 131.63169711520194, 447.1849942310126, 96.2443701718655, 118.70692735181173, 38.87345757371668, 120.80109053073761, -50.80804325046515, 135.7416695126038, 45.774008325448975, -41.63374195251962, -35.434363314966106, 361.06963217183954, 339.40720847890924, 392.0472225587616, 108.56804820275907, -71.33524878079994, 193.43329556808158, 721.914131394269, 304.5119284415974, 467.29384703449085, 20.98609911125248, 385.91203293550643], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [26.77012771361452, -540.846299366188, 400.0, -702.0045901365027, -38.07705098021791, -475.00447141952054, -361.6948895181261, 390.7374760969655, -909.2424169455804, -133.48270041948078, 274.72043401493823, -611.7440334352071, -306.678417037837, -216.10249043856916, 291.53139067453276, -61.87955976427642, -566.9131411281679, 73.36931111260913, -413.0328352287903, -413.7177213542167, -141.7834585987522, -261.61773368945165, -725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563, -381.2205944793153, -454.55928285601857, -148.6916300605951, 240.87022509907266, -385.797003995329, -397.4589646389331, -429.92369489421935, -638.8781425174238, -279.13105878994946, -185.82087159492505, -339.09376953390165, -836.9685274634752, -416.7892813943955, -692.5555527048227, -894.825847001374, -670.294761135386, -796.339262347617, -458.7445562022118, -309.3241337990654, -585.1454899272543, 367.83828645681115, -797.7600812512396, -79.61514626585519, -212.3744053860886, 39.88254941703409, -568.957636786438, -8.766414563537083, -1191.122797606987, 20.230238969050028, 393.30955685968087, -107.53971894955333, 14.461229986414903, 400.0, -23.59102976523713, -273.1815139482446, -142.99240487282412, 214.66680755463256, -884.5281752133185, -440.6714006508857, -128.09079647026232, -695.2194944891203, -170.08087699919687, -369.1936765940216, -784.9054323971094, 368.9027414937941, -374.6273885721471, -392.70243971996064, -83.70727226989395, -185.93029833701203, -584.5198792693571, -460.1255223136294, -411.9208868601221, -621.736747097598, 230.4448381850441, -368.40116753880693, -201.75762509589904, -405.02599417402115, -864.6226684258784, -741.1872548415215, -114.20068481162518, -453.76325533759456, -612.0121427675552, -829.7931836848153, -135.80744721391883, -234.41859233387888, -453.153080960089, 26.420352942370045, -625.0900781991511, -585.5823133501465, -246.98153035612435, -509.82449888519295, -218.60510063183557, -523.2742433803786, -270.8753029981853, -541.7631698232527, -609.2200474633665, -459.0423734236959, -67.36937417344953, -422.20731148086725, -528.0858831904351, -265.4700955998914, -123.64418674139694, -443.60544734086477, 14.786034685592988, -197.48230709242512, -422.6801901162252, -530.4685874597078, -81.03424377974882, -570.17175297026, -424.5207464418137, 15.526438976791612, -274.30106681319006, -718.6956776589478, -432.3085008491184, -260.33778806202827, -193.7039475623812, -778.6343618524269, -353.2194692554626, -407.5222178328217, 137.76645610280738, -443.88016621551765, 377.4462630665645, -1170.119141575183, -236.56972740109998, -383.8773366536348, -220.03463338879058, -107.98841777507602, -209.8177103013942, 390.7745877327287, -1114.9107802663395, -584.0134164561579, -193.33632593938572, -227.7750337768644, 342.03570377868573, -469.9301147079069, -426.286087184288, -493.17977930422046, -110.10386258331829], "policy_predator_policy_reward": [602.3699884774074, 445.9922760640732, 19.759243067903846, 704.1235549440039, 408.46823535528665, 317.28547694029675, 375.29488951812715, 4.2625239030345, 281.05463974578277, 762.8091793400209, 215.06276581468504, 670.8965433853589, 350.73100606940835, 292.4942190243039, 83.16368398311872, 87.62029275250443, 578.6465810004524, 91.45209750088608, 283.6965209770412, 617.8570104381693, 649.9994475691808, 14.458877862647142, 594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921, 594.8857481461172, 208.88644984037214, 135.95625344123064, 140.04466909593262, 476.0071243764619, 555.5006676354866, 751.5437414100859, 401.24473721582996, 423.37115750422385, 0.8838834764831843, 244.82144448194816, 844.7418469662854, 219.01597083301004, 891.4618474747814, 899.8258470013751, 687.3320110219923, 690.1356496254521, 751.9194821947303, 586.4440318759116, 586.9805493283963, 443.83950370027003, 685.8165969757017, 105.25803172204171, 237.09654391912912, 77.43546648646418, 580.5716681306263, 904.043775933585, 405.936603161642, 18.469761030949986, 3.690443140319115, 0.0, 152.7202106974498, 13.295117130987613, 57.043013206985, 282.2297986985713, 247.67257368651588, 549.3281010630786, 667.3507463195897, 558.6802156452095, 124.05473463226963, 270.11574743481714, 649.8143538800241, 638.6989002127244, 629.6208427620535, 401.6603411887298, 86.05241501882837, 244.7476239504497, 374.55222421343404, 160.44856107308937, 609.196919594319, 471.4255223136312, 434.7208868601257, 111.47341321925286, 622.9930076839183, 436.4498583923064, 305.8548931085313, 572.1955865975779, 843.4475929164886, 739.0958976613597, 653.9809590009133, 479.1851638724009, 602.1964012914722, 738.9708408575997, 734.3194946518156, 339.88156074404645, 437.0762079062685, 620.5905692848012, 693.9022689139919, 556.1859174983344, 326.59053572425006, 574.2935465175742, 558.5155296778825, 503.5640240574054, 425.93167516004246, 575.6554188506396, 706.9594955511902, 447.61847076841286, 525.9782710597381, 407.9100907228785, 638.6274741202906, 275.0371531989446, 232.78405649416092, 452.61627019680975, 15.076600032179197, 299.2294344537473, 441.7341532856412, 1.875091260832704, 558.8196967281576, 545.0539038837545, 585.3802650409352, 0.0, 304.548636161852, 231.91515979677328, 877.4552767587759, 1.81664026163498, 416.790732047809, 880.5780258928744, 612.3454373868545, 407.0007606174945, 202.1622095914287, 457.72827664598105, 0.752849061733814, 634.0017073888594, 881.2552097901827, 16.034315241272388, 516.5424060203509, 447.50986932575444, 63.72955431879617, 853.4876648968869, 592.5626590309964, 571.7061414657728, 510.15552937136687, 227.9765748517148, 125.05660218094921, 322.8603385588638, 594.3419624445874, 563.3439612115927, 425.8517136114547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8011247203044967, "mean_inference_ms": 3.5265113842693387, "mean_action_processing_ms": 1.1461802349813583, "mean_env_wait_ms": 10.297051466964687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007316231727600098, "StateBufferConnector_ms": 0.004551887512207031, "ViewRequirementAgentConnector_ms": 0.1764059066772461}, "num_episodes": 10, "episode_return_max": 721.914131394269, "episode_return_min": -86.49900554914603, "episode_return_mean": 194.557094375233, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.44303121558588, "num_env_steps_trained_throughput_per_sec": 157.44303121558588, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 25435.711, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25435.483, "sample_time_ms": 2147.753, "learn_time_ms": 23258.219, "learn_throughput": 171.982, "synch_weights_time_ms": 26.27}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "60982_00000", "date": "2024-08-23_11-43-42", "timestamp": 1724393622, "time_this_iter_s": 25.4528911113739, "time_total_s": 2631.9359271526337, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f776dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2631.9359271526337, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 36.98611111111111, "ram_util_percent": 82.78055555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.543156125810413, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.86344508973379, "policy_loss": -0.008797786981064492, "vf_loss": 5.871425161916743, "vf_explained_var": 0.20215381024375795, "kl": 0.008177213444221745, "entropy": 0.382791475707261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.865035650717518, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.607423277254457, "policy_loss": -0.014521978013513107, "vf_loss": 5.619905807858422, "vf_explained_var": 0.415580608605077, "kl": 0.010197246680282568, "entropy": 0.6693808976935332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 721.914131394269, "episode_reward_min": -86.49900554914603, "episode_reward_mean": 172.6019864727314, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1191.122797606987, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 904.043775933585}, "policy_reward_mean": {"prey_policy": -367.28540736677513, "predator_policy": 453.5864006031414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.9290197342978, 547.9525352616553, 395.19321271125443, 22.529330467898927, 244.24860806637423, 88.04344795957289, 29.51135697886568, 202.6872802622963, 23.573805444229258, 22.903376183978885, 216.16054365146564, 16.58715625409551, 92.5819934317874, -14.598677548535688, 36.695786904942615, 34.09149379295754, 410.0499917689534, 263.1127957277474, 102.64264848799243, 134.85492504809505, 100.1039590411045, 19.49999999999999, 127.27944099972913, 206.31088647513633, 53.29545786429317, 226.00822915253397, 40.164503777327624, 210.12909012032256, 233.9233053444646, 47.03558540252581, -32.00767934884794, 368.1795175756441, 248.25182337768334, 83.98664121427036, -40.696889404164374, -86.49900554914603, 1.132984208570161, 22.037249886607157, 186.97131327035603, 278.95495747798896, 699.7343058815451, 50.36502398923061, 128.93204724768594, 110.09116692470158, 435.7000000000028, 59.641721734313585, 446.74710057273796, 113.72845356401116, 546.8174797239799, 113.97275315632994, 54.62972982652579, 114.2206339836445, 481.9881091292049, 142.89013617402836, -0.8046969389597868, 34.100000000000236, 343.17451199061657, 172.1459588661286, 145.99451691416579, 537.6889170091337, 15.6061670587218, 507.6897046106803, 89.38609535634502, 715.8231129420093, 50.21260951631444, 404.37947667843156, 135.34615283888184, 131.63169711520194, 447.1849942310126, 96.2443701718655, 118.70692735181173, 38.87345757371668, 120.80109053073761, -50.80804325046515, 135.7416695126038, 45.774008325448975, -41.63374195251962, -35.434363314966106, 361.06963217183954, 339.40720847890924, 392.0472225587616, 108.56804820275907, -71.33524878079994, 193.43329556808158, 721.914131394269, 304.5119284415974, 467.29384703449085, 20.98609911125248, 385.91203293550643, 38.765804652163595, 40.13132491542486, 5.3813798135920194, 125.37756703254702, 218.69368757471176, 76.03119323059956, 108.08592724191429, 176.2919989730691, 5.813754761692005, 89.44018191081142, 81.28237352876691], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-725.8783800786111, -327.28590330673524, -571.9502125956194, -35.95475506954848, 108.12623120306355, -168.2154994248308, -243.98649998605194, -321.0677216580302, -389.1732267739714, -631.4154981442633, -317.2907791838326, -388.3607496642117, -727.3459012823929, -401.7717307753003, -1012.9459510938414, -53.790867001947255, -528.4198820340162, -574.0336861614151, -189.5438175543885, -516.2997648508593, -355.83315843346463, -474.25722526592074, -607.0879306262054, -709.9057093289173, -798.3856777711944, -475.32316115232163, -285.2658035647983, -109.7696670126306, -287.6540531327504, -207.7642218476803, -544.1512618696153, -589.6863107557507, -491.85711694159335, 212.0488445489286, -163.75885699976686, -662.4812307231634, -415.781339098362, -422.0758386423034, -854.6765627686218, -547.0156335328808, -743.9093049719668, -418.3593609978467, -633.5803971021278, -604.7635352396074, -372.59151425209103, -504.24189895151727, -842.8530760728685, -16.448524623837088, -551.269193835088, -505.3232838130192, -570.7135841983119, -302.7711577785711, -667.4479357146656, -718.3312602662763, -513.7620073307904, -561.711169803003, -75.59132409490039, -425.8077427484816, -683.2829008929035, -86.07073703652563, -381.2205944793153, -454.55928285601857, -148.6916300605951, 240.87022509907266, -385.797003995329, -397.4589646389331, -429.92369489421935, -638.8781425174238, -279.13105878994946, -185.82087159492505, -339.09376953390165, -836.9685274634752, -416.7892813943955, -692.5555527048227, -894.825847001374, -670.294761135386, -796.339262347617, -458.7445562022118, -309.3241337990654, -585.1454899272543, 367.83828645681115, -797.7600812512396, -79.61514626585519, -212.3744053860886, 39.88254941703409, -568.957636786438, -8.766414563537083, -1191.122797606987, 20.230238969050028, 393.30955685968087, -107.53971894955333, 14.461229986414903, 400.0, -23.59102976523713, -273.1815139482446, -142.99240487282412, 214.66680755463256, -884.5281752133185, -440.6714006508857, -128.09079647026232, -695.2194944891203, -170.08087699919687, -369.1936765940216, -784.9054323971094, 368.9027414937941, -374.6273885721471, -392.70243971996064, -83.70727226989395, -185.93029833701203, -584.5198792693571, -460.1255223136294, -411.9208868601221, -621.736747097598, 230.4448381850441, -368.40116753880693, -201.75762509589904, -405.02599417402115, -864.6226684258784, -741.1872548415215, -114.20068481162518, -453.76325533759456, -612.0121427675552, -829.7931836848153, -135.80744721391883, -234.41859233387888, -453.153080960089, 26.420352942370045, -625.0900781991511, -585.5823133501465, -246.98153035612435, -509.82449888519295, -218.60510063183557, -523.2742433803786, -270.8753029981853, -541.7631698232527, -609.2200474633665, -459.0423734236959, -67.36937417344953, -422.20731148086725, -528.0858831904351, -265.4700955998914, -123.64418674139694, -443.60544734086477, 14.786034685592988, -197.48230709242512, -422.6801901162252, -530.4685874597078, -81.03424377974882, -570.17175297026, -424.5207464418137, 15.526438976791612, -274.30106681319006, -718.6956776589478, -432.3085008491184, -260.33778806202827, -193.7039475623812, -778.6343618524269, -353.2194692554626, -407.5222178328217, 137.76645610280738, -443.88016621551765, 377.4462630665645, -1170.119141575183, -236.56972740109998, -383.8773366536348, -220.03463338879058, -107.98841777507602, -209.8177103013942, 390.7745877327287, -1114.9107802663395, -584.0134164561579, -193.33632593938572, -227.7750337768644, 342.03570377868573, -469.9301147079069, -426.286087184288, -493.17977930422046, -110.10386258331829, -128.7621519352125, -142.89166431948104, -630.1074550174355, -254.86664467572842, -250.10696998193592, -448.469411960918, -393.8704288084731, -217.92593609143523, -178.25044074308371, -303.9705135156925, -105.67881832288995, -172.74433373922207, -512.5738350777874, -59.70943966724817, -479.1138991937165, -632.8435185802244, -397.3304600242079, -493.18037107285556, -160.17101689059913, -196.58678895204696, -473.38907579156216, -626.6728827346974], "policy_predator_policy_reward": [594.1247057062463, 709.9685974134061, 533.6511210200335, 622.2063819067865, 0.0, 455.282480933018, 225.70780399266155, 361.8757481193272, 690.2257624364219, 574.6115705481936, 425.12272006377435, 368.5722567438531, 710.4880808293234, 448.1409082072377, 716.6886671769653, 552.7354311811174, 552.7198820340185, 573.3074916056438, 506.8419007786849, 221.9050578105412, 441.9732807832575, 604.2776465676012, 646.0684763868887, 687.5123198223315, 864.5257124615749, 501.76511989373364, 378.6137555521773, 1.8230374767184334, 231.27959822457981, 300.83446366079244, 531.2056958871092, 636.7233705312134, 350.4992564036293, 339.3590077579893, 643.8328655994318, 445.52001785124537, 354.3232057436148, 586.1766204850471, 693.1146635201978, 843.4324578294027, 714.9461779414063, 547.4264470695149, 646.0803971021309, 611.7635352396084, 712.3623697956597, 291.7504844076798, 835.1064151886085, 230.50607198323468, 642.5670807773491, 467.32085473505293, 517.8580655538512, 581.6349055755674, 666.3147810607226, 759.6289186975491, 561.4574941402979, 724.1447731138188, 262.4650130585772, 472.857359129265, 696.8829008929066, 119.50632243904921, 594.8857481461172, 208.88644984037214, 135.95625344123064, 140.04466909593262, 476.0071243764619, 555.5006676354866, 751.5437414100859, 401.24473721582996, 423.37115750422385, 0.8838834764831843, 244.82144448194816, 844.7418469662854, 219.01597083301004, 891.4618474747814, 899.8258470013751, 687.3320110219923, 690.1356496254521, 751.9194821947303, 586.4440318759116, 586.9805493283963, 443.83950370027003, 685.8165969757017, 105.25803172204171, 237.09654391912912, 77.43546648646418, 580.5716681306263, 904.043775933585, 405.936603161642, 18.469761030949986, 3.690443140319115, 0.0, 152.7202106974498, 13.295117130987613, 57.043013206985, 282.2297986985713, 247.67257368651588, 549.3281010630786, 667.3507463195897, 558.6802156452095, 124.05473463226963, 270.11574743481714, 649.8143538800241, 638.6989002127244, 629.6208427620535, 401.6603411887298, 86.05241501882837, 244.7476239504497, 374.55222421343404, 160.44856107308937, 609.196919594319, 471.4255223136312, 434.7208868601257, 111.47341321925286, 622.9930076839183, 436.4498583923064, 305.8548931085313, 572.1955865975779, 843.4475929164886, 739.0958976613597, 653.9809590009133, 479.1851638724009, 602.1964012914722, 738.9708408575997, 734.3194946518156, 339.88156074404645, 437.0762079062685, 620.5905692848012, 693.9022689139919, 556.1859174983344, 326.59053572425006, 574.2935465175742, 558.5155296778825, 503.5640240574054, 425.93167516004246, 575.6554188506396, 706.9594955511902, 447.61847076841286, 525.9782710597381, 407.9100907228785, 638.6274741202906, 275.0371531989446, 232.78405649416092, 452.61627019680975, 15.076600032179197, 299.2294344537473, 441.7341532856412, 1.875091260832704, 558.8196967281576, 545.0539038837545, 585.3802650409352, 0.0, 304.548636161852, 231.91515979677328, 877.4552767587759, 1.81664026163498, 416.790732047809, 880.5780258928744, 612.3454373868545, 407.0007606174945, 202.1622095914287, 457.72827664598105, 0.752849061733814, 634.0017073888594, 881.2552097901827, 16.034315241272388, 516.5424060203509, 447.50986932575444, 63.72955431879617, 853.4876648968869, 592.5626590309964, 571.7061414657728, 510.15552937136687, 227.9765748517148, 125.05660218094921, 322.8603385588638, 594.3419624445874, 563.3439612115927, 425.8517136114547, 67.96476955531327, 242.45485135154, 650.6411612027539, 274.4642634058346, 112.84548098757314, 591.1122807688727, 402.39916963119305, 334.7747623012672, 291.3948641940544, 409.51977763944024, 155.6794128643213, 198.77493242838767, 498.71287148926723, 181.6563304976844, 506.8312538612542, 781.4181628857565, 38.9984149321204, 857.3261709266403, 198.66992765890598, 247.52806009454983, 559.7615051400961, 621.5828269149343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7981642615007583, "mean_inference_ms": 3.5247292040572584, "mean_action_processing_ms": 1.14567070656393, "mean_env_wait_ms": 10.3079836190876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008200645446777344, "StateBufferConnector_ms": 0.004508018493652344, "ViewRequirementAgentConnector_ms": 0.15738403797149658}, "num_episodes": 11, "episode_return_max": 721.914131394269, "episode_return_min": -86.49900554914603, "episode_return_mean": 172.6019864727314, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.32166221022254, "num_env_steps_trained_throughput_per_sec": 147.32166221022254, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 25595.691, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25595.508, "sample_time_ms": 2203.349, "learn_time_ms": 23362.171, "learn_throughput": 171.217, "synch_weights_time_ms": 26.72}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "60982_00000", "date": "2024-08-23_11-44-09", "timestamp": 1724393649, "time_this_iter_s": 27.17846393585205, "time_total_s": 2659.1143910884857, "pid": 64197, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1711a51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2659.1143910884857, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 43.142105263157895, "ram_util_percent": 83.10789473684213}}
