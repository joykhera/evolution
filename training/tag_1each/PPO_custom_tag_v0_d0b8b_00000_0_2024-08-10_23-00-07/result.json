{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9574589480956395, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.326416955391566, "policy_loss": -0.013760275559616276, "vf_loss": 6.337159708638986, "vf_explained_var": 0.011245242382089297, "kl": 0.015087571575712581, "entropy": 1.5948879815638066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7803324844067296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.25563753247261, "policy_loss": -0.007135470364786064, "vf_loss": 6.261052100857099, "vf_explained_var": 0.011308606714010239, "kl": 0.008604442226962885, "entropy": 1.6009539406746627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 358.5, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3585, "policy_reward_min": {"prey_policy": -12.793939541531, "predator_policy": -6.141723509895442}, "policy_reward_max": {"prey_policy": 6.141723509895442, "predator_policy": 12.793939541531}, "policy_reward_mean": {"prey_policy": -3.270214161585213, "predator_policy": 3.270214161585213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.427481117864553, "mean_inference_ms": 1.4137101992675685, "mean_action_processing_ms": 0.1867102729755847, "mean_env_wait_ms": 0.11482712002841329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960132598876953, "StateBufferConnector_ms": 0.0020575523376464844, "ViewRequirementAgentConnector_ms": 0.04420042037963867}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 656.0473377205079, "num_env_steps_trained_throughput_per_sec": 656.0473377205079, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 6097.182, "restore_workers_time_ms": 0.086, "training_step_time_ms": 6096.993, "sample_time_ms": 1065.295, "learn_time_ms": 5021.045, "learn_throughput": 796.647, "synch_weights_time_ms": 10.261}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-00-23", "timestamp": 1723345223, "time_this_iter_s": 6.102467060089111, "time_total_s": 6.102467060089111, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6.102467060089111, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.25555555555556, "ram_util_percent": 83.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6331191492266952, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.58207263747851, "policy_loss": -0.007772278451011516, "vf_loss": 6.587388161818186, "vf_explained_var": -0.01542730126529932, "kl": 0.012283701323855608, "entropy": 1.5576424737771353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3548929986854394, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6609147946039835, "policy_loss": -0.0033911669510416687, "vf_loss": 6.663218781352043, "vf_explained_var": -0.002383098565042019, "kl": 0.005435915506954177, "entropy": 1.5884277341266473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.1, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7262, "policy_reward_min": {"prey_policy": -19.90287450977349, "predator_policy": -20.463146148452786}, "policy_reward_max": {"prey_policy": 20.463146148452786, "predator_policy": 19.90287450977349}, "policy_reward_mean": {"prey_policy": 1.3701743974749303, "predator_policy": -1.3701743974749303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38284531859826343, "mean_inference_ms": 1.2800050107203007, "mean_action_processing_ms": 0.16875622520247863, "mean_env_wait_ms": 0.10108264015290899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003973841667175293, "StateBufferConnector_ms": 0.0020682811737060547, "ViewRequirementAgentConnector_ms": 0.0484234094619751}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 725.6400532581887, "num_env_steps_trained_throughput_per_sec": 725.6400532581887, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 5804.783, "restore_workers_time_ms": 0.05, "training_step_time_ms": 5804.656, "sample_time_ms": 844.827, "learn_time_ms": 4930.915, "learn_throughput": 811.209, "synch_weights_time_ms": 25.895}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-00-30", "timestamp": 1723345230, "time_this_iter_s": 5.521382808685303, "time_total_s": 11.623849868774414, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.623849868774414, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.37272727272727, "ram_util_percent": 83.01818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1634820291772483, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.672330599526564, "policy_loss": -0.006032702764787246, "vf_loss": 6.676247027516365, "vf_explained_var": -0.06351125327249368, "kl": 0.010581391207454353, "entropy": 1.5081549923866988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2476011724832157, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.835565450290839, "policy_loss": -0.006438392932856611, "vf_loss": 6.839822297294934, "vf_explained_var": 0.0074836449076732, "kl": 0.010907752830160402, "entropy": 1.5852542816350856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 367.48275862068965, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 10657, "policy_reward_min": {"prey_policy": -19.90287450977349, "predator_policy": -26.42707181976808}, "policy_reward_max": {"prey_policy": 26.42707181976808, "predator_policy": 19.90287450977349}, "policy_reward_mean": {"prey_policy": 4.144056390970481, "predator_policy": -4.144056390970481}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3674493817867734, "mean_inference_ms": 1.2257423258406412, "mean_action_processing_ms": 0.16166946169144494, "mean_env_wait_ms": 0.0953064623915549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003965558676884092, "StateBufferConnector_ms": 0.002172486535434065, "ViewRequirementAgentConnector_ms": 0.05043169547771585}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.1716440816988, "num_env_steps_trained_throughput_per_sec": 702.1716440816988, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 5768.735, "restore_workers_time_ms": 0.042, "training_step_time_ms": 5768.626, "sample_time_ms": 825.425, "learn_time_ms": 4919.425, "learn_throughput": 813.103, "synch_weights_time_ms": 21.629}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-00-36", "timestamp": 1723345236, "time_this_iter_s": 5.699946880340576, "time_total_s": 17.32379674911499, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4928b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17.32379674911499, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.45, "ram_util_percent": 83.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3497632352635263, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.108759427567323, "policy_loss": -0.0049675166512315625, "vf_loss": 6.11191174586614, "vf_explained_var": 0.11806530343989531, "kl": 0.009076034605744762, "entropy": 1.4654164480666318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.35901185721159, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.131039101878802, "policy_loss": -0.011204331948586816, "vf_loss": 6.139493770400683, "vf_explained_var": 0.002838045544922352, "kl": 0.013748339546671042, "entropy": 1.5546762075275182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 375.1842105263158, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 14257, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -26.42707181976808}, "policy_reward_max": {"prey_policy": 26.42707181976808, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 1.4920191822939617, "predator_policy": -1.4920191822939617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35661102105097703, "mean_inference_ms": 1.1896631874544947, "mean_action_processing_ms": 0.1570856173465332, "mean_env_wait_ms": 0.09122904531492558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003894379264429996, "StateBufferConnector_ms": 0.0022756425957930716, "ViewRequirementAgentConnector_ms": 0.050324515292519016}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 744.1271946579656, "num_env_steps_trained_throughput_per_sec": 744.1271946579656, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 5670.41, "restore_workers_time_ms": 0.035, "training_step_time_ms": 5670.319, "sample_time_ms": 793.713, "learn_time_ms": 4856.205, "learn_throughput": 823.688, "synch_weights_time_ms": 18.713}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-00-41", "timestamp": 1723345241, "time_this_iter_s": 5.378214359283447, "time_total_s": 22.702011108398438, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22.702011108398438, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 32.9375, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3273833372009296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.806867795437574, "policy_loss": -0.00712460673263801, "vf_loss": 4.812431110193332, "vf_explained_var": 0.0567856028676033, "kl": 0.007806495400291584, "entropy": 1.4022289397815864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8463431912163892, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.175272320955992, "policy_loss": -0.0034315328581821327, "vf_loss": 5.17737880970041, "vf_explained_var": -0.003978896637757619, "kl": 0.006625121845742354, "entropy": 1.518625963355104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 378.3541666666667, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 18161, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -30.266462724831086}, "policy_reward_max": {"prey_policy": 30.266462724831086, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 3.4699153972033723, "predator_policy": -3.4699153972033723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3466022623899967, "mean_inference_ms": 1.1574163991757376, "mean_action_processing_ms": 0.1531387637377027, "mean_env_wait_ms": 0.08777005689292444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00391999880472819, "StateBufferConnector_ms": 0.002257774273554484, "ViewRequirementAgentConnector_ms": 0.05030458172162374}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.3764781746873, "num_env_steps_trained_throughput_per_sec": 799.3764781746873, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 5537.109, "restore_workers_time_ms": 0.031, "training_step_time_ms": 5537.031, "sample_time_ms": 764.696, "learn_time_ms": 4754.056, "learn_throughput": 841.387, "synch_weights_time_ms": 16.873}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-00-46", "timestamp": 1723345246, "time_this_iter_s": 5.0064051151275635, "time_total_s": 27.708416223526, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27.708416223526, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.614285714285717, "ram_util_percent": 82.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.388722925881545, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.202932700763146, "policy_loss": -0.005411425823209962, "vf_loss": 4.206321556866169, "vf_explained_var": 0.10533534865826369, "kl": 0.010112909066177404, "entropy": 1.3825285110622645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9810994052017727, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.275519940257072, "policy_loss": -0.007304721492497872, "vf_loss": 4.280751661211252, "vf_explained_var": 0.013260336716969807, "kl": 0.01036493538798042, "entropy": 1.5356491940716903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 375.98275862068965, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 21807, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -35.033916032099825}, "policy_reward_max": {"prey_policy": 35.033916032099825, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 5.445416801121944, "predator_policy": -5.445416801121944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.338894978254577, "mean_inference_ms": 1.1314827613877616, "mean_action_processing_ms": 0.1499139320185154, "mean_env_wait_ms": 0.08523053293930521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038531319848422348, "StateBufferConnector_ms": 0.0022117433876826845, "ViewRequirementAgentConnector_ms": 0.04920219552928004}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.112254868622, "num_env_steps_trained_throughput_per_sec": 804.112254868622, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 5443.33, "restore_workers_time_ms": 0.027, "training_step_time_ms": 5443.26, "sample_time_ms": 742.187, "learn_time_ms": 4684.109, "learn_throughput": 853.951, "synch_weights_time_ms": 15.741}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-00-51", "timestamp": 1723345251, "time_this_iter_s": 4.976921081542969, "time_total_s": 32.68533730506897, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 32.68533730506897, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.914285714285718, "ram_util_percent": 82.27142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.783717687179645, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8801550885041554, "policy_loss": -0.005381952022435144, "vf_loss": 3.883882949252923, "vf_explained_var": 0.21372086256742479, "kl": 0.008270443226780699, "entropy": 1.3512198297927778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9101447423609594, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.153171794116497, "policy_loss": -0.0070757400256601, "vf_loss": 4.157651857783397, "vf_explained_var": 0.02004831495384375, "kl": 0.012978402212288, "entropy": 1.5457861226052045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 379.5147058823529, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 25807, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 8.216892116371035, "predator_policy": -8.216892116371035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3328220862523077, "mean_inference_ms": 1.1111386133935588, "mean_action_processing_ms": 0.1475175859300027, "mean_env_wait_ms": 0.08287905068441531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038073343389174517, "StateBufferConnector_ms": 0.0021836336921243105, "ViewRequirementAgentConnector_ms": 0.048520284540512985}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.9741000573714, "num_env_steps_trained_throughput_per_sec": 781.9741000573714, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 5396.464, "restore_workers_time_ms": 0.025, "training_step_time_ms": 5396.399, "sample_time_ms": 727.507, "learn_time_ms": 4652.545, "learn_throughput": 859.745, "synch_weights_time_ms": 15.245}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-00-56", "timestamp": 1723345256, "time_this_iter_s": 5.1187779903411865, "time_total_s": 37.804115295410156, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.804115295410156, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.7, "ram_util_percent": 82.27142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.668033778419097, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.227032600094875, "policy_loss": -0.0019411046610912307, "vf_loss": 5.22816251690189, "vf_explained_var": 0.047454132325947286, "kl": 0.004055977064868976, "entropy": 1.368355152507623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9804698637376228, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.202461187044779, "policy_loss": 0.00048753143006858104, "vf_loss": 5.201179613918066, "vf_explained_var": 0.02727186984072129, "kl": 0.003970304388346187, "entropy": 1.5558343030512334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 378.30379746835445, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 29886, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 9.60709051319775, "predator_policy": -9.60709051319775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3272980720343063, "mean_inference_ms": 1.093078371738554, "mean_action_processing_ms": 0.14538462769181335, "mean_env_wait_ms": 0.08084812341431218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037984002994585642, "StateBufferConnector_ms": 0.0021650821347779865, "ViewRequirementAgentConnector_ms": 0.04885770097563538}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.3693613484427, "num_env_steps_trained_throughput_per_sec": 804.3693613484427, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 5343.516, "restore_workers_time_ms": 0.024, "training_step_time_ms": 5343.439, "sample_time_ms": 717.829, "learn_time_ms": 4609.64, "learn_throughput": 867.747, "synch_weights_time_ms": 14.91}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-01", "timestamp": 1723345261, "time_this_iter_s": 4.988035202026367, "time_total_s": 42.79215049743652, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42.79215049743652, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.3125, "ram_util_percent": 82.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6060689769064385, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.463778512179852, "policy_loss": -0.005494845596937618, "vf_loss": 5.468189735710621, "vf_explained_var": 0.03959884606301785, "kl": 0.010836063748496312, "entropy": 1.2908203224341075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.557732307476302, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.027115718275309, "policy_loss": -0.003709572951872057, "vf_loss": 5.03034361799558, "vf_explained_var": 0.10828950814902782, "kl": 0.004816714180783499, "entropy": 1.5438201282173396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 376.74444444444447, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 33907, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 11.010763733364222, "predator_policy": -11.010763733364222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 359, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400], "policy_prey_policy_reward": [-12.043756001001768, -2.085377584692921, 5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953], "policy_predator_policy_reward": [12.043756001001768, 2.085377584692921, -5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32312165998514936, "mean_inference_ms": 1.0786801954717014, "mean_action_processing_ms": 0.14365348432684102, "mean_env_wait_ms": 0.07916888541310582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037536356184217664, "StateBufferConnector_ms": 0.002124309539794922, "ViewRequirementAgentConnector_ms": 0.04818558692932129}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.7870317583607, "num_env_steps_trained_throughput_per_sec": 780.7870317583607, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 5319.019, "restore_workers_time_ms": 0.023, "training_step_time_ms": 5318.946, "sample_time_ms": 713.933, "learn_time_ms": 4589.653, "learn_throughput": 871.526, "synch_weights_time_ms": 14.383}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-07", "timestamp": 1723345267, "time_this_iter_s": 5.125715970993042, "time_total_s": 47.917866468429565, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 47.917866468429565, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.071428571428573, "ram_util_percent": 82.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.081057117134333, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.161979777365923, "policy_loss": -0.005489552784032033, "vf_loss": 5.166539736588796, "vf_explained_var": 0.1362667306015889, "kl": 0.009296047069416483, "entropy": 1.2367811104903619, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0093229771902164, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.554877246916294, "policy_loss": -0.004001300463278313, "vf_loss": 5.558152260879676, "vf_explained_var": 0.11125450786203146, "kl": 0.014525631096065134, "entropy": 1.5621335035810868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 379.48, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37948, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 12.094053730614469, "predator_policy": -12.094053730614469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.851975771128757, -3.8184037809274365, -9.139226983799794, 6.141723509895442, -12.793939541531, -0.2699821721879232, -7.358831867910908, 2.81367703517542, 20.463146148452786, 13.80087209509134, -9.074431848862652, 5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008], "policy_predator_policy_reward": [-5.851975771128757, 3.8184037809274365, 9.139226983799794, -6.141723509895442, 12.793939541531, 0.2699821721879232, 7.358831867910908, -2.81367703517542, -20.463146148452786, -13.80087209509134, 9.074431848862652, -5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31779841064697784, "mean_inference_ms": 1.0601787034738805, "mean_action_processing_ms": 0.14120910082140686, "mean_env_wait_ms": 0.07723667011158036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037232637405395508, "StateBufferConnector_ms": 0.002134084701538086, "ViewRequirementAgentConnector_ms": 0.04865443706512451}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 808.3842684674303, "num_env_steps_trained_throughput_per_sec": 808.3842684674303, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 5281.932, "restore_workers_time_ms": 0.022, "training_step_time_ms": 5281.864, "sample_time_ms": 705.686, "learn_time_ms": 4561.352, "learn_throughput": 876.933, "synch_weights_time_ms": 13.915}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-12", "timestamp": 1723345272, "time_this_iter_s": 4.950917959213257, "time_total_s": 52.86878442764282, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.86878442764282, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.800000000000004, "ram_util_percent": 82.24285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2716758638620376, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.146801198273897, "policy_loss": -0.009526159139932133, "vf_loss": 5.154624391098817, "vf_explained_var": 0.025861411541700362, "kl": 0.017029775964373793, "entropy": 1.2275772823641697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.572879948777457, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3983141305545965, "policy_loss": -0.003779355917261758, "vf_loss": 5.401232379178206, "vf_explained_var": -0.04806242398917675, "kl": 0.017222289815590337, "entropy": 1.5811602018773556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 380.06, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38006, "policy_reward_min": {"prey_policy": -40.0955718800102, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 40.0955718800102}, "policy_reward_mean": {"prey_policy": 12.365917089256325, "predator_policy": -12.365917089256325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 77, 400, 400, 400, 400, 400, 400, 195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400], "policy_prey_policy_reward": [5.935178761656417, 3.1053567788530643, 14.281702638275725, 14.233513614218339, -19.90287450977349, 1.1230390065040439, 16.140126880935163, 19.26009182514657, 26.42707181976808, -1.051382256468914, 2.3306474007015154, -5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006], "policy_predator_policy_reward": [-5.935178761656417, -3.1053567788530643, -14.281702638275725, -14.233513614218339, 19.90287450977349, -1.1230390065040439, -16.140126880935163, -19.26009182514657, -26.42707181976808, 1.051382256468914, -2.3306474007015154, 5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3038069588922192, "mean_inference_ms": 1.0173140829422271, "mean_action_processing_ms": 0.13561916269925947, "mean_env_wait_ms": 0.0726081212907487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003568291664123535, "StateBufferConnector_ms": 0.0020983219146728516, "ViewRequirementAgentConnector_ms": 0.04851841926574707}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 778.8951790133605, "num_env_steps_trained_throughput_per_sec": 778.8951790133605, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 5185.762, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5185.71, "sample_time_ms": 664.974, "learn_time_ms": 4505.94, "learn_throughput": 887.717, "synch_weights_time_ms": 13.891}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-17", "timestamp": 1723345277, "time_this_iter_s": 5.138266086578369, "time_total_s": 58.00705051422119, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58.00705051422119, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.32857142857143, "ram_util_percent": 82.38571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.065753677052756, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9370373979210855, "policy_loss": -0.0020382422061326604, "vf_loss": 5.93859969774882, "vf_explained_var": 0.07577592047552267, "kl": 0.0047594538593805176, "entropy": 1.191413608317574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.48665265434732, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.83263495961825, "policy_loss": -0.005984901924966835, "vf_loss": 5.8378585030635195, "vf_explained_var": 0.04754102819909652, "kl": 0.015227128011265835, "entropy": 1.567744310448567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 380.2, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38020, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 12.658311860695283, "predator_policy": -12.658311860695283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [195, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-5.005120678070531, 4.604637504183691, 11.852690332397483, 24.897060035162493, 9.458451405824952, -6.741077575652465, -18.537564829981093, 14.527430062543143, 22.67706832675657, -11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187], "policy_predator_policy_reward": [5.005120678070531, -4.604637504183691, -11.852690332397483, -24.897060035162493, -9.458451405824952, 6.741077575652465, 18.537564829981093, -14.527430062543143, -22.67706832675657, 11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2987548713434889, "mean_inference_ms": 0.9980213122866733, "mean_action_processing_ms": 0.13358138918394383, "mean_env_wait_ms": 0.07037596560572368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033887624740600586, "StateBufferConnector_ms": 0.0020650625228881836, "ViewRequirementAgentConnector_ms": 0.0470050573348999}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.8420832602536, "num_env_steps_trained_throughput_per_sec": 777.8420832602536, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 5148.768, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5148.718, "sample_time_ms": 672.996, "learn_time_ms": 4464.629, "learn_throughput": 895.931, "synch_weights_time_ms": 10.723}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-22", "timestamp": 1723345282, "time_this_iter_s": 5.1450371742248535, "time_total_s": 63.152087688446045, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.152087688446045, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.900000000000002, "ram_util_percent": 82.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1307343572999042, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.859659581879774, "policy_loss": -0.002299400123592932, "vf_loss": 5.861595518390337, "vf_explained_var": 0.025304489955306052, "kl": 0.007269408454931466, "entropy": 1.1894748877733945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.451378190082808, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.747575505574544, "policy_loss": -0.008468596855770253, "vf_loss": 5.75517884939909, "vf_explained_var": -0.01562203907718261, "kl": 0.017304565660508038, "entropy": 1.555486833055814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.25, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38225, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 12.474955362884883, "predator_policy": -12.474955362884883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 304, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-11.871142369065275, -12.753273235368226, -40.0955718800102, 2.8264823469353466, -13.513257257131222, 0.9370651761113855, 14.517005753597793, 5.862039292607497, -13.500549784055494, 30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627], "policy_predator_policy_reward": [11.871142369065275, 12.753273235368226, 40.0955718800102, -2.8264823469353466, 13.513257257131222, -0.9370651761113855, -14.517005753597793, -5.862039292607497, 13.500549784055494, -30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29523170893823475, "mean_inference_ms": 0.9871776737393851, "mean_action_processing_ms": 0.13236517575109247, "mean_env_wait_ms": 0.06894707258572931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033701658248901367, "StateBufferConnector_ms": 0.0020356178283691406, "ViewRequirementAgentConnector_ms": 0.04711627960205078}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 758.4388972475672, "num_env_steps_trained_throughput_per_sec": 758.4388972475672, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 5106.504, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5106.453, "sample_time_ms": 666.122, "learn_time_ms": 4428.504, "learn_throughput": 903.24, "synch_weights_time_ms": 11.415}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-27", "timestamp": 1723345287, "time_this_iter_s": 5.3194849491119385, "time_total_s": 68.47157263755798, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68.47157263755798, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 33.371428571428574, "ram_util_percent": 82.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8009882058327396, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.768995977938175, "policy_loss": -0.0028077901057258713, "vf_loss": 6.771459084252516, "vf_explained_var": 0.0910227244719863, "kl": 0.006893491985507009, "entropy": 1.2285883836448193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2950118244315187, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.669915383557479, "policy_loss": -0.006769309438580725, "vf_loss": 6.675985896090666, "vf_explained_var": -0.0019349693631132445, "kl": 0.013976117407840669, "entropy": 1.5182040624320507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.21, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38321, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 14.09924288971826, "predator_policy": -14.09924288971826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [30.266462724831086, 12.895281713038734, 10.74554563448747, 23.626627469140864, 16.947802521992557, 7.561929636839444, 5.551807222865634, 24.22312242018893, 35.033916032099825, 8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255], "policy_predator_policy_reward": [-30.266462724831086, -12.895281713038734, -10.74554563448747, -23.626627469140864, -16.947802521992557, -7.561929636839444, -5.551807222865634, -24.22312242018893, -35.033916032099825, -8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29301857062331793, "mean_inference_ms": 0.9801910251594471, "mean_action_processing_ms": 0.13167217288514882, "mean_env_wait_ms": 0.06805031725254156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033811330795288086, "StateBufferConnector_ms": 0.0020750761032104492, "ViewRequirementAgentConnector_ms": 0.05725407600402832}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 737.9063881233831, "num_env_steps_trained_throughput_per_sec": 737.9063881233831, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 5111.036, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5110.984, "sample_time_ms": 674.3, "learn_time_ms": 4424.769, "learn_throughput": 904.002, "synch_weights_time_ms": 11.493}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-33", "timestamp": 1723345293, "time_this_iter_s": 5.423404932022095, "time_total_s": 73.89497756958008, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73.89497756958008, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 34.6375, "ram_util_percent": 82.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9843892976020774, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.319329372793436, "policy_loss": -0.008360989034796755, "vf_loss": 5.327332995583614, "vf_explained_var": -0.010591168329119683, "kl": 0.007147496158453966, "entropy": 1.2235485586027304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5285566063597797, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.144715580592552, "policy_loss": -0.006868355244902583, "vf_loss": 5.15087431371212, "vf_explained_var": 0.17591511321564515, "kl": 0.01419232445564869, "entropy": 1.5024441860616207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.21, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38321, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 13.271851789140092, "predator_policy": -13.271851789140092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [8.425857320979276, 10.960182641189093, 26.109738901843876, -17.04654242967932, 26.78497004199349, 5.445258970952985, 23.789924276877095, 16.445869837513087, -0.8955169332707342, 33.362295270041066, 33.368777829406284, -0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954], "policy_predator_policy_reward": [-8.425857320979276, -10.960182641189093, -26.109738901843876, 17.04654242967932, -26.78497004199349, -5.445258970952985, -23.789924276877095, -16.445869837513087, 0.8955169332707342, -33.362295270041066, -33.368777829406284, 0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29161674195473386, "mean_inference_ms": 0.9753096546822556, "mean_action_processing_ms": 0.13121426001590447, "mean_env_wait_ms": 0.06729855037517271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033205747604370117, "StateBufferConnector_ms": 0.0020519495010375977, "ViewRequirementAgentConnector_ms": 0.056998252868652344}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.3905835331329, "num_env_steps_trained_throughput_per_sec": 803.3905835331329, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 5108.536, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5108.483, "sample_time_ms": 670.702, "learn_time_ms": 4425.642, "learn_throughput": 903.824, "synch_weights_time_ms": 11.714}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-38", "timestamp": 1723345298, "time_this_iter_s": 4.982614755630493, "time_total_s": 78.87759232521057, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.87759232521057, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.157142857142855, "ram_util_percent": 82.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.97863658334439, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3689324135581655, "policy_loss": -0.0075299154535362805, "vf_loss": 5.375687738259633, "vf_explained_var": -0.013394272203246753, "kl": 0.01549195642494884, "entropy": 1.1439036878446738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.399199078635623, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.766382523874442, "policy_loss": -0.005413559320246956, "vf_loss": 4.771196733415127, "vf_explained_var": 0.11329463850706815, "kl": 0.01198705472225784, "entropy": 1.4530922601620355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.75, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38675, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -45.58553582613903}, "policy_reward_max": {"prey_policy": 45.58553582613903, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 12.919218810087687, "predator_policy": -12.919218810087687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-0.9813720193135609, 45.58553582613903, 30.505724110145973, 28.669753970145717, 28.965247470937864, 27.88817408641297, 0.9517525556352737, 29.300634283841458, 40.53191553329039, 16.99007688185209, 8.417650728203164, 10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753], "policy_predator_policy_reward": [0.9813720193135609, -45.58553582613903, -30.505724110145973, -28.669753970145717, -28.965247470937864, -27.88817408641297, -0.9517525556352737, -29.300634283841458, -40.53191553329039, -16.99007688185209, -8.417650728203164, -10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29034313586296306, "mean_inference_ms": 0.971547163833104, "mean_action_processing_ms": 0.13090248831716272, "mean_env_wait_ms": 0.06659594444146387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003261566162109375, "StateBufferConnector_ms": 0.002039790153503418, "ViewRequirementAgentConnector_ms": 0.05717730522155762}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 790.098637908583, "num_env_steps_trained_throughput_per_sec": 790.098637908583, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 5117.359, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5117.306, "sample_time_ms": 673.198, "learn_time_ms": 4431.984, "learn_throughput": 902.53, "synch_weights_time_ms": 11.695}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-43", "timestamp": 1723345303, "time_this_iter_s": 5.066612005233765, "time_total_s": 83.94420433044434, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4981af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.94420433044434, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.842857142857138, "ram_util_percent": 82.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8536517235450445, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.915870089332262, "policy_loss": -0.006592947108341226, "vf_loss": 5.921446813146273, "vf_explained_var": 0.07429327343900999, "kl": 0.02032471638628645, "entropy": 1.1180953012158474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4682381826763353, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9000841731826466, "policy_loss": -0.004791849060954216, "vf_loss": 5.904330405096213, "vf_explained_var": -0.07633239099135002, "kl": 0.010912050418963423, "entropy": 1.4426350415994724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.32, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38332, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -40.135311291953236}, "policy_reward_max": {"prey_policy": 40.135311291953236, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 10.455416537869116, "predator_policy": -10.455416537869116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 79, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.50574675136476, -25.858223474003402, 37.24408932068017, 23.010160667576063, 35.174335644188886, 23.94334773676288, 36.79144739313818, 15.86127150964187, -0.3852335800257265, 14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637], "policy_predator_policy_reward": [-10.50574675136476, 25.858223474003402, -37.24408932068017, -23.010160667576063, -35.174335644188886, -23.94334773676288, -36.79144739313818, -15.86127150964187, 0.3852335800257265, -14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28941376512940237, "mean_inference_ms": 0.968907492037703, "mean_action_processing_ms": 0.13063837789700639, "mean_env_wait_ms": 0.06620418752886613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003188610076904297, "StateBufferConnector_ms": 0.0020351409912109375, "ViewRequirementAgentConnector_ms": 0.05689442157745361}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 818.2685003994964, "num_env_steps_trained_throughput_per_sec": 818.2685003994964, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 5094.671, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5094.618, "sample_time_ms": 673.569, "learn_time_ms": 4409.184, "learn_throughput": 907.197, "synch_weights_time_ms": 11.44}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-48", "timestamp": 1723345308, "time_this_iter_s": 4.891219854354858, "time_total_s": 88.8354241847992, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.8354241847992, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.04285714285714, "ram_util_percent": 82.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0675630608263114, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.515326039493084, "policy_loss": -0.009593449842456418, "vf_loss": 5.523350263635318, "vf_explained_var": 0.09905238493035237, "kl": 0.020922970901041064, "entropy": 0.9398310637101531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.180051389647027, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.004169594993194, "policy_loss": -0.0041852402699684415, "vf_loss": 4.0077830957869685, "vf_explained_var": 0.1286612642928958, "kl": 0.011434798626120145, "entropy": 1.4342263750731945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.53, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38653, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 10.359920818302221, "predator_policy": -10.359920818302221}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [14.244603641393134, 24.95152233534225, 28.786159961150478, 40.135311291953236, 21.78727569048831, -9.515956176674125, 27.643263428510746, 31.70891996523953, 8.570217823821636, 21.73049114707457, -14.050910208203732, 11.490974678006665, 33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325], "policy_predator_policy_reward": [-14.244603641393134, -24.95152233534225, -28.786159961150478, -40.135311291953236, -21.78727569048831, 9.515956176674125, -27.643263428510746, -31.70891996523953, -8.570217823821636, -21.73049114707457, 14.050910208203732, -11.490974678006665, -33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2888937211452137, "mean_inference_ms": 0.967266249535596, "mean_action_processing_ms": 0.13050638102965156, "mean_env_wait_ms": 0.06584124326610519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030721426010131836, "StateBufferConnector_ms": 0.0020405054092407227, "ViewRequirementAgentConnector_ms": 0.05649304389953613}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.3631039474274, "num_env_steps_trained_throughput_per_sec": 780.3631039474274, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 5109.965, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5109.925, "sample_time_ms": 677.168, "learn_time_ms": 4421.237, "learn_throughput": 904.724, "synch_weights_time_ms": 11.136}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-53", "timestamp": 1723345313, "time_this_iter_s": 5.128389120101929, "time_total_s": 93.96381330490112, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4981b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.96381330490112, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 28.325, "ram_util_percent": 82.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0996882155227166, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.689456436534723, "policy_loss": -0.01018588217824193, "vf_loss": 5.698647481699784, "vf_explained_var": 0.1678737575188279, "kl": 0.008843002652292379, "entropy": 0.9070074183866381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9266039537265898, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.167208239684502, "policy_loss": -0.008747616305966707, "vf_loss": 4.175187268853188, "vf_explained_var": 0.3825966985275348, "kl": 0.0153718157712127, "entropy": 1.4295985416819652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.5, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38650, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 10.541419599516804, "predator_policy": -10.541419599516804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [33.208004739060804, 19.134983413571362, 36.93305270642909, 23.1855157670345, -1.9684765061649188, 12.868347806024463, 36.24624074908272, 16.959061357235008, 8.425796673599848, 22.699697400237163, -11.937124417527407, -6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737], "policy_predator_policy_reward": [-33.208004739060804, -19.134983413571362, -36.93305270642909, -23.1855157670345, 1.9684765061649188, -12.868347806024463, -36.24624074908272, -16.959061357235008, -8.425796673599848, -22.699697400237163, 11.937124417527407, 6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2878278270945288, "mean_inference_ms": 0.9647321710229524, "mean_action_processing_ms": 0.13028008763573992, "mean_env_wait_ms": 0.06556212004441125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030885934829711914, "StateBufferConnector_ms": 0.0020453929901123047, "ViewRequirementAgentConnector_ms": 0.05658078193664551}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 817.340868797263, "num_env_steps_trained_throughput_per_sec": 817.340868797263, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 5087.054, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5087.014, "sample_time_ms": 670.146, "learn_time_ms": 4405.379, "learn_throughput": 907.981, "synch_weights_time_ms": 11.098}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-01-58", "timestamp": 1723345318, "time_this_iter_s": 4.8965699672698975, "time_total_s": 98.86038327217102, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.86038327217102, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.099999999999998, "ram_util_percent": 82.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3770971061040957, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.530425317833821, "policy_loss": -0.002979946930039053, "vf_loss": 4.53317953919371, "vf_explained_var": 0.16536005660891534, "kl": 0.0020063505786376465, "entropy": 0.8762744370227059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.378520068898797, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.239692921439807, "policy_loss": -0.007595760000792022, "vf_loss": 4.246614203602076, "vf_explained_var": 0.1439784411340952, "kl": 0.013489746959352768, "entropy": 1.4563542868942023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.5, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38650, "policy_reward_min": {"prey_policy": -41.357808221953846, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 41.357808221953846}, "policy_reward_mean": {"prey_policy": 10.965297413285588, "predator_policy": -10.965297413285588}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 84, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-6.056611493468473, 6.057820038203452, 25.428031425759485, -12.943503191080389, 4.887582632169337, -1.6952932830571399, -24.182208585869446, 23.118727029743006, 9.19500432427904, -41.357808221953846, 38.59907905495182, 31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586], "policy_predator_policy_reward": [6.056611493468473, -6.057820038203452, -25.428031425759485, 12.943503191080389, -4.887582632169337, 1.6952932830571399, 24.182208585869446, -23.118727029743006, -9.19500432427904, 41.357808221953846, -38.59907905495182, -31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28726879963169033, "mean_inference_ms": 0.9626312002299894, "mean_action_processing_ms": 0.13013173419525256, "mean_env_wait_ms": 0.06540732252599409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029958486557006836, "StateBufferConnector_ms": 0.002021312713623047, "ViewRequirementAgentConnector_ms": 0.05587899684906006}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.7611602925241, "num_env_steps_trained_throughput_per_sec": 781.7611602925241, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 5103.905, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5103.865, "sample_time_ms": 668.106, "learn_time_ms": 4424.219, "learn_throughput": 904.114, "synch_weights_time_ms": 11.149}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-03", "timestamp": 1723345323, "time_this_iter_s": 5.119387865066528, "time_total_s": 103.97977113723755, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.97977113723755, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 31.457142857142856, "ram_util_percent": 82.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.423427166355153, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.154648824036121, "policy_loss": -0.0034076235700922553, "vf_loss": 5.157682713866234, "vf_explained_var": 0.2129496604204178, "kl": 0.006644565095880088, "entropy": 0.9200602471828461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9052284645847974, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.923945859819651, "policy_loss": -0.008987920073559507, "vf_loss": 3.9321070407827694, "vf_explained_var": 0.2609210533400377, "kl": 0.016534360061513775, "entropy": 1.47073620830973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.75, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39275, "policy_reward_min": {"prey_policy": -30.96845765948495, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 30.96845765948495}, "policy_reward_mean": {"prey_policy": 11.917447883751175, "predator_policy": -11.917447883751175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [31.249944675354172, 3.1336110012083864, 20.92779959649534, 4.619865861398662, 32.95372429106043, -11.967675851738363, 8.360282207808783, 15.408122164848187, 4.346486211528717, 10.396512384121316, 4.6903563579936645, 8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185], "policy_predator_policy_reward": [-31.249944675354172, -3.1336110012083864, -20.92779959649534, -4.619865861398662, -32.95372429106043, 11.967675851738363, -8.360282207808783, -15.408122164848187, -4.346486211528717, -10.396512384121316, -4.6903563579936645, -8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2885084789669582, "mean_inference_ms": 0.9668418400593956, "mean_action_processing_ms": 0.1310540256447732, "mean_env_wait_ms": 0.06550244939696856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003574371337890625, "StateBufferConnector_ms": 0.0021816492080688477, "ViewRequirementAgentConnector_ms": 0.07216858863830566}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 582.1161657410536, "num_env_steps_trained_throughput_per_sec": 582.1161657410536, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 5277.505, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5277.465, "sample_time_ms": 754.37, "learn_time_ms": 4511.328, "learn_throughput": 886.657, "synch_weights_time_ms": 11.362}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-10", "timestamp": 1723345330, "time_this_iter_s": 6.891613245010376, "time_total_s": 110.87138438224792, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4981b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 110.87138438224792, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 54.089999999999996, "ram_util_percent": 82.09}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.386563648159305, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.861520412315925, "policy_loss": -0.013384110479576824, "vf_loss": 4.873938643435637, "vf_explained_var": 0.30276994649320843, "kl": 0.017171011241720387, "entropy": 0.8281926705191532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.901655816597243, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.352305080244938, "policy_loss": -0.0066844621889079765, "vf_loss": 4.358359613269568, "vf_explained_var": 0.20290314157803854, "kl": 0.01259867908596578, "entropy": 1.5231064268698296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.4, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38540, "policy_reward_min": {"prey_policy": -30.96845765948495, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 30.96845765948495}, "policy_reward_mean": {"prey_policy": 11.696352265713138, "predator_policy": -11.696352265713138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400], "policy_prey_policy_reward": [8.243179603669905, 4.26209653910303, -10.674400168057971, 2.9496143664450756, 1.6128801326452802, 13.571199374674627, -0.8993122395111897, -7.91691829923629, 32.193436724407235, 23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318], "policy_predator_policy_reward": [-8.243179603669905, -4.26209653910303, 10.674400168057971, -2.9496143664450756, -1.6128801326452802, -13.571199374674627, 0.8993122395111897, 7.91691829923629, -32.193436724407235, -23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2897275366042532, "mean_inference_ms": 0.9711703315248846, "mean_action_processing_ms": 0.13191024341748828, "mean_env_wait_ms": 0.06584792160209049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003575444221496582, "StateBufferConnector_ms": 0.002375483512878418, "ViewRequirementAgentConnector_ms": 0.07320058345794678}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.4114314771172, "num_env_steps_trained_throughput_per_sec": 785.4114314771172, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5272.549, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5272.509, "sample_time_ms": 755.481, "learn_time_ms": 4505.245, "learn_throughput": 887.854, "synch_weights_time_ms": 11.376}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-15", "timestamp": 1723345335, "time_this_iter_s": 5.095396995544434, "time_total_s": 115.96678137779236, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.96678137779236, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.97142857142858, "ram_util_percent": 81.97142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.219744413904846, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.451696294049422, "policy_loss": -0.000875235042864612, "vf_loss": 5.452266304691633, "vf_explained_var": 0.34777748535076775, "kl": 0.0054263639216222, "entropy": 0.889549720287323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.520317901329448, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.527132633825143, "policy_loss": -0.004959686183913921, "vf_loss": 4.531200669705868, "vf_explained_var": -0.1256040017430981, "kl": 0.01783297220581502, "entropy": 1.5714647876719634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.4, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38540, "policy_reward_min": {"prey_policy": -30.96845765948495, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 30.96845765948495}, "policy_reward_mean": {"prey_policy": 12.904956751492621, "predator_policy": -12.904956751492621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [23.954512827750516, 4.057772268076416, 21.416611093529895, -1.6167961701002582, -4.664140502496412, 28.312385024540255, 34.691377178362146, -26.250201571222373, -11.393668326515225, 4.740442503975736, -20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391], "policy_predator_policy_reward": [-23.954512827750516, -4.057772268076416, -21.416611093529895, 1.6167961701002582, 4.664140502496412, -28.312385024540255, -34.691377178362146, 26.250201571222373, 11.393668326515225, -4.740442503975736, 20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29061236643223853, "mean_inference_ms": 0.9736399375883319, "mean_action_processing_ms": 0.13240253850350736, "mean_env_wait_ms": 0.06599194943520843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034596920013427734, "StateBufferConnector_ms": 0.002330183982849121, "ViewRequirementAgentConnector_ms": 0.07158815860748291}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.0906192436757, "num_env_steps_trained_throughput_per_sec": 799.0906192436757, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 5245.718, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5245.684, "sample_time_ms": 746.605, "learn_time_ms": 4488.386, "learn_throughput": 891.189, "synch_weights_time_ms": 10.333}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-20", "timestamp": 1723345340, "time_this_iter_s": 5.008182048797607, "time_total_s": 120.97496342658997, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4981dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.97496342658997, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 28.52857142857143, "ram_util_percent": 81.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3205237689738474, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.660970148940881, "policy_loss": -0.002916234577666425, "vf_loss": 5.663473501304785, "vf_explained_var": 0.30827248487621545, "kl": 0.007339956019746315, "entropy": 0.7899616859853268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7599309580400586, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4650852801899115, "policy_loss": -0.005930465210743326, "vf_loss": 5.47028916378816, "vf_explained_var": -0.30473877551654976, "kl": 0.014531959041106556, "entropy": 1.569680476312836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 381.67, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38167, "policy_reward_min": {"prey_policy": -30.96845765948495, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 30.96845765948495}, "policy_reward_mean": {"prey_policy": 13.311881691639108, "predator_policy": -13.311881691639108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400], "policy_prey_policy_reward": [-20.101821652993273, 9.865287520873629, 39.207837005628754, 28.067069019368542, 25.28706364018954, 33.71493264286516, 4.959051905104854, -0.8101900265119895, -16.746143479912405, 31.258861920078758, 24.523645922750447, 37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964], "policy_predator_policy_reward": [20.101821652993273, -9.865287520873629, -39.207837005628754, -28.067069019368542, -25.28706364018954, -33.71493264286516, -4.959051905104854, 0.8101900265119895, 16.746143479912405, -31.258861920078758, -24.523645922750447, -37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29123942526644997, "mean_inference_ms": 0.9747821571450792, "mean_action_processing_ms": 0.13281759746416602, "mean_env_wait_ms": 0.06601486113797712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034879446029663086, "StateBufferConnector_ms": 0.0022591352462768555, "ViewRequirementAgentConnector_ms": 0.06161487102508545}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 812.844886560737, "num_env_steps_trained_throughput_per_sec": 812.844886560737, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 5195.741, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5195.71, "sample_time_ms": 729.502, "learn_time_ms": 4455.662, "learn_throughput": 897.734, "synch_weights_time_ms": 10.196}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-25", "timestamp": 1723345345, "time_this_iter_s": 4.923539161682129, "time_total_s": 125.8985025882721, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 125.8985025882721, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.285714285714285, "ram_util_percent": 81.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4061502259845535, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.507655463616053, "policy_loss": -0.004981043574419649, "vf_loss": 5.512084427475929, "vf_explained_var": 0.046358454724152884, "kl": 0.0098146876479046, "entropy": 0.8195017495503029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8912170983850958, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.473326517641544, "policy_loss": -0.00559393445631334, "vf_loss": 5.478178760409355, "vf_explained_var": -0.14475698669751486, "kl": 0.014833666526516553, "entropy": 1.5531937160839637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.87, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37787, "policy_reward_min": {"prey_policy": -30.96845765948495, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 30.96845765948495}, "policy_reward_mean": {"prey_policy": 12.823356652418619, "predator_policy": -12.823356652418619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400], "policy_prey_policy_reward": [37.29736154135423, 16.572292015282738, 22.269395447645064, -19.795195509340598, -1.7564945567107753, 27.4739028540328, 18.033998271825723, -30.96845765948495, -11.999601795159554, -14.090147106218394, -22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964, -5.554348655827297, 40.899571175537915, 15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054], "policy_predator_policy_reward": [-37.29736154135423, -16.572292015282738, -22.269395447645064, 19.795195509340598, 1.7564945567107753, -27.4739028540328, -18.033998271825723, 30.96845765948495, 11.999601795159554, 14.090147106218394, 22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964, 5.554348655827297, -40.899571175537915, -15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29199275607312214, "mean_inference_ms": 0.9764605813576219, "mean_action_processing_ms": 0.1332864661851505, "mean_env_wait_ms": 0.06605450139633981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523707389831543, "StateBufferConnector_ms": 0.002259492874145508, "ViewRequirementAgentConnector_ms": 0.06163740158081055}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 759.0347475272647, "num_env_steps_trained_throughput_per_sec": 759.0347475272647, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 5224.84, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5224.754, "sample_time_ms": 729.851, "learn_time_ms": 4483.5, "learn_throughput": 892.16, "synch_weights_time_ms": 10.807}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-30", "timestamp": 1723345350, "time_this_iter_s": 5.298181056976318, "time_total_s": 131.1966836452484, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 131.1966836452484, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.55, "ram_util_percent": 81.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.275670260594537, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.533702191958825, "policy_loss": -0.0039170114750353, "vf_loss": 5.53729800482591, "vf_explained_var": 0.05402880851179361, "kl": 0.005710020508524301, "entropy": 0.8612847569088141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9248738411813973, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6399760901927944, "policy_loss": -0.016407772942329757, "vf_loss": 5.655435183644295, "vf_explained_var": -0.0954521647344033, "kl": 0.01897344482253085, "entropy": 1.489404148235917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.87, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37787, "policy_reward_min": {"prey_policy": -29.92750960408509, "predator_policy": -48.69345003297944}, "policy_reward_max": {"prey_policy": 48.69345003297944, "predator_policy": 29.92750960408509}, "policy_reward_mean": {"prey_policy": 13.596593829503165, "predator_policy": -13.596593829503165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-22.710581386058834, 37.240084987214786, 10.215143174586743, -24.342967938436033, 2.83772281884848, 18.755769984282637, 39.5047328467791, 17.728295869328853, 15.478713751608034, 48.69345003297944, -29.92750960408509, 27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964, -5.554348655827297, 40.899571175537915, 15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054, -22.932542440226452, 29.91069069070727, 41.160454221174, -7.403093982639113, 18.223605271354195, 27.469353470317436, 20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594], "policy_predator_policy_reward": [22.710581386058834, -37.240084987214786, -10.215143174586743, 24.342967938436033, -2.83772281884848, -18.755769984282637, -39.5047328467791, -17.728295869328853, -15.478713751608034, -48.69345003297944, 29.92750960408509, -27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964, 5.554348655827297, -40.899571175537915, -15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054, 22.932542440226452, -29.91069069070727, -41.160454221174, 7.403093982639113, -18.223605271354195, -27.469353470317436, -20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29292317050916816, "mean_inference_ms": 0.9786743038906127, "mean_action_processing_ms": 0.1337234255274027, "mean_env_wait_ms": 0.06614609602071377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00364077091217041, "StateBufferConnector_ms": 0.0022749900817871094, "ViewRequirementAgentConnector_ms": 0.061540842056274414}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 769.774182903736, "num_env_steps_trained_throughput_per_sec": 769.774182903736, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 5238.207, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5238.121, "sample_time_ms": 742.078, "learn_time_ms": 4484.551, "learn_throughput": 891.951, "synch_weights_time_ms": 10.898}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-35", "timestamp": 1723345355, "time_this_iter_s": 5.198995113372803, "time_total_s": 136.39567875862122, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4981dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 136.39567875862122, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.328571428571426, "ram_util_percent": 81.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.063050031599899, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.264994023740291, "policy_loss": -0.004753587405624178, "vf_loss": 6.2694974785049755, "vf_explained_var": 0.1465585846453905, "kl": 0.004446883108494474, "entropy": 0.7725548206518094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2970555434003472, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.937533922493458, "policy_loss": -0.007924361879607508, "vf_loss": 4.944669394443433, "vf_explained_var": 0.17146623302251102, "kl": 0.01577802264694577, "entropy": 1.4875036446998517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 378.5, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37850, "policy_reward_min": {"prey_policy": -29.182387404744176, "predator_policy": -46.45233718421952}, "policy_reward_max": {"prey_policy": 46.45233718421952, "predator_policy": 29.182387404744176}, "policy_reward_mean": {"prey_policy": 13.293056734200547, "predator_policy": -13.293056734200547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400], "policy_prey_policy_reward": [27.222661431475252, 21.05833325247591, -25.577209438770595, 32.55590187084325, 24.89498268844367, 18.418702995207767, -10.835039797595002, 32.287006517428864, 18.29331683333867, 29.728030482196075, 15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964, -5.554348655827297, 40.899571175537915, 15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054, -22.932542440226452, 29.91069069070727, 41.160454221174, -7.403093982639113, 18.223605271354195, 27.469353470317436, 20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594, -23.958889798758705, -12.05554786723022, 40.36539911136443, -5.748243358901078, 46.45233718421952, 29.754677282450224, -0.723545172544263, 34.27115973635655, 4.625140717522584, -29.182387404744176, -0.6809554229487205], "policy_predator_policy_reward": [-27.222661431475252, -21.05833325247591, 25.577209438770595, -32.55590187084325, -24.89498268844367, -18.418702995207767, 10.835039797595002, -32.287006517428864, -18.29331683333867, -29.728030482196075, -15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964, 5.554348655827297, -40.899571175537915, -15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054, 22.932542440226452, -29.91069069070727, -41.160454221174, 7.403093982639113, -18.223605271354195, -27.469353470317436, -20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594, 23.958889798758705, 12.05554786723022, -40.36539911136443, 5.748243358901078, -46.45233718421952, -29.754677282450224, 0.723545172544263, -34.27115973635655, -4.625140717522584, 29.182387404744176, 0.6809554229487205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29381097523458655, "mean_inference_ms": 0.9812582176510428, "mean_action_processing_ms": 0.13421682074137878, "mean_env_wait_ms": 0.06629342922284223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037314891815185547, "StateBufferConnector_ms": 0.002275705337524414, "ViewRequirementAgentConnector_ms": 0.06209063529968262}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.970744239757, "num_env_steps_trained_throughput_per_sec": 797.970744239757, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 5250.642, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5250.554, "sample_time_ms": 742.992, "learn_time_ms": 4496.097, "learn_throughput": 889.661, "synch_weights_time_ms": 10.875}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-40", "timestamp": 1723345360, "time_this_iter_s": 5.015224933624268, "time_total_s": 141.41090369224548, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.41090369224548, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.428571428571427, "ram_util_percent": 81.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.082566102935622, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.431006221473217, "policy_loss": -0.004102227756326708, "vf_loss": 5.434944515426953, "vf_explained_var": 0.2730953924357891, "kl": 0.005828497093106814, "entropy": 0.8060454749191801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2420327835405867, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6717769992848237, "policy_loss": -0.011322280029222991, "vf_loss": 3.6821246509750685, "vf_explained_var": 0.4017317697405815, "kl": 0.019492519664754227, "entropy": 1.4989288258055846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.32, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38232, "policy_reward_min": {"prey_policy": -29.182387404744176, "predator_policy": -46.45233718421952}, "policy_reward_max": {"prey_policy": 46.45233718421952, "predator_policy": 29.182387404744176}, "policy_reward_mean": {"prey_policy": 13.452905065203982, "predator_policy": -13.452905065203982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [15.972556026323467, 10.984904709914879, -14.832353423681141, 43.38416416934806, 36.174636241758144, 21.16084425687737, 24.241620192038233, 12.11653889117322, 24.016239734709067, -7.907601740933295, 33.37253638951729, 23.16104076220531, 30.088461236420308, -0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964, -5.554348655827297, 40.899571175537915, 15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054, -22.932542440226452, 29.91069069070727, 41.160454221174, -7.403093982639113, 18.223605271354195, 27.469353470317436, 20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594, -23.958889798758705, -12.05554786723022, 40.36539911136443, -5.748243358901078, 46.45233718421952, 29.754677282450224, -0.723545172544263, 34.27115973635655, 4.625140717522584, -29.182387404744176, -0.6809554229487205, 21.347466768947704, 30.470518650164095, 20.505050642308987, -6.082100015137922, 11.779988618230448, 40.716507108271514, -5.465760914812492, 31.43217635219539, 4.462505705544757, 34.865167019675], "policy_predator_policy_reward": [-15.972556026323467, -10.984904709914879, 14.832353423681141, -43.38416416934806, -36.174636241758144, -21.16084425687737, -24.241620192038233, -12.11653889117322, -24.016239734709067, 7.907601740933295, -33.37253638951729, -23.16104076220531, -30.088461236420308, 0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964, 5.554348655827297, -40.899571175537915, -15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054, 22.932542440226452, -29.91069069070727, -41.160454221174, 7.403093982639113, -18.223605271354195, -27.469353470317436, -20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594, 23.958889798758705, 12.05554786723022, -40.36539911136443, 5.748243358901078, -46.45233718421952, -29.754677282450224, 0.723545172544263, -34.27115973635655, -4.625140717522584, 29.182387404744176, 0.6809554229487205, -21.347466768947704, -30.470518650164095, -20.505050642308987, 6.082100015137922, -11.779988618230448, -40.716507108271514, 5.465760914812492, -31.43217635219539, -4.462505705544757, -34.865167019675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2946985477409908, "mean_inference_ms": 0.9837399785104648, "mean_action_processing_ms": 0.13465308040300966, "mean_env_wait_ms": 0.06645923375815682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003697037696838379, "StateBufferConnector_ms": 0.002261519432067871, "ViewRequirementAgentConnector_ms": 0.06155824661254883}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 751.4526875542772, "num_env_steps_trained_throughput_per_sec": 751.4526875542772, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 5270.363, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5270.275, "sample_time_ms": 738.358, "learn_time_ms": 4520.418, "learn_throughput": 884.874, "synch_weights_time_ms": 10.911}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-46", "timestamp": 1723345366, "time_this_iter_s": 5.326864004135132, "time_total_s": 146.73776769638062, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.73776769638062, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.6625, "ram_util_percent": 82.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2084083365276457, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.469252387434244, "policy_loss": -0.005427249452380541, "vf_loss": 5.474384470532338, "vf_explained_var": 0.19551946440090737, "kl": 0.010494765052212014, "entropy": 0.808124985297521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3157601380720734, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.100246923665206, "policy_loss": -0.009245564133258692, "vf_loss": 4.1082988033692045, "vf_explained_var": -0.05978061382969221, "kl": 0.023873944513732644, "entropy": 1.4766677339871725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 375.94, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37594, "policy_reward_min": {"prey_policy": -42.520067572023024, "predator_policy": -46.45233718421952}, "policy_reward_max": {"prey_policy": 46.45233718421952, "predator_policy": 42.520067572023024}, "policy_reward_mean": {"prey_policy": 12.789140838252834, "predator_policy": -12.789140838252834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 316, 400, 400, 400, 400, 400, 400, 400, 157], "policy_prey_policy_reward": [-0.13943922657434626, 35.191912851565725, 23.103153052283854, 40.89841892305586, -1.4413435449353003, -7.091667610983748, 28.022727294831796, 11.461152848957031, 6.489150539444225, 12.031136606431204, 0.985238561678873, 8.607738039239727, -9.72899577119049, 32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964, -5.554348655827297, 40.899571175537915, 15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054, -22.932542440226452, 29.91069069070727, 41.160454221174, -7.403093982639113, 18.223605271354195, 27.469353470317436, 20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594, -23.958889798758705, -12.05554786723022, 40.36539911136443, -5.748243358901078, 46.45233718421952, 29.754677282450224, -0.723545172544263, 34.27115973635655, 4.625140717522584, -29.182387404744176, -0.6809554229487205, 21.347466768947704, 30.470518650164095, 20.505050642308987, -6.082100015137922, 11.779988618230448, 40.716507108271514, -5.465760914812492, 31.43217635219539, 4.462505705544757, 34.865167019675, 26.77066199581178, -10.282808286333704, 35.88142655054395, -42.520067572023024, -15.288337510431454, 24.03978766038798, 30.874543076671436, 36.20214694460272, 37.51955340006948, 27.723445742221898, 31.773961334873015, 26.090662375742518, -23.227810961580538], "policy_predator_policy_reward": [0.13943922657434626, -35.191912851565725, -23.103153052283854, -40.89841892305586, 1.4413435449353003, 7.091667610983748, -28.022727294831796, -11.461152848957031, -6.489150539444225, -12.031136606431204, -0.985238561678873, -8.607738039239727, 9.72899577119049, -32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964, 5.554348655827297, -40.899571175537915, -15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054, 22.932542440226452, -29.91069069070727, -41.160454221174, 7.403093982639113, -18.223605271354195, -27.469353470317436, -20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594, 23.958889798758705, 12.05554786723022, -40.36539911136443, 5.748243358901078, -46.45233718421952, -29.754677282450224, 0.723545172544263, -34.27115973635655, -4.625140717522584, 29.182387404744176, 0.6809554229487205, -21.347466768947704, -30.470518650164095, -20.505050642308987, 6.082100015137922, -11.779988618230448, -40.716507108271514, 5.465760914812492, -31.43217635219539, -4.462505705544757, -34.865167019675, -26.77066199581178, 10.282808286333704, -35.88142655054395, 42.520067572023024, 15.288337510431454, -24.03978766038798, -30.874543076671436, -36.20214694460272, -37.51955340006948, -27.723445742221898, -31.773961334873015, -26.090662375742518, 23.227810961580538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2958025379978184, "mean_inference_ms": 0.986793263436421, "mean_action_processing_ms": 0.1351346520451603, "mean_env_wait_ms": 0.06664390973950779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742814064025879, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.06196117401123047}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 790.8573783893897, "num_env_steps_trained_throughput_per_sec": 790.8573783893897, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 5286.751, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5286.664, "sample_time_ms": 738.961, "learn_time_ms": 4536.185, "learn_throughput": 881.798, "synch_weights_time_ms": 10.934}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 29, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-51", "timestamp": 1723345371, "time_this_iter_s": 5.061259746551514, "time_total_s": 151.79902744293213, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 151.79902744293213, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.21428571428572, "ram_util_percent": 82.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4829113729918997, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.3083058978120485, "policy_loss": -0.005609976793736374, "vf_loss": 6.313310734927654, "vf_explained_var": 0.2512412132074436, "kl": 0.02151713314406236, "entropy": 0.8362813187763095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.820636682274441, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.910428982476393, "policy_loss": -0.01436582648869565, "vf_loss": 6.922845137615998, "vf_explained_var": -0.0019665544231732687, "kl": 0.025995610206652205, "entropy": 1.4674825278421244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.67, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 36667, "policy_reward_min": {"prey_policy": -45.0998359719822, "predator_policy": -46.45233718421952}, "policy_reward_max": {"prey_policy": 46.45233718421952, "predator_policy": 45.0998359719822}, "policy_reward_mean": {"prey_policy": 11.046685893335765, "predator_policy": -11.046685893335765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 316, 400, 400, 400, 400, 400, 400, 400, 157, 400, 9, 400, 400, 400, 400, 97, 302, 400, 333, 400, 332, 400], "policy_prey_policy_reward": [32.68104117861378, 34.249688634148185, 7.62863451749142, 8.78639697980097, -2.879340220203865, 31.288596537385402, 25.18487067330637, -2.1789752094352934, 29.876210957592598, -10.288905505766929, 22.804872040416335, -25.10582421722762, 16.892930542916318, 24.593400545012166, 3.886405829456031, -5.75268686729423, 26.377644656763074, 10.225041449689524, 29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964, -5.554348655827297, 40.899571175537915, 15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054, -22.932542440226452, 29.91069069070727, 41.160454221174, -7.403093982639113, 18.223605271354195, 27.469353470317436, 20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594, -23.958889798758705, -12.05554786723022, 40.36539911136443, -5.748243358901078, 46.45233718421952, 29.754677282450224, -0.723545172544263, 34.27115973635655, 4.625140717522584, -29.182387404744176, -0.6809554229487205, 21.347466768947704, 30.470518650164095, 20.505050642308987, -6.082100015137922, 11.779988618230448, 40.716507108271514, -5.465760914812492, 31.43217635219539, 4.462505705544757, 34.865167019675, 26.77066199581178, -10.282808286333704, 35.88142655054395, -42.520067572023024, -15.288337510431454, 24.03978766038798, 30.874543076671436, 36.20214694460272, 37.51955340006948, 27.723445742221898, 31.773961334873015, 26.090662375742518, -23.227810961580538, 18.76708353532495, -4.874872398462484, -15.481646563547415, 8.351171521610041, 2.7669379061451522, 8.357911118034469, -28.244549300004543, -22.847234696143868, 23.306824297752648, -27.62616361324395, 26.87249235817515, -45.0998359719822, 29.895569878439616], "policy_predator_policy_reward": [-32.68104117861378, -34.249688634148185, -7.62863451749142, -8.78639697980097, 2.879340220203865, -31.288596537385402, -25.18487067330637, 2.1789752094352934, -29.876210957592598, 10.288905505766929, -22.804872040416335, 25.10582421722762, -16.892930542916318, -24.593400545012166, -3.886405829456031, 5.75268686729423, -26.377644656763074, -10.225041449689524, -29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964, 5.554348655827297, -40.899571175537915, -15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054, 22.932542440226452, -29.91069069070727, -41.160454221174, 7.403093982639113, -18.223605271354195, -27.469353470317436, -20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594, 23.958889798758705, 12.05554786723022, -40.36539911136443, 5.748243358901078, -46.45233718421952, -29.754677282450224, 0.723545172544263, -34.27115973635655, -4.625140717522584, 29.182387404744176, 0.6809554229487205, -21.347466768947704, -30.470518650164095, -20.505050642308987, 6.082100015137922, -11.779988618230448, -40.716507108271514, 5.465760914812492, -31.43217635219539, -4.462505705544757, -34.865167019675, -26.77066199581178, 10.282808286333704, -35.88142655054395, 42.520067572023024, 15.288337510431454, -24.03978766038798, -30.874543076671436, -36.20214694460272, -37.51955340006948, -27.723445742221898, -31.773961334873015, -26.090662375742518, 23.227810961580538, -18.76708353532495, 4.874872398462484, 15.481646563547415, -8.351171521610041, -2.7669379061451522, -8.357911118034469, 28.244549300004543, 22.847234696143868, -23.306824297752648, 27.62616361324395, -26.87249235817515, 45.0998359719822, -29.895569878439616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2956265813461338, "mean_inference_ms": 0.9852662617522263, "mean_action_processing_ms": 0.13489912076544683, "mean_env_wait_ms": 0.06652689443952656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034945011138916016, "StateBufferConnector_ms": 0.002202272415161133, "ViewRequirementAgentConnector_ms": 0.05474555492401123}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.74812004744, "num_env_steps_trained_throughput_per_sec": 801.74812004744, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 5273.996, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5273.908, "sample_time_ms": 742.399, "learn_time_ms": 4520.093, "learn_throughput": 884.938, "synch_weights_time_ms": 10.833}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 30, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-02-56", "timestamp": 1723345376, "time_this_iter_s": 4.9918272495269775, "time_total_s": 156.7908546924591, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.7908546924591, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.957142857142856, "ram_util_percent": 82.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3252057451133927, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.507321040332317, "policy_loss": -0.00512302238518411, "vf_loss": 7.511452658474445, "vf_explained_var": 0.29475862470765907, "kl": 0.023500596045885894, "entropy": 0.8168253876268864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0544458710278075, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.07038188079993, "policy_loss": -0.005463867369204915, "vf_loss": 8.074523708224296, "vf_explained_var": -0.1034159736086925, "kl": 0.011751345658753942, "entropy": 1.447833838313818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 339.03, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 33903, "policy_reward_min": {"prey_policy": -45.0998359719822, "predator_policy": -53.60007481135533}, "policy_reward_max": {"prey_policy": 53.60007481135533, "predator_policy": 45.0998359719822}, "policy_reward_mean": {"prey_policy": 6.040101290753015, "predator_policy": -6.040101290753015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 316, 400, 400, 400, 400, 400, 400, 400, 157, 400, 9, 400, 400, 400, 400, 97, 302, 400, 333, 400, 332, 400, 180, 182, 176, 98, 123, 212, 210, 28, 175, 310, 394, 400, 250, 117, 132, 251, 400, 63], "policy_prey_policy_reward": [29.08543626609427, 31.49299070443734, 10.304409896965993, 33.98958213096391, 20.173888612772156, 26.870920559562215, 0.7249197980198652, 10.703699313907514, 22.350998786756975, -0.8493980483067247, 13.20377175007161, -3.8994906788918695, 17.764755598793762, 6.896722647863964, -5.554348655827297, 40.899571175537915, 15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054, -22.932542440226452, 29.91069069070727, 41.160454221174, -7.403093982639113, 18.223605271354195, 27.469353470317436, 20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594, -23.958889798758705, -12.05554786723022, 40.36539911136443, -5.748243358901078, 46.45233718421952, 29.754677282450224, -0.723545172544263, 34.27115973635655, 4.625140717522584, -29.182387404744176, -0.6809554229487205, 21.347466768947704, 30.470518650164095, 20.505050642308987, -6.082100015137922, 11.779988618230448, 40.716507108271514, -5.465760914812492, 31.43217635219539, 4.462505705544757, 34.865167019675, 26.77066199581178, -10.282808286333704, 35.88142655054395, -42.520067572023024, -15.288337510431454, 24.03978766038798, 30.874543076671436, 36.20214694460272, 37.51955340006948, 27.723445742221898, 31.773961334873015, 26.090662375742518, -23.227810961580538, 18.76708353532495, -4.874872398462484, -15.481646563547415, 8.351171521610041, 2.7669379061451522, 8.357911118034469, -28.244549300004543, -22.847234696143868, 23.306824297752648, -27.62616361324395, 26.87249235817515, -45.0998359719822, 29.895569878439616, -24.552628198151158, -24.465296142760955, -14.44221142320248, -35.15043009408508, -14.275124340975466, -30.962830371174455, -40.081552538337874, -4.015036043834786, -27.61492684400922, -3.409788168371975, -17.63002137537114, 53.60007481135533, -36.13452614825498, -10.386158757006372, -11.36839188729007, -37.10136205796247, 24.06421381936085, -18.4624619755384], "policy_predator_policy_reward": [-29.08543626609427, -31.49299070443734, -10.304409896965993, -33.98958213096391, -20.173888612772156, -26.870920559562215, -0.7249197980198652, -10.703699313907514, -22.350998786756975, 0.8493980483067247, -13.20377175007161, 3.8994906788918695, -17.764755598793762, -6.896722647863964, 5.554348655827297, -40.899571175537915, -15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054, 22.932542440226452, -29.91069069070727, -41.160454221174, 7.403093982639113, -18.223605271354195, -27.469353470317436, -20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594, 23.958889798758705, 12.05554786723022, -40.36539911136443, 5.748243358901078, -46.45233718421952, -29.754677282450224, 0.723545172544263, -34.27115973635655, -4.625140717522584, 29.182387404744176, 0.6809554229487205, -21.347466768947704, -30.470518650164095, -20.505050642308987, 6.082100015137922, -11.779988618230448, -40.716507108271514, 5.465760914812492, -31.43217635219539, -4.462505705544757, -34.865167019675, -26.77066199581178, 10.282808286333704, -35.88142655054395, 42.520067572023024, 15.288337510431454, -24.03978766038798, -30.874543076671436, -36.20214694460272, -37.51955340006948, -27.723445742221898, -31.773961334873015, -26.090662375742518, 23.227810961580538, -18.76708353532495, 4.874872398462484, 15.481646563547415, -8.351171521610041, -2.7669379061451522, -8.357911118034469, 28.244549300004543, 22.847234696143868, -23.306824297752648, 27.62616361324395, -26.87249235817515, 45.0998359719822, -29.895569878439616, 24.552628198151158, 24.465296142760955, 14.44221142320248, 35.15043009408508, 14.275124340975466, 30.962830371174455, 40.081552538337874, 4.015036043834786, 27.61492684400922, 3.409788168371975, 17.63002137537114, -53.60007481135533, 36.13452614825498, 10.386158757006372, 11.36839188729007, 37.10136205796247, -24.06421381936085, 18.4624619755384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29420224559861397, "mean_inference_ms": 0.9797012382671122, "mean_action_processing_ms": 0.13408005265663914, "mean_env_wait_ms": 0.06608994345786384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003270864486694336, "StateBufferConnector_ms": 0.0019854307174682617, "ViewRequirementAgentConnector_ms": 0.045865416526794434}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 790.0930194576915, "num_env_steps_trained_throughput_per_sec": 790.0930194576915, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 5093.117, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5093.03, "sample_time_ms": 654.497, "learn_time_ms": 4427.366, "learn_throughput": 903.472, "synch_weights_time_ms": 10.6}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 31, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-01", "timestamp": 1723345381, "time_this_iter_s": 5.0655176639556885, "time_total_s": 161.8563723564148, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 161.8563723564148, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.400000000000002, "ram_util_percent": 82.4857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.688627109459291, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.738218485067288, "policy_loss": -0.007270594504370819, "vf_loss": 5.744453388700882, "vf_explained_var": 0.320069237301747, "kl": 0.01636618966397344, "entropy": 0.7517087367673715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.257900679670274, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.357326965530714, "policy_loss": -0.0025670777266592875, "vf_loss": 6.358937697112561, "vf_explained_var": -0.09042908605188131, "kl": 0.008500666127905673, "entropy": 1.4683501151700815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 317.77, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 31777, "policy_reward_min": {"prey_policy": -55.25392449674416, "predator_policy": -55.52760185871987}, "policy_reward_max": {"prey_policy": 55.52760185871987, "predator_policy": 55.25392449674416}, "policy_reward_mean": {"prey_policy": 2.7598652134227804, "predator_policy": -2.7598652134227804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 316, 400, 400, 400, 400, 400, 400, 400, 157, 400, 9, 400, 400, 400, 400, 97, 302, 400, 333, 400, 332, 400, 180, 182, 176, 98, 123, 212, 210, 28, 175, 310, 394, 400, 250, 117, 132, 251, 400, 63, 174, 220, 127, 400, 400, 336, 50, 400, 177, 87, 170, 400, 203, 202, 400, 155], "policy_prey_policy_reward": [15.455289138984512, 17.33148043164421, 26.50436186419131, -1.5587915958858432, 38.55151029447807, 3.1853150862154322, -14.101885167040257, 5.782530880925616, -16.12194295783054, -22.932542440226452, 29.91069069070727, 41.160454221174, -7.403093982639113, 18.223605271354195, 27.469353470317436, 20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594, -23.958889798758705, -12.05554786723022, 40.36539911136443, -5.748243358901078, 46.45233718421952, 29.754677282450224, -0.723545172544263, 34.27115973635655, 4.625140717522584, -29.182387404744176, -0.6809554229487205, 21.347466768947704, 30.470518650164095, 20.505050642308987, -6.082100015137922, 11.779988618230448, 40.716507108271514, -5.465760914812492, 31.43217635219539, 4.462505705544757, 34.865167019675, 26.77066199581178, -10.282808286333704, 35.88142655054395, -42.520067572023024, -15.288337510431454, 24.03978766038798, 30.874543076671436, 36.20214694460272, 37.51955340006948, 27.723445742221898, 31.773961334873015, 26.090662375742518, -23.227810961580538, 18.76708353532495, -4.874872398462484, -15.481646563547415, 8.351171521610041, 2.7669379061451522, 8.357911118034469, -28.244549300004543, -22.847234696143868, 23.306824297752648, -27.62616361324395, 26.87249235817515, -45.0998359719822, 29.895569878439616, -24.552628198151158, -24.465296142760955, -14.44221142320248, -35.15043009408508, -14.275124340975466, -30.962830371174455, -40.081552538337874, -4.015036043834786, -27.61492684400922, -3.409788168371975, -17.63002137537114, 53.60007481135533, -36.13452614825498, -10.386158757006372, -11.36839188729007, -37.10136205796247, 24.06421381936085, -18.4624619755384, -16.462496562062988, -32.086702636364464, -55.25392449674416, 55.52760185871987, 33.20220364978298, -39.689468837063735, -10.483916217467605, 35.17074724205315, -13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195], "policy_predator_policy_reward": [-15.455289138984512, -17.33148043164421, -26.50436186419131, 1.5587915958858432, -38.55151029447807, -3.1853150862154322, 14.101885167040257, -5.782530880925616, 16.12194295783054, 22.932542440226452, -29.91069069070727, -41.160454221174, 7.403093982639113, -18.223605271354195, -27.469353470317436, -20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594, 23.958889798758705, 12.05554786723022, -40.36539911136443, 5.748243358901078, -46.45233718421952, -29.754677282450224, 0.723545172544263, -34.27115973635655, -4.625140717522584, 29.182387404744176, 0.6809554229487205, -21.347466768947704, -30.470518650164095, -20.505050642308987, 6.082100015137922, -11.779988618230448, -40.716507108271514, 5.465760914812492, -31.43217635219539, -4.462505705544757, -34.865167019675, -26.77066199581178, 10.282808286333704, -35.88142655054395, 42.520067572023024, 15.288337510431454, -24.03978766038798, -30.874543076671436, -36.20214694460272, -37.51955340006948, -27.723445742221898, -31.773961334873015, -26.090662375742518, 23.227810961580538, -18.76708353532495, 4.874872398462484, 15.481646563547415, -8.351171521610041, -2.7669379061451522, -8.357911118034469, 28.244549300004543, 22.847234696143868, -23.306824297752648, 27.62616361324395, -26.87249235817515, 45.0998359719822, -29.895569878439616, 24.552628198151158, 24.465296142760955, 14.44221142320248, 35.15043009408508, 14.275124340975466, 30.962830371174455, 40.081552538337874, 4.015036043834786, 27.61492684400922, 3.409788168371975, 17.63002137537114, -53.60007481135533, 36.13452614825498, 10.386158757006372, 11.36839188729007, 37.10136205796247, -24.06421381936085, 18.4624619755384, 16.462496562062988, 32.086702636364464, 55.25392449674416, -55.52760185871987, -33.20220364978298, 39.689468837063735, 10.483916217467605, -35.17074724205315, 13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29347533524305985, "mean_inference_ms": 0.9763126353339863, "mean_action_processing_ms": 0.13340940558444148, "mean_env_wait_ms": 0.065811165997933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003258228302001953, "StateBufferConnector_ms": 0.002005934715270996, "ViewRequirementAgentConnector_ms": 0.04662799835205078}, "num_episodes": 16, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.5394323176507, "num_env_steps_trained_throughput_per_sec": 811.5394323176507, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 5076.72, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5076.632, "sample_time_ms": 645.269, "learn_time_ms": 4420.004, "learn_throughput": 904.977, "synch_weights_time_ms": 10.792}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 32, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-06", "timestamp": 1723345386, "time_this_iter_s": 4.931695222854614, "time_total_s": 166.7880675792694, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.7880675792694, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.87142857142857, "ram_util_percent": 82.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9993488780533273, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.572423280775547, "policy_loss": -0.0003576276074454654, "vf_loss": 6.5725384801626205, "vf_explained_var": 0.4037557085355123, "kl": 0.00383088528385586, "entropy": 0.7890876986086368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.511267158327003, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.071236061056455, "policy_loss": -0.005083210833011738, "vf_loss": 7.075372791290283, "vf_explained_var": -0.1755151309693853, "kl": 0.008413430869408363, "entropy": 1.5027455780655146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 303.55, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 30355, "policy_reward_min": {"prey_policy": -55.25392449674416, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 55.25392449674416}, "policy_reward_mean": {"prey_policy": 1.5931758674575485, "predator_policy": -1.5931758674575485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 120, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 316, 400, 400, 400, 400, 400, 400, 400, 157, 400, 9, 400, 400, 400, 400, 97, 302, 400, 333, 400, 332, 400, 180, 182, 176, 98, 123, 212, 210, 28, 175, 310, 394, 400, 250, 117, 132, 251, 400, 63, 174, 220, 127, 400, 400, 336, 50, 400, 177, 87, 170, 400, 203, 202, 400, 155, 400, 350, 112, 400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400], "policy_prey_policy_reward": [20.36370215756897, -1.3639031769355086, -12.636992885726475, 27.569497886086594, -23.958889798758705, -12.05554786723022, 40.36539911136443, -5.748243358901078, 46.45233718421952, 29.754677282450224, -0.723545172544263, 34.27115973635655, 4.625140717522584, -29.182387404744176, -0.6809554229487205, 21.347466768947704, 30.470518650164095, 20.505050642308987, -6.082100015137922, 11.779988618230448, 40.716507108271514, -5.465760914812492, 31.43217635219539, 4.462505705544757, 34.865167019675, 26.77066199581178, -10.282808286333704, 35.88142655054395, -42.520067572023024, -15.288337510431454, 24.03978766038798, 30.874543076671436, 36.20214694460272, 37.51955340006948, 27.723445742221898, 31.773961334873015, 26.090662375742518, -23.227810961580538, 18.76708353532495, -4.874872398462484, -15.481646563547415, 8.351171521610041, 2.7669379061451522, 8.357911118034469, -28.244549300004543, -22.847234696143868, 23.306824297752648, -27.62616361324395, 26.87249235817515, -45.0998359719822, 29.895569878439616, -24.552628198151158, -24.465296142760955, -14.44221142320248, -35.15043009408508, -14.275124340975466, -30.962830371174455, -40.081552538337874, -4.015036043834786, -27.61492684400922, -3.409788168371975, -17.63002137537114, 53.60007481135533, -36.13452614825498, -10.386158757006372, -11.36839188729007, -37.10136205796247, 24.06421381936085, -18.4624619755384, -16.462496562062988, -32.086702636364464, -55.25392449674416, 55.52760185871987, 33.20220364978298, -39.689468837063735, -10.483916217467605, 35.17074724205315, -13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195, 59.94981564232023, -34.37388251877181, -25.10043631926099, 44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865], "policy_predator_policy_reward": [-20.36370215756897, 1.3639031769355086, 12.636992885726475, -27.569497886086594, 23.958889798758705, 12.05554786723022, -40.36539911136443, 5.748243358901078, -46.45233718421952, -29.754677282450224, 0.723545172544263, -34.27115973635655, -4.625140717522584, 29.182387404744176, 0.6809554229487205, -21.347466768947704, -30.470518650164095, -20.505050642308987, 6.082100015137922, -11.779988618230448, -40.716507108271514, 5.465760914812492, -31.43217635219539, -4.462505705544757, -34.865167019675, -26.77066199581178, 10.282808286333704, -35.88142655054395, 42.520067572023024, 15.288337510431454, -24.03978766038798, -30.874543076671436, -36.20214694460272, -37.51955340006948, -27.723445742221898, -31.773961334873015, -26.090662375742518, 23.227810961580538, -18.76708353532495, 4.874872398462484, 15.481646563547415, -8.351171521610041, -2.7669379061451522, -8.357911118034469, 28.244549300004543, 22.847234696143868, -23.306824297752648, 27.62616361324395, -26.87249235817515, 45.0998359719822, -29.895569878439616, 24.552628198151158, 24.465296142760955, 14.44221142320248, 35.15043009408508, 14.275124340975466, 30.962830371174455, 40.081552538337874, 4.015036043834786, 27.61492684400922, 3.409788168371975, 17.63002137537114, -53.60007481135533, 36.13452614825498, 10.386158757006372, 11.36839188729007, 37.10136205796247, -24.06421381936085, 18.4624619755384, 16.462496562062988, 32.086702636364464, 55.25392449674416, -55.52760185871987, -33.20220364978298, 39.689468837063735, 10.483916217467605, -35.17074724205315, 13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195, -59.94981564232023, 34.37388251877181, 25.10043631926099, -44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29270682073714005, "mean_inference_ms": 0.9735277013322863, "mean_action_processing_ms": 0.13293212873088092, "mean_env_wait_ms": 0.06558845590700442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031021833419799805, "StateBufferConnector_ms": 0.0019992589950561523, "ViewRequirementAgentConnector_ms": 0.047081589698791504}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.041072650325, "num_env_steps_trained_throughput_per_sec": 803.041072650325, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 5074.258, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5074.17, "sample_time_ms": 645.835, "learn_time_ms": 4416.962, "learn_throughput": 905.6, "synch_weights_time_ms": 10.807}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 33, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-11", "timestamp": 1723345391, "time_this_iter_s": 4.984015226364136, "time_total_s": 171.77208280563354, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5c940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.77208280563354, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.67142857142857, "ram_util_percent": 82.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.581938818314423, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2041005318363505, "policy_loss": -0.0036225724504523288, "vf_loss": 7.207318597535292, "vf_explained_var": 0.42847750515987476, "kl": 0.0127843045501651, "entropy": 0.7221700355410576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5454450266435744, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.965848204493523, "policy_loss": -0.012549742630896314, "vf_loss": 6.976227866609891, "vf_explained_var": 0.007778074654440085, "kl": 0.019289623206998455, "entropy": 1.4097888031353554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 281.13, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 28113, "policy_reward_min": {"prey_policy": -55.25392449674416, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 55.25392449674416}, "policy_reward_mean": {"prey_policy": -2.3452839244204013, "predator_policy": 2.3452839244204013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 316, 400, 400, 400, 400, 400, 400, 400, 157, 400, 9, 400, 400, 400, 400, 97, 302, 400, 333, 400, 332, 400, 180, 182, 176, 98, 123, 212, 210, 28, 175, 310, 394, 400, 250, 117, 132, 251, 400, 63, 174, 220, 127, 400, 400, 336, 50, 400, 177, 87, 170, 400, 203, 202, 400, 155, 400, 350, 112, 400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71], "policy_prey_policy_reward": [30.470518650164095, 20.505050642308987, -6.082100015137922, 11.779988618230448, 40.716507108271514, -5.465760914812492, 31.43217635219539, 4.462505705544757, 34.865167019675, 26.77066199581178, -10.282808286333704, 35.88142655054395, -42.520067572023024, -15.288337510431454, 24.03978766038798, 30.874543076671436, 36.20214694460272, 37.51955340006948, 27.723445742221898, 31.773961334873015, 26.090662375742518, -23.227810961580538, 18.76708353532495, -4.874872398462484, -15.481646563547415, 8.351171521610041, 2.7669379061451522, 8.357911118034469, -28.244549300004543, -22.847234696143868, 23.306824297752648, -27.62616361324395, 26.87249235817515, -45.0998359719822, 29.895569878439616, -24.552628198151158, -24.465296142760955, -14.44221142320248, -35.15043009408508, -14.275124340975466, -30.962830371174455, -40.081552538337874, -4.015036043834786, -27.61492684400922, -3.409788168371975, -17.63002137537114, 53.60007481135533, -36.13452614825498, -10.386158757006372, -11.36839188729007, -37.10136205796247, 24.06421381936085, -18.4624619755384, -16.462496562062988, -32.086702636364464, -55.25392449674416, 55.52760185871987, 33.20220364978298, -39.689468837063735, -10.483916217467605, 35.17074724205315, -13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195, 59.94981564232023, -34.37388251877181, -25.10043631926099, 44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154], "policy_predator_policy_reward": [-30.470518650164095, -20.505050642308987, 6.082100015137922, -11.779988618230448, -40.716507108271514, 5.465760914812492, -31.43217635219539, -4.462505705544757, -34.865167019675, -26.77066199581178, 10.282808286333704, -35.88142655054395, 42.520067572023024, 15.288337510431454, -24.03978766038798, -30.874543076671436, -36.20214694460272, -37.51955340006948, -27.723445742221898, -31.773961334873015, -26.090662375742518, 23.227810961580538, -18.76708353532495, 4.874872398462484, 15.481646563547415, -8.351171521610041, -2.7669379061451522, -8.357911118034469, 28.244549300004543, 22.847234696143868, -23.306824297752648, 27.62616361324395, -26.87249235817515, 45.0998359719822, -29.895569878439616, 24.552628198151158, 24.465296142760955, 14.44221142320248, 35.15043009408508, 14.275124340975466, 30.962830371174455, 40.081552538337874, 4.015036043834786, 27.61492684400922, 3.409788168371975, 17.63002137537114, -53.60007481135533, 36.13452614825498, 10.386158757006372, 11.36839188729007, 37.10136205796247, -24.06421381936085, 18.4624619755384, 16.462496562062988, 32.086702636364464, 55.25392449674416, -55.52760185871987, -33.20220364978298, 39.689468837063735, 10.483916217467605, -35.17074724205315, 13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195, -59.94981564232023, 34.37388251877181, 25.10043631926099, -44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920260335783298, "mean_inference_ms": 0.9702904820150148, "mean_action_processing_ms": 0.13249019830405845, "mean_env_wait_ms": 0.06519571512112193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029944181442260742, "StateBufferConnector_ms": 0.0019736289978027344, "ViewRequirementAgentConnector_ms": 0.04689383506774902}, "num_episodes": 16, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.669390507878, "num_env_steps_trained_throughput_per_sec": 800.669390507878, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 5081.741, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5081.652, "sample_time_ms": 647.645, "learn_time_ms": 4422.561, "learn_throughput": 904.453, "synch_weights_time_ms": 10.871}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 34, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-16", "timestamp": 1723345396, "time_this_iter_s": 4.998760938644409, "time_total_s": 176.77084374427795, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.77084374427795, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 28.3625, "ram_util_percent": 82.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.567543972438822, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.791036183635394, "policy_loss": -0.00787926359892784, "vf_loss": 4.798474234342575, "vf_explained_var": 0.41101644914597274, "kl": 0.01394436118276765, "entropy": 0.5469535161741078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8212104097008703, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.412696878115336, "policy_loss": -0.007974580121905698, "vf_loss": 5.419524768491586, "vf_explained_var": -0.02851880540450414, "kl": 0.010192596492099899, "entropy": 1.3788668004175026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 268.97, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 26897, "policy_reward_min": {"prey_policy": -55.25392449674416, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 55.25392449674416}, "policy_reward_mean": {"prey_policy": -2.1171247277884793, "predator_policy": 2.1171247277884793}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [316, 400, 400, 400, 400, 400, 400, 400, 157, 400, 9, 400, 400, 400, 400, 97, 302, 400, 333, 400, 332, 400, 180, 182, 176, 98, 123, 212, 210, 28, 175, 310, 394, 400, 250, 117, 132, 251, 400, 63, 174, 220, 127, 400, 400, 336, 50, 400, 177, 87, 170, 400, 203, 202, 400, 155, 400, 350, 112, 400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400], "policy_prey_policy_reward": [-15.288337510431454, 24.03978766038798, 30.874543076671436, 36.20214694460272, 37.51955340006948, 27.723445742221898, 31.773961334873015, 26.090662375742518, -23.227810961580538, 18.76708353532495, -4.874872398462484, -15.481646563547415, 8.351171521610041, 2.7669379061451522, 8.357911118034469, -28.244549300004543, -22.847234696143868, 23.306824297752648, -27.62616361324395, 26.87249235817515, -45.0998359719822, 29.895569878439616, -24.552628198151158, -24.465296142760955, -14.44221142320248, -35.15043009408508, -14.275124340975466, -30.962830371174455, -40.081552538337874, -4.015036043834786, -27.61492684400922, -3.409788168371975, -17.63002137537114, 53.60007481135533, -36.13452614825498, -10.386158757006372, -11.36839188729007, -37.10136205796247, 24.06421381936085, -18.4624619755384, -16.462496562062988, -32.086702636364464, -55.25392449674416, 55.52760185871987, 33.20220364978298, -39.689468837063735, -10.483916217467605, 35.17074724205315, -13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195, 59.94981564232023, -34.37388251877181, -25.10043631926099, 44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554], "policy_predator_policy_reward": [15.288337510431454, -24.03978766038798, -30.874543076671436, -36.20214694460272, -37.51955340006948, -27.723445742221898, -31.773961334873015, -26.090662375742518, 23.227810961580538, -18.76708353532495, 4.874872398462484, 15.481646563547415, -8.351171521610041, -2.7669379061451522, -8.357911118034469, 28.244549300004543, 22.847234696143868, -23.306824297752648, 27.62616361324395, -26.87249235817515, 45.0998359719822, -29.895569878439616, 24.552628198151158, 24.465296142760955, 14.44221142320248, 35.15043009408508, 14.275124340975466, 30.962830371174455, 40.081552538337874, 4.015036043834786, 27.61492684400922, 3.409788168371975, 17.63002137537114, -53.60007481135533, 36.13452614825498, 10.386158757006372, 11.36839188729007, 37.10136205796247, -24.06421381936085, 18.4624619755384, 16.462496562062988, 32.086702636364464, 55.25392449674416, -55.52760185871987, -33.20220364978298, 39.689468837063735, 10.483916217467605, -35.17074724205315, 13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195, -59.94981564232023, 34.37388251877181, 25.10043631926099, -44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29152578715139427, "mean_inference_ms": 0.9677493796131629, "mean_action_processing_ms": 0.13223390636135848, "mean_env_wait_ms": 0.06503964935488923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029850006103515625, "StateBufferConnector_ms": 0.002013564109802246, "ViewRequirementAgentConnector_ms": 0.04800856113433838}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 796.1482429158098, "num_env_steps_trained_throughput_per_sec": 796.1482429158098, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 5057.172, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5057.137, "sample_time_ms": 652.419, "learn_time_ms": 4394.356, "learn_throughput": 910.259, "synch_weights_time_ms": 10.032}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 35, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-21", "timestamp": 1723345401, "time_this_iter_s": 5.0268330574035645, "time_total_s": 181.79767680168152, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.79767680168152, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 29.700000000000006, "ram_util_percent": 81.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2707775931805374, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.7752509951591495, "policy_loss": -0.003888411078272232, "vf_loss": 5.778700985511144, "vf_explained_var": 0.6093852215756973, "kl": 0.013856097844294106, "entropy": 0.6545128917942444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.68584440878282, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.414466535548369, "policy_loss": -0.008508700067371441, "vf_loss": 6.421426045894623, "vf_explained_var": 0.08225772473961115, "kl": 0.013770540737254673, "entropy": 1.4121669862419366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 257.96, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 25796, "policy_reward_min": {"prey_policy": -55.25392449674416, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 55.25392449674416}, "policy_reward_mean": {"prey_policy": -2.749061134525072, "predator_policy": 2.749061134525072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [97, 302, 400, 333, 400, 332, 400, 180, 182, 176, 98, 123, 212, 210, 28, 175, 310, 394, 400, 250, 117, 132, 251, 400, 63, 174, 220, 127, 400, 400, 336, 50, 400, 177, 87, 170, 400, 203, 202, 400, 155, 400, 350, 112, 400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178], "policy_prey_policy_reward": [-28.244549300004543, -22.847234696143868, 23.306824297752648, -27.62616361324395, 26.87249235817515, -45.0998359719822, 29.895569878439616, -24.552628198151158, -24.465296142760955, -14.44221142320248, -35.15043009408508, -14.275124340975466, -30.962830371174455, -40.081552538337874, -4.015036043834786, -27.61492684400922, -3.409788168371975, -17.63002137537114, 53.60007481135533, -36.13452614825498, -10.386158757006372, -11.36839188729007, -37.10136205796247, 24.06421381936085, -18.4624619755384, -16.462496562062988, -32.086702636364464, -55.25392449674416, 55.52760185871987, 33.20220364978298, -39.689468837063735, -10.483916217467605, 35.17074724205315, -13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195, 59.94981564232023, -34.37388251877181, -25.10043631926099, 44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169], "policy_predator_policy_reward": [28.244549300004543, 22.847234696143868, -23.306824297752648, 27.62616361324395, -26.87249235817515, 45.0998359719822, -29.895569878439616, 24.552628198151158, 24.465296142760955, 14.44221142320248, 35.15043009408508, 14.275124340975466, 30.962830371174455, 40.081552538337874, 4.015036043834786, 27.61492684400922, 3.409788168371975, 17.63002137537114, -53.60007481135533, 36.13452614825498, 10.386158757006372, 11.36839188729007, 37.10136205796247, -24.06421381936085, 18.4624619755384, 16.462496562062988, 32.086702636364464, 55.25392449674416, -55.52760185871987, -33.20220364978298, 39.689468837063735, 10.483916217467605, -35.17074724205315, 13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195, -59.94981564232023, 34.37388251877181, 25.10043631926099, -44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29085660876708064, "mean_inference_ms": 0.9657013473291637, "mean_action_processing_ms": 0.13204381825913858, "mean_env_wait_ms": 0.06475351479218915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002897500991821289, "StateBufferConnector_ms": 0.0019739866256713867, "ViewRequirementAgentConnector_ms": 0.04753744602203369}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.1353796271039, "num_env_steps_trained_throughput_per_sec": 804.1353796271039, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 5034.968, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5034.934, "sample_time_ms": 639.25, "learn_time_ms": 4385.476, "learn_throughput": 912.102, "synch_weights_time_ms": 9.877}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 36, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-26", "timestamp": 1723345406, "time_this_iter_s": 4.976974725723267, "time_total_s": 186.77465152740479, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b48938b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.77465152740479, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.54285714285714, "ram_util_percent": 82.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.12129979574432, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9981157153844835, "policy_loss": -0.0026636755399522373, "vf_loss": 6.000622004270554, "vf_explained_var": 0.6435719295094411, "kl": 0.004973993450185967, "entropy": 0.5820527210521201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7616889492298164, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.027040798465411, "policy_loss": -0.00895370821187195, "vf_loss": 6.03402018348376, "vf_explained_var": -0.12133367825299501, "kl": 0.017549378783315542, "entropy": 1.4531178082029024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 265.79, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 26579, "policy_reward_min": {"prey_policy": -55.25392449674416, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 55.25392449674416}, "policy_reward_mean": {"prey_policy": 0.13354515307148188, "predator_policy": -0.13354515307148188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [98, 123, 212, 210, 28, 175, 310, 394, 400, 250, 117, 132, 251, 400, 63, 174, 220, 127, 400, 400, 336, 50, 400, 177, 87, 170, 400, 203, 202, 400, 155, 400, 350, 112, 400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359], "policy_prey_policy_reward": [-35.15043009408508, -14.275124340975466, -30.962830371174455, -40.081552538337874, -4.015036043834786, -27.61492684400922, -3.409788168371975, -17.63002137537114, 53.60007481135533, -36.13452614825498, -10.386158757006372, -11.36839188729007, -37.10136205796247, 24.06421381936085, -18.4624619755384, -16.462496562062988, -32.086702636364464, -55.25392449674416, 55.52760185871987, 33.20220364978298, -39.689468837063735, -10.483916217467605, 35.17074724205315, -13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195, 59.94981564232023, -34.37388251877181, -25.10043631926099, 44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502], "policy_predator_policy_reward": [35.15043009408508, 14.275124340975466, 30.962830371174455, 40.081552538337874, 4.015036043834786, 27.61492684400922, 3.409788168371975, 17.63002137537114, -53.60007481135533, 36.13452614825498, 10.386158757006372, 11.36839188729007, 37.10136205796247, -24.06421381936085, 18.4624619755384, 16.462496562062988, 32.086702636364464, 55.25392449674416, -55.52760185871987, -33.20220364978298, 39.689468837063735, 10.483916217467605, -35.17074724205315, 13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195, -59.94981564232023, 34.37388251877181, 25.10043631926099, -44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2906959143714932, "mean_inference_ms": 0.9647880318506484, "mean_action_processing_ms": 0.1318522872616777, "mean_env_wait_ms": 0.0645220481324921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029053688049316406, "StateBufferConnector_ms": 0.002141714096069336, "ViewRequirementAgentConnector_ms": 0.04834461212158203}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 747.9328128973217, "num_env_steps_trained_throughput_per_sec": 747.9328128973217, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 5068.503, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5068.466, "sample_time_ms": 651.57, "learn_time_ms": 4405.86, "learn_throughput": 907.882, "synch_weights_time_ms": 10.629}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 37, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-31", "timestamp": 1723345411, "time_this_iter_s": 5.374491214752197, "time_total_s": 192.14914274215698, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.14914274215698, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 33.575, "ram_util_percent": 82.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.89978901874274, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.894203472634157, "policy_loss": -0.003832480084868924, "vf_loss": 6.897951971491178, "vf_explained_var": 0.35842904342959325, "kl": 0.00530966658866762, "entropy": 0.46074655021851263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5648456901932755, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.851530679066976, "policy_loss": -0.006145681355944058, "vf_loss": 6.8564594800273575, "vf_explained_var": -0.0008109063530961672, "kl": 0.010816730767605198, "entropy": 1.4656944704552493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 281.72, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 28172, "policy_reward_min": {"prey_policy": -55.25392449674416, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 55.25392449674416}, "policy_reward_mean": {"prey_policy": 3.567324856351547, "predator_policy": -3.567324856351547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 400, 63, 174, 220, 127, 400, 400, 336, 50, 400, 177, 87, 170, 400, 203, 202, 400, 155, 400, 350, 112, 400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80], "policy_prey_policy_reward": [-37.10136205796247, 24.06421381936085, -18.4624619755384, -16.462496562062988, -32.086702636364464, -55.25392449674416, 55.52760185871987, 33.20220364978298, -39.689468837063735, -10.483916217467605, 35.17074724205315, -13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195, 59.94981564232023, -34.37388251877181, -25.10043631926099, 44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635], "policy_predator_policy_reward": [37.10136205796247, -24.06421381936085, 18.4624619755384, 16.462496562062988, 32.086702636364464, 55.25392449674416, -55.52760185871987, -33.20220364978298, 39.689468837063735, 10.483916217467605, -35.17074724205315, 13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195, -59.94981564232023, 34.37388251877181, 25.10043631926099, -44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2904176442543699, "mean_inference_ms": 0.9633709528418108, "mean_action_processing_ms": 0.13158617793261354, "mean_env_wait_ms": 0.06448985890567423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029735565185546875, "StateBufferConnector_ms": 0.0022172927856445312, "ViewRequirementAgentConnector_ms": 0.04909861087799072}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 769.1806481646954, "num_env_steps_trained_throughput_per_sec": 769.1806481646954, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 5056.236, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5056.196, "sample_time_ms": 654.064, "learn_time_ms": 4391.098, "learn_throughput": 910.934, "synch_weights_time_ms": 10.625}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 38, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-37", "timestamp": 1723345417, "time_this_iter_s": 5.203107833862305, "time_total_s": 197.3522505760193, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.3522505760193, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.04285714285714, "ram_util_percent": 82.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.46888344536225, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.794623480488856, "policy_loss": -0.00425145142604985, "vf_loss": 5.798427327970663, "vf_explained_var": 0.4275003738080462, "kl": 0.028293759714382853, "entropy": 0.747928314593931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0285765122622252, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.310109671453635, "policy_loss": -0.011987267540098401, "vf_loss": 6.3200845887263615, "vf_explained_var": 0.03226055136571328, "kl": 0.017887654964976483, "entropy": 1.4711551216741403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 296.91, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 29691, "policy_reward_min": {"prey_policy": -42.84903219586195, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 42.84903219586195}, "policy_reward_mean": {"prey_policy": 6.430088903665774, "predator_policy": -6.430088903665774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [177, 87, 170, 400, 203, 202, 400, 155, 400, 350, 112, 400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-13.992108002310534, -20.12278497599561, -24.691906883962226, 54.23084349968201, -34.69373978103167, -13.07467372660542, 51.40418019093036, -42.84903219586195, 59.94981564232023, -34.37388251877181, -25.10043631926099, 44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228], "policy_predator_policy_reward": [13.992108002310534, 20.12278497599561, 24.691906883962226, -54.23084349968201, 34.69373978103167, 13.07467372660542, -51.40418019093036, 42.84903219586195, -59.94981564232023, 34.37388251877181, 25.10043631926099, -44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29005392640080524, "mean_inference_ms": 0.9620762841291075, "mean_action_processing_ms": 0.13140423871366977, "mean_env_wait_ms": 0.06435106343938381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029419660568237305, "StateBufferConnector_ms": 0.002238154411315918, "ViewRequirementAgentConnector_ms": 0.04983186721801758}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 793.1582296493734, "num_env_steps_trained_throughput_per_sec": 793.1582296493734, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 5054.769, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5054.728, "sample_time_ms": 657.603, "learn_time_ms": 4386.119, "learn_throughput": 911.968, "synch_weights_time_ms": 10.601}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 39, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-42", "timestamp": 1723345422, "time_this_iter_s": 5.045737028121948, "time_total_s": 202.39798760414124, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 202.39798760414124, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.52857142857142, "ram_util_percent": 82.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.043756948101024, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.187937015295029, "policy_loss": 4.096561121211077e-05, "vf_loss": 7.187836630642414, "vf_explained_var": 0.3470724028845628, "kl": 0.002502722219261007, "entropy": 0.8028531036029259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6820417937512198, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.639890046914418, "policy_loss": -0.007053243269911036, "vf_loss": 6.645140620072683, "vf_explained_var": -0.00997797902673483, "kl": 0.016023741689745446, "entropy": 1.479280003408591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 314.35, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31435, "policy_reward_min": {"prey_policy": -42.28423009192703, "predator_policy": -63.71989885065615}, "policy_reward_max": {"prey_policy": 63.71989885065615, "predator_policy": 42.28423009192703}, "policy_reward_mean": {"prey_policy": 7.93588581187948, "predator_policy": -7.93588581187948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 55, 154, 400, 258, 353, 225, 400, 129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [44.96538428521582, 63.71989885065615, -27.59419857875146, -17.741323233457322, 55.05661873386443, -28.099487203761576, -38.25189513187574, -2.6768055669508364, -9.21424073628405, -2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372], "policy_predator_policy_reward": [-44.96538428521582, -63.71989885065615, 27.59419857875146, 17.741323233457322, -55.05661873386443, 28.099487203761576, 38.25189513187574, 2.6768055669508364, 9.21424073628405, 2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2895861455009059, "mean_inference_ms": 0.9600648187530164, "mean_action_processing_ms": 0.13128216841678955, "mean_env_wait_ms": 0.06409310690596352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029054880142211914, "StateBufferConnector_ms": 0.002233743667602539, "ViewRequirementAgentConnector_ms": 0.04902076721191406}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.0351169927432, "num_env_steps_trained_throughput_per_sec": 802.0351169927432, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 5054.591, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5054.549, "sample_time_ms": 655.446, "learn_time_ms": 4388.086, "learn_throughput": 911.559, "synch_weights_time_ms": 10.613}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 40, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-47", "timestamp": 1723345427, "time_this_iter_s": 4.99004602432251, "time_total_s": 207.38803362846375, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.38803362846375, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 27.585714285714285, "ram_util_percent": 82.15714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.198366311751306, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.935758771002293, "policy_loss": -0.004351973870749741, "vf_loss": 6.939893845220407, "vf_explained_var": -0.03137285380313794, "kl": 0.018282315242167554, "entropy": 0.7277773493900895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.676470466951529, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.466152252256871, "policy_loss": -0.008176642811061658, "vf_loss": 7.4724379594127335, "vf_explained_var": -0.07437165391941865, "kl": 0.016808359011293607, "entropy": 1.4846675259371598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 323.9, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 32390, "policy_reward_min": {"prey_policy": -42.28423009192703, "predator_policy": -57.770284906500606}, "policy_reward_max": {"prey_policy": 57.770284906500606, "predator_policy": 42.28423009192703}, "policy_reward_mean": {"prey_policy": 8.910292188424659, "predator_policy": -8.910292188424659}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [129, 162, 400, 259, 363, 124, 258, 100, 209, 162, 149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.279606752615008, -31.13685136052984, 37.56441050004865, -26.21594516185928, -38.4872118360406, -19.9754965032464, -35.62848608026598, -12.155620209346404, -20.020920330236812, -12.284076143769813, -17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805], "policy_predator_policy_reward": [2.279606752615008, 31.13685136052984, -37.56441050004865, 26.21594516185928, 38.4872118360406, 19.9754965032464, 35.62848608026598, 12.155620209346404, 20.020920330236812, 12.284076143769813, 17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.289165002825834, "mean_inference_ms": 0.9583116723641762, "mean_action_processing_ms": 0.1310608799475153, "mean_env_wait_ms": 0.06404147661660076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028867721557617188, "StateBufferConnector_ms": 0.0025429725646972656, "ViewRequirementAgentConnector_ms": 0.04893612861633301}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 814.5395451745866, "num_env_steps_trained_throughput_per_sec": 814.5395451745866, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 5039.396, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5039.354, "sample_time_ms": 653.019, "learn_time_ms": 4375.127, "learn_throughput": 914.259, "synch_weights_time_ms": 10.803}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 41, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-52", "timestamp": 1723345432, "time_this_iter_s": 4.913347005844116, "time_total_s": 212.30138063430786, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.30138063430786, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 82.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.374363372474909, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.551793137689431, "policy_loss": -0.0024073420752150315, "vf_loss": 6.554134911795457, "vf_explained_var": 0.5360161321237683, "kl": 0.005526196057285378, "entropy": 0.7774397392446796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9732847142964602, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7927028675874075, "policy_loss": -0.01576274109344619, "vf_loss": 6.805368102590243, "vf_explained_var": 0.16584132971862953, "kl": 0.027533489300521012, "entropy": 1.4477854916205009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 342.05, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34205, "policy_reward_min": {"prey_policy": -42.28423009192703, "predator_policy": -57.770284906500606}, "policy_reward_max": {"prey_policy": 57.770284906500606, "predator_policy": 42.28423009192703}, "policy_reward_mean": {"prey_policy": 10.425729114456617, "predator_policy": -10.425729114456617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [149, 227, 275, 323, 400, 204, 354, 400, 71, 400, 206, 124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-17.63796892715996, -27.170624358352, -18.3813370724276, -37.73769793509629, 30.57122096546334, -16.963531720674247, -12.952158524677825, 17.88486456284155, -8.292074156219154, 38.64066470709864, -30.63317482464697, -17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316], "policy_predator_policy_reward": [17.63796892715996, 27.170624358352, 18.3813370724276, 37.73769793509629, -30.57122096546334, 16.963531720674247, 12.952158524677825, -17.88486456284155, 8.292074156219154, -38.64066470709864, 30.63317482464697, 17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2887579841768227, "mean_inference_ms": 0.9565063626686083, "mean_action_processing_ms": 0.1308189124185746, "mean_env_wait_ms": 0.06397963222353033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028772354125976562, "StateBufferConnector_ms": 0.002558588981628418, "ViewRequirementAgentConnector_ms": 0.048310279846191406}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.0722089591361, "num_env_steps_trained_throughput_per_sec": 811.0722089591361, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 5039.68, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5039.639, "sample_time_ms": 655.606, "learn_time_ms": 4373.042, "learn_throughput": 914.695, "synch_weights_time_ms": 10.586}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 42, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-03-57", "timestamp": 1723345437, "time_this_iter_s": 4.9343695640563965, "time_total_s": 217.23575019836426, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.23575019836426, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 27.52857142857143, "ram_util_percent": 82.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1270551798244317, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4082052628199255, "policy_loss": -0.0023977500507802083, "vf_loss": 6.410474316279093, "vf_explained_var": 0.6128919777149956, "kl": 0.010844508844164612, "entropy": 0.694204138405621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.600869558627407, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.773411870002747, "policy_loss": -0.004165393749281066, "vf_loss": 6.776211850345135, "vf_explained_var": 0.039299248283108074, "kl": 0.008091358833630985, "entropy": 1.4213242748131354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 351.37, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35137, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -57.770284906500606}, "policy_reward_max": {"prey_policy": 57.770284906500606, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 12.603360602523779, "predator_policy": -12.603360602523779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [124, 400, 90, 400, 400, 83, 400, 400, 177, 193, 400, 400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218], "policy_prey_policy_reward": [-17.310053567219665, 43.559083369883545, -35.68663281744948, 43.79073472888743, 47.467229324529285, -13.340180285982342, 48.52563977411163, 52.14589401473585, -20.676223808319783, -13.840661459312768, 52.70686636131554, 3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172], "policy_predator_policy_reward": [17.310053567219665, -43.559083369883545, 35.68663281744948, -43.79073472888743, -47.467229324529285, 13.340180285982342, -48.52563977411163, -52.14589401473585, 20.676223808319783, 13.840661459312768, -52.70686636131554, -3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.288258254393532, "mean_inference_ms": 0.9550906212175458, "mean_action_processing_ms": 0.13054205856128528, "mean_env_wait_ms": 0.06376992048444458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002841949462890625, "StateBufferConnector_ms": 0.0025665760040283203, "ViewRequirementAgentConnector_ms": 0.04859638214111328}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.9108812385512, "num_env_steps_trained_throughput_per_sec": 806.9108812385512, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 5037.291, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5037.25, "sample_time_ms": 657.618, "learn_time_ms": 4368.652, "learn_throughput": 915.614, "synch_weights_time_ms": 10.575}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 43, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-02", "timestamp": 1723345442, "time_this_iter_s": 4.960039854049683, "time_total_s": 222.19579005241394, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.19579005241394, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 27.799999999999994, "ram_util_percent": 82.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3322536049410703, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.183712975184123, "policy_loss": -0.004920733398224305, "vf_loss": 6.188498905301094, "vf_explained_var": 0.7181915998458862, "kl": 0.011360279782432882, "entropy": 0.5754743280510107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.250661207983891, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.607849781215191, "policy_loss": -0.003938849687983748, "vf_loss": 5.610693302750588, "vf_explained_var": 0.19938077790041764, "kl": 0.006490884461395297, "entropy": 1.4190141105403502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 364.6, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36460, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -58.949438679729916}, "policy_reward_max": {"prey_policy": 58.949438679729916, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 13.88574347565001, "predator_policy": -13.88574347565001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 231, 400, 5, 137, 400, 69, 400, 280, 400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400], "policy_prey_policy_reward": [3.7500613794806874, 47.8744787828309, -17.15661064387173, 40.51420349305664, -5.0602314556332, -39.45356241793253, 22.974681684319286, -17.69408432759088, 55.592712610417806, -34.169641646102804, 35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565], "policy_predator_policy_reward": [-3.7500613794806874, -47.8744787828309, 17.15661064387173, -40.51420349305664, 5.0602314556332, 39.45356241793253, -22.974681684319286, 17.69408432759088, -55.592712610417806, 34.169641646102804, -35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2879475601638016, "mean_inference_ms": 0.9537932640503594, "mean_action_processing_ms": 0.13026089164560864, "mean_env_wait_ms": 0.06363694978799499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028192996978759766, "StateBufferConnector_ms": 0.0025467872619628906, "ViewRequirementAgentConnector_ms": 0.048307180404663086}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 810.5642453636293, "num_env_steps_trained_throughput_per_sec": 810.5642453636293, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 5031.193, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5031.152, "sample_time_ms": 665.421, "learn_time_ms": 4354.839, "learn_throughput": 918.518, "synch_weights_time_ms": 10.493}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 44, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-06", "timestamp": 1723345446, "time_this_iter_s": 4.9374167919158936, "time_total_s": 227.13320684432983, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.13320684432983, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.28571428571428, "ram_util_percent": 82.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.348624345411857, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.437688027818997, "policy_loss": -0.003082327713976459, "vf_loss": 6.440680870413781, "vf_explained_var": 0.6388116722926498, "kl": 0.007543689228791983, "entropy": 0.6598849976435304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.366301601442198, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.062424427270889, "policy_loss": -0.00458270945722082, "vf_loss": 6.065703309575716, "vf_explained_var": -0.8760303799062967, "kl": 0.007726386830312683, "entropy": 1.3936080042272807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 373.12, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37312, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -62.038941796834706}, "policy_reward_max": {"prey_policy": 62.038941796834706, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 15.717412716253431, "predator_policy": -15.717412716253431}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 81, 178, 400, 400, 400, 400, 309, 400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [35.255548886939366, 34.010713177438284, 54.14049202517128, -24.19320876846897, -25.98465627205169, 28.281072870613936, 23.177171142376217, 38.46918534924742, 42.92774886602474, -42.28423009192703, 39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093], "policy_predator_policy_reward": [-35.255548886939366, -34.010713177438284, -54.14049202517128, 24.19320876846897, 25.98465627205169, -28.281072870613936, -23.177171142376217, -38.46918534924742, -42.92774886602474, 42.28423009192703, -39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28763203409739674, "mean_inference_ms": 0.952332664015424, "mean_action_processing_ms": 0.13005359766553884, "mean_env_wait_ms": 0.06360951674607565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002765655517578125, "StateBufferConnector_ms": 0.002561330795288086, "ViewRequirementAgentConnector_ms": 0.04817759990692139}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 779.0686086989875, "num_env_steps_trained_throughput_per_sec": 779.0686086989875, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 5042.207, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5042.167, "sample_time_ms": 668.078, "learn_time_ms": 4363.043, "learn_throughput": 916.791, "synch_weights_time_ms": 10.63}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 45, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-12", "timestamp": 1723345452, "time_this_iter_s": 5.152729034423828, "time_total_s": 232.28593587875366, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.28593587875366, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.75, "ram_util_percent": 82.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2567602969706058, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.093000051875909, "policy_loss": -0.0024805396523637077, "vf_loss": 6.095392465094725, "vf_explained_var": 0.5665957534064849, "kl": 0.007427214719507617, "entropy": 0.7162030939633648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3762956829741597, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.158763847996791, "policy_loss": -0.007699612885092696, "vf_loss": 5.1653172880411145, "vf_explained_var": 0.10338388700038195, "kl": 0.006792104022732922, "entropy": 1.376340048139294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.88, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37788, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -62.038941796834706}, "policy_reward_max": {"prey_policy": 62.038941796834706, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 14.699973310229229, "predator_policy": -14.699973310229229}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 117, 400, 400, 359, 400, 400, 400, 400, 400, 123, 400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400], "policy_prey_policy_reward": [39.40557751236466, -9.89972199895088, 39.54708883041292, 48.980989635416776, -27.54728616704502, 52.57937470933402, 44.41559090937119, 31.079169048776237, 24.844253656658573, -25.864654096279313, -5.553618935231942, 51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789], "policy_predator_policy_reward": [-39.40557751236466, 9.89972199895088, -39.54708883041292, -48.980989635416776, 27.54728616704502, -52.57937470933402, -44.41559090937119, -31.079169048776237, -24.844253656658573, 25.864654096279313, 5.553618935231942, -51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2873128580943327, "mean_inference_ms": 0.9509805913199108, "mean_action_processing_ms": 0.1298290225777421, "mean_env_wait_ms": 0.06351941555536325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002781510353088379, "StateBufferConnector_ms": 0.0024231672286987305, "ViewRequirementAgentConnector_ms": 0.04817163944244385}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 807.1368510646978, "num_env_steps_trained_throughput_per_sec": 807.1368510646978, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 5040.357, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5040.316, "sample_time_ms": 674.572, "learn_time_ms": 4354.596, "learn_throughput": 918.57, "synch_weights_time_ms": 10.73}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 46, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-17", "timestamp": 1723345457, "time_this_iter_s": 4.958438158035278, "time_total_s": 237.24437403678894, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.24437403678894, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 28.685714285714287, "ram_util_percent": 82.32857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.310274761977295, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.877987401684125, "policy_loss": -0.0024522376144886946, "vf_loss": 5.880362215141456, "vf_explained_var": 0.6436840227494637, "kl": 0.006523812082994833, "entropy": 0.759965776031216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8902645971005163, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.218682975073656, "policy_loss": -0.005093653466368172, "vf_loss": 6.222078598042329, "vf_explained_var": -0.9020904875049989, "kl": 0.010062191920309972, "entropy": 1.3518846989919742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.55, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38355, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 14.498898878262846, "predator_policy": -14.498898878262846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 239, 400, 400, 400, 80, 400, 400, 400, 340, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [51.971329120476184, -27.08729487837331, 49.39377906750908, 28.18468057312122, -18.490628667937884, -39.522721936773635, 27.74217734747382, 32.516702147866475, 15.050136538394092, -23.40093858496093, 33.579075668268196, -16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062], "policy_predator_policy_reward": [-51.971329120476184, 27.08729487837331, -49.39377906750908, -28.18468057312122, 18.490628667937884, 39.522721936773635, -27.74217734747382, -32.516702147866475, -15.050136538394092, 23.40093858496093, -33.579075668268196, 16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868131486355932, "mean_inference_ms": 0.9494883463950391, "mean_action_processing_ms": 0.12967093785288097, "mean_env_wait_ms": 0.06335004910677144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002755284309387207, "StateBufferConnector_ms": 0.002366304397583008, "ViewRequirementAgentConnector_ms": 0.04721379280090332}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 819.5849808357245, "num_env_steps_trained_throughput_per_sec": 819.5849808357245, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 4993.601, "restore_workers_time_ms": 0.014, "training_step_time_ms": 4993.566, "sample_time_ms": 659.185, "learn_time_ms": 4323.999, "learn_throughput": 925.07, "synch_weights_time_ms": 10.038}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 47, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-22", "timestamp": 1723345462, "time_this_iter_s": 4.883141279220581, "time_total_s": 242.12751531600952, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.12751531600952, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 28.014285714285712, "ram_util_percent": 82.17142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2056447580767173, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.684343897551298, "policy_loss": -0.003473966338788159, "vf_loss": 5.687745352089405, "vf_explained_var": 0.5505772652104497, "kl": 0.0061100151886279265, "entropy": 0.7640752113734682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.943465556949377, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.057083523521821, "policy_loss": -0.00692438590049278, "vf_loss": 5.062735777596632, "vf_explained_var": 0.054878050833940505, "kl": 0.007538497637254005, "entropy": 1.335669335971276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.96, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38896, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 16.619167615009705, "predator_policy": -16.619167615009705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-16.244595795953522, 17.733818221899668, 57.770284906500606, 16.5432512848942, 50.01296696701385, 13.397959816739228, 16.58237750033955, -16.41827315606446, 41.37604076838364, 4.9405173874105905, 7.127624377648019, 13.643772154521347, 2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305], "policy_predator_policy_reward": [16.244595795953522, -17.733818221899668, -57.770284906500606, -16.5432512848942, -50.01296696701385, -13.397959816739228, -16.58237750033955, 16.41827315606446, -41.37604076838364, -4.9405173874105905, -7.127624377648019, -13.643772154521347, -2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863402914450039, "mean_inference_ms": 0.9477057174907011, "mean_action_processing_ms": 0.12947556167615182, "mean_env_wait_ms": 0.06324789445760377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002575397491455078, "StateBufferConnector_ms": 0.002319812774658203, "ViewRequirementAgentConnector_ms": 0.045621275901794434}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.3598825534759, "num_env_steps_trained_throughput_per_sec": 805.3598825534759, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 4970.238, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4970.206, "sample_time_ms": 660.545, "learn_time_ms": 4299.312, "learn_throughput": 930.381, "synch_weights_time_ms": 10.008}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 48, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-27", "timestamp": 1723345467, "time_this_iter_s": 4.969620943069458, "time_total_s": 247.09713625907898, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.09713625907898, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 27.571428571428573, "ram_util_percent": 82.12857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3223273209606607, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.558167357246081, "policy_loss": -0.00422363315980571, "vf_loss": 5.5622790152827895, "vf_explained_var": 0.5240346959481637, "kl": 0.009436619176997778, "entropy": 0.8060851356014609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6049906966276466, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.275722089906534, "policy_loss": -0.007551750600881254, "vf_loss": 6.28173020084699, "vf_explained_var": -0.13126555227984985, "kl": 0.00914750464772472, "entropy": 1.33702710904181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 374.23, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37423, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 14.187220444738907, "predator_policy": -14.187220444738907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400], "policy_prey_policy_reward": [2.3250617995569094, -7.883500060802575, 54.74028226775497, -3.606286791263516, -5.561650496981372, 36.02182890739465, 29.283965519431888, -3.5796948089028326, 18.113028519011287, 25.692573912083432, -7.425999467811737, 19.281053011359074, 14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023], "policy_predator_policy_reward": [-2.3250617995569094, 7.883500060802575, -54.74028226775497, 3.606286791263516, 5.561650496981372, -36.02182890739465, -29.283965519431888, 3.5796948089028326, -18.113028519011287, -25.692573912083432, 7.425999467811737, -19.281053011359074, -14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860786913830083, "mean_inference_ms": 0.9470122922658267, "mean_action_processing_ms": 0.12926619345836945, "mean_env_wait_ms": 0.06320842625046777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034894943237304688, "StateBufferConnector_ms": 0.0024052858352661133, "ViewRequirementAgentConnector_ms": 0.0549541711807251}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 772.6794526882125, "num_env_steps_trained_throughput_per_sec": 772.6794526882125, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 4983.604, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4983.572, "sample_time_ms": 684.042, "learn_time_ms": 4288.911, "learn_throughput": 932.638, "synch_weights_time_ms": 10.267}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 49, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-32", "timestamp": 1723345472, "time_this_iter_s": 5.179779052734375, "time_total_s": 252.27691531181335, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.27691531181335, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.75714285714285, "ram_util_percent": 81.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0267763316941756, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.640366522967815, "policy_loss": -0.005096951340480397, "vf_loss": 5.645334476729234, "vf_explained_var": 0.5684267764290174, "kl": 0.010871028337820594, "entropy": 0.831939543535312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6064209826290607, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.112791618953149, "policy_loss": -0.00652806729049189, "vf_loss": 5.117470818509658, "vf_explained_var": -0.016254706494510173, "kl": 0.010956445345993989, "entropy": 1.4073003799964985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.51, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36651, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 13.827314870826628, "predator_policy": -13.827314870826628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 381, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400], "policy_prey_policy_reward": [14.029523729023694, 6.188309751583805, 31.960199487209586, -23.142168352192563, 1.794961454697022, -15.86040933550144, -4.55096108319675, 3.6157257420623026, -19.928442635988752, 26.42700866725514, -9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874], "policy_predator_policy_reward": [-14.029523729023694, -6.188309751583805, -31.960199487209586, 23.142168352192563, -1.794961454697022, 15.86040933550144, 4.55096108319675, -3.6157257420623026, 19.928442635988752, -26.42700866725514, 9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2858846111242692, "mean_inference_ms": 0.9470304018546608, "mean_action_processing_ms": 0.1291477413573286, "mean_env_wait_ms": 0.06308884184446134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036901235580444336, "StateBufferConnector_ms": 0.0024302005767822266, "ViewRequirementAgentConnector_ms": 0.0557781457901001}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.3660782478158, "num_env_steps_trained_throughput_per_sec": 803.3660782478158, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 4982.778, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4982.745, "sample_time_ms": 681.348, "learn_time_ms": 4290.614, "learn_throughput": 932.268, "synch_weights_time_ms": 10.42}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 50, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-37", "timestamp": 1723345477, "time_this_iter_s": 4.986850023269653, "time_total_s": 257.263765335083, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.263765335083, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.37142857142857, "ram_util_percent": 82.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.991204258861641, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.782271363337835, "policy_loss": -0.00905211290276687, "vf_loss": 5.790995598832766, "vf_explained_var": 0.488487048757573, "kl": 0.027633622786895563, "entropy": 0.8792839745680491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.59252920721968, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8342508807778355, "policy_loss": -0.006092889825716459, "vf_loss": 5.839199094474315, "vf_explained_var": -0.08743408216784397, "kl": 0.0067833954281348845, "entropy": 1.3834877685954174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.3, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36330, "policy_reward_min": {"prey_policy": -45.30564126678707, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 45.30564126678707}, "policy_reward_mean": {"prey_policy": 15.755446106738315, "predator_policy": -15.755446106738315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 123, 400, 400, 218, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400], "policy_prey_policy_reward": [-9.27252669109707, -0.11949852791304316, 50.7164139559813, 3.075643858125588, 43.39690787352686, 34.02993274038549, 7.86752568985343, 10.59137006057938, 33.63098818916566, -45.30564126678707, -20.346387004524477, 43.283273560449516, -25.848696133890172, 56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244], "policy_predator_policy_reward": [9.27252669109707, 0.11949852791304316, -50.7164139559813, -3.075643858125588, -43.39690787352686, -34.02993274038549, -7.86752568985343, -10.59137006057938, -33.63098818916566, 45.30564126678707, 20.346387004524477, -43.283273560449516, 25.848696133890172, -56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2857054344273432, "mean_inference_ms": 0.9466646027488618, "mean_action_processing_ms": 0.1290666469536861, "mean_env_wait_ms": 0.06307144482950022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003773927688598633, "StateBufferConnector_ms": 0.0021071434020996094, "ViewRequirementAgentConnector_ms": 0.055677175521850586}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.2025123499573, "num_env_steps_trained_throughput_per_sec": 813.2025123499573, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 4983.586, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4983.553, "sample_time_ms": 684.712, "learn_time_ms": 4288.289, "learn_throughput": 932.773, "synch_weights_time_ms": 10.186}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 51, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-42", "timestamp": 1723345482, "time_this_iter_s": 4.92143988609314, "time_total_s": 262.18520522117615, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.18520522117615, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 29.52857142857142, "ram_util_percent": 82.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2024767197668553, "cur_kl_coeff": 0.017797851562499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.607670129835606, "policy_loss": -0.007506591392060121, "vf_loss": 6.614826885362466, "vf_explained_var": 0.3742140990371505, "kl": 0.019654507970435893, "entropy": 0.8750297889734308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.961103990674019, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.640141442169746, "policy_loss": -0.002587059253952854, "vf_loss": 5.641759964823723, "vf_explained_var": -0.020060413889586924, "kl": 0.005739364338714857, "entropy": 1.4155971616506577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 354.24, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 35424, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 13.878293410845874, "predator_policy": -13.878293410845874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 89, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400], "policy_prey_policy_reward": [56.087010847296966, 53.26499328860756, -24.56398436604732, 58.949438679729916, 17.258737447261147, 25.73071506946821, 46.73987877416006, 23.661664395836006, -26.112284562119374, 46.327255157290054, 38.236558216319565, -3.459898759341952, -1.158554579074476, 35.370902959599775, -25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346], "policy_predator_policy_reward": [-56.087010847296966, -53.26499328860756, 24.56398436604732, -58.949438679729916, -17.258737447261147, -25.73071506946821, -46.73987877416006, -23.661664395836006, 26.112284562119374, -46.327255157290054, -38.236558216319565, 3.459898759341952, 1.158554579074476, -35.370902959599775, 25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28565670604161625, "mean_inference_ms": 0.9462403366575274, "mean_action_processing_ms": 0.12895146012883205, "mean_env_wait_ms": 0.06303374543615718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038176774978637695, "StateBufferConnector_ms": 0.002103447914123535, "ViewRequirementAgentConnector_ms": 0.055501580238342285}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 810.1300638694128, "num_env_steps_trained_throughput_per_sec": 810.1300638694128, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 4984.159, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4984.127, "sample_time_ms": 682.154, "learn_time_ms": 4291.46, "learn_throughput": 932.084, "synch_weights_time_ms": 10.143}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 52, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-47", "timestamp": 1723345487, "time_this_iter_s": 4.940046787261963, "time_total_s": 267.1252520084381, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.1252520084381, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 27.328571428571426, "ram_util_percent": 82.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.930872574914247, "cur_kl_coeff": 0.017797851562499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.671046190957228, "policy_loss": -0.0050237450656519895, "vf_loss": 6.675829193989435, "vf_explained_var": 0.45363578461110593, "kl": 0.013524262718312644, "entropy": 0.8423314073433479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9383630922064183, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.265558922787507, "policy_loss": -0.00720576656992004, "vf_loss": 6.27092128743728, "vf_explained_var": -0.03473933065931002, "kl": 0.010923764358185413, "entropy": 1.3695868195345005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 347.1, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 34710, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 11.886369766486554, "predator_policy": -11.886369766486554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297], "policy_prey_policy_reward": [-25.967389450441495, 40.109390050646965, 62.038941796834706, 29.224259011916153, 54.433035845254096, 46.77121241432082, 2.9770322296014093, 34.89405543118361, -21.15187462680633, 24.572766184510833, 53.13801193025611, 46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848], "policy_predator_policy_reward": [25.967389450441495, -40.109390050646965, -62.038941796834706, -29.224259011916153, -54.433035845254096, -46.77121241432082, -2.9770322296014093, -34.89405543118361, 21.15187462680633, -24.572766184510833, -53.13801193025611, -46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855723430398397, "mean_inference_ms": 0.946047854303772, "mean_action_processing_ms": 0.12885823731560667, "mean_env_wait_ms": 0.06296848761885414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003911852836608887, "StateBufferConnector_ms": 0.002106189727783203, "ViewRequirementAgentConnector_ms": 0.057718873023986816}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.6222075807376, "num_env_steps_trained_throughput_per_sec": 806.6222075807376, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 4984.336, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4984.304, "sample_time_ms": 684.233, "learn_time_ms": 4289.498, "learn_throughput": 932.51, "synch_weights_time_ms": 10.204}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "training_iteration": 53, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-52", "timestamp": 1723345492, "time_this_iter_s": 4.961796283721924, "time_total_s": 272.08704829216003, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c579d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.08704829216003, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 27.487499999999997, "ram_util_percent": 82.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.112646855507046, "cur_kl_coeff": 0.017797851562499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.51332353502512, "policy_loss": -0.002486414164256227, "vf_loss": 5.51545316328605, "vf_explained_var": 0.24391975632558266, "kl": 0.02004676785942756, "entropy": 0.817880394247671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8418851759905617, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.611086963613828, "policy_loss": -0.00249543097888818, "vf_loss": 3.6123001009225844, "vf_explained_var": 0.4987634585549434, "kl": 0.00759884349655409, "entropy": 1.370961793512106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 345.6, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34560, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.63766461223064}, "policy_reward_max": {"prey_policy": 62.63766461223064, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 11.85871329367902, "predator_policy": -11.85871329367902}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 268, 376, 400, 400, 400, 400, 400, 400, 366, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400], "policy_prey_policy_reward": [46.83702976969996, -24.042979987462708, -18.279779571346292, -20.52962953865781, -4.9758529977352515, -8.405850010698789, -17.083187393589903, -16.445043597617115, 56.12305771333245, 59.15907817758372, -31.224304900307622, 55.295465742845266, -37.54571095696051, 62.63766461223064, 28.881873657347867, -22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456], "policy_predator_policy_reward": [-46.83702976969996, 24.042979987462708, 18.279779571346292, 20.52962953865781, 4.9758529977352515, 8.405850010698789, 17.083187393589903, 16.445043597617115, -56.12305771333245, -59.15907817758372, 31.224304900307622, -55.295465742845266, 37.54571095696051, -62.63766461223064, -28.881873657347867, 22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28546195893830556, "mean_inference_ms": 0.9457117995676447, "mean_action_processing_ms": 0.12875807614312781, "mean_env_wait_ms": 0.06295749214971542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040187835693359375, "StateBufferConnector_ms": 0.0021409988403320312, "ViewRequirementAgentConnector_ms": 0.058852434158325195}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 825.959396817648, "num_env_steps_trained_throughput_per_sec": 825.959396817648, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 4975.138, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4975.106, "sample_time_ms": 678.687, "learn_time_ms": 4285.841, "learn_throughput": 933.306, "synch_weights_time_ms": 10.214}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 54, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-04-56", "timestamp": 1723345496, "time_this_iter_s": 4.845245838165283, "time_total_s": 276.9322941303253, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.9322941303253, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 29.799999999999997, "ram_util_percent": 82.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.250921987804274, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.984582437078158, "policy_loss": -0.01278800466437436, "vf_loss": 5.996073506772518, "vf_explained_var": 0.4520272588357329, "kl": 0.04857981514941929, "entropy": 0.8460286527251204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7903446200614175, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.504926307251056, "policy_loss": -0.003338992890591423, "vf_loss": 3.507140405351917, "vf_explained_var": 0.10642706211656332, "kl": 0.006666052339335467, "entropy": 1.3889415784428516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 336.8, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 33680, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 13.845231059214509, "predator_policy": -13.845231059214509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400], "policy_prey_policy_reward": [-22.590890216876236, 54.67131707020062, 45.438171647385055, 28.546681089086178, 31.55424812940236, -25.583834173448246, 48.59530750616425, 62.25926704975266, 39.56729566075158, -1.5245431916400207, 36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752], "policy_predator_policy_reward": [22.590890216876236, -54.67131707020062, -45.438171647385055, -28.546681089086178, -31.55424812940236, 25.583834173448246, -48.59530750616425, -62.25926704975266, -39.56729566075158, 1.5245431916400207, -36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28519536653173516, "mean_inference_ms": 0.9450364445174066, "mean_action_processing_ms": 0.12871451363630063, "mean_env_wait_ms": 0.06283657618213208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004080057144165039, "StateBufferConnector_ms": 0.002152681350708008, "ViewRequirementAgentConnector_ms": 0.05918240547180176}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.5032404570634, "num_env_steps_trained_throughput_per_sec": 811.5032404570634, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 4954.617, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4954.585, "sample_time_ms": 674.132, "learn_time_ms": 4269.848, "learn_throughput": 936.802, "synch_weights_time_ms": 10.258}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 55, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-01", "timestamp": 1723345501, "time_this_iter_s": 4.932131052017212, "time_total_s": 281.86442518234253, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.86442518234253, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 28.085714285714285, "ram_util_percent": 82.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.642889169231057, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5558507164319355, "policy_loss": -0.002800238729105331, "vf_loss": 6.558402735988299, "vf_explained_var": 0.5110951463381449, "kl": 0.006198478233302577, "entropy": 0.8330946934098998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5609134608258803, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.946750661234061, "policy_loss": -0.010110307942522923, "vf_loss": 3.9542911618947985, "vf_explained_var": 0.03898473499963681, "kl": 0.015228528127931682, "entropy": 1.3945595156401396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 333.46, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33346, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 14.442144855770861, "predator_policy": -14.442144855770861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 395, 2, 400, 54, 400, 304, 400, 38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [36.474771718659376, 40.42342020062619, 36.212384433009305, 53.77929719561361, -31.335915815052452, -2.621335568972733, 53.553172901323556, -31.937333717542973, -13.05112438346967, -25.56847050888249, -38.06697248318388, -9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527], "policy_predator_policy_reward": [-36.474771718659376, -40.42342020062619, -36.212384433009305, -53.77929719561361, 31.335915815052452, 2.621335568972733, -53.553172901323556, 31.937333717542973, 13.05112438346967, 25.56847050888249, 38.06697248318388, 9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2852086691785207, "mean_inference_ms": 0.9449561150506389, "mean_action_processing_ms": 0.1286599205787535, "mean_env_wait_ms": 0.0628198168969917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040967464447021484, "StateBufferConnector_ms": 0.0021811723709106445, "ViewRequirementAgentConnector_ms": 0.05951201915740967}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 794.3914046791831, "num_env_steps_trained_throughput_per_sec": 794.3914046791831, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 4962.568, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4962.536, "sample_time_ms": 673.322, "learn_time_ms": 4278.36, "learn_throughput": 934.938, "synch_weights_time_ms": 10.499}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-06", "timestamp": 1723345506, "time_this_iter_s": 5.038321256637573, "time_total_s": 286.9027464389801, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b48938b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 286.9027464389801, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 34.15, "ram_util_percent": 82.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7229016327609616, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.580938389897346, "policy_loss": -0.00843926889016681, "vf_loss": 6.588202302157879, "vf_explained_var": 0.4616164568811655, "kl": 0.029350693649947326, "entropy": 0.80923027942578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3312601427858075, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.505956968665123, "policy_loss": -0.006269323257826424, "vf_loss": 4.510723370313644, "vf_explained_var": 0.3742981320867936, "kl": 0.008906163317617436, "entropy": 1.3752274693300326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 333.36, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 33336, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 15.961672629820487, "predator_policy": -15.961672629820487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [38, 400, 134, 400, 400, 379, 170, 400, 400, 79, 307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400], "policy_prey_policy_reward": [-9.529578495020282, -7.014890657093705, -35.90035904477631, 50.96453798331023, -21.221326851994142, -24.70291606664405, -19.280257694513704, 45.4091418843916, 33.69529951038871, -16.331964145910465, -36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045], "policy_predator_policy_reward": [9.529578495020282, 7.014890657093705, 35.90035904477631, -50.96453798331023, 21.221326851994142, 24.70291606664405, 19.280257694513704, -45.4091418843916, -33.69529951038871, 16.331964145910465, 36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28512568697103147, "mean_inference_ms": 0.9442641111569253, "mean_action_processing_ms": 0.12862413887139099, "mean_env_wait_ms": 0.06279511492848829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004166126251220703, "StateBufferConnector_ms": 0.0021963119506835938, "ViewRequirementAgentConnector_ms": 0.06029057502746582}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 756.9261892548274, "num_env_steps_trained_throughput_per_sec": 756.9261892548274, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 5002.97, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5002.937, "sample_time_ms": 684.843, "learn_time_ms": 4307.27, "learn_throughput": 928.663, "synch_weights_time_ms": 10.455}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 57, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-12", "timestamp": 1723345512, "time_this_iter_s": 5.297292947769165, "time_total_s": 292.20003938674927, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.20003938674927, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 40.55714285714286, "ram_util_percent": 83.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.999543518697222, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.575910511612892, "policy_loss": -0.00448544372387308, "vf_loss": 6.579596689840158, "vf_explained_var": 0.5196880579615633, "kl": 0.013306522567550095, "entropy": 0.8228871727983157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.146245067442457, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.931673593322436, "policy_loss": -0.005528992709878366, "vf_loss": 3.935442831615607, "vf_explained_var": 0.0271687110265096, "kl": 0.010428245396533746, "entropy": 1.3896307868262132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 339.88, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33988, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 17.976070690623818, "predator_policy": -17.976070690623818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [307, 400, 293, 400, 400, 400, 400, 400, 176, 400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400], "policy_prey_policy_reward": [-36.52855133274668, 62.2167731776833, -26.32780067389659, 36.87686742089013, 35.77088450781423, 51.833955184139874, 28.723782875696678, 33.44620662111241, -30.470865038753107, 55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945], "policy_predator_policy_reward": [36.52855133274668, -62.2167731776833, 26.32780067389659, -36.87686742089013, -35.77088450781423, -51.833955184139874, -28.723782875696678, -33.44620662111241, 30.470865038753107, -55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28507541069016484, "mean_inference_ms": 0.9438034204717667, "mean_action_processing_ms": 0.12852840899814053, "mean_env_wait_ms": 0.0627919856232878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032007694244384766, "StateBufferConnector_ms": 0.0021020174026489258, "ViewRequirementAgentConnector_ms": 0.05101168155670166}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 817.3799327600753, "num_env_steps_trained_throughput_per_sec": 817.3799327600753, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 4995.666, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4995.633, "sample_time_ms": 679.192, "learn_time_ms": 4305.6, "learn_throughput": 929.023, "synch_weights_time_ms": 10.472}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 58, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-17", "timestamp": 1723345517, "time_this_iter_s": 4.896543025970459, "time_total_s": 297.0965824127197, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.0965824127197, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 34.38571428571429, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3896898700545233, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.61684951633215, "policy_loss": -0.00012905259209219366, "vf_loss": 6.616863915820916, "vf_explained_var": 0.26712321856369575, "kl": 0.0019086167686433563, "entropy": 0.722238100754718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.782428760578235, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.464482828974724, "policy_loss": -0.012296861571909783, "vf_loss": 3.4746707630654177, "vf_explained_var": 0.6572045399496953, "kl": 0.012497307100987348, "entropy": 1.3762202655275664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 343.48, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 34348, "policy_reward_min": {"prey_policy": -48.59406689048612, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 48.59406689048612}, "policy_reward_mean": {"prey_policy": 18.96163784315594, "predator_policy": -18.96163784315594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 284, 400, 275, 184, 213, 392, 400, 218, 400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400], "policy_prey_policy_reward": [55.25514441440378, 47.89623049609378, 48.67654097616039, -35.57780771566469, 47.94457032051621, -23.709326768022894, 41.162394834578244, -8.911186137042039, -27.16196505303743, -10.357180682169037, -44.897000192166765, 33.87625655682227, -48.59406689048612, 27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694], "policy_predator_policy_reward": [-55.25514441440378, -47.89623049609378, -48.67654097616039, 35.57780771566469, -47.94457032051621, 23.709326768022894, -41.162394834578244, 8.911186137042039, 27.16196505303743, 10.357180682169037, 44.897000192166765, -33.87625655682227, 48.59406689048612, -27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28501595785707384, "mean_inference_ms": 0.943425924388526, "mean_action_processing_ms": 0.12843403508938359, "mean_env_wait_ms": 0.06274577101991075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030051469802856445, "StateBufferConnector_ms": 0.002077937126159668, "ViewRequirementAgentConnector_ms": 0.05043387413024902}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 820.3484477708025, "num_env_steps_trained_throughput_per_sec": 820.3484477708025, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 4965.584, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4965.552, "sample_time_ms": 652.584, "learn_time_ms": 4302.345, "learn_throughput": 929.726, "synch_weights_time_ms": 10.259}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "training_iteration": 59, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-22", "timestamp": 1723345522, "time_this_iter_s": 4.878684997558594, "time_total_s": 301.9752674102783, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 301.9752674102783, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 28.8, "ram_util_percent": 82.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5775561364057165, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.34244160776337, "policy_loss": -0.003508144758234266, "vf_loss": 5.345781928797563, "vf_explained_var": 0.4400851013759772, "kl": 0.005587912664801327, "entropy": 0.7630446655054887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6265179736539723, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.161210286368926, "policy_loss": -0.006537124541743348, "vf_loss": 4.165201014031966, "vf_explained_var": 0.2332602674762408, "kl": 0.015089782185303432, "entropy": 1.3000663202255964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 346.25, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 34625, "policy_reward_min": {"prey_policy": -42.37115363092147, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 42.37115363092147}, "policy_reward_mean": {"prey_policy": 21.814930497254863, "predator_policy": -21.814930497254863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 376, 162, 400, 400, 15, 400, 250, 400, 400, 400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400], "policy_prey_policy_reward": [27.661561977796552, -26.842665658864817, -10.39722633878005, -22.08174779587588, 38.22481950951227, -8.719900104933165, 46.184337523835346, -28.95525183371754, 11.460309184278394, 39.88949187014409, 48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604], "policy_predator_policy_reward": [-27.661561977796552, 26.842665658864817, 10.39722633878005, 22.08174779587588, -38.22481950951227, 8.719900104933165, -46.184337523835346, 28.95525183371754, -11.460309184278394, -39.88949187014409, -48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847353184052513, "mean_inference_ms": 0.9424395100319132, "mean_action_processing_ms": 0.1284168804602232, "mean_env_wait_ms": 0.06269106472955302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003114938735961914, "StateBufferConnector_ms": 0.0030672550201416016, "ViewRequirementAgentConnector_ms": 0.053291916847229004}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 761.451938577576, "num_env_steps_trained_throughput_per_sec": 761.451938577576, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 4992.992, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4992.96, "sample_time_ms": 655.658, "learn_time_ms": 4326.395, "learn_throughput": 924.557, "synch_weights_time_ms": 10.539}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 60, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-27", "timestamp": 1723345527, "time_this_iter_s": 5.291493892669678, "time_total_s": 307.266761302948, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.266761302948, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 29.185714285714283, "ram_util_percent": 82.45714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.819212810943524, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.871477291981379, "policy_loss": -0.0033943146874662487, "vf_loss": 5.874622499942779, "vf_explained_var": 0.4722000495220224, "kl": 0.008294709796797198, "entropy": 0.7708813689028223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.040739602036774, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.174109047402938, "policy_loss": -0.0042351608390163165, "vf_loss": 5.1770417268077535, "vf_explained_var": 0.18128272394339243, "kl": 0.007718503871747836, "entropy": 1.2521848428994418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 352.45, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35245, "policy_reward_min": {"prey_policy": -42.37115363092147, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 42.37115363092147}, "policy_reward_mean": {"prey_policy": 22.68668406507607, "predator_policy": -22.68668406507607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 223, 400, 70, 400, 400, 125, 400, 400, 400, 297, 400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [48.65535556282415, -33.287590522472655, -27.26340539223562, -37.59296786008572, 48.695670955876494, 47.85690585893357, -25.702935642572086, 39.247880697574125, 60.15339654690953, 30.181742987599876, -26.198534280001848, 30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726], "policy_predator_policy_reward": [-48.65535556282415, 33.287590522472655, 27.26340539223562, 37.59296786008572, -48.695670955876494, -47.85690585893357, 25.702935642572086, -39.247880697574125, -60.15339654690953, -30.181742987599876, 26.198534280001848, -30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2845188089038726, "mean_inference_ms": 0.941940201517083, "mean_action_processing_ms": 0.128372733037422, "mean_env_wait_ms": 0.06259095067979117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003087162971496582, "StateBufferConnector_ms": 0.0030750036239624023, "ViewRequirementAgentConnector_ms": 0.05349326133728027}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 760.5715224508284, "num_env_steps_trained_throughput_per_sec": 760.5715224508284, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 5027.03, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5026.996, "sample_time_ms": 658.21, "learn_time_ms": 4357.819, "learn_throughput": 917.89, "synch_weights_time_ms": 10.6}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "training_iteration": 61, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-32", "timestamp": 1723345532, "time_this_iter_s": 5.263290882110596, "time_total_s": 312.5300521850586, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.5300521850586, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 34.6, "ram_util_percent": 81.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.157474382780492, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.660745445390543, "policy_loss": -0.008008995947602671, "vf_loss": 4.668264677623908, "vf_explained_var": 0.5075007024531563, "kl": 0.016307658662622758, "entropy": 0.834070257904629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.348469973169267, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.914568068832159, "policy_loss": -0.00629389518823397, "vf_loss": 4.919112349798282, "vf_explained_var": -0.05752762605746587, "kl": 0.010368104743891611, "entropy": 1.26751656383276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 361.3, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36130, "policy_reward_min": {"prey_policy": -42.37115363092147, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 42.37115363092147}, "policy_reward_mean": {"prey_policy": 24.498796809519106, "predator_policy": -24.498796809519106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 342, 193, 400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [30.76957979558881, 60.893183721940055, 36.60185919531174, 49.673531933968334, 50.71348732569812, -20.516745075006046, 30.690728553930676, 47.77559906683593, -5.887157282083102, -18.190982139835874, 35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173], "policy_predator_policy_reward": [-30.76957979558881, -60.893183721940055, -36.60185919531174, -49.673531933968334, -50.71348732569812, 20.516745075006046, -30.690728553930676, -47.77559906683593, 5.887157282083102, 18.190982139835874, -35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2844794097966078, "mean_inference_ms": 0.9411136312190759, "mean_action_processing_ms": 0.12829266078354412, "mean_env_wait_ms": 0.06261832971618869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029687881469726562, "StateBufferConnector_ms": 0.0030374526977539062, "ViewRequirementAgentConnector_ms": 0.05174088478088379}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 762.8908338507271, "num_env_steps_trained_throughput_per_sec": 762.8908338507271, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 5057.604, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5057.569, "sample_time_ms": 667.402, "learn_time_ms": 4379.168, "learn_throughput": 913.416, "synch_weights_time_ms": 10.625}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 62, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-37", "timestamp": 1723345537, "time_this_iter_s": 5.266102075576782, "time_total_s": 317.7961542606354, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 317.7961542606354, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 32.08571428571428, "ram_util_percent": 82.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.054249961860478, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.942193241169055, "policy_loss": -0.007394993199947446, "vf_loss": 4.949069686730703, "vf_explained_var": 0.623042312078178, "kl": 0.017266019448716936, "entropy": 0.8912672709052761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3883471857756375, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6002859704196455, "policy_loss": -0.006381470787649353, "vf_loss": 4.604990913967291, "vf_explained_var": -0.014675139635801315, "kl": 0.009935097655062303, "entropy": 1.2787897707273563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.95, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36395, "policy_reward_min": {"prey_policy": -42.37115363092147, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 42.37115363092147}, "policy_reward_mean": {"prey_policy": 23.00858243187947, "predator_policy": -23.00858243187947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 20, 400, 400, 135, 400, 170, 400, 400, 400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [35.75070844017456, 36.40692828003487, 36.46829814563, -13.308768598354762, 50.62704650843332, 26.512609945856475, -15.020520218008487, 42.140625330037444, -3.6294732995366203, 53.316758538965345, 52.80892741777409, 41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088], "policy_predator_policy_reward": [-35.75070844017456, -36.40692828003487, -36.46829814563, 13.308768598354762, -50.62704650843332, -26.512609945856475, 15.020520218008487, -42.140625330037444, 3.6294732995366203, -53.316758538965345, -52.80892741777409, -41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2844026232017263, "mean_inference_ms": 0.9408314172345197, "mean_action_processing_ms": 0.12823691763757472, "mean_env_wait_ms": 0.06259329690536942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028510093688964844, "StateBufferConnector_ms": 0.0029927492141723633, "ViewRequirementAgentConnector_ms": 0.05036818981170654}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.1800384726838, "num_env_steps_trained_throughput_per_sec": 805.1800384726838, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 5058.492, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5058.457, "sample_time_ms": 666.298, "learn_time_ms": 4381.258, "learn_throughput": 912.98, "synch_weights_time_ms": 10.526}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 63, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-42", "timestamp": 1723345542, "time_this_iter_s": 4.970672130584717, "time_total_s": 322.7668263912201, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.7668263912201, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 30.54285714285714, "ram_util_percent": 81.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.059399227239192, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.05953177685539, "policy_loss": -0.006653099245401487, "vf_loss": 5.0656660755475365, "vf_explained_var": 0.5183752882604797, "kl": 0.017273844543334433, "entropy": 0.9064072152599693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2093133927012483, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.066853870948155, "policy_loss": -0.004490617599852461, "vf_loss": 5.070032794276873, "vf_explained_var": -0.031475134876867136, "kl": 0.007773034908992808, "entropy": 1.2341679584234952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 372.7, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37270, "policy_reward_min": {"prey_policy": -42.37115363092147, "predator_policy": -62.85626815142108}, "policy_reward_max": {"prey_policy": 62.85626815142108, "predator_policy": 42.37115363092147}, "policy_reward_mean": {"prey_policy": 21.583817558157044, "predator_policy": -21.583817558157044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 205, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [41.77046351161404, -42.37115363092147, -14.010398216652181, 62.85626815142108, 14.485995405919752, 48.84498997330633, -29.504515614662175, 30.957108100571745, -8.996606179802988, 42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805], "policy_predator_policy_reward": [-41.77046351161404, 42.37115363092147, 14.010398216652181, -62.85626815142108, -14.485995405919752, -48.84498997330633, 29.504515614662175, -30.957108100571745, 8.996606179802988, -42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2843990994248651, "mean_inference_ms": 0.9403509740490135, "mean_action_processing_ms": 0.12828133358770294, "mean_env_wait_ms": 0.0626176200333002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002839207649230957, "StateBufferConnector_ms": 0.002968430519104004, "ViewRequirementAgentConnector_ms": 0.04970431327819824}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 820.5734588670167, "num_env_steps_trained_throughput_per_sec": 820.5734588670167, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 5061.671, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5061.636, "sample_time_ms": 665.687, "learn_time_ms": 4385.023, "learn_throughput": 912.196, "synch_weights_time_ms": 10.55}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 64, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-47", "timestamp": 1723345547, "time_this_iter_s": 4.87724494934082, "time_total_s": 327.6440713405609, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 327.6440713405609, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 27.928571428571427, "ram_util_percent": 81.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.650751187155644, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.864844969411691, "policy_loss": -0.003760416394895098, "vf_loss": 5.868302393953005, "vf_explained_var": 0.5343336771552761, "kl": 0.010088208410407964, "entropy": 0.8373084316651026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0224221323616804, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.866768113027017, "policy_loss": -0.006439389446071194, "vf_loss": 4.871721148490906, "vf_explained_var": 0.13323549851775168, "kl": 0.00880790784904345, "entropy": 1.1835061685492596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.99, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37799, "policy_reward_min": {"prey_policy": -40.70307361498715, "predator_policy": -61.11353719113712}, "policy_reward_max": {"prey_policy": 61.11353719113712, "predator_policy": 40.70307361498715}, "policy_reward_mean": {"prey_policy": 22.778382103726, "predator_policy": -22.778382103726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [42.03871514636836, 53.893624142336634, 49.99866948782175, 49.1868749469068, 50.441876851221586, 33.76366337234527, 59.768095239950355, 37.790648190615464, 48.7878326884392, 41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728], "policy_predator_policy_reward": [-42.03871514636836, -53.893624142336634, -49.99866948782175, -49.1868749469068, -50.441876851221586, -33.76366337234527, -59.768095239950355, -37.790648190615464, -48.7878326884392, -41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2843566707865197, "mean_inference_ms": 0.940354387488872, "mean_action_processing_ms": 0.1281716359836803, "mean_env_wait_ms": 0.06261630550191032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028711557388305664, "StateBufferConnector_ms": 0.0029898881912231445, "ViewRequirementAgentConnector_ms": 0.050341248512268066}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.9782914140835, "num_env_steps_trained_throughput_per_sec": 800.9782914140835, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 5068.147, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5068.112, "sample_time_ms": 664.345, "learn_time_ms": 4393.02, "learn_throughput": 910.535, "synch_weights_time_ms": 10.373}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 65, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-52", "timestamp": 1723345552, "time_this_iter_s": 4.9965410232543945, "time_total_s": 332.6406123638153, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.6406123638153, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 28.5125, "ram_util_percent": 82.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8302173713843026, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.280698441465696, "policy_loss": -0.002271081897682355, "vf_loss": 5.282561901708444, "vf_explained_var": 0.3288915168493986, "kl": 0.01357183433121577, "entropy": 0.8524421712383627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.301792257713775, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3527394918104014, "policy_loss": -0.006332710195420077, "vf_loss": 3.3574165681997936, "vf_explained_var": 0.5562361751993498, "kl": 0.009811136366642855, "entropy": 1.2764036214600007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.99, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37799, "policy_reward_min": {"prey_policy": -40.70307361498715, "predator_policy": -61.11353719113712}, "policy_reward_max": {"prey_policy": 61.11353719113712, "predator_policy": 40.70307361498715}, "policy_reward_mean": {"prey_policy": 21.87398733290144, "predator_policy": -21.87398733290144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 74, 400, 400, 173, 241, 257, 400, 400, 400, 400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [41.93414598889578, -8.357385766976602, 56.831147702843296, 46.828286236554966, -32.77549794320863, -33.67301798115308, -40.70307361498715, 53.383490636117045, 51.724193389085045, 42.022741111067496, 43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132], "policy_predator_policy_reward": [-41.93414598889578, 8.357385766976602, -56.831147702843296, -46.828286236554966, 32.77549794320863, 33.67301798115308, 40.70307361498715, -53.383490636117045, -51.724193389085045, -42.022741111067496, -43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842837932543235, "mean_inference_ms": 0.9400756530646066, "mean_action_processing_ms": 0.12813646246819432, "mean_env_wait_ms": 0.06260953489609938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002873539924621582, "StateBufferConnector_ms": 0.0029611587524414062, "ViewRequirementAgentConnector_ms": 0.05001199245452881}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 824.0567037232817, "num_env_steps_trained_throughput_per_sec": 824.0567037232817, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 5050.021, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5049.987, "sample_time_ms": 660.1, "learn_time_ms": 4379.496, "learn_throughput": 913.347, "synch_weights_time_ms": 10.026}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 66, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-05-57", "timestamp": 1723345557, "time_this_iter_s": 4.856563091278076, "time_total_s": 337.4971754550934, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.4971754550934, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 29.383333333333336, "ram_util_percent": 82.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.502133566389481, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6308337792754175, "policy_loss": -0.0017873946543356092, "vf_loss": 5.632446556786696, "vf_explained_var": -0.008267179566125075, "kl": 0.005814740756038091, "entropy": 0.869481575426956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.883428434903423, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.195257207999627, "policy_loss": -0.0040318806483507314, "vf_loss": 4.197841629385948, "vf_explained_var": 0.19866965431720018, "kl": 0.008577528689072807, "entropy": 1.1845320738852023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.54, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38654, "policy_reward_min": {"prey_policy": -32.42932877484682, "predator_policy": -61.11353719113712}, "policy_reward_max": {"prey_policy": 61.11353719113712, "predator_policy": 32.42932877484682}, "policy_reward_mean": {"prey_policy": 22.31172971483219, "predator_policy": -22.31172971483219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 262, 389, 156, 245, 400, 400, 400, 400, 400, 400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [43.54199348534161, -27.760379092314277, -27.88128483739139, -21.05844040078986, -14.119396789647073, 61.11353719113712, 30.9191291143499, 59.025399331631945, 31.770226239438074, 23.467814010678303, 20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516], "policy_predator_policy_reward": [-43.54199348534161, 27.760379092314277, 27.88128483739139, 21.05844040078986, 14.119396789647073, -61.11353719113712, -30.9191291143499, -59.025399331631945, -31.770226239438074, -23.467814010678303, -20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842219495647301, "mean_inference_ms": 0.9396992678381777, "mean_action_processing_ms": 0.1280746260415375, "mean_env_wait_ms": 0.06259102581690096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002832651138305664, "StateBufferConnector_ms": 0.002931356430053711, "ViewRequirementAgentConnector_ms": 0.049309492111206055}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.3417236746659, "num_env_steps_trained_throughput_per_sec": 806.3417236746659, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 5017.635, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5017.602, "sample_time_ms": 649.579, "learn_time_ms": 4357.63, "learn_throughput": 917.93, "synch_weights_time_ms": 10.046}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "training_iteration": 67, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-02", "timestamp": 1723345562, "time_this_iter_s": 4.963325023651123, "time_total_s": 342.4605004787445, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.4605004787445, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.442857142857143, "ram_util_percent": 82.04285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.514474488484363, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.029774197936058, "policy_loss": -0.01063012287171053, "vf_loss": 5.03971519668897, "vf_explained_var": -0.0023583161334196725, "kl": 0.022944689830770946, "entropy": 0.8955973924448093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.992436339209477, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.960655715192358, "policy_loss": -0.0035954094397311564, "vf_loss": 2.9632107292612395, "vf_explained_var": 0.17991472488890092, "kl": 0.006165316309923989, "entropy": 1.2084136486053467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.05, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38805, "policy_reward_min": {"prey_policy": -32.42932877484682, "predator_policy": -59.707345999959294}, "policy_reward_max": {"prey_policy": 59.707345999959294, "predator_policy": 32.42932877484682}, "policy_reward_mean": {"prey_policy": 22.62586577590639, "predator_policy": -22.62586577590639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 336, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.90123138378538, 42.253023807764215, -32.42932877484682, 29.403917881869482, 35.19351178737309, 46.14998053345517, 57.387591125635694, 37.442022727822525, 51.0007331766075, 31.189859741612395, 49.29793880641561, 41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185], "policy_predator_policy_reward": [-20.90123138378538, -42.253023807764215, 32.42932877484682, -29.403917881869482, -35.19351178737309, -46.14998053345517, -57.387591125635694, -37.442022727822525, -51.0007331766075, -31.189859741612395, -49.29793880641561, -41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.284126685462627, "mean_inference_ms": 0.9391218742355187, "mean_action_processing_ms": 0.12804061838336803, "mean_env_wait_ms": 0.06255436335640209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028706789016723633, "StateBufferConnector_ms": 0.002979755401611328, "ViewRequirementAgentConnector_ms": 0.05040895938873291}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 814.2011310538293, "num_env_steps_trained_throughput_per_sec": 814.2011310538293, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 5019.545, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5019.512, "sample_time_ms": 649.655, "learn_time_ms": 4359.245, "learn_throughput": 917.59, "synch_weights_time_ms": 10.257}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 68, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-07", "timestamp": 1723345567, "time_this_iter_s": 4.915619611740112, "time_total_s": 347.3761200904846, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c49f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.3761200904846, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.771428571428572, "ram_util_percent": 82.12857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.456885349936783, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.994842066864172, "policy_loss": -0.005386973763233982, "vf_loss": 4.999391352633635, "vf_explained_var": -0.11421063517530759, "kl": 0.018594651739379523, "entropy": 0.8904935967177152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9555309106906256, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7979726143181325, "policy_loss": -0.005008756820219181, "vf_loss": 3.801855169609189, "vf_explained_var": -0.07116805613040925, "kl": 0.006673895271092559, "entropy": 1.1210903438429038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.69, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38869, "policy_reward_min": {"prey_policy": -32.152445092037205, "predator_policy": -59.707345999959294}, "policy_reward_max": {"prey_policy": 59.707345999959294, "predator_policy": 32.152445092037205}, "policy_reward_mean": {"prey_policy": 20.38512894402075, "predator_policy": -20.38512894402075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 114, 400, 129, 400, 400, 400, 400, 223, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [41.7863079674772, 11.412508386486838, 49.86806687312186, 32.11903494938912, -24.69704619335894, 41.91876661058172, -15.11152541301974, 20.643675401645304, 34.06152653509604, 5.5184802639377, 4.236183594452978, -24.607796058986093, -8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014], "policy_predator_policy_reward": [-41.7863079674772, -11.412508386486838, -49.86806687312186, -32.11903494938912, 24.69704619335894, -41.91876661058172, 15.11152541301974, -20.643675401645304, -34.06152653509604, -5.5184802639377, -4.236183594452978, 24.607796058986093, 8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28396294801294913, "mean_inference_ms": 0.9386479822504105, "mean_action_processing_ms": 0.12797526620559807, "mean_env_wait_ms": 0.06253122750601735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002942204475402832, "StateBufferConnector_ms": 0.002969980239868164, "ViewRequirementAgentConnector_ms": 0.050190091133117676}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.2095885350031, "num_env_steps_trained_throughput_per_sec": 797.2095885350031, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 5033.698, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5033.665, "sample_time_ms": 653.228, "learn_time_ms": 4369.946, "learn_throughput": 915.343, "synch_weights_time_ms": 10.141}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 69, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-12", "timestamp": 1723345572, "time_this_iter_s": 5.020136117935181, "time_total_s": 352.3962562084198, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 352.3962562084198, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 27.0125, "ram_util_percent": 82.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.57678909006839, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.155729830265045, "policy_loss": -0.007500650845516551, "vf_loss": 4.162452434003353, "vf_explained_var": -0.6770704766735435, "kl": 0.017270486427280927, "entropy": 0.8480500732858975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.458814910488824, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.510658717652162, "policy_loss": -0.009919050478977927, "vf_loss": 3.518600855519374, "vf_explained_var": 0.22537461494406064, "kl": 0.011714986074782377, "entropy": 1.0838335664321979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.38, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38838, "policy_reward_min": {"prey_policy": -32.152445092037205, "predator_policy": -59.707345999959294}, "policy_reward_max": {"prey_policy": 59.707345999959294, "predator_policy": 32.152445092037205}, "policy_reward_mean": {"prey_policy": 19.82419737866117, "predator_policy": -19.82419737866117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400], "policy_prey_policy_reward": [-8.943063048493123, 26.6231758403841, 47.624390329442576, 28.912171250435932, -4.05295867810036, 44.11121041787676, 34.177291204565726, 17.04047985881077, -10.412453678150243, 59.707345999959294, 30.927271732237315, 51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956], "policy_predator_policy_reward": [8.943063048493123, -26.6231758403841, -47.624390329442576, -28.912171250435932, 4.05295867810036, -44.11121041787676, -34.177291204565726, -17.04047985881077, 10.412453678150243, -59.707345999959294, -30.927271732237315, -51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2839223491775266, "mean_inference_ms": 0.9383405635242639, "mean_action_processing_ms": 0.12790898618235824, "mean_env_wait_ms": 0.06250619841141952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004104137420654297, "StateBufferConnector_ms": 0.0020486116409301758, "ViewRequirementAgentConnector_ms": 0.048213839530944824}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.4205939309049, "num_env_steps_trained_throughput_per_sec": 802.4205939309049, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 5006.877, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5006.844, "sample_time_ms": 653.827, "learn_time_ms": 4342.725, "learn_throughput": 921.081, "synch_weights_time_ms": 9.955}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 70, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-17", "timestamp": 1723345577, "time_this_iter_s": 4.9877917766571045, "time_total_s": 357.3840479850769, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b48fa820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 357.3840479850769, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 28.528571428571432, "ram_util_percent": 82.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.086538566586872, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.69710874085625, "policy_loss": -0.005480430063471431, "vf_loss": 4.702441406995058, "vf_explained_var": -0.33203152356048427, "kl": 0.0032802622311985867, "entropy": 0.880367012694478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2247057585045695, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6068985809882483, "policy_loss": -0.003983357515729343, "vf_loss": 3.609550889581442, "vf_explained_var": 0.048497688087324305, "kl": 0.007887664087135173, "entropy": 1.0943188657984138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.38, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38838, "policy_reward_min": {"prey_policy": -32.152445092037205, "predator_policy": -58.02139004875044}, "policy_reward_max": {"prey_policy": 58.02139004875044, "predator_policy": 32.152445092037205}, "policy_reward_mean": {"prey_policy": 18.757530485498034, "predator_policy": -18.757530485498034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [51.76049130992401, 52.311559965749076, 36.463190010721775, -0.3133960050310165, 47.064373661641184, 38.015937421984624, -16.608006921193173, 1.0129436247929036, 41.11341668310915, 14.105398671796301, 31.61659631935003, 32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253], "policy_predator_policy_reward": [-51.76049130992401, -52.311559965749076, -36.463190010721775, 0.3133960050310165, -47.064373661641184, -38.015937421984624, 16.608006921193173, -1.0129436247929036, -41.11341668310915, -14.105398671796301, -31.61659631935003, -32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2837801096700171, "mean_inference_ms": 0.9378835787799822, "mean_action_processing_ms": 0.1278490246471832, "mean_env_wait_ms": 0.062461283640096434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004105091094970703, "StateBufferConnector_ms": 0.0020568370819091797, "ViewRequirementAgentConnector_ms": 0.04731595516204834}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.3526343283118, "num_env_steps_trained_throughput_per_sec": 736.3526343283118, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 5024.174, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5024.142, "sample_time_ms": 660.047, "learn_time_ms": 4353.453, "learn_throughput": 918.811, "synch_weights_time_ms": 10.296}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "training_iteration": 71, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-23", "timestamp": 1723345583, "time_this_iter_s": 5.438318967819214, "time_total_s": 362.8223669528961, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c57f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 362.8223669528961, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 34.51428571428572, "ram_util_percent": 82.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.140630663558841, "cur_kl_coeff": 0.022525405883789058, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6245365445812543, "policy_loss": -0.005245716289694732, "vf_loss": 3.629417511075735, "vf_explained_var": 0.13418996874243022, "kl": 0.016193086119710723, "entropy": 0.8453561893974741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.160783031210303, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3603958734621604, "policy_loss": -0.0012900118279503658, "vf_loss": 3.3609181540707747, "vf_explained_var": 0.02488501351326704, "kl": 0.004549543070316269, "entropy": 1.040537273697555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.38, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38838, "policy_reward_min": {"prey_policy": -32.152445092037205, "predator_policy": -58.02139004875044}, "policy_reward_max": {"prey_policy": 58.02139004875044, "predator_policy": 32.152445092037205}, "policy_reward_mean": {"prey_policy": 16.496545401853616, "predator_policy": -16.496545401853616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [32.444221853784, 5.701540066353445, 25.206229392048755, -17.53544580323426, -19.141648006211675, -1.0216054694032088, 55.07439233688128, -14.715564389410488, 41.17355386774409, -2.3836229411065837, 39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128], "policy_predator_policy_reward": [-32.444221853784, -5.701540066353445, -25.206229392048755, 17.53544580323426, 19.141648006211675, 1.0216054694032088, -55.07439233688128, 14.715564389410488, -41.17355386774409, 2.3836229411065837, -39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28386421739373097, "mean_inference_ms": 0.9384962431389207, "mean_action_processing_ms": 0.12780920341277302, "mean_env_wait_ms": 0.06249949484650888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004188179969787598, "StateBufferConnector_ms": 0.0022182464599609375, "ViewRequirementAgentConnector_ms": 0.04867970943450928}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 680.6266699013293, "num_env_steps_trained_throughput_per_sec": 680.6266699013293, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 5087.547, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5087.515, "sample_time_ms": 699.439, "learn_time_ms": 4377.278, "learn_throughput": 913.81, "synch_weights_time_ms": 10.441}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 72, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-29", "timestamp": 1723345589, "time_this_iter_s": 5.9142351150512695, "time_total_s": 368.7366020679474, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.7366020679474, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 38.87777777777777, "ram_util_percent": 82.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.746840257383883, "cur_kl_coeff": 0.022525405883789058, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7297023197015124, "policy_loss": -0.006252123275771737, "vf_loss": 3.735813865810633, "vf_explained_var": 0.23264812485625347, "kl": 0.0062412240752211115, "entropy": 0.8789584806188941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2809693886277578, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1797810851285857, "policy_loss": -0.00532353242742829, "vf_loss": 3.183760913213094, "vf_explained_var": 0.18620371899257104, "kl": 0.015925559199998437, "entropy": 1.0654401288678248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.38, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38838, "policy_reward_min": {"prey_policy": -32.152445092037205, "predator_policy": -58.02139004875044}, "policy_reward_max": {"prey_policy": 58.02139004875044, "predator_policy": 32.152445092037205}, "policy_reward_mean": {"prey_policy": 17.351636212262033, "predator_policy": -17.351636212262033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [39.82450499159362, 24.455736806808048, 14.064269985991075, -1.2763682028744423, 16.555597172066634, -32.152445092037205, 18.976598583107805, 41.53219577467743, -4.1389545306000315, 38.46443880610282, 58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093], "policy_predator_policy_reward": [-39.82450499159362, -24.455736806808048, -14.064269985991075, 1.2763682028744423, -16.555597172066634, 32.152445092037205, -18.976598583107805, -41.53219577467743, 4.1389545306000315, -38.46443880610282, -58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28385659888869574, "mean_inference_ms": 0.9390116178617002, "mean_action_processing_ms": 0.12783513270939012, "mean_env_wait_ms": 0.06248720440950077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041925907135009766, "StateBufferConnector_ms": 0.0022608041763305664, "ViewRequirementAgentConnector_ms": 0.05039834976196289}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 743.2183033568342, "num_env_steps_trained_throughput_per_sec": 743.2183033568342, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 5128.964, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5128.931, "sample_time_ms": 722.802, "learn_time_ms": 4395.072, "learn_throughput": 910.11, "synch_weights_time_ms": 10.691}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "training_iteration": 73, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-34", "timestamp": 1723345594, "time_this_iter_s": 5.385007858276367, "time_total_s": 374.12160992622375, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c579d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 374.12160992622375, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 32.9, "ram_util_percent": 82.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5703646400322517, "cur_kl_coeff": 0.022525405883789058, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4662262229869762, "policy_loss": -0.007254559348803013, "vf_loss": 3.47302961461246, "vf_explained_var": 0.09185600951313973, "kl": 0.020029770771121832, "entropy": 0.7833482533693313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0278764781852563, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.236069019511342, "policy_loss": -0.007780141359156308, "vf_loss": 3.2426022252688806, "vf_explained_var": 0.012872092612087726, "kl": 0.01477843697656549, "entropy": 1.080259232968092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 384.64, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38464, "policy_reward_min": {"prey_policy": -20.888460241820805, "predator_policy": -58.02139004875044}, "policy_reward_max": {"prey_policy": 58.02139004875044, "predator_policy": 20.888460241820805}, "policy_reward_mean": {"prey_policy": 17.30503063860937, "predator_policy": -17.30503063860937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400], "policy_prey_policy_reward": [58.02139004875044, 25.85675285377991, -20.888460241820805, 22.61153199982976, 42.63429684824731, 19.395414498721728, 39.92641113726295, 50.96548705405208, 42.443741312123194, 45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443], "policy_predator_policy_reward": [-58.02139004875044, -25.85675285377991, 20.888460241820805, -22.61153199982976, -42.63429684824731, -19.395414498721728, -39.92641113726295, -50.96548705405208, -42.443741312123194, -45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28392053611149976, "mean_inference_ms": 0.9393837621200796, "mean_action_processing_ms": 0.12782127360463505, "mean_env_wait_ms": 0.06249793468125899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041800737380981445, "StateBufferConnector_ms": 0.0022679567337036133, "ViewRequirementAgentConnector_ms": 0.052323102951049805}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.8966385804425, "num_env_steps_trained_throughput_per_sec": 780.8966385804425, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 5153.731, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5153.699, "sample_time_ms": 726.007, "learn_time_ms": 4416.642, "learn_throughput": 905.665, "synch_weights_time_ms": 10.684}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 74, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-39", "timestamp": 1723345599, "time_this_iter_s": 5.125171899795532, "time_total_s": 379.2467818260193, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 379.2467818260193, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 82.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.480138246032099, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7759985481699307, "policy_loss": -0.010377000078976076, "vf_loss": 2.78612091653049, "vf_explained_var": -0.010521283373236656, "kl": 0.007536346164232762, "entropy": 0.7651341573024789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.64914020197466, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.252580008407434, "policy_loss": -0.004397079128102633, "vf_loss": 2.255799463391304, "vf_explained_var": 0.16957078507790962, "kl": 0.013957003202862054, "entropy": 1.1014686875045299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 384.64, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38464, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -53.834180767560014}, "policy_reward_max": {"prey_policy": 53.834180767560014, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 15.386474084479564, "predator_policy": -15.386474084479564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [45.50349323166959, 0.36180324270281616, 49.57301076891604, 35.6413356668883, 40.170495568713726, 30.644745001221132, 18.468371673596174, 34.59866938299213, 32.41169620940761, -11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037], "policy_predator_policy_reward": [-45.50349323166959, -0.36180324270281616, -49.57301076891604, -35.6413356668883, -40.170495568713726, -30.644745001221132, -18.468371673596174, -34.59866938299213, -32.41169620940761, 11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2839870994150982, "mean_inference_ms": 0.9399933955846766, "mean_action_processing_ms": 0.12780599159924902, "mean_env_wait_ms": 0.06250957956313911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004144191741943359, "StateBufferConnector_ms": 0.0022586584091186523, "ViewRequirementAgentConnector_ms": 0.052347779273986816}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.0862464565289, "num_env_steps_trained_throughput_per_sec": 811.0862464565289, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 5147.508, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5147.475, "sample_time_ms": 729.58, "learn_time_ms": 4406.822, "learn_throughput": 907.684, "synch_weights_time_ms": 10.699}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 75, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-44", "timestamp": 1723345604, "time_this_iter_s": 4.934544086456299, "time_total_s": 384.1813259124756, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.1813259124756, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 29.257142857142856, "ram_util_percent": 82.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7208872426611683, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8859010435640813, "policy_loss": -0.002794707472639857, "vf_loss": 2.888556364302834, "vf_explained_var": 0.17023219987750055, "kl": 0.004125593465623578, "entropy": 0.74515287168324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.090146133614083, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4528766439606744, "policy_loss": -0.006825201621783587, "vf_loss": 2.458771941562494, "vf_explained_var": 0.02308657243847847, "kl": 0.011021059126242991, "entropy": 1.1167924905816713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 384.64, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38464, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -53.834180767560014}, "policy_reward_max": {"prey_policy": 53.834180767560014, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 13.795861831768946, "predator_policy": -13.795861831768946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-11.5810766922664, 18.532268781632474, 11.768294322816992, 37.748834929639195, 9.27593209843701, 19.095815737563342, 50.67046150749516, 24.627320084673308, -2.817417090121376, 23.647333383179813, 15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586], "policy_predator_policy_reward": [11.5810766922664, -18.532268781632474, -11.768294322816992, -37.748834929639195, -9.27593209843701, -19.095815737563342, -50.67046150749516, -24.627320084673308, 2.817417090121376, -23.647333383179813, -15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840329428539444, "mean_inference_ms": 0.9405171814230618, "mean_action_processing_ms": 0.12778355835864333, "mean_env_wait_ms": 0.06251540946447914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00413060188293457, "StateBufferConnector_ms": 0.002254009246826172, "ViewRequirementAgentConnector_ms": 0.052632689476013184}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 821.5166931198459, "num_env_steps_trained_throughput_per_sec": 821.5166931198459, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 5149.009, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5148.975, "sample_time_ms": 725.286, "learn_time_ms": 4412.544, "learn_throughput": 906.506, "synch_weights_time_ms": 10.769}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 76, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-49", "timestamp": 1723345609, "time_this_iter_s": 4.871872901916504, "time_total_s": 389.0531988143921, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c579d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 389.0531988143921, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 28.866666666666664, "ram_util_percent": 82.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.011787342901031, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1739676085611186, "policy_loss": -0.00530917391370167, "vf_loss": 3.179112285127242, "vf_explained_var": 0.20418872125446796, "kl": 0.009736271574397359, "entropy": 0.729652323698004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.346606382975976, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9847495149821044, "policy_loss": -0.007916359173395903, "vf_loss": 2.9914081810663142, "vf_explained_var": 0.02232270029683908, "kl": 0.014906020361165513, "entropy": 1.0855896265556415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.61, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38861, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -53.834180767560014}, "policy_reward_max": {"prey_policy": 53.834180767560014, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 13.187495181410105, "predator_policy": -13.187495181410105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [15.073263083041283, 7.618406561509559, 45.43162560654499, 25.082842564521357, -13.773873891671997, 53.834180767560014, 11.708523290617185, 10.368263713310945, -6.831736222192909, 4.657926568783433, 20.03507263232959, 49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939], "policy_predator_policy_reward": [-15.073263083041283, -7.618406561509559, -45.43162560654499, -25.082842564521357, 13.773873891671997, -53.834180767560014, -11.708523290617185, -10.368263713310945, 6.831736222192909, -4.657926568783433, -20.03507263232959, -49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840605803452082, "mean_inference_ms": 0.9412195865454771, "mean_action_processing_ms": 0.12776842078034753, "mean_env_wait_ms": 0.0625019880976273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004102826118469238, "StateBufferConnector_ms": 0.002230525016784668, "ViewRequirementAgentConnector_ms": 0.05201113224029541}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.8702541142324, "num_env_steps_trained_throughput_per_sec": 802.8702541142324, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 5151.154, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5151.119, "sample_time_ms": 724.906, "learn_time_ms": 4415.049, "learn_throughput": 905.992, "synch_weights_time_ms": 10.785}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "training_iteration": 77, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-54", "timestamp": 1723345614, "time_this_iter_s": 4.984591960906982, "time_total_s": 394.0377907752991, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 394.0377907752991, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 26.862500000000004, "ram_util_percent": 82.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.877749092504382, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1047644381721815, "policy_loss": -0.004924552272617196, "vf_loss": 3.109594498574734, "vf_explained_var": 0.19829947383453447, "kl": 0.0055931279173771975, "entropy": 0.723082190255324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2746048156172036, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.73197659154733, "policy_loss": -0.007902185447649875, "vf_loss": 2.7387618350485963, "vf_explained_var": 0.2441291267052293, "kl": 0.01323787608660218, "entropy": 1.0144113266219696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.61, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38861, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -49.66690741318683}, "policy_reward_max": {"prey_policy": 49.66690741318683, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 12.746122573361577, "predator_policy": -12.746122573361577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [49.66690741318683, 11.323525694505573, 10.804027726532958, 22.650297600528138, 21.029706128717955, 7.54039153056663, -7.527583777339014, 17.355399151271463, -6.921903643487877, -1.277343622178278, 21.949913680805466, 24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882], "policy_predator_policy_reward": [-49.66690741318683, -11.323525694505573, -10.804027726532958, -22.650297600528138, -21.029706128717955, -7.54039153056663, 7.527583777339014, -17.355399151271463, 6.921903643487877, 1.277343622178278, -21.949913680805466, -24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840840729532595, "mean_inference_ms": 0.9418319398734729, "mean_action_processing_ms": 0.12773236848725658, "mean_env_wait_ms": 0.06250439811388159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004003286361694336, "StateBufferConnector_ms": 0.002248048782348633, "ViewRequirementAgentConnector_ms": 0.05156302452087402}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.2563426789325, "num_env_steps_trained_throughput_per_sec": 811.2563426789325, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 5152.938, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5152.903, "sample_time_ms": 728.261, "learn_time_ms": 4413.729, "learn_throughput": 906.263, "synch_weights_time_ms": 10.541}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 78, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-06-59", "timestamp": 1723345619, "time_this_iter_s": 4.933557033538818, "time_total_s": 398.9713478088379, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 398.9713478088379, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 28.4, "ram_util_percent": 82.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8337900144979358, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.672653850913048, "policy_loss": -0.007539048373776798, "vf_loss": 3.6799371654788655, "vf_explained_var": 0.008911127348740895, "kl": 0.01513712454308472, "entropy": 0.7753166549528638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3908024933810035, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.250352125118176, "policy_loss": -0.003704166292542747, "vf_loss": 3.25378175030152, "vf_explained_var": 0.21473907865583897, "kl": 0.003253803301904649, "entropy": 1.0586457402755818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.23, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38923, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -39.88931659286625}, "policy_reward_max": {"prey_policy": 39.88931659286625, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 11.4821637194849, "predator_policy": -11.4821637194849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [24.08086212100731, 23.9037146779013, -1.8289247663441461, 19.42114133191825, 9.559627608703785, -12.534239897927739, 30.542021242764008, -3.1952415035672956, 19.17439815122422, 13.102241684800777, 29.174586119661306, 12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506], "policy_predator_policy_reward": [-24.08086212100731, -23.9037146779013, 1.8289247663441461, -19.42114133191825, -9.559627608703785, 12.534239897927739, -30.542021242764008, 3.1952415035672956, -19.17439815122422, -13.102241684800777, -29.174586119661306, -12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2841401733651143, "mean_inference_ms": 0.9424192424637244, "mean_action_processing_ms": 0.12772744696343274, "mean_env_wait_ms": 0.06251988250643208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027887821197509766, "StateBufferConnector_ms": 0.00222015380859375, "ViewRequirementAgentConnector_ms": 0.05188894271850586}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.9600793945075, "num_env_steps_trained_throughput_per_sec": 797.9600793945075, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 5152.466, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5152.431, "sample_time_ms": 722.703, "learn_time_ms": 4418.745, "learn_throughput": 905.234, "synch_weights_time_ms": 10.607}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "training_iteration": 79, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-04", "timestamp": 1723345624, "time_this_iter_s": 5.015444278717041, "time_total_s": 403.98679208755493, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 403.98679208755493, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 28.75714285714285, "ram_util_percent": 82.61428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.768895181703071, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.951779613768061, "policy_loss": -0.005388799523158619, "vf_loss": 2.956895516440272, "vf_explained_var": 0.19115634771684806, "kl": 0.01615405931983682, "entropy": 0.7581271170328061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2979648121943077, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1423980232328175, "policy_loss": -0.01134936831901238, "vf_loss": 3.1527616990109286, "vf_explained_var": -0.155354316222171, "kl": 0.02336464843071037, "entropy": 1.1345625010629494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.92, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39292, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -39.88931659286625}, "policy_reward_max": {"prey_policy": 39.88931659286625, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 10.57637653365298, "predator_policy": -10.57637653365298}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.238688635291993, 7.731018636470392, 22.42971761225412, 9.76088491753806, 11.781197109650204, 5.8953806742713155, -4.218214169859863, 31.97827254135253, -10.352862984588432, 9.728650142702662, 5.7838432034788445, -7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782], "policy_predator_policy_reward": [-12.238688635291993, -7.731018636470392, -22.42971761225412, -9.76088491753806, -11.781197109650204, -5.8953806742713155, 4.218214169859863, -31.97827254135253, 10.352862984588432, -9.728650142702662, -5.7838432034788445, 7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842506752530685, "mean_inference_ms": 0.9433280915902644, "mean_action_processing_ms": 0.12765993056851008, "mean_env_wait_ms": 0.06251923233280948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002700209617614746, "StateBufferConnector_ms": 0.0021903514862060547, "ViewRequirementAgentConnector_ms": 0.05132246017456055}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.3781690745293, "num_env_steps_trained_throughput_per_sec": 805.3781690745293, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 5150.635, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5150.601, "sample_time_ms": 722.118, "learn_time_ms": 4417.719, "learn_throughput": 905.445, "synch_weights_time_ms": 10.39}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 80, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-09", "timestamp": 1723345629, "time_this_iter_s": 4.969241142272949, "time_total_s": 408.9560332298279, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.9560332298279, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 27.742857142857144, "ram_util_percent": 82.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.035788438220819, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.24334553355972, "policy_loss": -0.007921503542941839, "vf_loss": 5.250936396916708, "vf_explained_var": 0.018546403013169767, "kl": 0.01957192056433266, "entropy": 0.7696609834829966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.625713359688719, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.597176171590885, "policy_loss": -0.014338988263261854, "vf_loss": 5.6096863999962805, "vf_explained_var": -0.11209476248671611, "kl": 0.028899227587280505, "entropy": 1.0027976434677839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.92, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39292, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -39.88931659286625}, "policy_reward_max": {"prey_policy": 39.88931659286625, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 10.864647799798512, "predator_policy": -10.864647799798512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-7.747321918955173, 2.4619378874251545, -0.2624375906095331, 9.750361442575972, 16.84101425291415, 17.70777517144449, 5.364369722543671, 21.16866704947128, 19.860832485244234, 39.88931659286625, 10.458658813136005, 10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654], "policy_predator_policy_reward": [7.747321918955173, -2.4619378874251545, 0.2624375906095331, -9.750361442575972, -16.84101425291415, -17.70777517144449, -5.364369722543671, -21.16866704947128, -19.860832485244234, -39.88931659286625, -10.458658813136005, -10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28428924202893247, "mean_inference_ms": 0.943604679412947, "mean_action_processing_ms": 0.1275691028381948, "mean_env_wait_ms": 0.06253810736655256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002664327621459961, "StateBufferConnector_ms": 0.0021647214889526367, "ViewRequirementAgentConnector_ms": 0.05046522617340088}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 786.4360304846563, "num_env_steps_trained_throughput_per_sec": 786.4360304846563, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 5116.041, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5115.997, "sample_time_ms": 708.018, "learn_time_ms": 4396.608, "learn_throughput": 909.792, "synch_weights_time_ms": 10.985}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 81, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-14", "timestamp": 1723345634, "time_this_iter_s": 5.090670824050903, "time_total_s": 414.0467040538788, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 414.0467040538788, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 31.814285714285713, "ram_util_percent": 82.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.34232526148359, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.449934267252684, "policy_loss": -0.0070971707221663865, "vf_loss": 4.456915132701397, "vf_explained_var": 0.06965222296615442, "kl": 0.0068852208840946595, "entropy": 0.7414838552474976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6776272004470227, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.87909031783541, "policy_loss": -0.013653797336883145, "vf_loss": 4.88972851211826, "vf_explained_var": -0.13983880449086428, "kl": 0.03176931929288666, "entropy": 0.8681203922256827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.94, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38894, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -37.576405357135314}, "policy_reward_max": {"prey_policy": 37.576405357135314, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 10.25110827590535, "predator_policy": -10.25110827590535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400], "policy_prey_policy_reward": [10.2726284812289, 16.40947616688257, 30.871042600804127, 10.963386243868456, 18.74218539822353, 3.8179661733757797, 29.025638992657093, 25.02764230413981, -4.204273623021557, 19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919], "policy_predator_policy_reward": [-10.2726284812289, -16.40947616688257, -30.871042600804127, -10.963386243868456, -18.74218539822353, -3.8179661733757797, -29.025638992657093, -25.02764230413981, 4.204273623021557, -19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2839999296557595, "mean_inference_ms": 0.9427691005267234, "mean_action_processing_ms": 0.12752944174119743, "mean_env_wait_ms": 0.06247921886609691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002604961395263672, "StateBufferConnector_ms": 0.002015352249145508, "ViewRequirementAgentConnector_ms": 0.048487186431884766}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 793.1312700209647, "num_env_steps_trained_throughput_per_sec": 793.1312700209647, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 5032.677, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5032.633, "sample_time_ms": 657.555, "learn_time_ms": 4363.868, "learn_throughput": 916.618, "synch_weights_time_ms": 10.842}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 82, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-19", "timestamp": 1723345639, "time_this_iter_s": 5.046229124069214, "time_total_s": 419.092933177948, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 419.092933177948, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 36.84285714285714, "ram_util_percent": 82.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9790907919406893, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.143369483947754, "policy_loss": -0.00580152098700637, "vf_loss": 5.1489720722039545, "vf_explained_var": 0.14091225496182838, "kl": 0.011774732142683202, "entropy": 0.7696078372498353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.328675167200466, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.119979872057836, "policy_loss": -0.006203707434906391, "vf_loss": 5.124995889017979, "vf_explained_var": 0.036074422175685565, "kl": 0.008341544095019781, "entropy": 0.9254696719348431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.94, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38894, "policy_reward_min": {"prey_policy": -20.73132019626091, "predator_policy": -37.576405357135314}, "policy_reward_max": {"prey_policy": 37.576405357135314, "predator_policy": 20.73132019626091}, "policy_reward_mean": {"prey_policy": 9.548174839558762, "predator_policy": -9.548174839558762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [19.02236930313039, 24.086257721121928, 12.675266862983772, 16.40297207790268, 9.7032088454541, -10.584255106725417, 23.75874200913959, 35.7570865354443, -20.73132019626091, 25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011], "policy_predator_policy_reward": [-19.02236930313039, -24.086257721121928, -12.675266862983772, -16.40297207790268, -9.7032088454541, 10.584255106725417, -23.75874200913959, -35.7570865354443, 20.73132019626091, -25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28385496499705437, "mean_inference_ms": 0.9420143203143558, "mean_action_processing_ms": 0.12743021703021695, "mean_env_wait_ms": 0.0624200254086783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002591848373413086, "StateBufferConnector_ms": 0.001999974250793457, "ViewRequirementAgentConnector_ms": 0.04851961135864258}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 797.6194098424502, "num_env_steps_trained_throughput_per_sec": 797.6194098424502, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 4995.97, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4995.925, "sample_time_ms": 628.987, "learn_time_ms": 4355.97, "learn_throughput": 918.28, "synch_weights_time_ms": 10.603}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "training_iteration": 83, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-24", "timestamp": 1723345644, "time_this_iter_s": 5.0176239013671875, "time_total_s": 424.1105570793152, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 424.1105570793152, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 36.89999999999999, "ram_util_percent": 82.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.104982492638131, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9393161825835703, "policy_loss": -0.0041636994457803665, "vf_loss": 3.9433569128314656, "vf_explained_var": 0.15484398671736319, "kl": 0.007278805508749897, "entropy": 0.7277698094646136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.307968417337785, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.229847846428553, "policy_loss": -0.007508842314806922, "vf_loss": 4.235745035111904, "vf_explained_var": 0.10559626513471206, "kl": 0.011319184638892902, "entropy": 0.9072274584323168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.68, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39268, "policy_reward_min": {"prey_policy": -20.366961438243397, "predator_policy": -37.576405357135314}, "policy_reward_max": {"prey_policy": 37.576405357135314, "predator_policy": 20.366961438243397}, "policy_reward_mean": {"prey_policy": 9.552255269921007, "predator_policy": -9.552255269921007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.16234550419541, 31.902554598384896, 31.01269934565797, -14.761336826191254, 7.228454260460936, 19.734497985201443, -16.470389571516584, 26.033404998034037, 1.4419442059323302, 37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607], "policy_predator_policy_reward": [-25.16234550419541, -31.902554598384896, -31.01269934565797, 14.761336826191254, -7.228454260460936, -19.734497985201443, 16.470389571516584, -26.033404998034037, -1.4419442059323302, -37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2836091238934182, "mean_inference_ms": 0.9414393120065984, "mean_action_processing_ms": 0.12731802466368664, "mean_env_wait_ms": 0.06235823849372564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002578139305114746, "StateBufferConnector_ms": 0.0019881725311279297, "ViewRequirementAgentConnector_ms": 0.046242356300354004}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 773.9875262146435, "num_env_steps_trained_throughput_per_sec": 773.9875262146435, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 5000.542, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5000.498, "sample_time_ms": 621.552, "learn_time_ms": 4367.836, "learn_throughput": 915.785, "synch_weights_time_ms": 10.738}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 84, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-29", "timestamp": 1723345649, "time_this_iter_s": 5.173640966415405, "time_total_s": 429.2841980457306, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 429.2841980457306, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 37.84285714285715, "ram_util_percent": 82.2857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.995406886438529, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.712197183817625, "policy_loss": -0.003725778315614055, "vf_loss": 4.715851032485564, "vf_explained_var": 0.1443993141874671, "kl": 0.0042577269606811925, "entropy": 0.6619287980720401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0875533616480726, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.219781465580066, "policy_loss": -0.009494075881957543, "vf_loss": 5.227049506207307, "vf_explained_var": -0.1311053916811943, "kl": 0.015634157658635902, "entropy": 0.8720202616726359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 390.81, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39081, "policy_reward_min": {"prey_policy": -20.366961438243397, "predator_policy": -37.576405357135314}, "policy_reward_max": {"prey_policy": 37.576405357135314, "predator_policy": 20.366961438243397}, "policy_reward_mean": {"prey_policy": 9.38960969541954, "predator_policy": -9.38960969541954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400], "policy_prey_policy_reward": [37.576405357135314, -3.394564730194432, 15.388324368731325, 7.107162377052028, 19.877471038857124, 31.263434074985362, 9.41743770710637, 9.634781075440586, 2.465241339273831, 25.39562243692477, 17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658], "policy_predator_policy_reward": [-37.576405357135314, 3.394564730194432, -15.388324368731325, -7.107162377052028, -19.877471038857124, -31.263434074985362, -9.41743770710637, -9.634781075440586, -2.465241339273831, -25.39562243692477, -17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2834818050268946, "mean_inference_ms": 0.9408389955515246, "mean_action_processing_ms": 0.12725900926115394, "mean_env_wait_ms": 0.06232701678589294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027184486389160156, "StateBufferConnector_ms": 0.0020606517791748047, "ViewRequirementAgentConnector_ms": 0.047278642654418945}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 756.6614507895638, "num_env_steps_trained_throughput_per_sec": 756.6614507895638, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 5036.015, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5035.967, "sample_time_ms": 632.219, "learn_time_ms": 4391.921, "learn_throughput": 910.763, "synch_weights_time_ms": 11.454}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 85, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-35", "timestamp": 1723345655, "time_this_iter_s": 5.299062013626099, "time_total_s": 434.5832600593567, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 434.5832600593567, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 44.775, "ram_util_percent": 82.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.873350601581236, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.912548505266508, "policy_loss": -0.005813384531453873, "vf_loss": 4.9182826134065785, "vf_explained_var": 0.26807806820919117, "kl": 0.009386973672810965, "entropy": 0.6717360545570652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1219741656134525, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.94793493077159, "policy_loss": -0.003809002019018711, "vf_loss": 4.951117793718974, "vf_explained_var": -0.041265206411480904, "kl": 0.00439748196199886, "entropy": 0.9104847485820452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 390.81, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39081, "policy_reward_min": {"prey_policy": -37.195124691454744, "predator_policy": -41.3525376594803}, "policy_reward_max": {"prey_policy": 41.3525376594803, "predator_policy": 37.195124691454744}, "policy_reward_mean": {"prey_policy": 7.931162393950638, "predator_policy": -7.931162393950638}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [17.02960261370736, 11.507908540364639, 27.69239557739263, 17.63376418338523, -7.38721513832191, 34.25128648146342, -0.7518338671802738, -7.705670139844939, 2.263703140902823, 25.84098807223461, -0.09928817443081428, 21.26134637989459, 12.602450410847966, 8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601], "policy_predator_policy_reward": [-17.02960261370736, -11.507908540364639, -27.69239557739263, -17.63376418338523, 7.38721513832191, -34.25128648146342, 0.7518338671802738, 7.705670139844939, -2.263703140902823, -25.84098807223461, 0.09928817443081428, -21.26134637989459, -12.602450410847966, -8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28341320187283725, "mean_inference_ms": 0.9399874258520644, "mean_action_processing_ms": 0.12723275385780938, "mean_env_wait_ms": 0.062311850186525984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002749323844909668, "StateBufferConnector_ms": 0.0020716190338134766, "ViewRequirementAgentConnector_ms": 0.04768681526184082}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.6587253025748, "num_env_steps_trained_throughput_per_sec": 729.6587253025748, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 5097.312, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5097.264, "sample_time_ms": 638.319, "learn_time_ms": 4447.099, "learn_throughput": 899.463, "synch_weights_time_ms": 11.467}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 86, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-40", "timestamp": 1723345660, "time_this_iter_s": 5.489596843719482, "time_total_s": 440.0728569030762, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 440.0728569030762, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 45.287499999999994, "ram_util_percent": 83.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.968338900556167, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.245417730261882, "policy_loss": -0.005158245484441674, "vf_loss": 5.250490982333819, "vf_explained_var": 0.06739936160544555, "kl": 0.010064027212672499, "entropy": 0.6285882152616977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1008569817990064, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.510556207597256, "policy_loss": -0.004331099371969079, "vf_loss": 5.513901119927565, "vf_explained_var": 0.0065372629091143605, "kl": 0.01385257623619167, "entropy": 0.914261447203656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.3, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38330, "policy_reward_min": {"prey_policy": -37.195124691454744, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.195124691454744}, "policy_reward_mean": {"prey_policy": 8.011057064116107, "predator_policy": -8.011057064116107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400], "policy_prey_policy_reward": [8.880970984689117, 19.08579369115373, 33.29274654139271, 0.8765177787072744, -6.595205374338892, 11.657210418447882, -5.646280956121707, 0.9995138611611374, -11.830058754773987, 11.194770729798822, 1.0337365770418927, 6.150530469859092, -2.631841316246316, -8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755], "policy_predator_policy_reward": [-8.880970984689117, -19.08579369115373, -33.29274654139271, -0.8765177787072744, 6.595205374338892, -11.657210418447882, 5.646280956121707, -0.9995138611611374, 11.830058754773987, -11.194770729798822, -1.0337365770418927, -6.150530469859092, 2.631841316246316, 8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28327133580813696, "mean_inference_ms": 0.9391974320620257, "mean_action_processing_ms": 0.12722475998395733, "mean_env_wait_ms": 0.06232714692117202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002917647361755371, "StateBufferConnector_ms": 0.002115607261657715, "ViewRequirementAgentConnector_ms": 0.0499035120010376}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 782.4540768284737, "num_env_steps_trained_throughput_per_sec": 782.4540768284737, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 5110.312, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5110.263, "sample_time_ms": 646.332, "learn_time_ms": 4451.939, "learn_throughput": 898.485, "synch_weights_time_ms": 11.615}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 87, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-45", "timestamp": 1723345665, "time_this_iter_s": 5.114869117736816, "time_total_s": 445.187726020813, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 445.187726020813, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 43.38571428571429, "ram_util_percent": 82.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.047445006482303, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.377353890488545, "policy_loss": -0.007441627780887454, "vf_loss": 5.384743574758371, "vf_explained_var": -0.22905789948999883, "kl": 0.00615095349114488, "entropy": 0.582520291612794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9507671278590957, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.138919449845949, "policy_loss": -0.002973675765436686, "vf_loss": 5.1415985256433485, "vf_explained_var": 0.13275939486920835, "kl": 0.004138331930987097, "entropy": 0.8781135336185495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.1, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38210, "policy_reward_min": {"prey_policy": -37.195124691454744, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.195124691454744}, "policy_reward_mean": {"prey_policy": 7.86364307176069, "predator_policy": -7.86364307176069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211], "policy_prey_policy_reward": [-8.915978463086137, 26.870542020721782, 8.66875899209412, -5.696240665006506, -20.366961438243397, 12.592085332358678, -0.07593440066839108, 11.812700000942357, 11.636386288427211, 6.353854732391925, 27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532], "policy_predator_policy_reward": [8.915978463086137, -26.870542020721782, -8.66875899209412, 5.696240665006506, 20.366961438243397, -12.592085332358678, 0.07593440066839108, -11.812700000942357, -11.636386288427211, -6.353854732391925, -27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28321742773938874, "mean_inference_ms": 0.9387935837473017, "mean_action_processing_ms": 0.12720258356715128, "mean_env_wait_ms": 0.06232801806968502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029381513595581055, "StateBufferConnector_ms": 0.0020720958709716797, "ViewRequirementAgentConnector_ms": 0.04987919330596924}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.9568263948042, "num_env_steps_trained_throughput_per_sec": 802.9568263948042, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 5115.409, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5115.359, "sample_time_ms": 644.233, "learn_time_ms": 4459.139, "learn_throughput": 897.034, "synch_weights_time_ms": 11.613}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 88, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-50", "timestamp": 1723345670, "time_this_iter_s": 4.984094858169556, "time_total_s": 450.17182087898254, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 450.17182087898254, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 41.15714285714286, "ram_util_percent": 82.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0275598273923, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.93616819207867, "policy_loss": -0.0055446695211382275, "vf_loss": 4.9416434407234195, "vf_explained_var": 0.34580845093975465, "kl": 0.008217465963276533, "entropy": 0.774732179629306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2461585716033974, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.154214308410883, "policy_loss": -0.004535022018535529, "vf_loss": 5.158527278403441, "vf_explained_var": -0.0854648328696688, "kl": 0.006238774092916082, "entropy": 0.8381195174530148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.1, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38210, "policy_reward_min": {"prey_policy": -37.195124691454744, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.195124691454744}, "policy_reward_mean": {"prey_policy": 8.284797354138684, "predator_policy": -8.284797354138684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [27.73740752174798, -19.13678217519269, -8.356349188325098, 21.62101684702308, 17.00404466648782, 24.146527272965205, 33.48367050764826, 9.19144887022508, -8.562872554659913, 23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606], "policy_predator_policy_reward": [-27.73740752174798, 19.13678217519269, 8.356349188325098, -21.62101684702308, -17.00404466648782, -24.146527272965205, -33.48367050764826, -9.19144887022508, 8.562872554659913, -23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2831117384214357, "mean_inference_ms": 0.9384867389335928, "mean_action_processing_ms": 0.12719683137656937, "mean_env_wait_ms": 0.06233220419158456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002928018569946289, "StateBufferConnector_ms": 0.0020470619201660156, "ViewRequirementAgentConnector_ms": 0.0491030216217041}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 765.2599708870155, "num_env_steps_trained_throughput_per_sec": 765.2599708870155, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 5136.829, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5136.779, "sample_time_ms": 649.457, "learn_time_ms": 4475.284, "learn_throughput": 893.798, "synch_weights_time_ms": 11.664}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "training_iteration": 89, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-07-56", "timestamp": 1723345676, "time_this_iter_s": 5.230231761932373, "time_total_s": 455.4020526409149, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b48fa9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 455.4020526409149, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 41.53750000000001, "ram_util_percent": 82.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.069637405251464, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.097442978123824, "policy_loss": -0.004984202536434168, "vf_loss": 4.102369565268358, "vf_explained_var": 0.29753488978991904, "kl": 0.006821718377522042, "entropy": 0.5092540658079088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4403037895138064, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.867719490081072, "policy_loss": -0.006855488024787822, "vf_loss": 3.8738271849850814, "vf_explained_var": 0.041581359381477036, "kl": 0.021007985047190186, "entropy": 0.8294811594610413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.1, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38210, "policy_reward_min": {"prey_policy": -37.195124691454744, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.195124691454744}, "policy_reward_mean": {"prey_policy": 9.43620398892782, "predator_policy": -9.43620398892782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [23.790064415219543, 5.7135049780268155, 14.190609108592803, 9.870910993690401, 4.2656067471543295, 1.621979822227111, 13.872252772025654, 9.396491454577937, 16.124975271274902, -15.876288854209701, 11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957], "policy_predator_policy_reward": [-23.790064415219543, -5.7135049780268155, -14.190609108592803, -9.870910993690401, -4.2656067471543295, -1.621979822227111, -13.872252772025654, -9.396491454577937, -16.124975271274902, 15.876288854209701, -11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28305074820944626, "mean_inference_ms": 0.9381966008743347, "mean_action_processing_ms": 0.1271849211827851, "mean_env_wait_ms": 0.06233300722691749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029981136322021484, "StateBufferConnector_ms": 0.0020731687545776367, "ViewRequirementAgentConnector_ms": 0.05023050308227539}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.2017919907881, "num_env_steps_trained_throughput_per_sec": 801.2017919907881, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 5139.417, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5139.368, "sample_time_ms": 659.819, "learn_time_ms": 4467.463, "learn_throughput": 895.363, "synch_weights_time_ms": 11.712}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 90, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-01", "timestamp": 1723345681, "time_this_iter_s": 4.995611190795898, "time_total_s": 460.3976638317108, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 460.3976638317108, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 40.42857142857143, "ram_util_percent": 82.38571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.048800294101238, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.026132482041915, "policy_loss": -0.006860316891591841, "vf_loss": 4.032955983529488, "vf_explained_var": 0.25480791156490645, "kl": 0.004360210098102849, "entropy": 0.5554217105420928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8313979679718613, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.561471185336511, "policy_loss": -0.005701151260291226, "vf_loss": 4.566240298748016, "vf_explained_var": 0.015706721879541873, "kl": 0.017455912736127555, "entropy": 0.9202130207171043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.1, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38210, "policy_reward_min": {"prey_policy": -37.195124691454744, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.195124691454744}, "policy_reward_mean": {"prey_policy": 9.387736785613974, "predator_policy": -9.387736785613974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [11.938012134911467, -2.0680141398055483, 10.487221456345544, 18.356159075043248, 1.2822046388291426, 18.65195664534355, -2.7661063172596854, 8.61261015368919, 9.807537089325827, 20.871677123970358, -14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438], "policy_predator_policy_reward": [-11.938012134911467, 2.0680141398055483, -10.487221456345544, -18.356159075043248, -1.2822046388291426, -18.65195664534355, 2.7661063172596854, -8.61261015368919, -9.807537089325827, -20.871677123970358, 14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2829933948689202, "mean_inference_ms": 0.9379759554831303, "mean_action_processing_ms": 0.12717569246361426, "mean_env_wait_ms": 0.062332664662258654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002957463264465332, "StateBufferConnector_ms": 0.002036452293395996, "ViewRequirementAgentConnector_ms": 0.049852967262268066}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.120119979548, "num_env_steps_trained_throughput_per_sec": 798.120119979548, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 5131.971, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5131.932, "sample_time_ms": 668.092, "learn_time_ms": 4452.7, "learn_throughput": 898.331, "synch_weights_time_ms": 10.788}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "training_iteration": 91, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-06", "timestamp": 1723345686, "time_this_iter_s": 5.014384984970093, "time_total_s": 465.4120488166809, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c5c940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 465.4120488166809, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 35.55714285714286, "ram_util_percent": 82.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9919570348535975, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.630284975717465, "policy_loss": -0.00436490651894322, "vf_loss": 3.6346180476248264, "vf_explained_var": 0.1766657881438732, "kl": 0.007537435258331016, "entropy": 0.5321161946902673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.556547312190135, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.097893885274728, "policy_loss": -0.0022082830687092307, "vf_loss": 4.099784297992786, "vf_explained_var": -0.028998204755286375, "kl": 0.005953310996110108, "entropy": 0.9527246087789536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.08, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38608, "policy_reward_min": {"prey_policy": -37.195124691454744, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.195124691454744}, "policy_reward_mean": {"prey_policy": 9.635432943113443, "predator_policy": -9.635432943113443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-14.401228226573956, 18.189778150748683, 27.20279174869907, 8.357711635886748, -3.846148840730116, -3.137746919727661, 7.5879773419011, 3.86415414174707, 22.079368223619923, 8.648592752012846, 12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535], "policy_predator_policy_reward": [14.401228226573956, -18.189778150748683, -27.20279174869907, -8.357711635886748, 3.846148840730116, 3.137746919727661, -7.5879773419011, -3.86415414174707, -22.079368223619923, -8.648592752012846, -12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28300682151828577, "mean_inference_ms": 0.9378961323980357, "mean_action_processing_ms": 0.12713240782292046, "mean_env_wait_ms": 0.062312723698528825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029692649841308594, "StateBufferConnector_ms": 0.0020159482955932617, "ViewRequirementAgentConnector_ms": 0.04937422275543213}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.6094875708641, "num_env_steps_trained_throughput_per_sec": 806.6094875708641, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 5123.544, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5123.505, "sample_time_ms": 670.336, "learn_time_ms": 4441.781, "learn_throughput": 900.54, "synch_weights_time_ms": 11.037}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 92, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-11", "timestamp": 1723345691, "time_this_iter_s": 4.962097883224487, "time_total_s": 470.3741466999054, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.3741466999054, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 36.01428571428571, "ram_util_percent": 81.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6592294072732328, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.197406859695912, "policy_loss": -0.004710676347652528, "vf_loss": 4.202095204343398, "vf_explained_var": -0.009779046475887298, "kl": 0.005288317528879471, "entropy": 0.5145741967173915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7149348251521586, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.857345346858104, "policy_loss": -0.01136809366629071, "vf_loss": 3.86772612730662, "vf_explained_var": 0.019134396190444627, "kl": 0.018491260602855657, "entropy": 0.9260588149229686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.08, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38608, "policy_reward_min": {"prey_policy": -37.70844964370046, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.70844964370046}, "policy_reward_mean": {"prey_policy": 9.36479243771659, "predator_policy": -9.36479243771659}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.682763634274227, 21.2142777384295, 10.687899530869444, -0.589278892713125, 11.77207681975436, 20.138517140420607, 22.39216554512105, 6.157794039884941, 32.98057687986947, 0.2039118873199186, 25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209], "policy_predator_policy_reward": [-12.682763634274227, -21.2142777384295, -10.687899530869444, 0.589278892713125, -11.77207681975436, -20.138517140420607, -22.39216554512105, -6.157794039884941, -32.98057687986947, -0.2039118873199186, -25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28297899705834423, "mean_inference_ms": 0.9377480964622048, "mean_action_processing_ms": 0.1271319214619818, "mean_env_wait_ms": 0.06231437592699378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002987980842590332, "StateBufferConnector_ms": 0.0020226240158081055, "ViewRequirementAgentConnector_ms": 0.0496976375579834}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.4814562405178, "num_env_steps_trained_throughput_per_sec": 811.4814562405178, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 5114.977, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5114.938, "sample_time_ms": 672.982, "learn_time_ms": 4430.425, "learn_throughput": 902.848, "synch_weights_time_ms": 11.183}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 93, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-16", "timestamp": 1723345696, "time_this_iter_s": 4.93381667137146, "time_total_s": 475.30796337127686, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c07820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 475.30796337127686, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 35.74285714285714, "ram_util_percent": 81.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7468540698910755, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.142410393804312, "policy_loss": -0.007895852836130264, "vf_loss": 4.150276199479898, "vf_explained_var": 0.09758344429234664, "kl": 0.0071124569386576296, "entropy": 0.5260194707351427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.489315032524367, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2071078355113665, "policy_loss": -0.005982082404564911, "vf_loss": 4.212430445849895, "vf_explained_var": -0.19918773639947177, "kl": 0.012351319597503498, "entropy": 0.9409528049329917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.25, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38225, "policy_reward_min": {"prey_policy": -37.70844964370046, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.70844964370046}, "policy_reward_mean": {"prey_policy": 8.022078387800764, "predator_policy": -8.022078387800764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 213, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17], "policy_prey_policy_reward": [25.08923303478196, -1.1313249384282393, 12.176365363904406, -15.949520058355436, 13.100415295914658, -23.805214595781774, 4.829045418833946, 41.3525376594803, 14.508682287829743, -37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672], "policy_predator_policy_reward": [-25.08923303478196, 1.1313249384282393, -12.176365363904406, 15.949520058355436, -13.100415295914658, 23.805214595781774, -4.829045418833946, -41.3525376594803, -14.508682287829743, 37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28292530166372204, "mean_inference_ms": 0.937686832537312, "mean_action_processing_ms": 0.12711598932284005, "mean_env_wait_ms": 0.06231275449760391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029752254486083984, "StateBufferConnector_ms": 0.0020809173583984375, "ViewRequirementAgentConnector_ms": 0.049526214599609375}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 784.6454114384927, "num_env_steps_trained_throughput_per_sec": 784.6454114384927, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 5107.957, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5107.918, "sample_time_ms": 678.19, "learn_time_ms": 4418.351, "learn_throughput": 905.315, "synch_weights_time_ms": 11.037}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 94, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-21", "timestamp": 1723345701, "time_this_iter_s": 5.100491046905518, "time_total_s": 480.4084544181824, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 480.4084544181824, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 37.25714285714285, "ram_util_percent": 81.8142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.87031759750098, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9937895389894646, "policy_loss": -0.004157780135331753, "vf_loss": 3.997927851478259, "vf_explained_var": 0.08320976893107096, "kl": 0.00461130156838507, "entropy": 0.5866225225230058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4681777455533545, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.597951626777649, "policy_loss": -0.007438188209198416, "vf_loss": 3.604659869521856, "vf_explained_var": 0.05042036821444829, "kl": 0.013670947875182304, "entropy": 0.9717107805112998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 384.12, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38412, "policy_reward_min": {"prey_policy": -37.70844964370046, "predator_policy": -48.21340366204052}, "policy_reward_max": {"prey_policy": 48.21340366204052, "predator_policy": 37.70844964370046}, "policy_reward_mean": {"prey_policy": 8.471272585381138, "predator_policy": -8.471272585381138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-37.195124691454744, 9.221521785697387, -3.9300429187173194, 0.4284113760408097, -12.840244851702362, 16.31701342819601, 14.714898765283632, 48.21340366204052, 38.725355596878266, 47.39571578299163, 0.05867243738340555, -4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294], "policy_predator_policy_reward": [37.195124691454744, -9.221521785697387, 3.9300429187173194, -0.4284113760408097, 12.840244851702362, -16.31701342819601, -14.714898765283632, -48.21340366204052, -38.725355596878266, -47.39571578299163, -0.05867243738340555, 4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2829146304392691, "mean_inference_ms": 0.9375239993145464, "mean_action_processing_ms": 0.1271036496928382, "mean_env_wait_ms": 0.06230201346027449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002859354019165039, "StateBufferConnector_ms": 0.0020449161529541016, "ViewRequirementAgentConnector_ms": 0.04878997802734375}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 757.7251790501824, "num_env_steps_trained_throughput_per_sec": 757.7251790501824, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 5107.214, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5107.179, "sample_time_ms": 674.143, "learn_time_ms": 4422.337, "learn_throughput": 904.499, "synch_weights_time_ms": 10.357}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 95, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-26", "timestamp": 1723345706, "time_this_iter_s": 5.281899690628052, "time_total_s": 485.6903541088104, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49474c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 485.6903541088104, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 39.4375, "ram_util_percent": 81.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9954251859957974, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3650292408963045, "policy_loss": -0.00253073294297792, "vf_loss": 4.3675474435091015, "vf_explained_var": 0.01791766385237376, "kl": 0.005947649814942441, "entropy": 0.6748081959784031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.639756318864723, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.187989701827367, "policy_loss": -0.00827368569977504, "vf_loss": 4.195365493496259, "vf_explained_var": -0.01756484918296337, "kl": 0.01681688803201335, "entropy": 0.9958318418512742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 380.64, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38064, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -45.61656323330565}, "policy_reward_max": {"prey_policy": 45.61656323330565, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 7.051989482069314, "predator_policy": -7.051989482069314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 21, 28, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400], "policy_prey_policy_reward": [-4.219196524432581, 40.96196109721178, -7.221412753178228, -16.576407485088456, 12.53828491693358, -36.2275617562036, 1.8498744151045905, 21.915316942037755, 32.78692113392738, 24.8885629331785, 13.168547649964651, 8.845519564696303, -34.37968884489132, -34.917684642306504, -22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297], "policy_predator_policy_reward": [4.219196524432581, -40.96196109721178, 7.221412753178228, 16.576407485088456, -12.53828491693358, 36.2275617562036, -1.8498744151045905, -21.915316942037755, -32.78692113392738, -24.8885629331785, -13.168547649964651, -8.845519564696303, 34.37968884489132, 34.917684642306504, 22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28317021839974343, "mean_inference_ms": 0.9376023465173654, "mean_action_processing_ms": 0.12713539790888398, "mean_env_wait_ms": 0.062309444293529886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028836727142333984, "StateBufferConnector_ms": 0.0021064281463623047, "ViewRequirementAgentConnector_ms": 0.06005728244781494}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 734.406076813588, "num_env_steps_trained_throughput_per_sec": 734.406076813588, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 5103.673, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5103.637, "sample_time_ms": 701.895, "learn_time_ms": 4391.011, "learn_throughput": 910.952, "synch_weights_time_ms": 10.389}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 96, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-31", "timestamp": 1723345711, "time_this_iter_s": 5.451714992523193, "time_total_s": 491.1420691013336, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 491.1420691013336, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 40.3, "ram_util_percent": 82.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.187234327942133, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.998998862008254, "policy_loss": -0.0029017329114140013, "vf_loss": 4.001878894865513, "vf_explained_var": 0.024319270129005113, "kl": 0.010276135642108015, "entropy": 0.7666115296383699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7605749580388266, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.907300427556038, "policy_loss": -0.0021101314249487284, "vf_loss": 3.9090482130646707, "vf_explained_var": -0.05384068917483091, "kl": 0.006786524503536384, "entropy": 0.8539078931013743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 387.33, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 38733, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -45.61656323330565}, "policy_reward_max": {"prey_policy": 45.61656323330565, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 8.056204954346743, "predator_policy": -8.056204954346743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 211, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-22.98717122401503, 18.246810828249536, -1.8363781413465965, 9.58305412348674, 22.76549366517535, 27.276295475768755, -11.713277106658532, 9.138344085170125, 0.29219442052579225, 29.928854708219255, 1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938], "policy_predator_policy_reward": [22.98717122401503, -18.246810828249536, 1.8363781413465965, -9.58305412348674, -22.76549366517535, -27.276295475768755, 11.713277106658532, -9.138344085170125, -0.29219442052579225, -29.928854708219255, -1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2835193067597711, "mean_inference_ms": 0.9383130807400768, "mean_action_processing_ms": 0.12717401216362118, "mean_env_wait_ms": 0.062312844498455006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027532577514648438, "StateBufferConnector_ms": 0.002117633819580078, "ViewRequirementAgentConnector_ms": 0.058588266372680664}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.9535495710555, "num_env_steps_trained_throughput_per_sec": 798.9535495710555, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 5093.115, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5093.08, "sample_time_ms": 697.723, "learn_time_ms": 4384.815, "learn_throughput": 912.239, "synch_weights_time_ms": 10.199}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "training_iteration": 97, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-37", "timestamp": 1723345717, "time_this_iter_s": 5.009432792663574, "time_total_s": 496.1515018939972, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 496.1515018939972, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 38.442857142857136, "ram_util_percent": 82.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.868582120661934, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.992876401046912, "policy_loss": -0.0051509728398135245, "vf_loss": 3.9980146778126557, "vf_explained_var": 0.2523938536643982, "kl": 0.006014937215181545, "entropy": 0.654219316256543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6573146574820083, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.412211422622204, "policy_loss": -0.004226327204378322, "vf_loss": 4.4159305460751055, "vf_explained_var": 0.002920771886905034, "kl": 0.009498770824159711, "entropy": 0.7499420141180356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.22, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38922, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 7.468463250539571, "predator_policy": -7.468463250539571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.5655148381771156, -35.4477742382435, 21.600860780061467, 11.940821005891213, 15.53486587639313, 34.92820158412596, -4.487242422589606, 45.61656323330565, 35.53811883093682, 20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122], "policy_predator_policy_reward": [-1.5655148381771156, 35.4477742382435, -21.600860780061467, -11.940821005891213, -15.53486587639313, -34.92820158412596, 4.487242422589606, -45.61656323330565, -35.53811883093682, -20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28373232574682955, "mean_inference_ms": 0.9383356151094153, "mean_action_processing_ms": 0.12718025533293417, "mean_env_wait_ms": 0.06229804159274644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00273740291595459, "StateBufferConnector_ms": 0.0021206140518188477, "ViewRequirementAgentConnector_ms": 0.058234453201293945}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.2420394542818, "num_env_steps_trained_throughput_per_sec": 800.2420394542818, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 5094.806, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5094.77, "sample_time_ms": 695.426, "learn_time_ms": 4388.753, "learn_throughput": 911.421, "synch_weights_time_ms": 10.245}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 98, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-42", "timestamp": 1723345722, "time_this_iter_s": 5.001595735549927, "time_total_s": 501.1530976295471, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71bdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 501.1530976295471, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 35.75, "ram_util_percent": 82.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.220712525211274, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4311989409228167, "policy_loss": -0.003682500892803849, "vf_loss": 3.4348702368636927, "vf_explained_var": 0.3135947538539767, "kl": 0.005306856039743624, "entropy": 0.7498287039498488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4557540704185765, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.922916239251693, "policy_loss": -0.0038406026957090943, "vf_loss": 3.926389588415623, "vf_explained_var": -0.021955642973383267, "kl": 0.0068780038400310635, "entropy": 0.8344994186734159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.22, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38922, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 8.128333300287473, "predator_policy": -8.128333300287473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.150900399879887, 38.65327270504371, 9.076676435952606, 3.842296409510622, 32.84851255654628, 16.25437591294876, 10.288058762708957, -23.78428735520947, 27.282337530353992, -25.794044727867906, 3.3489354458261644, 18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715], "policy_predator_policy_reward": [-20.150900399879887, -38.65327270504371, -9.076676435952606, -3.842296409510622, -32.84851255654628, -16.25437591294876, -10.288058762708957, 23.78428735520947, -27.282337530353992, 25.794044727867906, -3.3489354458261644, -18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28392656765700514, "mean_inference_ms": 0.9383569786437319, "mean_action_processing_ms": 0.12719817657460752, "mean_env_wait_ms": 0.06229690636571965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002706289291381836, "StateBufferConnector_ms": 0.002135038375854492, "ViewRequirementAgentConnector_ms": 0.05810725688934326}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 796.6632221172174, "num_env_steps_trained_throughput_per_sec": 796.6632221172174, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 5074.202, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5074.166, "sample_time_ms": 695.887, "learn_time_ms": 4367.777, "learn_throughput": 915.798, "synch_weights_time_ms": 10.157}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 99, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-47", "timestamp": 1723345727, "time_this_iter_s": 5.023530960083008, "time_total_s": 506.1766285896301, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71bdaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.1766285896301, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 82.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.11354593615979, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6094557714958984, "policy_loss": -0.006324599674068547, "vf_loss": 3.615755705535412, "vf_explained_var": 0.2553431934987505, "kl": 0.011681265217365615, "entropy": 0.6014313188071052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.458864142621557, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6931340048710504, "policy_loss": -0.00706519679442863, "vf_loss": 3.6990406177937984, "vf_explained_var": -0.14422918806473414, "kl": 0.02169903250327965, "entropy": 0.8240271323050062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.54, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38554, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 8.1412002200219, "predator_policy": -8.1412002200219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400], "policy_prey_policy_reward": [18.418108700435585, 6.021754665973351, 28.446749196825138, 5.066938655175685, 28.018257995248177, 11.09863627043438, 24.97047133825099, 11.858785452116742, 14.597640607507174, 5.185929830550073, 22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323], "policy_predator_policy_reward": [-18.418108700435585, -6.021754665973351, -28.446749196825138, -5.066938655175685, -28.018257995248177, -11.09863627043438, -24.97047133825099, -11.858785452116742, -14.597640607507174, -5.185929830550073, -22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28423462995870485, "mean_inference_ms": 0.9384922554184069, "mean_action_processing_ms": 0.12715761335735568, "mean_env_wait_ms": 0.062338080441004445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00270998477935791, "StateBufferConnector_ms": 0.0021632909774780273, "ViewRequirementAgentConnector_ms": 0.05835914611816406}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 807.5411250077013, "num_env_steps_trained_throughput_per_sec": 807.5411250077013, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 5070.282, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5070.246, "sample_time_ms": 686.947, "learn_time_ms": 4372.661, "learn_throughput": 914.775, "synch_weights_time_ms": 10.293}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 100, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-52", "timestamp": 1723345732, "time_this_iter_s": 4.956009149551392, "time_total_s": 511.1326377391815, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.1326377391815, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 35.642857142857146, "ram_util_percent": 82.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.167440357245505, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.537136256198088, "policy_loss": -0.004548606651951559, "vf_loss": 4.5416658560434975, "vf_explained_var": -0.022695658666392168, "kl": 0.009013444070036519, "entropy": 0.6190648747608065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5553276551887394, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.348140008499225, "policy_loss": -0.004493904424149756, "vf_loss": 4.351310356209676, "vf_explained_var": 0.11417203185458978, "kl": 0.016525644193238685, "entropy": 0.761469248495996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.97, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38297, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 7.109287207341876, "predator_policy": -7.109287207341876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400], "policy_prey_policy_reward": [22.46933145446743, -1.4854380428937013, 3.7580621793870606, 0.528962247264813, 11.563147984803908, 26.495980558885535, 19.587443117584165, -2.8485101045803294, 19.330237848775653, 15.841700052805017, -17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791], "policy_predator_policy_reward": [-22.46933145446743, 1.4854380428937013, -3.7580621793870606, -0.528962247264813, -11.563147984803908, -26.495980558885535, -19.587443117584165, 2.8485101045803294, -19.330237848775653, -15.841700052805017, 17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28442709077060985, "mean_inference_ms": 0.9384470707092472, "mean_action_processing_ms": 0.12722465388706022, "mean_env_wait_ms": 0.06232184120262087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027483701705932617, "StateBufferConnector_ms": 0.0021930932998657227, "ViewRequirementAgentConnector_ms": 0.05933094024658203}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.1929777497512, "num_env_steps_trained_throughput_per_sec": 785.1929777497512, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 5078.534, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5078.498, "sample_time_ms": 685.334, "learn_time_ms": 4382.574, "learn_throughput": 912.706, "synch_weights_time_ms": 10.247}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "training_iteration": 101, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-08-57", "timestamp": 1723345737, "time_this_iter_s": 5.096992015838623, "time_total_s": 516.2296297550201, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71bd280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 516.2296297550201, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 35.728571428571435, "ram_util_percent": 82.34285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.184316401928664, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.794652832299471, "policy_loss": -0.004501985350604324, "vf_loss": 4.799143103261788, "vf_explained_var": 0.17621050669501226, "kl": 0.0055408262020140596, "entropy": 0.6036846047267318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4818698002025483, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.05936448002855, "policy_loss": -0.00737116166613608, "vf_loss": 5.065768196433782, "vf_explained_var": 0.019172290277977785, "kl": 0.012079464260570423, "entropy": 0.7729996812840303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.97, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38297, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 7.14904762367043, "predator_policy": -7.14904762367043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-17.316106769577278, -13.99267853744564, -37.70844964370046, 23.464112160981568, 5.47756668227354, 35.64588466078209, 27.722300579282198, 4.344187667902084, -7.758670532233481, 11.065426667548422, -8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027], "policy_predator_policy_reward": [17.316106769577278, 13.99267853744564, 37.70844964370046, -23.464112160981568, -5.47756668227354, -35.64588466078209, -27.722300579282198, -4.344187667902084, 7.758670532233481, -11.065426667548422, 8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28460902755328726, "mean_inference_ms": 0.9384734340713256, "mean_action_processing_ms": 0.1272491750475041, "mean_env_wait_ms": 0.06232861670083343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00272369384765625, "StateBufferConnector_ms": 0.002213120460510254, "ViewRequirementAgentConnector_ms": 0.05869781970977783}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.8942002846783, "num_env_steps_trained_throughput_per_sec": 798.8942002846783, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 5083.323, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5083.287, "sample_time_ms": 688.331, "learn_time_ms": 4384.298, "learn_throughput": 912.347, "synch_weights_time_ms": 10.308}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 102, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-02", "timestamp": 1723345742, "time_this_iter_s": 5.010115146636963, "time_total_s": 521.2397449016571, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 521.2397449016571, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 35.9, "ram_util_percent": 81.97142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.003796208401521, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.116886133452256, "policy_loss": -0.006953679636838691, "vf_loss": 4.123815150062243, "vf_explained_var": 0.26777287243554987, "kl": 0.01167344689671257, "entropy": 0.5994142156094313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.560587825750311, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.24658674672246, "policy_loss": -0.0047190969358780425, "vf_loss": 4.250789398451646, "vf_explained_var": 0.09022266163180272, "kl": 0.006448241784930559, "entropy": 0.7968708354358872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.97, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38297, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 8.117917746171594, "predator_policy": -8.117917746171594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-8.27408014191117, -5.728030589811894, 5.898702282244972, 8.019124927610143, -18.578103976716115, -13.3415575522672, 11.433181001778241, 10.531808232750848, 5.810982320343285, -4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821], "policy_predator_policy_reward": [8.27408014191117, 5.728030589811894, -5.898702282244972, -8.019124927610143, 18.578103976716115, 13.3415575522672, -11.433181001778241, -10.531808232750848, -5.810982320343285, 4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.284773760146713, "mean_inference_ms": 0.938496617396886, "mean_action_processing_ms": 0.12726938615519962, "mean_env_wait_ms": 0.062327732665585785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002718329429626465, "StateBufferConnector_ms": 0.002200007438659668, "ViewRequirementAgentConnector_ms": 0.058515071868896484}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.836675563997, "num_env_steps_trained_throughput_per_sec": 795.836675563997, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 5093.013, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5092.978, "sample_time_ms": 689.178, "learn_time_ms": 4393.257, "learn_throughput": 910.486, "synch_weights_time_ms": 10.199}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "training_iteration": 103, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-07", "timestamp": 1723345747, "time_this_iter_s": 5.028693914413452, "time_total_s": 526.2684388160706, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 526.2684388160706, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 36.6, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.702402972678343, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.273715232064327, "policy_loss": -0.005158990912120013, "vf_loss": 4.278843415280183, "vf_explained_var": 0.08436047018816074, "kl": 0.014591936582275478, "entropy": 0.637553539685905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.474319618878265, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.176127999772628, "policy_loss": -0.010669186729016171, "vf_loss": 4.184793156633774, "vf_explained_var": -0.07236451040953398, "kl": 0.025022090077654012, "entropy": 0.7649429445465405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.8, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38680, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 8.918844218595519, "predator_policy": -8.918844218595519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-4.176487163784518, 27.185444330267366, 38.1352679937453, -7.788323229061454, 18.85894092047552, 15.098824819702294, 20.368881301550754, 31.021659791055505, -28.922685959792084, 12.271004627442707, -24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568], "policy_predator_policy_reward": [4.176487163784518, -27.185444330267366, -38.1352679937453, 7.788323229061454, -18.85894092047552, -15.098824819702294, -20.368881301550754, -31.021659791055505, 28.922685959792084, -12.271004627442707, 24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28493027335704474, "mean_inference_ms": 0.9383286340926239, "mean_action_processing_ms": 0.12728453687308774, "mean_env_wait_ms": 0.062328508622449895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002725839614868164, "StateBufferConnector_ms": 0.0022188425064086914, "ViewRequirementAgentConnector_ms": 0.058086514472961426}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.3806297372531, "num_env_steps_trained_throughput_per_sec": 799.3806297372531, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 5083.616, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5083.581, "sample_time_ms": 685.786, "learn_time_ms": 4387.227, "learn_throughput": 911.738, "synch_weights_time_ms": 10.224}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 104, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-12", "timestamp": 1723345752, "time_this_iter_s": 5.0064921379089355, "time_total_s": 531.2749309539795, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c078b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 531.2749309539795, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 81.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.063686769952377, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3824074777464075, "policy_loss": -0.006189761524243901, "vf_loss": 4.3885675576825935, "vf_explained_var": 0.21779221532245477, "kl": 0.014054466378588922, "entropy": 0.6925012296065688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.61138248257339, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.710465188076099, "policy_loss": -0.005970006301261795, "vf_loss": 4.714914257576068, "vf_explained_var": -0.059672016029556595, "kl": 0.012660163966088659, "entropy": 0.7834478217487534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.8, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38680, "policy_reward_min": {"prey_policy": -38.7885446136785, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.7885446136785}, "policy_reward_mean": {"prey_policy": 8.404719288064115, "predator_policy": -8.404719288064115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 52, 400, 400, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-24.13986730088682, 5.41312443809305, -38.7885446136785, -1.9876555143720864, 7.948962327792991, -14.000779569975027, 9.997170514224297, -0.9932741131373319, 25.82344426210841, 7.527952723988427, 31.627957119660536, -10.374495620571022, 12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037], "policy_predator_policy_reward": [24.13986730088682, -5.41312443809305, 38.7885446136785, 1.9876555143720864, -7.948962327792991, 14.000779569975027, -9.997170514224297, 0.9932741131373319, -25.82344426210841, -7.527952723988427, -31.627957119660536, 10.374495620571022, -12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2849671153543627, "mean_inference_ms": 0.9376276622820734, "mean_action_processing_ms": 0.12727297312204225, "mean_env_wait_ms": 0.06231024034750111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027309656143188477, "StateBufferConnector_ms": 0.0022118091583251953, "ViewRequirementAgentConnector_ms": 0.058017849922180176}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.6904230287946, "num_env_steps_trained_throughput_per_sec": 803.6904230287946, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 5053.424, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5053.389, "sample_time_ms": 679.165, "learn_time_ms": 4363.702, "learn_throughput": 916.653, "synch_weights_time_ms": 10.19}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 105, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-17", "timestamp": 1723345757, "time_this_iter_s": 4.979572057723999, "time_total_s": 536.2545030117035, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.2545030117035, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 35.51428571428572, "ram_util_percent": 81.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9087695865581433, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.200589819252491, "policy_loss": -0.011219800908778173, "vf_loss": 4.2117778199414415, "vf_explained_var": 0.24924825119475524, "kl": 0.015056771681562837, "entropy": 0.6775603348389267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3877761393164594, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8129896722733974, "policy_loss": -0.0019280339848288955, "vf_loss": 3.814514854302009, "vf_explained_var": 0.18563061685611804, "kl": 0.003353373533854313, "entropy": 0.8296970456217726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.75, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 39375, "policy_reward_min": {"prey_policy": -38.25645128281549, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.25645128281549}, "policy_reward_mean": {"prey_policy": 10.242216440524517, "predator_policy": -10.242216440524517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.590969909186445, 5.731599645046078, 2.694459255309635, 15.334049336810224, 19.349911868599154, 26.3868573889657, 1.042197088340874, 10.263749139558936, -23.17079412916938, 25.704957673343454, -15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014], "policy_predator_policy_reward": [-12.590969909186445, -5.731599645046078, -2.694459255309635, -15.334049336810224, -19.349911868599154, -26.3868573889657, -1.042197088340874, -10.263749139558936, 23.17079412916938, -25.704957673343454, 15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28481662111235634, "mean_inference_ms": 0.9372403208726893, "mean_action_processing_ms": 0.12717160920405685, "mean_env_wait_ms": 0.06226606239317878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026814937591552734, "StateBufferConnector_ms": 0.00211334228515625, "ViewRequirementAgentConnector_ms": 0.04566347599029541}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.6005682910297, "num_env_steps_trained_throughput_per_sec": 806.6005682910297, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 5004.672, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5004.641, "sample_time_ms": 643.476, "learn_time_ms": 4350.756, "learn_throughput": 919.38, "synch_weights_time_ms": 10.082}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 106, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-22", "timestamp": 1723345762, "time_this_iter_s": 4.961626291275024, "time_total_s": 541.2161293029785, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b499db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 541.2161293029785, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 35.0, "ram_util_percent": 81.75714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.917621297389269, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.377674755205711, "policy_loss": -0.006412128567656813, "vf_loss": 4.384059023360411, "vf_explained_var": -0.0671770370254914, "kl": 0.013190762793973236, "entropy": 0.7958385113626718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5180190026760103, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.774516299366951, "policy_loss": -0.004586466244412198, "vf_loss": 3.7785393349826335, "vf_explained_var": 0.0631557938332359, "kl": 0.009379987729516811, "entropy": 0.8094311566402514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.75, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39375, "policy_reward_min": {"prey_policy": -38.25645128281549, "predator_policy": -55.23041149157461}, "policy_reward_max": {"prey_policy": 55.23041149157461, "predator_policy": 38.25645128281549}, "policy_reward_mean": {"prey_policy": 9.581775176615718, "predator_policy": -9.581775176615718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-15.688925776969857, -19.3395767808786, -38.25645128281549, 55.23041149157461, 13.93067191871491, -9.396733130132546, -11.658465636138839, 6.636734338329468, 14.75742763883122, 16.055216600421403, 3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127], "policy_predator_policy_reward": [15.688925776969857, 19.3395767808786, 38.25645128281549, -55.23041149157461, -13.93067191871491, 9.396733130132546, 11.658465636138839, -6.636734338329468, -14.75742763883122, -16.055216600421403, -3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28459726270652924, "mean_inference_ms": 0.9366125924802939, "mean_action_processing_ms": 0.1270858246608849, "mean_env_wait_ms": 0.062225321395415895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002721428871154785, "StateBufferConnector_ms": 0.0020982027053833008, "ViewRequirementAgentConnector_ms": 0.045537471771240234}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 767.4881265484115, "num_env_steps_trained_throughput_per_sec": 767.4881265484115, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 5025.198, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5025.164, "sample_time_ms": 642.63, "learn_time_ms": 4371.43, "learn_throughput": 915.032, "synch_weights_time_ms": 10.762}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "training_iteration": 107, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-27", "timestamp": 1723345767, "time_this_iter_s": 5.215107202529907, "time_total_s": 546.4312365055084, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c078b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 546.4312365055084, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 41.012499999999996, "ram_util_percent": 82.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.112706698849797, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.10909306332469, "policy_loss": -0.006554039175777386, "vf_loss": 4.115628769248724, "vf_explained_var": 0.0659669711564978, "kl": 0.008684377071617037, "entropy": 0.5815499577050408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.426801198658844, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.0260896349946655, "policy_loss": -0.0029095818628168974, "vf_loss": 4.028236656884352, "vf_explained_var": 0.04281481162955363, "kl": 0.012695047517031082, "entropy": 0.7790737393001715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 390.66, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39066, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -45.27335774769076}, "policy_reward_max": {"prey_policy": 45.27335774769076, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 10.116785961158385, "predator_policy": -10.116785961158385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400], "policy_prey_policy_reward": [3.3000514718747773, 25.133926561545202, 26.467968910861224, 30.186157028421125, 14.905844709521741, 21.69892517999402, 26.52768103220923, 28.501162967999715, 13.899890778095873, 45.27335774769076, 5.31032344794928, 14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943], "policy_predator_policy_reward": [-3.3000514718747773, -25.133926561545202, -26.467968910861224, -30.186157028421125, -14.905844709521741, -21.69892517999402, -26.52768103220923, -28.501162967999715, -13.899890778095873, -45.27335774769076, -5.31032344794928, -14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28447811799575584, "mean_inference_ms": 0.9359495040703214, "mean_action_processing_ms": 0.12706454113195942, "mean_env_wait_ms": 0.06219060832498288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002786993980407715, "StateBufferConnector_ms": 0.0021102428436279297, "ViewRequirementAgentConnector_ms": 0.04603409767150879}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 727.9179199265888, "num_env_steps_trained_throughput_per_sec": 727.9179199265888, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 5074.862, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5074.827, "sample_time_ms": 657.287, "learn_time_ms": 4406.384, "learn_throughput": 907.774, "synch_weights_time_ms": 10.81}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 108, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-33", "timestamp": 1723345773, "time_this_iter_s": 5.498712062835693, "time_total_s": 551.9299485683441, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 551.9299485683441, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 43.449999999999996, "ram_util_percent": 81.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.307898100279272, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.411076412598292, "policy_loss": -0.007902232253400143, "vf_loss": 4.4189565872152645, "vf_explained_var": 0.171249229585131, "kl": 0.010447909410002806, "entropy": 0.6565307519088189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.018841144690911, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9424602155884108, "policy_loss": -0.003423197647255923, "vf_loss": 3.9454267799854277, "vf_explained_var": 0.009373946922520797, "kl": 0.007601934016263022, "entropy": 0.8370090544223785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 390.66, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39066, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -43.08097368752649}, "policy_reward_max": {"prey_policy": 43.08097368752649, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 8.146037739544152, "predator_policy": -8.146037739544152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 32, 400, 400, 400, 400, 400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [14.02921512524918, 22.20552806363005, 16.474441904191174, 7.364558009451628, -22.338330757409395, 18.046314574290328, -17.03093499162578, 10.21936214762323, -2.4415259934705453, -4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327], "policy_predator_policy_reward": [-14.02921512524918, -22.20552806363005, -16.474441904191174, -7.364558009451628, 22.338330757409395, -18.046314574290328, 17.03093499162578, -10.21936214762323, 2.4415259934705453, 4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28454601021194825, "mean_inference_ms": 0.9356321629211373, "mean_action_processing_ms": 0.1270094641392936, "mean_env_wait_ms": 0.0622022519316261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028939247131347656, "StateBufferConnector_ms": 0.002100825309753418, "ViewRequirementAgentConnector_ms": 0.04678165912628174}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 782.2460182176071, "num_env_steps_trained_throughput_per_sec": 782.2460182176071, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 5084.116, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5084.08, "sample_time_ms": 660.216, "learn_time_ms": 4412.377, "learn_throughput": 906.541, "synch_weights_time_ms": 11.129}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "training_iteration": 109, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-38", "timestamp": 1723345778, "time_this_iter_s": 5.116319894790649, "time_total_s": 557.0462684631348, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 557.0462684631348, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 37.542857142857144, "ram_util_percent": 81.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.132108067845305, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.18889990573128, "policy_loss": -0.00413926120090764, "vf_loss": 4.1930187692244845, "vf_explained_var": 0.18861991576850415, "kl": 0.009658748912092079, "entropy": 0.5708507766015828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5122306333854794, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.816788025200367, "policy_loss": -0.0074376291823379384, "vf_loss": 3.8235755080978078, "vf_explained_var": 0.05427242461591959, "kl": 0.010823657990335082, "entropy": 0.784154073583583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 394.34, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39434, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -43.08097368752649}, "policy_reward_max": {"prey_policy": 43.08097368752649, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 8.563639010689222, "predator_policy": -8.563639010689222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 143, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-4.2663799314847, 14.994851934596596, 14.884444585752497, 3.7569702649704, -22.007144098708544, -7.341595661956813, 13.48525070345131, 26.893266808514806, 12.533832832849791, 27.961900996782912, 43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916], "policy_predator_policy_reward": [4.2663799314847, -14.994851934596596, -14.884444585752497, -3.7569702649704, 22.007144098708544, 7.341595661956813, -13.48525070345131, -26.893266808514806, -12.533832832849791, -27.961900996782912, -43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28431349734795097, "mean_inference_ms": 0.935255041867513, "mean_action_processing_ms": 0.12704660100998383, "mean_env_wait_ms": 0.06214286177533276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002908945083618164, "StateBufferConnector_ms": 0.0020810365676879883, "ViewRequirementAgentConnector_ms": 0.045921921730041504}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 814.3335617210976, "num_env_steps_trained_throughput_per_sec": 814.3335617210976, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 5079.984, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5079.948, "sample_time_ms": 657.141, "learn_time_ms": 4411.437, "learn_throughput": 906.734, "synch_weights_time_ms": 11.012}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 110, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-43", "timestamp": 1723345783, "time_this_iter_s": 4.914863109588623, "time_total_s": 561.9611315727234, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 561.9611315727234, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 36.55714285714286, "ram_util_percent": 81.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.124570867915948, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8659902694324653, "policy_loss": -0.0010493449141601257, "vf_loss": 3.867030646900336, "vf_explained_var": 0.05784903826812903, "kl": 0.004250256495584712, "entropy": 0.6834456975882252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8411843032265702, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7774239321549734, "policy_loss": -0.00786747960082721, "vf_loss": 3.784467341254155, "vf_explained_var": -0.16203023164222638, "kl": 0.013718837633482757, "entropy": 0.7261752350876729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.91, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39691, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -44.489386796094756}, "policy_reward_max": {"prey_policy": 44.489386796094756, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 8.537063033702362, "predator_policy": -8.537063033702362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [43.08097368752649, 30.121346399469413, -14.136558195777862, -3.3385624648819316, -22.55911814593283, 17.572606281304974, 14.088360028543669, 29.510535960043185, -3.0845256177230027, 22.52795647078346, -15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905], "policy_predator_policy_reward": [-43.08097368752649, -30.121346399469413, 14.136558195777862, 3.3385624648819316, 22.55911814593283, -17.572606281304974, -14.088360028543669, -29.510535960043185, 3.0845256177230027, -22.52795647078346, 15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2841916044908668, "mean_inference_ms": 0.9349975816419573, "mean_action_processing_ms": 0.1269981144339744, "mean_env_wait_ms": 0.06212020558255452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029333829879760742, "StateBufferConnector_ms": 0.0020682811737060547, "ViewRequirementAgentConnector_ms": 0.04604196548461914}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.6895372411025, "num_env_steps_trained_throughput_per_sec": 806.6895372411025, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 5066.409, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5066.372, "sample_time_ms": 654.726, "learn_time_ms": 4400.312, "learn_throughput": 909.026, "synch_weights_time_ms": 10.975}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 111, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-48", "timestamp": 1723345788, "time_this_iter_s": 4.961185932159424, "time_total_s": 566.9223175048828, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 566.9223175048828, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 35.17142857142857, "ram_util_percent": 81.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.089035965067645, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2271390380958715, "policy_loss": -0.0037227853021856087, "vf_loss": 3.2308535034457844, "vf_explained_var": 0.09258278366178274, "kl": 0.007877219443642265, "entropy": 0.47433978629608947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6823761359478038, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.521550682683786, "policy_loss": -0.0033763929386623204, "vf_loss": 3.52476891502738, "vf_explained_var": 0.04584917891770601, "kl": 0.00263325310711013, "entropy": 0.7198757669577996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.91, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39691, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -44.489386796094756}, "policy_reward_max": {"prey_policy": 44.489386796094756, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 8.156428126838636, "predator_policy": -8.156428126838636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-15.07513142467759, 27.823283431041794, 16.855756652081507, 21.969447689642895, 29.23745522372851, 5.323015284101583, 11.001302509398894, 6.415139765824318, 1.7523595840041821, 22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925], "policy_predator_policy_reward": [15.07513142467759, -27.823283431041794, -16.855756652081507, -21.969447689642895, -29.23745522372851, -5.323015284101583, -11.001302509398894, -6.415139765824318, -1.7523595840041821, -22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2841546632636176, "mean_inference_ms": 0.9345965092830832, "mean_action_processing_ms": 0.12696143209261584, "mean_env_wait_ms": 0.06210567439184269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029304027557373047, "StateBufferConnector_ms": 0.0020394325256347656, "ViewRequirementAgentConnector_ms": 0.04607844352722168}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 820.8509605427596, "num_env_steps_trained_throughput_per_sec": 820.8509605427596, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 5053.016, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5052.98, "sample_time_ms": 650.767, "learn_time_ms": 4391.206, "learn_throughput": 910.912, "synch_weights_time_ms": 10.655}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 112, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-52", "timestamp": 1723345792, "time_this_iter_s": 4.875513076782227, "time_total_s": 571.797830581665, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 571.797830581665, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 35.785714285714285, "ram_util_percent": 81.34285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.036366978722314, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4396575349072616, "policy_loss": -0.004259944192017429, "vf_loss": 3.4439101606607436, "vf_explained_var": 0.26370968446135523, "kl": 0.00692843016332895, "entropy": 0.5853547968591253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5772050632163883, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.205914386486014, "policy_loss": -0.005458448718127329, "vf_loss": 3.2112132975210748, "vf_explained_var": 0.12363109420984983, "kl": 0.0053117376457557635, "entropy": 0.7486699146529039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39691, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -44.489386796094756}, "policy_reward_max": {"prey_policy": 44.489386796094756, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 7.92067910359749, "predator_policy": -7.92067910359749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [22.159296713697636, 12.694169447250857, 14.596707039309322, 6.697705958009784, 4.313909767991984, -9.648955543701796, 20.982787809251086, -11.323815616035958, 15.392868170640568, -12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288], "policy_predator_policy_reward": [-22.159296713697636, -12.694169447250857, -14.596707039309322, -6.697705958009784, -4.313909767991984, 9.648955543701796, -20.982787809251086, 11.323815616035958, -15.392868170640568, 12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28414686137208234, "mean_inference_ms": 0.9342403235382402, "mean_action_processing_ms": 0.1269273715270252, "mean_env_wait_ms": 0.06210769134714924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003189682960510254, "StateBufferConnector_ms": 0.0020629167556762695, "ViewRequirementAgentConnector_ms": 0.04642760753631592}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 794.6649524064487, "num_env_steps_trained_throughput_per_sec": 794.6649524064487, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 5053.758, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5053.721, "sample_time_ms": 653.555, "learn_time_ms": 4389.172, "learn_throughput": 911.334, "synch_weights_time_ms": 10.642}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "training_iteration": 113, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-09-57", "timestamp": 1723345797, "time_this_iter_s": 5.036117076873779, "time_total_s": 576.8339476585388, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 576.8339476585388, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 36.528571428571425, "ram_util_percent": 81.58571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.401871188978354, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6921008380750817, "policy_loss": -0.0030176274774324457, "vf_loss": 3.6951138570904734, "vf_explained_var": 0.15014645271003246, "kl": 0.004374345303421447, "entropy": 0.5260038789672156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.170533670174579, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6734015787641208, "policy_loss": -0.002076161570342568, "vf_loss": 3.6750133944054446, "vf_explained_var": -0.004869461183746656, "kl": 0.015460816115141543, "entropy": 0.7828777538612485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39691, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 9.031931594010329, "predator_policy": -9.031931594010329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.039195428520728, 8.755805100510898, 17.352847124648175, 15.219845685509124, 41.220236747368, 10.761976358949454, -6.004975765310263, -5.90075998191568, 7.221707427368944, -5.947452890147037, -0.07547498013775034, 7.488995533087181, 11.363792398486783, 28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605], "policy_predator_policy_reward": [12.039195428520728, -8.755805100510898, -17.352847124648175, -15.219845685509124, -41.220236747368, -10.761976358949454, 6.004975765310263, 5.90075998191568, -7.221707427368944, 5.947452890147037, 0.07547498013775034, -7.488995533087181, -11.363792398486783, -28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28409586719828117, "mean_inference_ms": 0.9340082411690034, "mean_action_processing_ms": 0.12689914600423008, "mean_env_wait_ms": 0.062095755035593135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032004117965698242, "StateBufferConnector_ms": 0.0019402503967285156, "ViewRequirementAgentConnector_ms": 0.04663431644439697}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 795.1873607361756, "num_env_steps_trained_throughput_per_sec": 795.1873607361756, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 5056.397, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5056.359, "sample_time_ms": 652.103, "learn_time_ms": 4393.228, "learn_throughput": 910.492, "synch_weights_time_ms": 10.672}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 114, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-03", "timestamp": 1723345803, "time_this_iter_s": 5.033306121826172, "time_total_s": 581.867253780365, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 581.867253780365, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 37.44285714285714, "ram_util_percent": 81.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.265743972361088, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.122956325362126, "policy_loss": -0.0040447341241815595, "vf_loss": 4.126997717221578, "vf_explained_var": 0.27208689507097006, "kl": 0.0063498485431341956, "entropy": 0.5752913636465867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7251791105916103, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2499974449475606, "policy_loss": -0.006364223324393, "vf_loss": 3.2559762125213942, "vf_explained_var": 0.1366951911399762, "kl": 0.012834037090558326, "entropy": 0.7978459231555461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.91, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 39691, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 9.861850259497626, "predator_policy": -9.861850259497626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [28.356802876762178, 19.86313914354593, 32.55214425163364, 1.6209315280020284, -2.9119200106817793, 9.592701617809062, 11.319646260649161, 36.080989768735584, 26.551961511395014, 19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142], "policy_predator_policy_reward": [-28.356802876762178, -19.86313914354593, -32.55214425163364, -1.6209315280020284, 2.9119200106817793, -9.592701617809062, -11.319646260649161, -36.080989768735584, -26.551961511395014, -19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840784784275159, "mean_inference_ms": 0.934071083015494, "mean_action_processing_ms": 0.12684960866655792, "mean_env_wait_ms": 0.06208856224341854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032111406326293945, "StateBufferConnector_ms": 0.0019452571868896484, "ViewRequirementAgentConnector_ms": 0.04670405387878418}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.2933814772032, "num_env_steps_trained_throughput_per_sec": 800.2933814772032, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 5058.509, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5058.471, "sample_time_ms": 646.73, "learn_time_ms": 4400.679, "learn_throughput": 908.951, "synch_weights_time_ms": 10.704}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 115, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-08", "timestamp": 1723345808, "time_this_iter_s": 5.0009660720825195, "time_total_s": 586.8682198524475, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 586.8682198524475, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 35.68571428571429, "ram_util_percent": 81.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.168236976675689, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.11753565594554, "policy_loss": -0.0016645464692070769, "vf_loss": 4.119197387993336, "vf_explained_var": 0.20015338727583487, "kl": 0.0053318478117842715, "entropy": 0.5774891206063331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.01719602967302, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.431911650051673, "policy_loss": -0.009235679590832054, "vf_loss": 4.440101315826178, "vf_explained_var": 0.06342691741883755, "kl": 0.03482763939529776, "entropy": 0.7973503521333138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39691, "policy_reward_min": {"prey_policy": -27.489859103962562, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.489859103962562}, "policy_reward_mean": {"prey_policy": 9.941673694573966, "predator_policy": -9.941673694573966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [19.23026368407269, -27.489859103962562, 28.788680210285143, 18.43258079428304, -6.175761482927939, -10.369225725309901, -11.712256600538476, 21.582964676352415, -10.718988156963931, 8.315432489821127, 18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152], "policy_predator_policy_reward": [-19.23026368407269, 27.489859103962562, -28.788680210285143, -18.43258079428304, 6.175761482927939, 10.369225725309901, 11.712256600538476, -21.582964676352415, 10.718988156963931, -8.315432489821127, -18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840017558208619, "mean_inference_ms": 0.9337787124634076, "mean_action_processing_ms": 0.12680578382290292, "mean_env_wait_ms": 0.06207763531258749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032120943069458008, "StateBufferConnector_ms": 0.0019927024841308594, "ViewRequirementAgentConnector_ms": 0.049594759941101074}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.1614518818326, "num_env_steps_trained_throughput_per_sec": 749.1614518818326, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 5096.532, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5096.486, "sample_time_ms": 655.283, "learn_time_ms": 4429.617, "learn_throughput": 903.013, "synch_weights_time_ms": 11.185}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 116, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-13", "timestamp": 1723345813, "time_this_iter_s": 5.352704048156738, "time_total_s": 592.2209239006042, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 592.2209239006042, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 38.85, "ram_util_percent": 81.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.466621500377854, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.039769574999809, "policy_loss": -0.003468382003484294, "vf_loss": 5.043233693142732, "vf_explained_var": 0.28804647978395226, "kl": 0.008108589748451328, "entropy": 0.5528645250325401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.418930508568883, "cur_kl_coeff": 0.045050811767578115, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.053456723193327, "policy_loss": -0.01004491660981633, "vf_loss": 5.062383534262578, "vf_explained_var": 0.1508541068683068, "kl": 0.024818608554748607, "entropy": 0.8212975067396958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.91, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39691, "policy_reward_min": {"prey_policy": -27.057537540466157, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.057537540466157}, "policy_reward_mean": {"prey_policy": 10.460055624951979, "predator_policy": -10.460055624951979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 91, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [18.84725935203591, 13.173453795838597, 10.565909267145415, 1.7598397816254163, 11.323579583174695, 23.125125844391405, -21.416255106236335, 18.279169764010206, 16.36479772550736, -26.251492172289943, 2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972], "policy_predator_policy_reward": [-18.84725935203591, -13.173453795838597, -10.565909267145415, -1.7598397816254163, -11.323579583174695, -23.125125844391405, 21.416255106236335, -18.279169764010206, -16.36479772550736, 26.251492172289943, -2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2839156192299013, "mean_inference_ms": 0.9333056912607283, "mean_action_processing_ms": 0.12679499519247706, "mean_env_wait_ms": 0.062057364616612966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003190279006958008, "StateBufferConnector_ms": 0.0021080970764160156, "ViewRequirementAgentConnector_ms": 0.050435781478881836}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.3565342029628, "num_env_steps_trained_throughput_per_sec": 780.3565342029628, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 5087.938, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5087.893, "sample_time_ms": 653.844, "learn_time_ms": 4423.174, "learn_throughput": 904.328, "synch_weights_time_ms": 10.489}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 117, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-18", "timestamp": 1723345818, "time_this_iter_s": 5.129302024841309, "time_total_s": 597.3502259254456, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 597.3502259254456, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 39.89999999999999, "ram_util_percent": 82.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.56845998664697, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.843272969375054, "policy_loss": -0.003447378274965255, "vf_loss": 4.846717833727598, "vf_explained_var": 0.22445097050319116, "kl": 0.004739298483448608, "entropy": 0.6829789376507203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.021945011119048, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.992258840302626, "policy_loss": -0.006175361342805748, "vf_loss": 5.997196077307065, "vf_explained_var": 0.08208621926605701, "kl": 0.01832221985384684, "entropy": 0.763850751084586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -27.73550433167638, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.73550433167638}, "policy_reward_mean": {"prey_policy": 9.450125306132168, "predator_policy": -9.450125306132168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400], "policy_prey_policy_reward": [2.488140561029855, -9.335352334980165, -13.258943757424017, 19.562402989949476, -8.731758331200712, 24.69182226829137, -1.0593891397569664, 5.386116184202724, -18.786770649518743, 18.199721413880486, 24.974478470266327, -2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023], "policy_predator_policy_reward": [-2.488140561029855, 9.335352334980165, 13.258943757424017, -19.562402989949476, 8.731758331200712, -24.69182226829137, 1.0593891397569664, -5.386116184202724, 18.786770649518743, -18.199721413880486, -24.974478470266327, 2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28383291617342016, "mean_inference_ms": 0.933258420645667, "mean_action_processing_ms": 0.12674157345934314, "mean_env_wait_ms": 0.06203827516459724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031414031982421875, "StateBufferConnector_ms": 0.002102494239807129, "ViewRequirementAgentConnector_ms": 0.05002021789550781}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 787.8545822402855, "num_env_steps_trained_throughput_per_sec": 787.8545822402855, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 5046.133, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5046.089, "sample_time_ms": 638.507, "learn_time_ms": 4396.826, "learn_throughput": 909.747, "synch_weights_time_ms": 10.373}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 118, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-23", "timestamp": 1723345823, "time_this_iter_s": 5.0796520709991455, "time_total_s": 602.4298779964447, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 602.4298779964447, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 36.41428571428572, "ram_util_percent": 82.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.034976814563076, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4384321975211303, "policy_loss": -0.0045188680679226914, "vf_loss": 3.4429485823959114, "vf_explained_var": 0.39913974025597176, "kl": 0.009398715658941171, "entropy": 0.6264770089338223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.919207289877037, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7903600459297495, "policy_loss": -0.0030564598622731865, "vf_loss": 4.792798216640949, "vf_explained_var": 0.005322706761459509, "kl": 0.009149461073504627, "entropy": 0.801318830748399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -27.73550433167638, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.73550433167638}, "policy_reward_mean": {"prey_policy": 8.955373077574098, "predator_policy": -8.955373077574098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.020572155029729, 18.8499529152711, 27.467514267950044, -21.737812968413664, 3.3951392648370025, 17.878695781006403, 34.399553611750726, -7.3361603726642315, 17.39244485172916, 15.998460893111059, 20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916], "policy_predator_policy_reward": [2.020572155029729, -18.8499529152711, -27.467514267950044, 21.737812968413664, -3.3951392648370025, -17.878695781006403, -34.399553611750726, 7.3361603726642315, -17.39244485172916, -15.998460893111059, -20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28366955939457544, "mean_inference_ms": 0.932740063187596, "mean_action_processing_ms": 0.12667465088743937, "mean_env_wait_ms": 0.06200283579701276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030088424682617188, "StateBufferConnector_ms": 0.0020885467529296875, "ViewRequirementAgentConnector_ms": 0.04902350902557373}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 732.6634013337124, "num_env_steps_trained_throughput_per_sec": 732.6634013337124, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 5080.738, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5080.69, "sample_time_ms": 632.042, "learn_time_ms": 4437.199, "learn_throughput": 901.47, "synch_weights_time_ms": 11.039}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "training_iteration": 119, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-29", "timestamp": 1723345829, "time_this_iter_s": 5.475926876068115, "time_total_s": 607.9058048725128, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71bd790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 607.9058048725128, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 43.7, "ram_util_percent": 82.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.109176526404918, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3240786222120127, "policy_loss": -0.004098334585917959, "vf_loss": 3.328175628433625, "vf_explained_var": 0.5061391131331523, "kl": 0.0050778812980076474, "entropy": 0.5375265807223817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8781734981263676, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.287375672409932, "policy_loss": -0.008321147254901008, "vf_loss": 4.294462522864341, "vf_explained_var": -0.06398723994692167, "kl": 0.018264936110750085, "entropy": 0.8717806978772084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -27.73550433167638, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.73550433167638}, "policy_reward_mean": {"prey_policy": 8.83528632303735, "predator_policy": -8.83528632303735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.123609059732324, -4.958759167071218, 44.489386796094756, -0.7858637513824291, 21.86196945909159, 3.489273568446947, 6.936222124176753, -27.057537540466157, -1.8589607056511905, 14.43110428336253, -2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138], "policy_predator_policy_reward": [-20.123609059732324, 4.958759167071218, -44.489386796094756, 0.7858637513824291, -21.86196945909159, -3.489273568446947, -6.936222124176753, 27.057537540466157, 1.8589607056511905, -14.43110428336253, 2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2834867228254963, "mean_inference_ms": 0.9324869023443989, "mean_action_processing_ms": 0.12662832632678828, "mean_env_wait_ms": 0.06196587676546728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002983570098876953, "StateBufferConnector_ms": 0.0021064281463623047, "ViewRequirementAgentConnector_ms": 0.049445390701293945}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.0455897109954, "num_env_steps_trained_throughput_per_sec": 749.0455897109954, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 5123.553, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5123.503, "sample_time_ms": 635.007, "learn_time_ms": 4477.104, "learn_throughput": 893.435, "synch_weights_time_ms": 10.985}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 120, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-34", "timestamp": 1723345834, "time_this_iter_s": 5.342880010604858, "time_total_s": 613.2486848831177, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 613.2486848831177, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 38.825, "ram_util_percent": 81.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.861266130084793, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.448433526108662, "policy_loss": -0.010464002379740123, "vf_loss": 4.4588936842978, "vf_explained_var": 0.27529977870484196, "kl": 0.01448254954886907, "entropy": 0.6650905452668667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.450206829421222, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.851640742272139, "policy_loss": -0.007881468717823737, "vf_loss": 4.857796240846316, "vf_explained_var": -0.33187186494469645, "kl": 0.025540685488738068, "entropy": 0.7839004662508766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -27.73550433167638, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.73550433167638}, "policy_reward_mean": {"prey_policy": 8.442053908760638, "predator_policy": -8.442053908760638}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.135350624220557, 14.406185946172783, 24.08790893651339, 19.707287898040587, -12.39718067363544, -4.847119440977448, 12.792467748922586, 10.516500963812838, -0.8422813210084925, 28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854], "policy_predator_policy_reward": [2.135350624220557, -14.406185946172783, -24.08790893651339, -19.707287898040587, 12.39718067363544, 4.847119440977448, -12.792467748922586, -10.516500963812838, 0.8422813210084925, -28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28340381843019463, "mean_inference_ms": 0.9320587805557727, "mean_action_processing_ms": 0.1265760947700594, "mean_env_wait_ms": 0.06194605847931274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003020763397216797, "StateBufferConnector_ms": 0.002147078514099121, "ViewRequirementAgentConnector_ms": 0.04935598373413086}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.3350014683691, "num_env_steps_trained_throughput_per_sec": 789.3350014683691, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 5134.456, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5134.405, "sample_time_ms": 639.21, "learn_time_ms": 4483.581, "learn_throughput": 892.144, "synch_weights_time_ms": 11.201}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "training_iteration": 121, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-39", "timestamp": 1723345839, "time_this_iter_s": 5.07087516784668, "time_total_s": 618.3195600509644, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.3195600509644, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 37.75714285714286, "ram_util_percent": 81.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6454821775356927, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.684658469756444, "policy_loss": -0.002496081398324653, "vf_loss": 2.6871530880530674, "vf_explained_var": 0.3036508673802018, "kl": 0.005521455166972337, "entropy": 0.7013661556566755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.867753843528529, "cur_kl_coeff": 0.10136432647705075, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.076838251203299, "policy_loss": -0.0064575107302516695, "vf_loss": 4.0824384860694405, "vf_explained_var": 0.07854062380890052, "kl": 0.008457453134838033, "entropy": 0.7904164409264922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -27.73550433167638, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.73550433167638}, "policy_reward_mean": {"prey_policy": 8.419787485843852, "predator_policy": -8.419787485843852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [28.639043352518218, -16.481592643266094, 30.870059988797593, 3.6892042949532637, -1.319952636484544, 11.552840940443609, 25.311545113670153, -14.011300221134743, 13.477878201534288, 39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772], "policy_predator_policy_reward": [-28.639043352518218, 16.481592643266094, -30.870059988797593, -3.6892042949532637, 1.319952636484544, -11.552840940443609, -25.311545113670153, 14.011300221134743, -13.477878201534288, -39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28333419735417353, "mean_inference_ms": 0.931662936992443, "mean_action_processing_ms": 0.12652535046766486, "mean_env_wait_ms": 0.06193961824391391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031447410583496094, "StateBufferConnector_ms": 0.002159714698791504, "ViewRequirementAgentConnector_ms": 0.0500410795211792}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 826.4215035288832, "num_env_steps_trained_throughput_per_sec": 826.4215035288832, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 5131.171, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5131.12, "sample_time_ms": 641.421, "learn_time_ms": 4478.088, "learn_throughput": 893.238, "synch_weights_time_ms": 11.202}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 122, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-44", "timestamp": 1723345844, "time_this_iter_s": 4.843328952789307, "time_total_s": 623.1628890037537, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 623.1628890037537, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 35.32857142857143, "ram_util_percent": 81.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.569659488524, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.037126975134015, "policy_loss": -0.0036926090188596087, "vf_loss": 3.0408181870977082, "vf_explained_var": 0.4389973736057679, "kl": 0.005289119596849427, "entropy": 0.5342036375775934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3579381185894213, "cur_kl_coeff": 0.10136432647705075, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.662620705366135, "policy_loss": -0.004773031009244732, "vf_loss": 3.6664204262197018, "vf_explained_var": -0.08986066201080879, "kl": 0.009602179073649708, "entropy": 0.7962584337840478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -27.73550433167638, "predator_policy": -44.98701558844276}, "policy_reward_max": {"prey_policy": 44.98701558844276, "predator_policy": 27.73550433167638}, "policy_reward_mean": {"prey_policy": 7.97146118849141, "predator_policy": -7.97146118849141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [39.33595119546844, 24.04929819654695, -18.212643831577637, 17.580034060595306, 11.558711405959016, 29.685081178740603, 44.98701558844276, 27.077570773829276, 10.928904219692605, 3.9451485238498165, 13.3358298988339, 13.716490092523127, 22.535559114319735, 20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885], "policy_predator_policy_reward": [-39.33595119546844, -24.04929819654695, 18.212643831577637, -17.580034060595306, -11.558711405959016, -29.685081178740603, -44.98701558844276, -27.077570773829276, -10.928904219692605, -3.9451485238498165, -13.3358298988339, -13.716490092523127, -22.535559114319735, -20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2832376878382625, "mean_inference_ms": 0.9313472796635628, "mean_action_processing_ms": 0.12648184331642534, "mean_env_wait_ms": 0.06191836427102783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002886533737182617, "StateBufferConnector_ms": 0.0023245811462402344, "ViewRequirementAgentConnector_ms": 0.04981207847595215}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 812.8338204281981, "num_env_steps_trained_throughput_per_sec": 812.8338204281981, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 5119.92, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5119.868, "sample_time_ms": 638.599, "learn_time_ms": 4469.666, "learn_throughput": 894.922, "synch_weights_time_ms": 11.196}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 123, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-49", "timestamp": 1723345849, "time_this_iter_s": 4.923525810241699, "time_total_s": 628.0864148139954, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 628.0864148139954, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 35.32857142857143, "ram_util_percent": 81.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.219187038950622, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6872497794528805, "policy_loss": -0.005930600964832896, "vf_loss": 4.69317854543527, "vf_explained_var": 0.37773094680160285, "kl": 0.006964321562644915, "entropy": 0.6031827318792542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.520117573750516, "cur_kl_coeff": 0.10136432647705075, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.839492327471574, "policy_loss": -0.02285661564140658, "vf_loss": 4.858727111915747, "vf_explained_var": -0.019710890638331573, "kl": 0.03573073902460162, "entropy": 0.7668268632764618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.368410517363166}, "policy_reward_max": {"prey_policy": 37.368410517363166, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 6.400270083354162, "predator_policy": -6.400270083354162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.836137740751532, 7.777734827334783, 26.0494254651813, 11.483744474802052, -0.7745966583690453, -10.620491429575845, 25.0446713359624, 18.542414781441547, 20.53714571157142, 29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677], "policy_predator_policy_reward": [-20.836137740751532, -7.777734827334783, -26.0494254651813, -11.483744474802052, 0.7745966583690453, 10.620491429575845, -25.0446713359624, -18.542414781441547, -20.53714571157142, -29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28315001853161165, "mean_inference_ms": 0.9310421110184985, "mean_action_processing_ms": 0.12644382495302234, "mean_env_wait_ms": 0.061891210783201284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002866983413696289, "StateBufferConnector_ms": 0.002327561378479004, "ViewRequirementAgentConnector_ms": 0.05059075355529785}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.5551234221127, "num_env_steps_trained_throughput_per_sec": 805.5551234221127, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 5113.446, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5113.395, "sample_time_ms": 642.613, "learn_time_ms": 4459.209, "learn_throughput": 897.02, "synch_weights_time_ms": 11.164}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 124, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-54", "timestamp": 1723345854, "time_this_iter_s": 4.970645904541016, "time_total_s": 633.0570607185364, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4928940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 633.0570607185364, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 35.6, "ram_util_percent": 81.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.132894628494978, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.264308137198289, "policy_loss": -0.004206297693114417, "vf_loss": 4.26851207986474, "vf_explained_var": 0.13601746962716182, "kl": 0.00899187235142449, "entropy": 0.6869807455688715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6878046818077563, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.83870250955224, "policy_loss": -0.006420335815831398, "vf_loss": 4.8431388253966965, "vf_explained_var": 0.07504848334938288, "kl": 0.013048727559785837, "entropy": 0.8733780194694797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.51, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39651, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.368410517363166}, "policy_reward_max": {"prey_policy": 37.368410517363166, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 5.127363916440299, "predator_policy": -5.127363916440299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [29.407731808016223, 20.707875597675766, 13.201166920462068, 23.418234179673163, 17.590736388825963, 16.410562130871146, -1.2953554783240264, 18.539456698669223, 33.0283322096152, 7.9801866243486685, 27.804544842090337, 14.91844528060063, -1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285], "policy_predator_policy_reward": [-29.407731808016223, -20.707875597675766, -13.201166920462068, -23.418234179673163, -17.590736388825963, -16.410562130871146, 1.2953554783240264, -18.539456698669223, -33.0283322096152, -7.9801866243486685, -27.804544842090337, -14.91844528060063, 1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28305154128869253, "mean_inference_ms": 0.9307282079733435, "mean_action_processing_ms": 0.12639577583352568, "mean_env_wait_ms": 0.061876321667802714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029066801071166992, "StateBufferConnector_ms": 0.0023270845413208008, "ViewRequirementAgentConnector_ms": 0.05095016956329346}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.921416143202, "num_env_steps_trained_throughput_per_sec": 789.921416143202, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 5120.008, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5119.957, "sample_time_ms": 646.885, "learn_time_ms": 4461.508, "learn_throughput": 896.558, "synch_weights_time_ms": 11.156}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 125, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-10-59", "timestamp": 1723345859, "time_this_iter_s": 5.0665740966796875, "time_total_s": 638.1236348152161, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 638.1236348152161, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 36.82857142857143, "ram_util_percent": 81.67142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8617834273725746, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.61179847518603, "policy_loss": -0.007698556064618363, "vf_loss": 4.619493875652552, "vf_explained_var": 0.22506786454468966, "kl": 0.011986066180121298, "entropy": 0.6890585888177156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7738610096896688, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.978404574841261, "policy_loss": -0.00419184819450796, "vf_loss": 4.981952601671219, "vf_explained_var": -0.053783008456230165, "kl": 0.004234308003207188, "entropy": 0.8512237259497245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.27, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38927, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.368410517363166}, "policy_reward_max": {"prey_policy": 37.368410517363166, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 2.8573450371102584, "predator_policy": -2.8573450371102584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36], "policy_prey_policy_reward": [-1.2584805020245682, 3.9661765648615415, -6.445506687092051, 12.79510182712157, -4.886785859756595, -0.19652023321036793, 27.044861965973972, 7.346534641577755, -27.73550433167638, 18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259], "policy_predator_policy_reward": [1.2584805020245682, -3.9661765648615415, 6.445506687092051, -12.79510182712157, 4.886785859756595, 0.19652023321036793, -27.044861965973972, -7.346534641577755, 27.73550433167638, -18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.282971725495848, "mean_inference_ms": 0.9301948101736055, "mean_action_processing_ms": 0.12633442585393617, "mean_env_wait_ms": 0.06186016441008541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029560327529907227, "StateBufferConnector_ms": 0.002322077751159668, "ViewRequirementAgentConnector_ms": 0.048648953437805176}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.3268623149742, "num_env_steps_trained_throughput_per_sec": 800.3268623149742, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 5085.873, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5085.83, "sample_time_ms": 643.161, "learn_time_ms": 4431.566, "learn_throughput": 902.616, "synch_weights_time_ms": 10.736}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 126, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-04", "timestamp": 1723345864, "time_this_iter_s": 5.00059175491333, "time_total_s": 643.1242265701294, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49288b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 643.1242265701294, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 35.74285714285714, "ram_util_percent": 81.64285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1840654913336035, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3528926715254785, "policy_loss": -0.003815330143697793, "vf_loss": 4.356705969572067, "vf_explained_var": 0.2718596580127875, "kl": 0.007718139655065196, "entropy": 0.6400548860430717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7091225450858474, "cur_kl_coeff": 0.07602324485778808, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.577294923365116, "policy_loss": -0.003910461934962465, "vf_loss": 4.580377278973659, "vf_explained_var": -0.053953996114432815, "kl": 0.01089303952450122, "entropy": 0.8322462576131026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.27, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38927, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.368410517363166}, "policy_reward_max": {"prey_policy": 37.368410517363166, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 2.987212640795541, "predator_policy": -2.987212640795541}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 51, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [18.689841779332248, -13.492280748712222, 11.75399012355168, -10.354875029128666, -14.480423527982946, -7.746939286080519, -4.5419805668992765, 5.339992899240023, 1.301430262408818, 16.107631400610472, 9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251], "policy_predator_policy_reward": [-18.689841779332248, 13.492280748712222, -11.75399012355168, 10.354875029128666, 14.480423527982946, 7.746939286080519, 4.5419805668992765, -5.339992899240023, -1.301430262408818, -16.107631400610472, -9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28291601074170014, "mean_inference_ms": 0.9303225191393956, "mean_action_processing_ms": 0.12629014254843401, "mean_env_wait_ms": 0.06184297491392322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002990245819091797, "StateBufferConnector_ms": 0.002236604690551758, "ViewRequirementAgentConnector_ms": 0.04860532283782959}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 809.785101526399, "num_env_steps_trained_throughput_per_sec": 809.785101526399, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 5067.244, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5067.204, "sample_time_ms": 640.212, "learn_time_ms": 4415.818, "learn_throughput": 905.834, "synch_weights_time_ms": 10.807}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "training_iteration": 127, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-09", "timestamp": 1723345869, "time_this_iter_s": 4.942358732223511, "time_total_s": 648.0665853023529, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4928940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 648.0665853023529, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 35.371428571428574, "ram_util_percent": 81.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.721231817578276, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3197801741460955, "policy_loss": -0.007447024704985475, "vf_loss": 4.327225223183632, "vf_explained_var": 0.31822036287436883, "kl": 0.007475705186468673, "entropy": 0.522565306785206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.515686601959169, "cur_kl_coeff": 0.07602324485778808, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.496753167112669, "policy_loss": -0.005369549288298003, "vf_loss": 4.501447626451651, "vf_explained_var": -0.17914430828144154, "kl": 0.00887994225003558, "entropy": 0.8021376009409626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.76, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39276, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.368410517363166}, "policy_reward_max": {"prey_policy": 37.368410517363166, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 3.508992523581601, "predator_policy": -3.508992523581601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.43290740154572, -3.00620780624989, -20.60898469109639, -17.616404741002157, -13.972268419144584, 37.368410517363166, -17.18614359812733, 17.306124321239515, -14.471249828614916, 10.679634206517683, 5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677], "policy_predator_policy_reward": [-9.43290740154572, 3.00620780624989, 20.60898469109639, 17.616404741002157, 13.972268419144584, -37.368410517363166, 17.18614359812733, -17.306124321239515, 14.471249828614916, -10.679634206517683, -5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2828383634194134, "mean_inference_ms": 0.9300816035335013, "mean_action_processing_ms": 0.12626259960573477, "mean_env_wait_ms": 0.061836546365043786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002977728843688965, "StateBufferConnector_ms": 0.0022161006927490234, "ViewRequirementAgentConnector_ms": 0.04805433750152588}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 793.1024001285058, "num_env_steps_trained_throughput_per_sec": 793.1024001285058, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 5063.885, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5063.845, "sample_time_ms": 647.907, "learn_time_ms": 4404.739, "learn_throughput": 908.113, "synch_weights_time_ms": 10.831}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 128, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-14", "timestamp": 1723345874, "time_this_iter_s": 5.045986175537109, "time_total_s": 653.11257147789, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 653.11257147789, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 35.41428571428572, "ram_util_percent": 81.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.045498547206322, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1714866813272238, "policy_loss": -0.004810527602482277, "vf_loss": 3.1762949084242185, "vf_explained_var": 0.4357795440902313, "kl": 0.00876081506463046, "entropy": 0.5595597141732772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7812590660216907, "cur_kl_coeff": 0.07602324485778808, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.683331909030676, "policy_loss": -0.006796505565095382, "vf_loss": 3.6890145532786844, "vf_explained_var": -0.23998702615499495, "kl": 0.014651741627968654, "entropy": 0.8847290658702452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.76, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39276, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.17081796599058}, "policy_reward_max": {"prey_policy": 37.17081796599058, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 4.127377781346639, "predator_policy": -4.127377781346639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.427816420744513, 18.744836183140862, -21.471728266737408, 16.626597687901455, 13.662808303552296, 16.945110663482403, -0.29048380321174605, 5.393618201931577, 26.56033103855138, 5.793219304247721, -16.38727278852228, -0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824], "policy_predator_policy_reward": [-5.427816420744513, -18.744836183140862, 21.471728266737408, -16.626597687901455, -13.662808303552296, -16.945110663482403, 0.29048380321174605, -5.393618201931577, -26.56033103855138, -5.793219304247721, 16.38727278852228, 0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28267047472640067, "mean_inference_ms": 0.9298528344932646, "mean_action_processing_ms": 0.12622967406324356, "mean_env_wait_ms": 0.06182102508287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030335187911987305, "StateBufferConnector_ms": 0.0021969079971313477, "ViewRequirementAgentConnector_ms": 0.047617435455322266}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 810.5739574351967, "num_env_steps_trained_throughput_per_sec": 810.5739574351967, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 5011.409, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5011.373, "sample_time_ms": 645.019, "learn_time_ms": 4356.143, "learn_throughput": 918.243, "synch_weights_time_ms": 9.882}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 129, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-19", "timestamp": 1723345879, "time_this_iter_s": 4.937361001968384, "time_total_s": 658.0499324798584, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49288b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 658.0499324798584, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 36.628571428571426, "ram_util_percent": 81.67142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.391255841342111, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6635809195538362, "policy_loss": -0.002866575264730879, "vf_loss": 3.666446290910244, "vf_explained_var": 0.08628495385249456, "kl": 0.004544150558369431, "entropy": 0.5145345761130253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.699012349297603, "cur_kl_coeff": 0.07602324485778808, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.409136376778284, "policy_loss": -0.011153694007953163, "vf_loss": 4.418051564941804, "vf_explained_var": -0.37373123299330474, "kl": 0.02944472681559894, "entropy": 0.905445825184385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.76, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39276, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.17081796599058}, "policy_reward_max": {"prey_policy": 37.17081796599058, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 4.3806271366911655, "predator_policy": -4.3806271366911655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-0.5570957702922144, 3.486827870373709, -0.7246967447334427, -3.9459000875859864, 26.542402233968787, 3.1024723273556134, 3.6972129045123268, 16.34003344933854, 11.578602848297333, 17.687761820980725, 5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553], "policy_predator_policy_reward": [0.5570957702922144, -3.486827870373709, 0.7246967447334427, 3.9459000875859864, -26.542402233968787, -3.1024723273556134, -3.6972129045123268, -16.34003344933854, -11.578602848297333, -17.687761820980725, -5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28263980989336546, "mean_inference_ms": 0.9296060344377736, "mean_action_processing_ms": 0.12619270916822634, "mean_env_wait_ms": 0.06180857331375591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030385255813598633, "StateBufferConnector_ms": 0.0021697282791137695, "ViewRequirementAgentConnector_ms": 0.04742884635925293}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.2314001413151, "num_env_steps_trained_throughput_per_sec": 804.2314001413151, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 4974.764, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4974.731, "sample_time_ms": 644.211, "learn_time_ms": 4320.313, "learn_throughput": 925.859, "synch_weights_time_ms": 9.877}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 130, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-24", "timestamp": 1723345884, "time_this_iter_s": 4.976269960403442, "time_total_s": 663.0262024402618, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 663.0262024402618, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 35.74285714285715, "ram_util_percent": 81.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0700785759836435, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.623414169996977, "policy_loss": -0.0034846203057289434, "vf_loss": 3.626898083339135, "vf_explained_var": 0.15983048447718223, "kl": 0.005431888645678116, "entropy": 0.5829983089429637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.294582338134448, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.06626477787892, "policy_loss": -0.004730378686993693, "vf_loss": 4.069330650319656, "vf_explained_var": 0.30758294463157654, "kl": 0.014596347443135262, "entropy": 0.9198782291884223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.91, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38891, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.17081796599058}, "policy_reward_max": {"prey_policy": 37.17081796599058, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 4.118376078369668, "predator_policy": -4.118376078369668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400], "policy_prey_policy_reward": [5.721503762658596, 5.023308163679793, 6.471698900433793, 12.875365726639266, 0.3227513679497118, 12.56246106132716, -13.181676510024772, 23.606909434022757, -11.258305032789732, 14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401], "policy_predator_policy_reward": [-5.721503762658596, -5.023308163679793, -6.471698900433793, -12.875365726639266, -0.3227513679497118, -12.56246106132716, 13.181676510024772, -23.606909434022757, 11.258305032789732, -14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2825703064001212, "mean_inference_ms": 0.9293149405861091, "mean_action_processing_ms": 0.126130189008299, "mean_env_wait_ms": 0.06180810516417717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003018021583557129, "StateBufferConnector_ms": 0.0021458864212036133, "ViewRequirementAgentConnector_ms": 0.047006845474243164}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 771.6036229812123, "num_env_steps_trained_throughput_per_sec": 771.6036229812123, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 4986.409, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4986.36, "sample_time_ms": 636.192, "learn_time_ms": 4339.499, "learn_throughput": 921.765, "synch_weights_time_ms": 10.256}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "training_iteration": 131, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-29", "timestamp": 1723345889, "time_this_iter_s": 5.206140041351318, "time_total_s": 668.2323424816132, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 668.2323424816132, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 37.25, "ram_util_percent": 81.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.239721705081562, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9789902238796153, "policy_loss": -0.012843075763521483, "vf_loss": 2.991831129292647, "vf_explained_var": 0.3297386342659593, "kl": 0.016506419927299645, "entropy": 0.7140416142220298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5979559182499847, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.731211008876562, "policy_loss": -0.008315476984231887, "vf_loss": 3.73824053555727, "vf_explained_var": -0.07596034898112218, "kl": 0.011276871362278352, "entropy": 0.9781351692353686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38891, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.17081796599058}, "policy_reward_max": {"prey_policy": 37.17081796599058, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 3.7719775647000806, "predator_policy": -3.7719775647000806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [14.315732609163149, 16.454661801880903, -15.100642553067772, 12.813133597542958, 9.572548777024398, -15.232861932184488, 1.7239199541952885, 12.424671133410804, 27.35863547155797, 2.369075936945819, -8.266868519772848, 10.40755258928434, 29.469134551583252, 9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353], "policy_predator_policy_reward": [-14.315732609163149, -16.454661801880903, 15.100642553067772, -12.813133597542958, -9.572548777024398, 15.232861932184488, -1.7239199541952885, -12.424671133410804, -27.35863547155797, -2.369075936945819, 8.266868519772848, -10.40755258928434, -29.469134551583252, -9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2824872566490327, "mean_inference_ms": 0.929041462144542, "mean_action_processing_ms": 0.12610002916403198, "mean_env_wait_ms": 0.06180101248177876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003141045570373535, "StateBufferConnector_ms": 0.002156496047973633, "ViewRequirementAgentConnector_ms": 0.04741370677947998}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.0410775018141, "num_env_steps_trained_throughput_per_sec": 804.0410775018141, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 4999.883, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4999.831, "sample_time_ms": 637.364, "learn_time_ms": 4351.765, "learn_throughput": 919.167, "synch_weights_time_ms": 10.29}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 132, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-34", "timestamp": 1723345894, "time_this_iter_s": 4.977538108825684, "time_total_s": 673.2098805904388, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 673.2098805904388, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 38.114285714285714, "ram_util_percent": 81.11428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.302108387897412, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8470959233740967, "policy_loss": -0.005762945593354137, "vf_loss": 3.8528568002084893, "vf_explained_var": 0.3189215819040934, "kl": 0.015715182360969516, "entropy": 0.7089655441542466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.639286816616853, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.291929912815491, "policy_loss": -0.0071662458925857205, "vf_loss": 4.297620496153831, "vf_explained_var": 0.01727020274847746, "kl": 0.012940329188369331, "entropy": 0.9383660467341542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.91, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38891, "policy_reward_min": {"prey_policy": -39.92072413050029, "predator_policy": -37.17081796599058}, "policy_reward_max": {"prey_policy": 37.17081796599058, "predator_policy": 39.92072413050029}, "policy_reward_mean": {"prey_policy": 3.949740652194849, "predator_policy": -3.949740652194849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.427219304658244, 4.218088861744926, -39.92072413050029, 26.436378681332833, 11.296789621479967, 0.48869227179476127, -2.304805870020677, -10.242677546975754, 7.196369394414495, -3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114], "policy_predator_policy_reward": [-9.427219304658244, -4.218088861744926, 39.92072413050029, -26.436378681332833, -11.296789621479967, -0.48869227179476127, 2.304805870020677, 10.242677546975754, -7.196369394414495, 3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28235915584552074, "mean_inference_ms": 0.9286052120672487, "mean_action_processing_ms": 0.12607576788546487, "mean_env_wait_ms": 0.061801783743416536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003212571144104004, "StateBufferConnector_ms": 0.0019932985305786133, "ViewRequirementAgentConnector_ms": 0.04812419414520264}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.0844086039712, "num_env_steps_trained_throughput_per_sec": 789.0844086039712, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 5014.694, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5014.643, "sample_time_ms": 635.47, "learn_time_ms": 4368.443, "learn_throughput": 915.658, "synch_weights_time_ms": 10.317}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "training_iteration": 133, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-39", "timestamp": 1723345899, "time_this_iter_s": 5.071681022644043, "time_total_s": 678.2815616130829, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 678.2815616130829, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 36.42857142857143, "ram_util_percent": 81.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.559728454612196, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2503564578791457, "policy_loss": -0.006816252949647605, "vf_loss": 3.257171530276537, "vf_explained_var": 0.31185508631169795, "kl": 0.008926120240351162, "entropy": 0.7358347117279966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4288845161596933, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.41244727447629, "policy_loss": -0.005474330832172806, "vf_loss": 3.4166424249609313, "vf_explained_var": -0.09204879576961199, "kl": 0.011217380227284158, "entropy": 0.9141993798936406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38891, "policy_reward_min": {"prey_policy": -24.34351692161948, "predator_policy": -37.17081796599058}, "policy_reward_max": {"prey_policy": 37.17081796599058, "predator_policy": 24.34351692161948}, "policy_reward_mean": {"prey_policy": 4.500100953145569, "predator_policy": -4.500100953145569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-3.9698414514159728, -12.68600291138808, 37.17081796599058, -5.201064357633239, -18.98367848939977, 3.163043675453384, -4.8613967213319285, -21.69926212566676, 3.5922261946653506, 14.165370974940931, 7.294120354145008, 4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229], "policy_predator_policy_reward": [3.9698414514159728, 12.68600291138808, -37.17081796599058, 5.201064357633239, 18.98367848939977, -3.163043675453384, 4.8613967213319285, 21.69926212566676, -3.5922261946653506, -14.165370974940931, -7.294120354145008, -4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.282262489202816, "mean_inference_ms": 0.9282692056822323, "mean_action_processing_ms": 0.12600980558324026, "mean_env_wait_ms": 0.06178507810511325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003166794776916504, "StateBufferConnector_ms": 0.0019742250442504883, "ViewRequirementAgentConnector_ms": 0.04648780822753906}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 815.5442274289605, "num_env_steps_trained_throughput_per_sec": 815.5442274289605, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 5008.611, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5008.561, "sample_time_ms": 633.837, "learn_time_ms": 4364.013, "learn_throughput": 916.588, "synch_weights_time_ms": 10.303}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 134, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-44", "timestamp": 1723345904, "time_this_iter_s": 4.907374143600464, "time_total_s": 683.1889357566833, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 683.1889357566833, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 35.285714285714285, "ram_util_percent": 81.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.35405792320768, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.401696187009414, "policy_loss": -0.006688602019615549, "vf_loss": 3.408383404960235, "vf_explained_var": 0.23994669690728188, "kl": 0.01050115142262981, "entropy": 0.6438339726999402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7315941327561934, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.804682832459609, "policy_loss": -0.007874580903929503, "vf_loss": 3.810926128178835, "vf_explained_var": -0.050528296766181785, "kl": 0.014305168547794511, "entropy": 0.8308356452112396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.15, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38515, "policy_reward_min": {"prey_policy": -24.34351692161948, "predator_policy": -33.0293890985301}, "policy_reward_max": {"prey_policy": 33.0293890985301, "predator_policy": 24.34351692161948}, "policy_reward_mean": {"prey_policy": 5.298983101187654, "predator_policy": -5.298983101187654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 40, 400, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24], "policy_prey_policy_reward": [4.798668849680556, 18.91853230691692, -8.897532102042497, -2.6692741114867395, 3.621599052199212, 0.5236739188759785, -5.784091370114813, -19.15400267259259, -9.299301817511342, -9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312], "policy_predator_policy_reward": [-4.798668849680556, -18.91853230691692, 8.897532102042497, 2.6692741114867395, -3.621599052199212, -0.5236739188759785, 5.784091370114813, 19.15400267259259, 9.299301817511342, 9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821112784648885, "mean_inference_ms": 0.9275986431753465, "mean_action_processing_ms": 0.12599040731446964, "mean_env_wait_ms": 0.06177387817623444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030989646911621094, "StateBufferConnector_ms": 0.0019282102584838867, "ViewRequirementAgentConnector_ms": 0.04560267925262451}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.9000748107627, "num_env_steps_trained_throughput_per_sec": 811.9000748107627, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 4994.903, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4994.853, "sample_time_ms": 628.299, "learn_time_ms": 4355.862, "learn_throughput": 918.303, "synch_weights_time_ms": 10.285}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 135, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-49", "timestamp": 1723345909, "time_this_iter_s": 4.92926287651062, "time_total_s": 688.118198633194, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 688.118198633194, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 35.48571428571429, "ram_util_percent": 81.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.63528497920682, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.63002396201094, "policy_loss": -0.004637661265587667, "vf_loss": 3.634660866111517, "vf_explained_var": 0.2450403785953919, "kl": 0.005701487299570829, "entropy": 0.6770153471579154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.944239866298934, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4796001513799033, "policy_loss": -0.004886270199979966, "vf_loss": 3.4837985622386136, "vf_explained_var": -0.33599122166633605, "kl": 0.00603204602164169, "entropy": 0.9256423337385058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.39, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39239, "policy_reward_min": {"prey_policy": -24.34351692161948, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 24.34351692161948}, "policy_reward_mean": {"prey_policy": 6.523108885522771, "predator_policy": -6.523108885522771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-9.319814149238685, -2.4433668082526054, 12.730842181134062, 4.8956961153157135, 33.0293890985301, 8.663037490054013, 1.0476561354821143, -15.687500491210251, 22.928463808249926, -19.94249838601619, -11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705], "policy_predator_policy_reward": [9.319814149238685, 2.4433668082526054, -12.730842181134062, -4.8956961153157135, -33.0293890985301, -8.663037490054013, -1.0476561354821143, 15.687500491210251, -22.928463808249926, 19.94249838601619, 11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2819499098012743, "mean_inference_ms": 0.9274807000163662, "mean_action_processing_ms": 0.12595943169480622, "mean_env_wait_ms": 0.06174697966930792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030912160873413086, "StateBufferConnector_ms": 0.001917123794555664, "ViewRequirementAgentConnector_ms": 0.04591786861419678}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 828.4695140032359, "num_env_steps_trained_throughput_per_sec": 828.4695140032359, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 4977.925, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4977.875, "sample_time_ms": 626.73, "learn_time_ms": 4340.418, "learn_throughput": 921.57, "synch_weights_time_ms": 10.321}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 136, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-54", "timestamp": 1723345914, "time_this_iter_s": 4.830712080001831, "time_total_s": 692.9489107131958, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71bdd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 692.9489107131958, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 35.285714285714285, "ram_util_percent": 81.17142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.311062661123772, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.341577929755052, "policy_loss": -0.0026073741663518984, "vf_loss": 3.3441842570900917, "vf_explained_var": 0.34471942987293, "kl": 0.007980841026567627, "entropy": 0.6887622032314539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.54821271194766, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.604040383795897, "policy_loss": -0.0053711756319292665, "vf_loss": 3.608199106156826, "vf_explained_var": 0.09331963490694761, "kl": 0.010632298490581131, "entropy": 0.903435573168099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.63, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38863, "policy_reward_min": {"prey_policy": -24.34351692161948, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 24.34351692161948}, "policy_reward_mean": {"prey_policy": 6.5880598496569585, "predator_policy": -6.5880598496569585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-11.214345369139885, -9.820314712291374, 2.3799814762658524, -1.5230468648837991, 10.463693130384016, 14.967113091826821, 18.651343924651528, 27.863985485898677, 21.27246154138392, 9.139461235935862, -16.369305717906443, 13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062], "policy_predator_policy_reward": [11.214345369139885, 9.820314712291374, -2.3799814762658524, 1.5230468648837991, -10.463693130384016, -14.967113091826821, -18.651343924651528, -27.863985485898677, -21.27246154138392, -9.139461235935862, 16.369305717906443, -13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28192134891676074, "mean_inference_ms": 0.9270613305154367, "mean_action_processing_ms": 0.1259035575218671, "mean_env_wait_ms": 0.06174934922350579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031889677047729492, "StateBufferConnector_ms": 0.0019255876541137695, "ViewRequirementAgentConnector_ms": 0.046271443367004395}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.7865314606153, "num_env_steps_trained_throughput_per_sec": 813.7865314606153, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 4975.497, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4975.447, "sample_time_ms": 627.942, "learn_time_ms": 4336.844, "learn_throughput": 922.33, "synch_weights_time_ms": 10.257}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "training_iteration": 137, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-11-59", "timestamp": 1723345919, "time_this_iter_s": 4.917914152145386, "time_total_s": 697.8668248653412, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 697.8668248653412, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 81.17142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.1679068995639685, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.54432604064544, "policy_loss": -0.0058167251476940384, "vf_loss": 3.5501420542597772, "vf_explained_var": 0.48746242206543683, "kl": 0.005411782321294293, "entropy": 0.6526481237883369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7944343615323306, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.231349072357019, "policy_loss": -0.006006237889232579, "vf_loss": 4.236101634303728, "vf_explained_var": -0.1348053994278113, "kl": 0.010993884743259642, "entropy": 0.9047738694275419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.63, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38863, "policy_reward_min": {"prey_policy": -24.34351692161948, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 24.34351692161948}, "policy_reward_mean": {"prey_policy": 7.749966726643922, "predator_policy": -7.749966726643922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [13.594564235027953, 5.060143922201142, 14.548528982610655, 3.0264479278071086, -24.34351692161948, 7.114720365125738, 16.72083756836824, 9.990374117013475, 6.982985799749855, 1.2764184805468979, 2.47085056912198, 18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444], "policy_predator_policy_reward": [-13.594564235027953, -5.060143922201142, -14.548528982610655, -3.0264479278071086, 24.34351692161948, -7.114720365125738, -16.72083756836824, -9.990374117013475, -6.982985799749855, -1.2764184805468979, -2.47085056912198, -18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2818379755680642, "mean_inference_ms": 0.926698363224882, "mean_action_processing_ms": 0.12583085382542036, "mean_env_wait_ms": 0.061750995119098165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031957626342773438, "StateBufferConnector_ms": 0.0019495487213134766, "ViewRequirementAgentConnector_ms": 0.04684185981750488}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 809.5444823211359, "num_env_steps_trained_throughput_per_sec": 809.5444823211359, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 4965.253, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4965.202, "sample_time_ms": 624.376, "learn_time_ms": 4330.083, "learn_throughput": 923.77, "synch_weights_time_ms": 10.331}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 138, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-04", "timestamp": 1723345924, "time_this_iter_s": 4.944247007369995, "time_total_s": 702.8110718727112, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71f0ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 702.8110718727112, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 36.45714285714286, "ram_util_percent": 81.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.28826117174079, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4374081678688526, "policy_loss": -0.005056247925434339, "vf_loss": 3.442463198055824, "vf_explained_var": 0.3922621118525664, "kl": 0.00923474585800316, "entropy": 0.7315430438766877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.789230253423254, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.117743169516325, "policy_loss": -0.00564197647375598, "vf_loss": 4.122036402920882, "vf_explained_var": 0.07258894064774116, "kl": 0.011827490527392081, "entropy": 0.8811498173202078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.63, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38863, "policy_reward_min": {"prey_policy": -23.355339213889312, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 23.355339213889312}, "policy_reward_mean": {"prey_policy": 8.669660837963283, "predator_policy": -8.669660837963283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [18.49259009292358, 27.286438211200505, 6.757728491773882, 15.879502730568884, -4.862549021028677, 25.31438622456845, -13.25893721690553, -0.8428421090777896, -22.07604124946319, 14.265072521776641, 4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064], "policy_predator_policy_reward": [-18.49259009292358, -27.286438211200505, -6.757728491773882, -15.879502730568884, 4.862549021028677, -25.31438622456845, 13.25893721690553, 0.8428421090777896, 22.07604124946319, -14.265072521776641, -4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.281696741523811, "mean_inference_ms": 0.9263992621976053, "mean_action_processing_ms": 0.12582260503854362, "mean_env_wait_ms": 0.06172328793884302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031790733337402344, "StateBufferConnector_ms": 0.001978158950805664, "ViewRequirementAgentConnector_ms": 0.048209190368652344}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.1327378941462, "num_env_steps_trained_throughput_per_sec": 806.1327378941462, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 4967.972, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4967.921, "sample_time_ms": 632.961, "learn_time_ms": 4324.245, "learn_throughput": 925.017, "synch_weights_time_ms": 10.305}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "training_iteration": 139, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-09", "timestamp": 1723345929, "time_this_iter_s": 4.96456503868103, "time_total_s": 707.7756369113922, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71f00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 707.7756369113922, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 36.142857142857146, "ram_util_percent": 81.65714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.802557996225854, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.221183106054862, "policy_loss": -0.005181551585944059, "vf_loss": 3.2263637490570547, "vf_explained_var": 0.10142121079067389, "kl": 0.006967038758399724, "entropy": 0.6029625181108713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.591358210084339, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9129997668166956, "policy_loss": -0.004315587025727533, "vf_loss": 2.916318507492542, "vf_explained_var": 0.09388988011827072, "kl": 0.008741596756073023, "entropy": 0.9379497598856688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.24, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38524, "policy_reward_min": {"prey_policy": -24.16753909810891, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 24.16753909810891}, "policy_reward_mean": {"prey_policy": 8.902608203440769, "predator_policy": -8.902608203440769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [4.936902235749738, 5.999254341474128, -10.800819783541895, -11.007129798663136, 27.957329063796728, 31.718055629120045, 10.832734168894401, 11.832218065528853, 14.021517344652239, -13.848361476001529, -5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054], "policy_predator_policy_reward": [-4.936902235749738, -5.999254341474128, 10.800819783541895, 11.007129798663136, -27.957329063796728, -31.718055629120045, -10.832734168894401, -11.832218065528853, -14.021517344652239, 13.848361476001529, 5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28160997015703365, "mean_inference_ms": 0.9260119843750193, "mean_action_processing_ms": 0.12578929155949864, "mean_env_wait_ms": 0.061711557656347754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031200647354125977, "StateBufferConnector_ms": 0.001972198486328125, "ViewRequirementAgentConnector_ms": 0.048169851303100586}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.3158925341795, "num_env_steps_trained_throughput_per_sec": 798.3158925341795, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 4971.657, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4971.606, "sample_time_ms": 640.073, "learn_time_ms": 4320.765, "learn_throughput": 925.762, "synch_weights_time_ms": 10.359}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 140, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-14", "timestamp": 1723345934, "time_this_iter_s": 5.014147996902466, "time_total_s": 712.7897849082947, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 712.7897849082947, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 37.01428571428572, "ram_util_percent": 81.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.239473312472303, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6299074004093805, "policy_loss": -0.0030707636673469097, "vf_loss": 3.6329771051804225, "vf_explained_var": 0.4468967841938138, "kl": 0.008008043790556562, "entropy": 0.602624147074918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.866784836227695, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3153675136466823, "policy_loss": -0.00507783628515123, "vf_loss": 3.319173706074556, "vf_explained_var": 0.07463500003019968, "kl": 0.011151280605429293, "entropy": 0.9117592188840111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.24, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38524, "policy_reward_min": {"prey_policy": -24.16753909810891, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 24.16753909810891}, "policy_reward_mean": {"prey_policy": 8.970792644312255, "predator_policy": -8.970792644312255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-5.047551610099646, 3.666041769514486, -4.4820844191837494, -2.8358917329721045, 3.724833401270132, 0.4734441642292353, 8.887196485035215, 9.602786056569833, 24.60813243651118, -20.391801243449155, 17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473], "policy_predator_policy_reward": [5.047551610099646, -3.666041769514486, 4.4820844191837494, 2.8358917329721045, -3.724833401270132, -0.4734441642292353, -8.887196485035215, -9.602786056569833, -24.60813243651118, 20.391801243449155, -17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28151932392071616, "mean_inference_ms": 0.9256819811939181, "mean_action_processing_ms": 0.12578331192956027, "mean_env_wait_ms": 0.06168530562300458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031713247299194336, "StateBufferConnector_ms": 0.002001643180847168, "ViewRequirementAgentConnector_ms": 0.04830634593963623}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 822.1615479352675, "num_env_steps_trained_throughput_per_sec": 822.1615479352675, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 4939.778, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4939.745, "sample_time_ms": 642.779, "learn_time_ms": 4286.848, "learn_throughput": 933.086, "synch_weights_time_ms": 9.796}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 141, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-19", "timestamp": 1723345939, "time_this_iter_s": 4.86767578125, "time_total_s": 717.6574606895447, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71f0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 717.6574606895447, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 34.84285714285714, "ram_util_percent": 81.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.115824142470956, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.255200184136629, "policy_loss": -0.006146376524702646, "vf_loss": 3.2613458300630254, "vf_explained_var": 0.11846200438837211, "kl": 0.005561316203598906, "entropy": 0.6146465142567953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.006925098225475, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.001602981860439, "policy_loss": -0.008407620797030783, "vf_loss": 3.008183147137364, "vf_explained_var": 0.07310007611910502, "kl": 0.01602537087481678, "entropy": 0.8559282759204507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.24, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38524, "policy_reward_min": {"prey_policy": -24.16753909810891, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 24.16753909810891}, "policy_reward_mean": {"prey_policy": 10.749053688891804, "predator_policy": -10.749053688891804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [17.288434951225664, 20.672008847612627, 12.606035452773135, 9.94006870473599, 22.843857851007666, 23.695332339605304, -3.570153296264447, 0.03427640931758802, -10.131172827640114, 15.391703281042428, 4.4535566208948225, -5.685188087713584, 10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006], "policy_predator_policy_reward": [-17.288434951225664, -20.672008847612627, -12.606035452773135, -9.94006870473599, -22.843857851007666, -23.695332339605304, 3.570153296264447, -0.03427640931758802, 10.131172827640114, -15.391703281042428, -4.4535566208948225, 5.685188087713584, -10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28146973668317943, "mean_inference_ms": 0.9254476273971284, "mean_action_processing_ms": 0.12573971576558596, "mean_env_wait_ms": 0.061660339474359074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002953648567199707, "StateBufferConnector_ms": 0.00197601318359375, "ViewRequirementAgentConnector_ms": 0.04748892784118652}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.4671779111356, "num_env_steps_trained_throughput_per_sec": 805.4671779111356, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 4938.896, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4938.866, "sample_time_ms": 642.239, "learn_time_ms": 4286.496, "learn_throughput": 933.163, "synch_weights_time_ms": 9.808}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 142, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-24", "timestamp": 1723345944, "time_this_iter_s": 4.968705177307129, "time_total_s": 722.6261658668518, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 722.6261658668518, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 35.24285714285714, "ram_util_percent": 81.27142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.733535442749659, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.541426872462034, "policy_loss": -0.0056287316418699145, "vf_loss": 3.547054943193992, "vf_explained_var": 0.2607120372354984, "kl": 0.004854820085427048, "entropy": 0.5813527784620722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.653349270795782, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.009612722073992, "policy_loss": -0.007796133318576418, "vf_loss": 3.0162747291227183, "vf_explained_var": 0.2296809796243906, "kl": 0.009945433472380702, "entropy": 0.8223282122984529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.24, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38524, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -37.20641462024116}, "policy_reward_max": {"prey_policy": 37.20641462024116, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 11.2781772168343, "predator_policy": -11.2781772168343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.674776742541699, -1.5323773618156906, 3.941143246414832, 2.4105905970269106, 18.180134143337025, 13.79702150127229, 1.1390115673874277, 1.4426114878738758, 16.673465531952182, 20.727320781759666, -12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616], "policy_predator_policy_reward": [-10.674776742541699, 1.5323773618156906, -3.941143246414832, -2.4105905970269106, -18.180134143337025, -13.79702150127229, -1.1390115673874277, -1.4426114878738758, -16.673465531952182, -20.727320781759666, 12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2813793930024021, "mean_inference_ms": 0.9250652902967421, "mean_action_processing_ms": 0.12571184021442636, "mean_env_wait_ms": 0.061652226954019416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029157400131225586, "StateBufferConnector_ms": 0.002033233642578125, "ViewRequirementAgentConnector_ms": 0.04774284362792969}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 779.6912402954042, "num_env_steps_trained_throughput_per_sec": 779.6912402954042, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 4945.003, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4944.973, "sample_time_ms": 645.423, "learn_time_ms": 4289.464, "learn_throughput": 932.517, "synch_weights_time_ms": 9.753}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "training_iteration": 143, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-29", "timestamp": 1723345949, "time_this_iter_s": 5.132816791534424, "time_total_s": 727.7589826583862, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 727.7589826583862, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 38.357142857142854, "ram_util_percent": 81.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.988954884062211, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6614167295396327, "policy_loss": -0.007962864398238404, "vf_loss": 3.6693790959815185, "vf_explained_var": 0.44026597297439973, "kl": 0.007765508381994264, "entropy": 0.5992316003267963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9135284668455523, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7052876077592374, "policy_loss": -0.005014354743373891, "vf_loss": 3.70856675679485, "vf_explained_var": 0.08752979468554259, "kl": 0.015216183284812057, "entropy": 0.8733165338014562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.24, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38524, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 11.339952558644095, "predator_policy": -11.339952558644095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-12.62248348256339, 4.0221914510802605, 6.856237895977507, 17.015124110895208, 20.702262010766063, 25.272145771328418, -23.355339213889312, -5.114328801556187, -10.329873180183274, 12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346], "policy_predator_policy_reward": [12.62248348256339, -4.0221914510802605, -6.856237895977507, -17.015124110895208, -20.702262010766063, -25.272145771328418, 23.355339213889312, 5.114328801556187, 10.329873180183274, -12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2813420210055211, "mean_inference_ms": 0.9245638854534303, "mean_action_processing_ms": 0.12573286871877448, "mean_env_wait_ms": 0.06165199598846544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029486417770385742, "StateBufferConnector_ms": 0.0020629167556762695, "ViewRequirementAgentConnector_ms": 0.04841470718383789}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.2168171782545, "num_env_steps_trained_throughput_per_sec": 775.2168171782545, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 4970.518, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4970.487, "sample_time_ms": 651.442, "learn_time_ms": 4308.242, "learn_throughput": 928.453, "synch_weights_time_ms": 10.457}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 144, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-34", "timestamp": 1723345954, "time_this_iter_s": 5.163205146789551, "time_total_s": 732.9221878051758, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71394c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 732.9221878051758, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 39.45714285714286, "ram_util_percent": 81.22857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.821409615067144, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.126305728778243, "policy_loss": -0.00612509619386401, "vf_loss": 3.1324302181601524, "vf_explained_var": 0.2743725179384152, "kl": 0.00930910418542353, "entropy": 0.5433921477136513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4609307121485475, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6425406244893868, "policy_loss": -0.009460622534000625, "vf_loss": 3.6495735056698324, "vf_explained_var": -0.14230873460570972, "kl": 0.021289380979301362, "entropy": 0.891794930708905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38900, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 12.09957109877868, "predator_policy": -12.09957109877868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.152063757101658, 26.60216755065039, 23.793065866258154, 37.20641462024116, 5.842493933906667, 29.913779364216367, -15.594932623198705, -9.198114249899703, -19.276386226449674, 18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206], "policy_predator_policy_reward": [-12.152063757101658, -26.60216755065039, -23.793065866258154, -37.20641462024116, -5.842493933906667, -29.913779364216367, 15.594932623198705, 9.198114249899703, 19.276386226449674, -18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2813537414785795, "mean_inference_ms": 0.9247232547662295, "mean_action_processing_ms": 0.1257046699501381, "mean_env_wait_ms": 0.06164812179925503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002972841262817383, "StateBufferConnector_ms": 0.002094268798828125, "ViewRequirementAgentConnector_ms": 0.049888014793395996}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 761.8693327133225, "num_env_steps_trained_throughput_per_sec": 761.8693327133225, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 5002.871, "restore_workers_time_ms": 0.011, "training_step_time_ms": 5002.839, "sample_time_ms": 663.157, "learn_time_ms": 4328.842, "learn_throughput": 924.035, "synch_weights_time_ms": 10.488}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 145, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-39", "timestamp": 1723345959, "time_this_iter_s": 5.255872964859009, "time_total_s": 738.1780607700348, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b48fa9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 738.1780607700348, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 36.4375, "ram_util_percent": 81.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4662604781488575, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.315694023172061, "policy_loss": -0.0057281546032754704, "vf_loss": 3.3214217548569045, "vf_explained_var": 0.2178828134511908, "kl": 0.006750781721047269, "entropy": 0.6112413025150697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.85571788897117, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.172643931210041, "policy_loss": -0.004940630652708933, "vf_loss": 3.1767168069879212, "vf_explained_var": -0.028481775025526682, "kl": 0.005073037665549572, "entropy": 0.7639733242491881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.76, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39276, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 12.295681898645661, "predator_policy": -12.295681898645661}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [18.05117254042475, 25.40434336953171, -13.682095417675256, -18.70687000377897, 10.800614581458941, 15.616169391763375, 31.987779114371747, 1.4003883077202062, 8.152018822517043, 32.13340059105143, 1.781981451853202, 2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836], "policy_predator_policy_reward": [-18.05117254042475, -25.40434336953171, 13.682095417675256, 18.70687000377897, -10.800614581458941, -15.616169391763375, -31.987779114371747, -1.4003883077202062, -8.152018822517043, -32.13340059105143, -1.781981451853202, -2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2812644239663239, "mean_inference_ms": 0.9247145088661749, "mean_action_processing_ms": 0.12572113930716003, "mean_env_wait_ms": 0.06163460880735934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002969503402709961, "StateBufferConnector_ms": 0.0020869970321655273, "ViewRequirementAgentConnector_ms": 0.04972672462463379}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 807.655456509611, "num_env_steps_trained_throughput_per_sec": 807.655456509611, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 5015.314, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5015.281, "sample_time_ms": 667.587, "learn_time_ms": 4336.963, "learn_throughput": 922.304, "synch_weights_time_ms": 10.38}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 146, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-44", "timestamp": 1723345964, "time_this_iter_s": 4.955215215682983, "time_total_s": 743.1332759857178, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 743.1332759857178, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 36.78571428571428, "ram_util_percent": 81.47142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.550036896578968, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9656517737855514, "policy_loss": -0.004683639786283796, "vf_loss": 2.970335025091966, "vf_explained_var": 0.3216938544685642, "kl": 0.005741300614722237, "entropy": 0.6072782245775064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.536153929432233, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.38933058877786, "policy_loss": -0.003681127494201064, "vf_loss": 3.3918000780045987, "vf_explained_var": -0.060966520383954045, "kl": 0.007083531115575176, "entropy": 0.7524963271493713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.76, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39276, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 12.464332465392088, "predator_policy": -12.464332465392088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [2.6282763607542456, 21.432014138970285, 23.75091658180548, 16.37839158258957, 27.082333018764082, 22.425725116330646, 4.412994096992001, 21.823663159193444, 0.4602691875867695, 35.81796880988032, 6.7549983342764826, 29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724], "policy_predator_policy_reward": [-2.6282763607542456, -21.432014138970285, -23.75091658180548, -16.37839158258957, -27.082333018764082, -22.425725116330646, -4.412994096992001, -21.823663159193444, -0.4602691875867695, -35.81796880988032, -6.7549983342764826, -29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2813549863388804, "mean_inference_ms": 0.9246300899257007, "mean_action_processing_ms": 0.12570756322346582, "mean_env_wait_ms": 0.06165538075362846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030095577239990234, "StateBufferConnector_ms": 0.00206601619720459, "ViewRequirementAgentConnector_ms": 0.048958778381347656}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 808.5515575947373, "num_env_steps_trained_throughput_per_sec": 808.5515575947373, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 5018.497, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5018.463, "sample_time_ms": 666.66, "learn_time_ms": 4341.08, "learn_throughput": 921.43, "synch_weights_time_ms": 10.37}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 147, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-49", "timestamp": 1723345969, "time_this_iter_s": 4.9496519565582275, "time_total_s": 748.082927942276, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71394c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 748.082927942276, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 35.44285714285714, "ram_util_percent": 81.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.611837022813658, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3933088526129724, "policy_loss": -0.00808441963987813, "vf_loss": 3.401392632226149, "vf_explained_var": 0.257433951087296, "kl": 0.009720871367992363, "entropy": 0.7109647226830323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.688689711689949, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3176448789735633, "policy_loss": -0.005728511450676403, "vf_loss": 3.3224596326549847, "vf_explained_var": -0.09881222993135452, "kl": 0.005341960310413081, "entropy": 0.74174791375796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.76, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39276, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 11.889008261900685, "predator_policy": -11.889008261900685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [29.425724388342864, 30.27217431002031, 2.254246440514363, 18.329364571846586, 11.240064033902293, -17.074339265824698, 18.088760216927422, 12.842535150417064, 16.692614165208763, 1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105], "policy_predator_policy_reward": [-29.425724388342864, -30.27217431002031, -2.254246440514363, -18.329364571846586, -11.240064033902293, 17.074339265824698, -18.088760216927422, -12.842535150417064, -16.692614165208763, -1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28125589290305125, "mean_inference_ms": 0.924603731207528, "mean_action_processing_ms": 0.12573023739354422, "mean_env_wait_ms": 0.061630196891525955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00307309627532959, "StateBufferConnector_ms": 0.0020679235458374023, "ViewRequirementAgentConnector_ms": 0.04882705211639404}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 818.81050527625, "num_env_steps_trained_throughput_per_sec": 818.81050527625, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 5012.905, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5012.872, "sample_time_ms": 663.08, "learn_time_ms": 4339.15, "learn_throughput": 921.84, "synch_weights_time_ms": 10.3}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 148, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-54", "timestamp": 1723345974, "time_this_iter_s": 4.887622833251953, "time_total_s": 752.970550775528, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71feaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 752.970550775528, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 35.128571428571426, "ram_util_percent": 81.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.646300007464985, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.688350119938453, "policy_loss": -0.005306574161416696, "vf_loss": 3.693656205634276, "vf_explained_var": 0.2391562769189477, "kl": 0.007460286137054161, "entropy": 0.648548244095097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.862215573899448, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7685743302106856, "policy_loss": -0.001261884341511177, "vf_loss": 3.7694114898641904, "vf_explained_var": 0.01399803248544534, "kl": 0.0024829616675398625, "entropy": 0.7396133067707221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.76, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39276, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 11.672668411829955, "predator_policy": -11.672668411829955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 61, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.57230378292342, -23.78993654406631, 20.27686190709943, 23.226264222954065, 34.049677721951284, 29.66090690386852, 11.23383881040396, -24.16753909810891, 1.4950933518511054, 5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003], "policy_predator_policy_reward": [-1.57230378292342, 23.78993654406631, -20.27686190709943, -23.226264222954065, -34.049677721951284, -29.66090690386852, -11.23383881040396, 24.16753909810891, -1.4950933518511054, -5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28119392098749907, "mean_inference_ms": 0.924366499613621, "mean_action_processing_ms": 0.12572877488812653, "mean_env_wait_ms": 0.061620631689044816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030750036239624023, "StateBufferConnector_ms": 0.002063155174255371, "ViewRequirementAgentConnector_ms": 0.04817676544189453}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 825.8067767951333, "num_env_steps_trained_throughput_per_sec": 825.8067767951333, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1192000, "timers": {"training_iteration_time_ms": 5001.084, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5001.05, "sample_time_ms": 655.759, "learn_time_ms": 4334.641, "learn_throughput": 922.799, "synch_weights_time_ms": 10.311}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "done": false, "training_iteration": 149, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-12-59", "timestamp": 1723345979, "time_this_iter_s": 4.846384048461914, "time_total_s": 757.8169348239899, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 757.8169348239899, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 35.25714285714285, "ram_util_percent": 81.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.724815680272878, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.096166421845555, "policy_loss": -0.006914511487654333, "vf_loss": 3.103080324952801, "vf_explained_var": 0.377848153313001, "kl": 0.009140460341585591, "entropy": 0.7348194998378555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6441132995610435, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9146496719370285, "policy_loss": -0.002482002441926549, "vf_loss": 2.916915542632341, "vf_explained_var": -0.057527368019024534, "kl": 0.0025270644589858956, "entropy": 0.7430996434763074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.15, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39615, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 11.42888390890617, "predator_policy": -11.42888390890617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.524868729891132, -12.850435735580401, 17.381206474844106, -6.928927785020037, 1.1285787620718182, 28.133033720473804, 15.897903682102566, -10.639343541263273, 30.16487921489881, 10.648380355739473, 32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311], "policy_predator_policy_reward": [-5.524868729891132, 12.850435735580401, -17.381206474844106, 6.928927785020037, -1.1285787620718182, -28.133033720473804, -15.897903682102566, 10.639343541263273, -30.16487921489881, -10.648380355739473, -32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28122172443498217, "mean_inference_ms": 0.9241578002065843, "mean_action_processing_ms": 0.12571479905104838, "mean_env_wait_ms": 0.06162789186571867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031003952026367188, "StateBufferConnector_ms": 0.0020655393600463867, "ViewRequirementAgentConnector_ms": 0.04790699481964111}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.5109447743396, "num_env_steps_trained_throughput_per_sec": 813.5109447743396, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 4991.725, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4991.692, "sample_time_ms": 646.202, "learn_time_ms": 4334.878, "learn_throughput": 922.748, "synch_weights_time_ms": 10.27}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 150, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-04", "timestamp": 1723345984, "time_this_iter_s": 4.919547080993652, "time_total_s": 762.7364819049835, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 762.7364819049835, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 35.357142857142854, "ram_util_percent": 81.38571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.563589230241875, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.291817419230938, "policy_loss": -0.006140442766384997, "vf_loss": 2.2979569050172963, "vf_explained_var": 0.39171928223222496, "kl": 0.01459522407609152, "entropy": 0.6612711283067862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1996985965097946, "cur_kl_coeff": 0.04276307523250579, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.526480491211017, "policy_loss": -0.006030865702632582, "vf_loss": 2.53186549457411, "vf_explained_var": -0.030239799184103806, "kl": 0.015103068287626146, "entropy": 0.7165858398502072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 12.022775700318478, "predator_policy": -12.022775700318478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [32.01108289372015, 30.5258032944825, 9.34248056192898, 29.691794457250595, 9.863828644516808, 15.484720509947998, 33.60894524694805, -8.34616774082054, 21.907694584716193, 21.94102731269006, 18.308394691219412, 22.812242538516426, -28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506], "policy_predator_policy_reward": [-32.01108289372015, -30.5258032944825, -9.34248056192898, -29.691794457250595, -9.863828644516808, -15.484720509947998, -33.60894524694805, 8.34616774082054, -21.907694584716193, -21.94102731269006, -18.308394691219412, -22.812242538516426, 28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2811584186526964, "mean_inference_ms": 0.9239645014123637, "mean_action_processing_ms": 0.12569823355958765, "mean_env_wait_ms": 0.06162068425114973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029668807983398438, "StateBufferConnector_ms": 0.0020400285720825195, "ViewRequirementAgentConnector_ms": 0.047451019287109375}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 824.8315697625369, "num_env_steps_trained_throughput_per_sec": 824.8315697625369, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1208000, "timers": {"training_iteration_time_ms": 4990.15, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4990.117, "sample_time_ms": 646.529, "learn_time_ms": 4332.98, "learn_throughput": 923.152, "synch_weights_time_ms": 10.262}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "done": false, "training_iteration": 151, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-09", "timestamp": 1723345989, "time_this_iter_s": 4.852050304412842, "time_total_s": 767.5885322093964, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fe700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 767.5885322093964, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 35.91428571428572, "ram_util_percent": 81.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.239436922594905, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9351251748700937, "policy_loss": -0.00684070797918442, "vf_loss": 2.9419653568416835, "vf_explained_var": 0.3970390985409419, "kl": 0.007879834215521471, "entropy": 0.713214075875779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2124310565491516, "cur_kl_coeff": 0.04276307523250579, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.028929411123196, "policy_loss": -0.005091410980094224, "vf_loss": 3.033694756527742, "vf_explained_var": -0.09267385272930066, "kl": 0.007625045789321781, "entropy": 0.7191907094791532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -28.102039393413108, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 28.102039393413108}, "policy_reward_mean": {"prey_policy": 10.981571856688157, "predator_policy": -10.981571856688157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-28.102039393413108, -3.021162655222721, 32.26515317238949, -5.205015618018308, 21.512756099106518, 13.78227629402511, 20.946151370671053, 15.915092998006365, 29.81795786785245, 21.419305675713616, 21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274], "policy_predator_policy_reward": [28.102039393413108, 3.021162655222721, -32.26515317238949, 5.205015618018308, -21.512756099106518, -13.78227629402511, -20.946151370671053, -15.915092998006365, -29.81795786785245, -21.419305675713616, -21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.281033810576244, "mean_inference_ms": 0.9238391012636419, "mean_action_processing_ms": 0.12573822225021128, "mean_env_wait_ms": 0.061600745459154164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002993345260620117, "StateBufferConnector_ms": 0.0020477771759033203, "ViewRequirementAgentConnector_ms": 0.047472476959228516}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.2413394087404, "num_env_steps_trained_throughput_per_sec": 813.2413394087404, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 4985.402, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4985.369, "sample_time_ms": 643.596, "learn_time_ms": 4331.221, "learn_throughput": 923.527, "synch_weights_time_ms": 10.204}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 152, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-14", "timestamp": 1723345994, "time_this_iter_s": 4.921303033828735, "time_total_s": 772.5098352432251, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 772.5098352432251, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 35.41428571428572, "ram_util_percent": 81.65714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4025682739913465, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4454704826076825, "policy_loss": -0.003089420033453886, "vf_loss": 3.448559316744407, "vf_explained_var": 0.30800531692802907, "kl": 0.009130355417335024, "entropy": 0.7499051547298828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5651295773684977, "cur_kl_coeff": 0.04276307523250579, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3547232800473767, "policy_loss": -0.0073807188656549744, "vf_loss": 3.3611154834429424, "vf_explained_var": -0.18649656710525353, "kl": 0.023116052129733746, "entropy": 0.7049481576929489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.52842792413422, "predator_policy": -47.86137965877223}, "policy_reward_max": {"prey_policy": 47.86137965877223, "predator_policy": 23.52842792413422}, "policy_reward_mean": {"prey_policy": 11.17894864341475, "predator_policy": -11.17894864341475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [21.43885712365555, -16.89607103406453, -3.049418652017664, 9.019763793212412, -5.334585908232079, 26.314449943051354, -13.984221575627657, 10.16473143648992, 47.86137965877223, 18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855], "policy_predator_policy_reward": [-21.43885712365555, 16.89607103406453, 3.049418652017664, -9.019763793212412, 5.334585908232079, -26.314449943051354, 13.984221575627657, -10.16473143648992, -47.86137965877223, -18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28102705264436123, "mean_inference_ms": 0.92316844360279, "mean_action_processing_ms": 0.12570077295031074, "mean_env_wait_ms": 0.06159764496203647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029991865158081055, "StateBufferConnector_ms": 0.0019763708114624023, "ViewRequirementAgentConnector_ms": 0.046668291091918945}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 815.8739591382591, "num_env_steps_trained_throughput_per_sec": 815.8739591382591, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 4962.651, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4962.617, "sample_time_ms": 637.994, "learn_time_ms": 4313.793, "learn_throughput": 927.258, "synch_weights_time_ms": 10.488}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 153, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-19", "timestamp": 1723345999, "time_this_iter_s": 4.905776262283325, "time_total_s": 777.4156115055084, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 777.4156115055084, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 37.10000000000001, "ram_util_percent": 81.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.740735403199991, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6777040059367816, "policy_loss": -0.0021340014776797035, "vf_loss": 3.6798375098655622, "vf_explained_var": 0.3961362181852261, "kl": 0.007316946259176286, "entropy": 0.769369981251657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3972326082487903, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.503895489498973, "policy_loss": -0.004621775587050555, "vf_loss": 3.5073089630653462, "vf_explained_var": 0.010188513435423374, "kl": 0.018837256513347698, "entropy": 0.6979893264050285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.52842792413422, "predator_policy": -36.24533403411518}, "policy_reward_max": {"prey_policy": 36.24533403411518, "predator_policy": 23.52842792413422}, "policy_reward_mean": {"prey_policy": 11.212476771806513, "predator_policy": -11.212476771806513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [18.096347633490346, 3.7308747046950046, 7.298038780007715, 12.772323060971488, 18.711443665250144, 17.945951433692606, 1.4301578672939357, -7.569162285386071, 28.48929730808249, 15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082], "policy_predator_policy_reward": [-18.096347633490346, -3.7308747046950046, -7.298038780007715, -12.772323060971488, -18.711443665250144, -17.945951433692606, -1.4301578672939357, 7.569162285386071, -28.48929730808249, -15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28093027037817014, "mean_inference_ms": 0.9233418102363548, "mean_action_processing_ms": 0.12566281612893304, "mean_env_wait_ms": 0.061575321919759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029821395874023438, "StateBufferConnector_ms": 0.0019432306289672852, "ViewRequirementAgentConnector_ms": 0.04585075378417969}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 822.379573211231, "num_env_steps_trained_throughput_per_sec": 822.379573211231, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 4933.059, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4933.026, "sample_time_ms": 628.764, "learn_time_ms": 4294.09, "learn_throughput": 931.513, "synch_weights_time_ms": 9.843}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 154, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-24", "timestamp": 1723346004, "time_this_iter_s": 4.866705894470215, "time_total_s": 782.2823173999786, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 782.2823173999786, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 37.86666666666667, "ram_util_percent": 81.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.507909431308508, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.819110472748677, "policy_loss": -0.0026246261848427823, "vf_loss": 2.8217344980686905, "vf_explained_var": 0.2744231772919496, "kl": 0.009251808097985759, "entropy": 0.8032329954206944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.419288823629419, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0806849993765355, "policy_loss": -0.007630864443005218, "vf_loss": 3.0873674415051937, "vf_explained_var": -0.07312515440086524, "kl": 0.014785647857544089, "entropy": 0.7392759618659814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.52842792413422, "predator_policy": -36.24533403411518}, "policy_reward_max": {"prey_policy": 36.24533403411518, "predator_policy": 23.52842792413422}, "policy_reward_mean": {"prey_policy": 11.074491928677705, "predator_policy": -11.074491928677705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [15.598866040706206, 25.793132904294396, -4.111676245885178, 4.47961364217087, 13.702700886910822, 28.0102323127998, 8.000217347838884, -5.325806759685307, 22.039313198021713, 18.46390469305836, 24.116788685853578, 7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712], "policy_predator_policy_reward": [-15.598866040706206, -25.793132904294396, 4.111676245885178, -4.47961364217087, -13.702700886910822, -28.0102323127998, -8.000217347838884, 5.325806759685307, -22.039313198021713, -18.46390469305836, -24.116788685853578, -7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2808301299338507, "mean_inference_ms": 0.9229717855017546, "mean_action_processing_ms": 0.125624201000187, "mean_env_wait_ms": 0.06155131790988578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029562711715698242, "StateBufferConnector_ms": 0.001909494400024414, "ViewRequirementAgentConnector_ms": 0.04443097114562988}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.4416097654857, "num_env_steps_trained_throughput_per_sec": 798.4416097654857, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 4909.01, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4908.978, "sample_time_ms": 617.529, "learn_time_ms": 4281.314, "learn_throughput": 934.293, "synch_weights_time_ms": 9.805}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 155, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-29", "timestamp": 1723346009, "time_this_iter_s": 5.015737771987915, "time_total_s": 787.2980551719666, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 787.2980551719666, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 36.1, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.493759641672174, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.843193245927493, "policy_loss": -0.004518297600831526, "vf_loss": 2.8477108942965668, "vf_explained_var": 0.44796230308711527, "kl": 0.00981004766184507, "entropy": 0.8231125464042027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5800453833614787, "cur_kl_coeff": 0.0641446128487587, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7850445794562497, "policy_loss": -0.0029030753027958173, "vf_loss": 2.787847267339627, "vf_explained_var": 0.10008237964163223, "kl": 0.0015649764269932698, "entropy": 0.7263258616129558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.52842792413422, "predator_policy": -36.24533403411518}, "policy_reward_max": {"prey_policy": 36.24533403411518, "predator_policy": 23.52842792413422}, "policy_reward_mean": {"prey_policy": 10.933401164318969, "predator_policy": -10.933401164318969}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [7.962369795761717, 19.130727119170896, 18.119125401443913, 14.32855579374641, -6.888236471323253, 14.836328868204642, 14.186777705675986, 25.418194613687863, -1.204285662593918, -0.20238642574634724, -1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739], "policy_predator_policy_reward": [-7.962369795761717, -19.130727119170896, -18.119125401443913, -14.32855579374641, 6.888236471323253, -14.836328868204642, -14.186777705675986, -25.418194613687863, 1.204285662593918, 0.20238642574634724, 1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2807509213347531, "mean_inference_ms": 0.9225219114231349, "mean_action_processing_ms": 0.12557441745172848, "mean_env_wait_ms": 0.0615297494630437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029562711715698242, "StateBufferConnector_ms": 0.0019016265869140625, "ViewRequirementAgentConnector_ms": 0.045694828033447266}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.1924945127354, "num_env_steps_trained_throughput_per_sec": 801.1924945127354, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 4913.005, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4912.973, "sample_time_ms": 618.224, "learn_time_ms": 4284.347, "learn_throughput": 933.631, "synch_weights_time_ms": 10.067}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 156, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-34", "timestamp": 1723346014, "time_this_iter_s": 4.99651312828064, "time_total_s": 792.2945683002472, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71f0310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 792.2945683002472, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 38.228571428571435, "ram_util_percent": 81.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.715363392482201, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.587418278803428, "policy_loss": -0.010183330610501192, "vf_loss": 3.597600556910038, "vf_explained_var": 0.0557374058291316, "kl": 0.01576453629013599, "entropy": 0.931689898048838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2965205726524194, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7692154922833043, "policy_loss": -0.0035234454428670387, "vf_loss": 2.7723558356364566, "vf_explained_var": 0.05746024151643117, "kl": 0.011945162702381853, "entropy": 0.7225868686412772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.52842792413422, "predator_policy": -36.24533403411518}, "policy_reward_max": {"prey_policy": 36.24533403411518, "predator_policy": 23.52842792413422}, "policy_reward_mean": {"prey_policy": 10.59552102198587, "predator_policy": -10.59552102198587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1.5965935268130806, 9.656910496013985, 16.057417737808706, -6.348993692866429, 15.256506826874801, 8.116012934990959, 6.42010087036148, 13.777464417216153, 36.24533403411518, 18.847609728825713, 9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017], "policy_predator_policy_reward": [1.5965935268130806, -9.656910496013985, -16.057417737808706, 6.348993692866429, -15.256506826874801, -8.116012934990959, -6.42010087036148, -13.777464417216153, -36.24533403411518, -18.847609728825713, -9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2806252485066528, "mean_inference_ms": 0.9220896076246801, "mean_action_processing_ms": 0.1255391884735637, "mean_env_wait_ms": 0.061497592574064674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00280606746673584, "StateBufferConnector_ms": 0.0019358396530151367, "ViewRequirementAgentConnector_ms": 0.047660231590270996}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.7755766047733, "num_env_steps_trained_throughput_per_sec": 789.7755766047733, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1256000, "timers": {"training_iteration_time_ms": 4924.767, "restore_workers_time_ms": 0.011, "training_step_time_ms": 4924.734, "sample_time_ms": 622.964, "learn_time_ms": 4291.338, "learn_throughput": 932.11, "synch_weights_time_ms": 10.097}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "done": false, "training_iteration": 157, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-39", "timestamp": 1723346019, "time_this_iter_s": 5.068289041519165, "time_total_s": 797.3628573417664, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c7b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 797.3628573417664, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 39.4, "ram_util_percent": 82.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.427103478896121, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2945510746290285, "policy_loss": -0.0025524848630690635, "vf_loss": 2.2971025973558428, "vf_explained_var": 0.2875898633152246, "kl": 0.014435297179457796, "entropy": 0.8492672573775053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.592971616735061, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2584642872214316, "policy_loss": -0.006542272699880414, "vf_loss": 2.2645618340621394, "vf_explained_var": 0.047358197097977, "kl": 0.013866499979543888, "entropy": 0.7282519242415826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.52842792413422, "predator_policy": -35.608023412363714}, "policy_reward_max": {"prey_policy": 35.608023412363714, "predator_policy": 23.52842792413422}, "policy_reward_mean": {"prey_policy": 10.307136384182359, "predator_policy": -10.307136384182359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.003360211475105, 4.115938520775863, 9.871194463020291, 19.861804827293426, 4.888066636727956, 13.29266263819601, 1.8694872374363527, 22.43550880321916, 11.756527672565138, 12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978], "policy_predator_policy_reward": [-9.003360211475105, -4.115938520775863, -9.871194463020291, -19.861804827293426, -4.888066636727956, -13.29266263819601, -1.8694872374363527, -22.43550880321916, -11.756527672565138, -12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28050411658112884, "mean_inference_ms": 0.9219214862624178, "mean_action_processing_ms": 0.12551163264269602, "mean_env_wait_ms": 0.06147933282943344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027266740798950195, "StateBufferConnector_ms": 0.0019189119338989258, "ViewRequirementAgentConnector_ms": 0.047539710998535156}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.6311918166257, "num_env_steps_trained_throughput_per_sec": 802.6311918166257, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 4934.615, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4934.582, "sample_time_ms": 634.993, "learn_time_ms": 4289.148, "learn_throughput": 932.586, "synch_weights_time_ms": 10.103}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 158, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-44", "timestamp": 1723346024, "time_this_iter_s": 4.9860382080078125, "time_total_s": 802.3488955497742, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fa940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 802.3488955497742, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 36.714285714285715, "ram_util_percent": 82.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.989312530619403, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7349464328338704, "policy_loss": -0.004616860202319609, "vf_loss": 2.739562573283911, "vf_explained_var": 0.32293126471340655, "kl": 0.010935768097980041, "entropy": 0.8750465681155523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8851360170791547, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.670157582933704, "policy_loss": -0.0028186441011105972, "vf_loss": 2.67272638057669, "vf_explained_var": 0.17047730578730505, "kl": 0.007790312237713764, "entropy": 0.7562081422656775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.52842792413422, "predator_policy": -35.608023412363714}, "policy_reward_max": {"prey_policy": 35.608023412363714, "predator_policy": 23.52842792413422}, "policy_reward_mean": {"prey_policy": 10.364845261098814, "predator_policy": -10.364845261098814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.345968205048003, 5.14893100286012, 7.22744107175971, 7.462733940747292, 9.763761079051704, -23.52842792413422, 21.250681141932322, -0.6988309620758706, 1.4378910901134674, 21.11484032624311, 35.608023412363714, 21.602136901112566, 6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806], "policy_predator_policy_reward": [-12.345968205048003, -5.14893100286012, -7.22744107175971, -7.462733940747292, -9.763761079051704, 23.52842792413422, -21.250681141932322, 0.6988309620758706, -1.4378910901134674, -21.11484032624311, -35.608023412363714, -21.602136901112566, -6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2804191252351197, "mean_inference_ms": 0.9216877824869486, "mean_action_processing_ms": 0.12548416515087793, "mean_env_wait_ms": 0.061463248885966444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002689838409423828, "StateBufferConnector_ms": 0.0018889904022216797, "ViewRequirementAgentConnector_ms": 0.04672539234161377}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 820.9199636093023, "num_env_steps_trained_throughput_per_sec": 820.9199636093023, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 4937.498, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4937.465, "sample_time_ms": 635.944, "learn_time_ms": 4291.1, "learn_throughput": 932.162, "synch_weights_time_ms": 10.082}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 159, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-49", "timestamp": 1723346029, "time_this_iter_s": 4.875831127166748, "time_total_s": 807.2247266769409, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71faee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 807.2247266769409, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 34.81428571428572, "ram_util_percent": 81.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.599915508367121, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1353770500669875, "policy_loss": -0.0037208993257081603, "vf_loss": 2.1390971022968492, "vf_explained_var": 0.4111640972395738, "kl": 0.013024218712384869, "entropy": 0.8709383094062407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6335745959232253, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3472217402110496, "policy_loss": -0.0002104257148554704, "vf_loss": 2.3472114119678738, "vf_explained_var": 0.006391609832644462, "kl": 0.0068832513129444195, "entropy": 0.750036500642697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -16.91127976714955, "predator_policy": -31.16721108984949}, "policy_reward_max": {"prey_policy": 31.16721108984949, "predator_policy": 16.91127976714955}, "policy_reward_mean": {"prey_policy": 9.5154181425432, "predator_policy": -9.5154181425432}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400], "policy_prey_policy_reward": [6.506946816826606, 10.65105102449742, 30.638964509125056, 6.7674312881662715, 21.394649629450054, 2.2371558552637296, 6.36491082612128, -3.9219472435378506, 3.9020246947248296, 14.651290935084837, 4.009158539481781, 17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607], "policy_predator_policy_reward": [-6.506946816826606, -10.65105102449742, -30.638964509125056, -6.7674312881662715, -21.394649629450054, -2.2371558552637296, -6.36491082612128, 3.9219472435378506, -3.9020246947248296, -14.651290935084837, -4.009158539481781, -17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.280378324853287, "mean_inference_ms": 0.9212714861856145, "mean_action_processing_ms": 0.12545320141720234, "mean_env_wait_ms": 0.06145596469390666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026885271072387695, "StateBufferConnector_ms": 0.001899123191833496, "ViewRequirementAgentConnector_ms": 0.046706557273864746}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 828.1383135575509, "num_env_steps_trained_throughput_per_sec": 828.1383135575509, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 4928.813, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4928.78, "sample_time_ms": 637.322, "learn_time_ms": 4280.988, "learn_throughput": 934.364, "synch_weights_time_ms": 10.134}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 160, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-54", "timestamp": 1723346034, "time_this_iter_s": 4.832914352416992, "time_total_s": 812.0576410293579, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71f0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 812.0576410293579, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 35.18571428571429, "ram_util_percent": 81.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.374604124762118, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5387323651462794, "policy_loss": -0.003587280336554007, "vf_loss": 2.542318808287382, "vf_explained_var": 0.22445310857146977, "kl": 0.012773952558965955, "entropy": 0.8275053463255365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.35711057279259, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4675700755789878, "policy_loss": -0.005356619557035932, "vf_loss": 2.472477780220409, "vf_explained_var": 0.025428208336234093, "kl": 0.013996836781780118, "entropy": 0.7239716298257312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -16.91127976714955, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 16.91127976714955}, "policy_reward_mean": {"prey_policy": 9.586981835792955, "predator_policy": -9.586981835792955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [17.802508591136522, 19.169470534615137, 13.996637897144577, 13.583275413564163, 18.14252755580521, 28.460221168230813, -12.6801819822413, 5.67942996565292, 6.315099318885274, 22.57736487100261, 10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755], "policy_predator_policy_reward": [-17.802508591136522, -19.169470534615137, -13.996637897144577, -13.583275413564163, -18.14252755580521, -28.460221168230813, 12.6801819822413, -5.67942996565292, -6.315099318885274, -22.57736487100261, -10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28022225388499544, "mean_inference_ms": 0.9210892718549495, "mean_action_processing_ms": 0.12547457132306536, "mean_env_wait_ms": 0.0614296050587897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002682328224182129, "StateBufferConnector_ms": 0.0018811225891113281, "ViewRequirementAgentConnector_ms": 0.04651367664337158}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 831.8429156499732, "num_env_steps_trained_throughput_per_sec": 831.8429156499732, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1288000, "timers": {"training_iteration_time_ms": 4924.726, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4924.692, "sample_time_ms": 635.674, "learn_time_ms": 4278.563, "learn_throughput": 934.893, "synch_weights_time_ms": 10.122}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "done": false, "training_iteration": 161, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-13-58", "timestamp": 1723346038, "time_this_iter_s": 4.811169862747192, "time_total_s": 816.8688108921051, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fa8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 816.8688108921051, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 35.61428571428572, "ram_util_percent": 81.52857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.0144117347896096, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.481098010763526, "policy_loss": -0.004715223079013716, "vf_loss": 2.4858122818171977, "vf_explained_var": 0.48997382558882235, "kl": 0.014506619597169626, "entropy": 0.8726159519826372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.690828104875982, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6194168525437513, "policy_loss": -0.0035641334708392, "vf_loss": 2.6224130327502886, "vf_explained_var": 0.1086010946581761, "kl": 0.01770864879937939, "entropy": 0.7319689024239778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 9.182110694411028, "predator_policy": -9.182110694411028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.584480220173347, 24.17498562480003, 21.787996008965564, 28.720865303533436, 19.299236938363926, 4.019233926803491, 12.472484486702939, 2.0706239022278368, -6.639116798803855, 16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957], "policy_predator_policy_reward": [-10.584480220173347, -24.17498562480003, -21.787996008965564, -28.720865303533436, -19.299236938363926, -4.019233926803491, -12.472484486702939, -2.0706239022278368, 6.639116798803855, -16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28013526923029686, "mean_inference_ms": 0.9205059011529094, "mean_action_processing_ms": 0.12543743319564232, "mean_env_wait_ms": 0.06141289928466202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027180910110473633, "StateBufferConnector_ms": 0.001880645751953125, "ViewRequirementAgentConnector_ms": 0.04696464538574219}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 756.6535678031703, "num_env_steps_trained_throughput_per_sec": 756.6535678031703, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 4961.511, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4961.477, "sample_time_ms": 639.976, "learn_time_ms": 4310.964, "learn_throughput": 927.867, "synch_weights_time_ms": 10.202}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 162, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-04", "timestamp": 1723346044, "time_this_iter_s": 5.289368152618408, "time_total_s": 822.1581790447235, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71f0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 822.1581790447235, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 40.471428571428575, "ram_util_percent": 81.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.756681260466576, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2709304903944334, "policy_loss": -0.0057021892026871985, "vf_loss": 2.2766317680478094, "vf_explained_var": 0.3373900814602772, "kl": 0.013726710477383951, "entropy": 0.8335616554444035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6365283712123833, "cur_kl_coeff": 0.03207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6514196558545033, "policy_loss": -0.0002515992261275339, "vf_loss": 2.651512091234326, "vf_explained_var": 0.03008169128249089, "kl": 0.0049629586308496685, "entropy": 0.7410431426639358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 8.979739302217064, "predator_policy": -8.979739302217064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [16.359476651994907, 4.898830533364624, 5.556097744273757, 14.127798392804497, 11.491708973276324, 8.37612271461023, 5.418918402464577, 3.8448560790172834, 8.813888132610082, 13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054], "policy_predator_policy_reward": [-16.359476651994907, -4.898830533364624, -5.556097744273757, -14.127798392804497, -11.491708973276324, -8.37612271461023, -5.418918402464577, -3.8448560790172834, -8.813888132610082, -13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2801135626858009, "mean_inference_ms": 0.9206638196697118, "mean_action_processing_ms": 0.12539388768295984, "mean_env_wait_ms": 0.06140972017165667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027472972869873047, "StateBufferConnector_ms": 0.0018957853317260742, "ViewRequirementAgentConnector_ms": 0.047220826148986816}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 822.1870521295752, "num_env_steps_trained_throughput_per_sec": 822.1870521295752, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1304000, "timers": {"training_iteration_time_ms": 4957.746, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4957.712, "sample_time_ms": 644.244, "learn_time_ms": 4303.208, "learn_throughput": 929.539, "synch_weights_time_ms": 9.928}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "done": false, "training_iteration": 163, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-09", "timestamp": 1723346049, "time_this_iter_s": 4.8679118156433105, "time_total_s": 827.0260908603668, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4c4aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 827.0260908603668, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 36.5, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.670382444622616, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.918418842678269, "policy_loss": -0.006739042524228959, "vf_loss": 2.925157134483258, "vf_explained_var": 0.26477695486197866, "kl": 0.011473243020653119, "entropy": 0.7880855585138004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.738901314449807, "cur_kl_coeff": 0.016036153212189676, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.814155889550845, "policy_loss": -0.009756403481393743, "vf_loss": 2.8235390399893125, "vf_explained_var": 0.06926935308923324, "kl": 0.023276168162011078, "entropy": 0.7632434802750746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 8.487050355703802, "predator_policy": -8.487050355703802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [13.394641046023125, 20.51922907034501, 17.832392891958712, 3.0094824824645414, 10.243932974000998, -13.45532744345224, 10.77129801064861, 18.818818520529188, 5.972320302698712, -7.5799285237320575, 13.50222379468143, 6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566], "policy_predator_policy_reward": [-13.394641046023125, -20.51922907034501, -17.832392891958712, -3.0094824824645414, -10.243932974000998, 13.45532744345224, -10.77129801064861, -18.818818520529188, -5.972320302698712, 7.5799285237320575, -13.50222379468143, -6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28005958220341215, "mean_inference_ms": 0.9205237692663425, "mean_action_processing_ms": 0.12537591069407208, "mean_env_wait_ms": 0.061401655304379014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027943849563598633, "StateBufferConnector_ms": 0.00195920467376709, "ViewRequirementAgentConnector_ms": 0.04791545867919922}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 805.2628966877852, "num_env_steps_trained_throughput_per_sec": 805.2628966877852, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 4968.085, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4968.051, "sample_time_ms": 650.045, "learn_time_ms": 4307.815, "learn_throughput": 928.545, "synch_weights_time_ms": 9.851}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 164, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-14", "timestamp": 1723346054, "time_this_iter_s": 4.9702887535095215, "time_total_s": 831.9963796138763, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 831.9963796138763, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 37.1, "ram_util_percent": 81.87142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.397924073537191, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4985519186904033, "policy_loss": -0.0065201102484328055, "vf_loss": 2.5050710358967385, "vf_explained_var": 0.4162197317928076, "kl": 0.01502877066571638, "entropy": 0.793469978372256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.335136320007344, "cur_kl_coeff": 0.024054229818284516, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.580143987139066, "policy_loss": 0.00012748604688871031, "vf_loss": 2.5798445532719296, "vf_explained_var": -0.06189352348446846, "kl": 0.007148249524185333, "entropy": 0.7659067116056879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 8.56782200929614, "predator_policy": -8.56782200929614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [6.995163169697626, 22.956731695520713, 15.702637117654305, 22.20581646785974, -1.8467547651952998, 20.905773346397197, 21.597460751543093, 7.836574967062168, 14.382512248721739, -0.11265413091712162, 3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394], "policy_predator_policy_reward": [-6.995163169697626, -22.956731695520713, -15.702637117654305, -22.20581646785974, 1.8467547651952998, -20.905773346397197, -21.597460751543093, -7.836574967062168, -14.382512248721739, 0.11265413091712162, -3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.280084022764302, "mean_inference_ms": 0.9204620597319945, "mean_action_processing_ms": 0.1253595158446606, "mean_env_wait_ms": 0.06140471050435028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028426647186279297, "StateBufferConnector_ms": 0.0019747018814086914, "ViewRequirementAgentConnector_ms": 0.04815399646759033}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 829.5199491367482, "num_env_steps_trained_throughput_per_sec": 829.5199491367482, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 4949.315, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4949.282, "sample_time_ms": 654.561, "learn_time_ms": 4284.502, "learn_throughput": 933.597, "synch_weights_time_ms": 9.881}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 165, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-18", "timestamp": 1723346058, "time_this_iter_s": 4.824625015258789, "time_total_s": 836.8210046291351, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71f0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 836.8210046291351, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 35.02857142857143, "ram_util_percent": 81.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.606742498464882, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.113440734644731, "policy_loss": -0.004937996480051273, "vf_loss": 3.1183776068190734, "vf_explained_var": 0.34650157938400905, "kl": 0.017183211615746378, "entropy": 0.7494478300213814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5239303138107063, "cur_kl_coeff": 0.024054229818284516, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.431687197337548, "policy_loss": -0.005622753766510868, "vf_loss": 3.4368802088002366, "vf_explained_var": -0.21693376290301483, "kl": 0.017866192019479855, "entropy": 0.7636843711137772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 8.766290201678704, "predator_policy": -8.766290201678704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [3.4579963108260756, 15.963332519671951, 18.044331221434415, 8.473966100565946, -15.233969043531985, -1.1757763136493224, 0.8484462661045526, 17.272134916673497, 24.36134865754017, 31.16721108984949, 10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145], "policy_predator_policy_reward": [-3.4579963108260756, -15.963332519671951, -18.044331221434415, -8.473966100565946, 15.233969043531985, 1.1757763136493224, -0.8484462661045526, -17.272134916673497, -24.36134865754017, -31.16721108984949, -10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2799386799979089, "mean_inference_ms": 0.9202614308112804, "mean_action_processing_ms": 0.12534852155641601, "mean_env_wait_ms": 0.06136836494807107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028818845748901367, "StateBufferConnector_ms": 0.001978278160095215, "ViewRequirementAgentConnector_ms": 0.04596507549285889}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 827.9861131880001, "num_env_steps_trained_throughput_per_sec": 827.9861131880001, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 4933.16, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4933.126, "sample_time_ms": 647.472, "learn_time_ms": 4275.686, "learn_throughput": 935.522, "synch_weights_time_ms": 9.637}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 166, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-23", "timestamp": 1723346063, "time_this_iter_s": 4.833544969558716, "time_total_s": 841.6545495986938, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fe1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 841.6545495986938, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 35.27142857142858, "ram_util_percent": 81.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.788164304383099, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.904710828885436, "policy_loss": -0.006135499521284752, "vf_loss": 2.9108452449242272, "vf_explained_var": 0.2818760875612497, "kl": 0.016461848790840842, "entropy": 0.702106367982924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9386318303644656, "cur_kl_coeff": 0.024054229818284516, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.882475387925903, "policy_loss": -0.010167841758326782, "vf_loss": 2.891961713631948, "vf_explained_var": -0.2592383390913407, "kl": 0.02833176900857951, "entropy": 0.6726983960097035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 8.513242439451641, "predator_policy": -8.513242439451641}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.584555549001328, 10.727171097328316, 18.265570183385055, -8.072808526156848, 19.72671272695315, -5.553120746741776, -6.426342208754534, 13.572514658664023, 3.601842222647978, -2.370801685919787, 12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786], "policy_predator_policy_reward": [-10.584555549001328, -10.727171097328316, -18.265570183385055, 8.072808526156848, -19.72671272695315, 5.553120746741776, 6.426342208754534, -13.572514658664023, -3.601842222647978, 2.370801685919787, -12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798614119790878, "mean_inference_ms": 0.9201759120491642, "mean_action_processing_ms": 0.1253295316517089, "mean_env_wait_ms": 0.061355692765474056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002950310707092285, "StateBufferConnector_ms": 0.001967787742614746, "ViewRequirementAgentConnector_ms": 0.044730544090270996}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 778.7435862516231, "num_env_steps_trained_throughput_per_sec": 778.7435862516231, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 1336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1336000, "timers": {"training_iteration_time_ms": 4940.335, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4940.301, "sample_time_ms": 646.05, "learn_time_ms": 4284.257, "learn_throughput": 933.651, "synch_weights_time_ms": 9.656}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "done": false, "training_iteration": 167, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-29", "timestamp": 1723346069, "time_this_iter_s": 5.149674892425537, "time_total_s": 846.8042244911194, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7139f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 846.8042244911194, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 38.628571428571426, "ram_util_percent": 81.72857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.074449192918837, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7555347599089144, "policy_loss": -0.0050979695452648835, "vf_loss": 2.7606320455670357, "vf_explained_var": 0.25843379062910876, "kl": 0.010361700089319107, "entropy": 0.5561386840417981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.740907975162069, "cur_kl_coeff": 0.03608134472742676, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.708886647472779, "policy_loss": -0.0031389153412116383, "vf_loss": 2.7118593158821267, "vf_explained_var": 0.1260930728788177, "kl": 0.004607408684920279, "entropy": 0.7354522616912921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -32.73663485029826}, "policy_reward_max": {"prey_policy": 32.73663485029826, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 9.177153518464928, "predator_policy": -9.177153518464928}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.03316101165877, 24.484898974896588, 21.288996864069922, 6.57144343730112, 16.379372953265353, 6.777314186852379, 0.6520889291216676, 17.048964031108806, 4.918725757037908, 13.806166464328001, 1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056], "policy_predator_policy_reward": [-12.03316101165877, -24.484898974896588, -21.288996864069922, -6.57144343730112, -16.379372953265353, -6.777314186852379, -0.6520889291216676, -17.048964031108806, -4.918725757037908, -13.806166464328001, -1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27982109690010576, "mean_inference_ms": 0.9197977653899858, "mean_action_processing_ms": 0.12527883976975382, "mean_env_wait_ms": 0.061340116905787306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00301969051361084, "StateBufferConnector_ms": 0.001976490020751953, "ViewRequirementAgentConnector_ms": 0.044954657554626465}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.1426642014981, "num_env_steps_trained_throughput_per_sec": 804.1426642014981, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 4939.398, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4939.364, "sample_time_ms": 638.665, "learn_time_ms": 4290.481, "learn_throughput": 932.296, "synch_weights_time_ms": 9.879}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 168, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-34", "timestamp": 1723346074, "time_this_iter_s": 4.976855039596558, "time_total_s": 851.7810795307159, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d2820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 851.7810795307159, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 37.37142857142857, "ram_util_percent": 81.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.222015155603488, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5626727593441805, "policy_loss": -0.006359759489472102, "vf_loss": 2.5690317617108422, "vf_explained_var": 0.5230525329709053, "kl": 0.011385353968741659, "entropy": 0.5628518381466469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7282325650875765, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3440517552196978, "policy_loss": -0.010513515378018685, "vf_loss": 3.3542378313839434, "vf_explained_var": -0.04853388033807278, "kl": 0.01815000097928987, "entropy": 0.7520605656007926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 8.942039979196135, "predator_policy": -8.942039979196135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.3925768672511474, -5.79407626088247, 4.778090353368569, 16.567572663792557, -16.91127976714955, 2.178280694255136, -1.9628310542461875, 8.83513658722562, -3.182694327680779, 9.1667694521607, 10.889043368485591, 7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088], "policy_predator_policy_reward": [-1.3925768672511474, 5.79407626088247, -4.778090353368569, -16.567572663792557, 16.91127976714955, -2.178280694255136, 1.9628310542461875, -8.83513658722562, 3.182694327680779, -9.1667694521607, -10.889043368485591, -7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2797787627670016, "mean_inference_ms": 0.9195851589158486, "mean_action_processing_ms": 0.12525206632461544, "mean_env_wait_ms": 0.0613256729889803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003079056739807129, "StateBufferConnector_ms": 0.002585291862487793, "ViewRequirementAgentConnector_ms": 0.045732975006103516}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 792.6961949796806, "num_env_steps_trained_throughput_per_sec": 792.6961949796806, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 1352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1352000, "timers": {"training_iteration_time_ms": 4956.747, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4956.713, "sample_time_ms": 642.373, "learn_time_ms": 4304.13, "learn_throughput": 929.34, "synch_weights_time_ms": 9.867}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "done": false, "training_iteration": 169, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-39", "timestamp": 1723346079, "time_this_iter_s": 5.050114631652832, "time_total_s": 856.8311941623688, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 856.8311941623688, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 37.2, "ram_util_percent": 81.82857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.127274530380964, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2620595005651314, "policy_loss": -0.00676918234094046, "vf_loss": 3.2688280095656714, "vf_explained_var": 0.3128438123812278, "kl": 0.010137195497768318, "entropy": 0.578065297504266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.836646840845545, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.324682943398754, "policy_loss": -0.0039395630771953925, "vf_loss": 3.3283906063685813, "vf_explained_var": -0.014658730539182822, "kl": 0.0128549830908133, "entropy": 0.7459457690517107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 10.23399646965669, "predator_policy": -10.23399646965669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [7.836350480875069, 2.54460894221085, -11.626940730225265, 10.320049761118973, 32.73663485029826, 21.6475884778942, 0.8265189792980578, 15.67406445342855, 8.952927526433353, 10.557160090361755, 28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264], "policy_predator_policy_reward": [-7.836350480875069, -2.54460894221085, 11.626940730225265, -10.320049761118973, -32.73663485029826, -21.6475884778942, -0.8265189792980578, -15.67406445342855, -8.952927526433353, -10.557160090361755, -28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2797232789391752, "mean_inference_ms": 0.9194700621588257, "mean_action_processing_ms": 0.12525031554148827, "mean_env_wait_ms": 0.06131243259815253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031186342239379883, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.04628098011016846}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.939966937064, "num_env_steps_trained_throughput_per_sec": 798.939966937064, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 4974.399, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4974.365, "sample_time_ms": 649.781, "learn_time_ms": 4314.404, "learn_throughput": 927.127, "synch_weights_time_ms": 9.834}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 170, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-44", "timestamp": 1723346084, "time_this_iter_s": 5.009282112121582, "time_total_s": 861.8404762744904, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fe040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 861.8404762744904, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 37.42857142857143, "ram_util_percent": 81.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.818183241970837, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2324579232682784, "policy_loss": -0.00581034598047457, "vf_loss": 2.23826772843798, "vf_explained_var": 0.3548717019458612, "kl": 0.00811207091270963, "entropy": 0.505341789436837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.619654521284004, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4129607373227677, "policy_loss": -0.00409825386304874, "vf_loss": 2.4167235939453047, "vf_explained_var": 0.06483596079051494, "kl": 0.01859102341072445, "entropy": 0.7356643442685405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -25.27883973947764, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 25.27883973947764}, "policy_reward_mean": {"prey_policy": 9.511808529853468, "predator_policy": -9.511808529853468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [28.701118636141018, -0.2654217606871754, 19.857878682680052, -25.27883973947764, 4.506891767377084, 9.577902984823758, 14.523913050818344, 13.226212034136452, 6.534158798746532, 21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124], "policy_predator_policy_reward": [-28.701118636141018, 0.2654217606871754, -19.857878682680052, 25.27883973947764, -4.506891767377084, -9.577902984823758, -14.523913050818344, -13.226212034136452, -6.534158798746532, -21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2797825917529542, "mean_inference_ms": 0.918953124240264, "mean_action_processing_ms": 0.12521092940634154, "mean_env_wait_ms": 0.0613196025432437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031479597091674805, "StateBufferConnector_ms": 0.0025911331176757812, "ViewRequirementAgentConnector_ms": 0.04664647579193115}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.064800375713, "num_env_steps_trained_throughput_per_sec": 801.064800375713, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 4992.875, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4992.84, "sample_time_ms": 658.78, "learn_time_ms": 4323.812, "learn_throughput": 925.11, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 171, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-49", "timestamp": 1723346089, "time_this_iter_s": 4.995977878570557, "time_total_s": 866.8364541530609, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d2280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 866.8364541530609, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 36.81428571428571, "ram_util_percent": 82.52857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6608519431203606, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4817861301203568, "policy_loss": -0.005948780481170009, "vf_loss": 2.4877345013121763, "vf_explained_var": 0.03761169525484244, "kl": 0.005677968536960658, "entropy": 0.453971619065851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2165190384412807, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.397414419862131, "policy_loss": -0.0059378553360147635, "vf_loss": 2.4031895615160463, "vf_explained_var": -0.027115743048489092, "kl": 0.009018896933255518, "entropy": 0.7774700487653414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 10.154189137488736, "predator_policy": -10.154189137488736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [21.175424741044957, 8.103317844172494, 11.49022124189986, 7.004921229145804, -2.7259121500450068, 25.195267815533892, 4.798303124542883, 3.6954067959439314, 15.670295369943187, 23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932], "policy_predator_policy_reward": [-21.175424741044957, -8.103317844172494, -11.49022124189986, -7.004921229145804, 2.7259121500450068, -25.195267815533892, -4.798303124542883, -3.6954067959439314, -15.670295369943187, -23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2797753104998219, "mean_inference_ms": 0.919390445420172, "mean_action_processing_ms": 0.12519317663798243, "mean_env_wait_ms": 0.061312875134854845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031948089599609375, "StateBufferConnector_ms": 0.0026324987411499023, "ViewRequirementAgentConnector_ms": 0.047699928283691406}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 801.5460270306296, "num_env_steps_trained_throughput_per_sec": 801.5460270306296, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 4963.267, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4963.232, "sample_time_ms": 664.531, "learn_time_ms": 4288.521, "learn_throughput": 932.722, "synch_weights_time_ms": 9.831}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 172, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-54", "timestamp": 1723346094, "time_this_iter_s": 4.992914915084839, "time_total_s": 871.8293690681458, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 871.8293690681458, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 34.775000000000006, "ram_util_percent": 82.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.934834973948697, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.601054195811351, "policy_loss": -0.0043074020722997375, "vf_loss": 3.6053613781929017, "vf_explained_var": 0.18449999541044235, "kl": 0.0028735852577614442, "entropy": 0.3864484358889361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5498217220728594, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1726816069334745, "policy_loss": -0.004590777430469946, "vf_loss": 3.1769137836992742, "vf_explained_var": 0.04002901390194893, "kl": 0.01987788265796553, "entropy": 0.7504726480071743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 10.136965902670955, "predator_policy": -10.136965902670955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [23.021829122233054, -5.918136238003163, 21.22694040854146, 20.945623136768457, 8.872431324954551, 11.270210051198248, 5.094738168529229, -4.541948281674365, -23.25760609485673, -4.073449502367566, 8.94671491891637, 10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734], "policy_predator_policy_reward": [-23.021829122233054, 5.918136238003163, -21.22694040854146, -20.945623136768457, -8.872431324954551, -11.270210051198248, -5.094738168529229, 4.541948281674365, 23.25760609485673, 4.073449502367566, -8.94671491891637, -10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27977939225787274, "mean_inference_ms": 0.9193351717730366, "mean_action_processing_ms": 0.12518344492830902, "mean_env_wait_ms": 0.061308951805659255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003198385238647461, "StateBufferConnector_ms": 0.0026519298553466797, "ViewRequirementAgentConnector_ms": 0.048066020011901855}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.5796318338677, "num_env_steps_trained_throughput_per_sec": 811.5796318338677, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 1384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1384000, "timers": {"training_iteration_time_ms": 4969.626, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4969.591, "sample_time_ms": 661.602, "learn_time_ms": 4297.776, "learn_throughput": 930.714, "synch_weights_time_ms": 9.868}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "done": false, "training_iteration": 173, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-14-59", "timestamp": 1723346099, "time_this_iter_s": 4.931190013885498, "time_total_s": 876.7605590820312, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fe040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 876.7605590820312, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 35.885714285714286, "ram_util_percent": 82.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7416029406090576, "cur_kl_coeff": 3.299620002508164e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7266256709893546, "policy_loss": -0.004248024633246435, "vf_loss": 2.730873612438639, "vf_explained_var": 0.3003108192856113, "kl": 0.0037080136399490963, "entropy": 0.2834634203619013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.796027295353512, "cur_kl_coeff": 0.01804067236371338, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0588916016121703, "policy_loss": -0.013825988135067746, "vf_loss": 3.07212009044985, "vf_explained_var": -0.15139418231944243, "kl": 0.033119561123805256, "entropy": 0.729182402168711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 10.728999764942742, "predator_policy": -10.728999764942742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.895696245250939, 12.993141667150791, 5.266488913964558, 2.270141206958108, 12.349749149068721, 22.966989363203005, -12.600099149376938, 16.722569690839606, 7.847811093298258, 13.447045386126394, 18.9642194765618, 24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719], "policy_predator_policy_reward": [-10.895696245250939, -12.993141667150791, -5.266488913964558, -2.270141206958108, -12.349749149068721, -22.966989363203005, 12.600099149376938, -16.722569690839606, -7.847811093298258, -13.447045386126394, -18.9642194765618, -24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27983010311437073, "mean_inference_ms": 0.9192600219317046, "mean_action_processing_ms": 0.12517010487501884, "mean_env_wait_ms": 0.061309151483414225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031032562255859375, "StateBufferConnector_ms": 0.0025905370712280273, "ViewRequirementAgentConnector_ms": 0.04751622676849365}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.5039812479303, "num_env_steps_trained_throughput_per_sec": 806.5039812479303, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 4968.861, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4968.827, "sample_time_ms": 658.698, "learn_time_ms": 4299.862, "learn_throughput": 930.262, "synch_weights_time_ms": 9.926}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 174, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-04", "timestamp": 1723346104, "time_this_iter_s": 4.962173938751221, "time_total_s": 881.7227330207825, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 881.7227330207825, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 35.72857142857142, "ram_util_percent": 82.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6439422607111434, "cur_kl_coeff": 1.649810001254082e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.234618608901898, "policy_loss": -0.004776527339708991, "vf_loss": 3.2393951222300528, "vf_explained_var": 0.21079032129297653, "kl": 0.0032634885352218076, "entropy": 0.3297095922132333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5196674189219874, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9772996339946984, "policy_loss": -0.002250013058316351, "vf_loss": 2.9793499443680047, "vf_explained_var": -0.22487528175115584, "kl": 0.007379781082157912, "entropy": 0.7648010713979602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.87, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39687, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 10.152447077493, "predator_policy": -10.152447077493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400], "policy_prey_policy_reward": [24.213862355112735, 2.2554969182581814, 10.748826943804236, 28.50422188451045, 10.767385169488652, -9.543593363272848, 31.969964009200787, 13.92884636091232, 18.660850352024145, 9.744720206241858, -24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802], "policy_predator_policy_reward": [-24.213862355112735, -2.2554969182581814, -10.748826943804236, -28.50422188451045, -10.767385169488652, 9.543593363272848, -31.969964009200787, -13.92884636091232, -18.660850352024145, -9.744720206241858, 24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27978400451630486, "mean_inference_ms": 0.9188271447004578, "mean_action_processing_ms": 0.1251812715742011, "mean_env_wait_ms": 0.06129552163145911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033184289932250977, "StateBufferConnector_ms": 0.00261688232421875, "ViewRequirementAgentConnector_ms": 0.04861807823181152}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 811.7868166976355, "num_env_steps_trained_throughput_per_sec": 811.7868166976355, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 4979.395, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4979.36, "sample_time_ms": 659.269, "learn_time_ms": 4309.691, "learn_throughput": 928.141, "synch_weights_time_ms": 10.063}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 175, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-09", "timestamp": 1723346109, "time_this_iter_s": 4.929915904998779, "time_total_s": 886.6526489257812, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 886.6526489257812, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 34.957142857142856, "ram_util_percent": 82.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.458510268914203, "cur_kl_coeff": 8.24905000627041e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.124425736318032, "policy_loss": -0.008515130074132078, "vf_loss": 3.1329408629486957, "vf_explained_var": 0.3409064537535111, "kl": 0.007601290991229155, "entropy": 0.35076910359784963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6587141659731666, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4135489009320734, "policy_loss": -0.002601828095066594, "vf_loss": 2.4159621177862087, "vf_explained_var": 0.1908263190339009, "kl": 0.00696965217537134, "entropy": 0.7786693700278798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.87, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39687, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 9.698679778099223, "predator_policy": -9.698679778099223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-24.015429679813483, 31.9094365747086, 5.061707411017252, -9.5215296037331, 7.399694984446981, 10.108623052181827, 17.09081217587785, 16.05238814848606, 14.043822233364786, 32.32663655854551, 10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162], "policy_predator_policy_reward": [24.015429679813483, -31.9094365747086, -5.061707411017252, 9.5215296037331, -7.399694984446981, -10.108623052181827, -17.09081217587785, -16.05238814848606, -14.043822233364786, -32.32663655854551, -10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2797769039855482, "mean_inference_ms": 0.9189690785135383, "mean_action_processing_ms": 0.12518693945424927, "mean_env_wait_ms": 0.06130030641405791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003313899040222168, "StateBufferConnector_ms": 0.002710580825805664, "ViewRequirementAgentConnector_ms": 0.04868340492248535}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 806.4076886572915, "num_env_steps_trained_throughput_per_sec": 806.4076886572915, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 4992.322, "restore_workers_time_ms": 0.014, "training_step_time_ms": 4992.287, "sample_time_ms": 665.592, "learn_time_ms": 4316.304, "learn_throughput": 926.719, "synch_weights_time_ms": 10.054}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 176, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-14", "timestamp": 1723346114, "time_this_iter_s": 4.96278715133667, "time_total_s": 891.6154360771179, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fa5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 891.6154360771179, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 35.44285714285714, "ram_util_percent": 81.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8013023651515443, "cur_kl_coeff": 8.24905000627041e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2300123574833077, "policy_loss": -0.010901864905463299, "vf_loss": 3.2409142119189105, "vf_explained_var": 0.3069118688503901, "kl": 0.009811303555401819, "entropy": 0.3677895299779872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6385625594606004, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8188137734308838, "policy_loss": -0.009056949406658531, "vf_loss": 1.8271995987122258, "vf_explained_var": 0.2712032935892542, "kl": 0.024800348250957165, "entropy": 0.8229330424840252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.87, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39687, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -34.35285124207756}, "policy_reward_max": {"prey_policy": 34.35285124207756, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 9.957431191894909, "predator_policy": -9.957431191894909}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [10.23352073284935, 15.351536845066036, 11.934645492738571, 22.877102918139194, 26.478043699165802, -1.8132717575230295, 6.9316614182386616, 1.6050907151717269, -5.478565450656056, 34.35285124207756, 7.909831617487377, 5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081], "policy_predator_policy_reward": [-10.23352073284935, -15.351536845066036, -11.934645492738571, -22.877102918139194, -26.478043699165802, 1.8132717575230295, -6.9316614182386616, -1.6050907151717269, 5.478565450656056, -34.35285124207756, -7.909831617487377, -5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27981905965717835, "mean_inference_ms": 0.9188850287700384, "mean_action_processing_ms": 0.12516992395683377, "mean_env_wait_ms": 0.061303867800872484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003255128860473633, "StateBufferConnector_ms": 0.002768874168395996, "ViewRequirementAgentConnector_ms": 0.048963308334350586}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 817.9529412774197, "num_env_steps_trained_throughput_per_sec": 817.9529412774197, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 4967.699, "restore_workers_time_ms": 0.014, "training_step_time_ms": 4967.665, "sample_time_ms": 668.768, "learn_time_ms": 4288.526, "learn_throughput": 932.721, "synch_weights_time_ms": 10.044}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 177, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-18", "timestamp": 1723346118, "time_this_iter_s": 4.892910003662109, "time_total_s": 896.50834608078, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 896.50834608078, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 35.614285714285714, "ram_util_percent": 81.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.947384161812564, "cur_kl_coeff": 8.24905000627041e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.722299901396036, "policy_loss": -0.011372839677884864, "vf_loss": 3.733672602723042, "vf_explained_var": 0.3648840255414446, "kl": 0.017949644772708002, "entropy": 0.5010533802521725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6896078187351424, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2289585220317045, "policy_loss": -0.009813102298843053, "vf_loss": 3.2381102497378986, "vf_explained_var": 0.1231431449453036, "kl": 0.01629358058377538, "entropy": 0.9026983634879192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.87, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39687, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -33.048091136929884}, "policy_reward_max": {"prey_policy": 33.048091136929884, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 9.937883231533934, "predator_policy": -9.937883231533934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.577675248340391, 8.791557347784067, 9.255416912662621, 6.442630966194152, 15.896705157394916, 12.155300015569747, -6.772515592021687, 6.840325767272088, 8.963931177767257, 3.738446084284405, -7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528], "policy_predator_policy_reward": [-5.577675248340391, -8.791557347784067, -9.255416912662621, -6.442630966194152, -15.896705157394916, -12.155300015569747, 6.772515592021687, -6.840325767272088, -8.963931177767257, -3.738446084284405, 7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798152333831162, "mean_inference_ms": 0.9189742665633441, "mean_action_processing_ms": 0.12519078147434573, "mean_env_wait_ms": 0.061302607548778865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032596588134765625, "StateBufferConnector_ms": 0.0027837753295898438, "ViewRequirementAgentConnector_ms": 0.04960465431213379}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 802.3529389259312, "num_env_steps_trained_throughput_per_sec": 802.3529389259312, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 4968.809, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4968.774, "sample_time_ms": 667.602, "learn_time_ms": 4290.851, "learn_throughput": 932.216, "synch_weights_time_ms": 9.987}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 178, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-23", "timestamp": 1723346123, "time_this_iter_s": 4.988524913787842, "time_total_s": 901.4968709945679, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72c9670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 901.4968709945679, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 35.285714285714285, "ram_util_percent": 81.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.007282841950655, "cur_kl_coeff": 8.24905000627041e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.4356395594775675, "policy_loss": -0.011454834208416287, "vf_loss": 4.447094193845987, "vf_explained_var": 0.24932105001062155, "kl": 0.02834418078665454, "entropy": 0.7262410948053002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5674190085381268, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9172359774510066, "policy_loss": -0.01074100014763341, "vf_loss": 3.9273333325982094, "vf_explained_var": 0.02253713763008515, "kl": 0.01585659906182679, "entropy": 0.9497095684210459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.87, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39687, "policy_reward_min": {"prey_policy": -24.991133678656347, "predator_policy": -33.048091136929884}, "policy_reward_max": {"prey_policy": 33.048091136929884, "predator_policy": 24.991133678656347}, "policy_reward_mean": {"prey_policy": 10.44596561749926, "predator_policy": -10.44596561749926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-7.154527936156974, 25.514287022966474, 33.048091136929884, 19.66378281815816, 8.513916992391929, 13.510934248270793, 15.770213550314267, 10.60086976963429, 22.982292758075264, -23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784], "policy_predator_policy_reward": [7.154527936156974, -25.514287022966474, -33.048091136929884, -19.66378281815816, -8.513916992391929, -13.510934248270793, -15.770213550314267, -10.60086976963429, -22.982292758075264, 23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798986738472622, "mean_inference_ms": 0.9190154177841023, "mean_action_processing_ms": 0.12521484324705962, "mean_env_wait_ms": 0.06131430441730166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003211379051208496, "StateBufferConnector_ms": 0.002206563949584961, "ViewRequirementAgentConnector_ms": 0.04959309101104736}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 767.3282365380381, "num_env_steps_trained_throughput_per_sec": 767.3282365380381, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 1432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1432000, "timers": {"training_iteration_time_ms": 4985.491, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4985.456, "sample_time_ms": 670.254, "learn_time_ms": 4304.831, "learn_throughput": 929.189, "synch_weights_time_ms": 10.04}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "done": false, "training_iteration": 179, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-29", "timestamp": 1723346129, "time_this_iter_s": 5.215365171432495, "time_total_s": 906.7122361660004, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72c9b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 906.7122361660004, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 37.871428571428574, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8780785342057547, "cur_kl_coeff": 1.237357500940561e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.201145378748576, "policy_loss": -0.007554612262659551, "vf_loss": 4.2086999970177805, "vf_explained_var": 0.42988498192280533, "kl": 0.006468477945665955, "entropy": 0.49054277706891297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4328236841907103, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6595449122289816, "policy_loss": -0.0056187452760544454, "vf_loss": 3.6648670891920725, "vf_explained_var": 0.02695764700571696, "kl": 0.007306029925043868, "entropy": 0.8688678386310736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -29.289032845904845, "predator_policy": -32.71328999075347}, "policy_reward_max": {"prey_policy": 32.71328999075347, "predator_policy": 29.289032845904845}, "policy_reward_mean": {"prey_policy": 9.55668597468994, "predator_policy": -9.55668597468994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400], "policy_prey_policy_reward": [-23.13052363341975, 7.499994895340208, -0.7152390731623228, 1.6716657569068332, -24.991133678656347, 14.572267495094124, 8.495073050937727, 26.804901244524444, 16.451096885335648, 0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385], "policy_predator_policy_reward": [23.13052363341975, -7.499994895340208, 0.7152390731623228, -1.6716657569068332, 24.991133678656347, -14.572267495094124, -8.495073050937727, -26.804901244524444, -16.451096885335648, -0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27992932109810414, "mean_inference_ms": 0.9189569141577103, "mean_action_processing_ms": 0.12517454463221497, "mean_env_wait_ms": 0.06131463750692378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003175973892211914, "StateBufferConnector_ms": 0.002200603485107422, "ViewRequirementAgentConnector_ms": 0.048989057540893555}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.7186981675816, "num_env_steps_trained_throughput_per_sec": 789.7186981675816, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 4991.337, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4991.302, "sample_time_ms": 661.182, "learn_time_ms": 4319.427, "learn_throughput": 926.049, "synch_weights_time_ms": 10.346}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 180, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-34", "timestamp": 1723346134, "time_this_iter_s": 5.070757150650024, "time_total_s": 911.7829933166504, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 911.7829933166504, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 38.471428571428575, "ram_util_percent": 81.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.02848536328723, "cur_kl_coeff": 1.237357500940561e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.546612998098135, "policy_loss": -0.004481551595381461, "vf_loss": 3.5510945399602254, "vf_explained_var": 0.29314173956712086, "kl": 0.003241988155261666, "entropy": 0.40414376674840846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.568234237966438, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.653500356152654, "policy_loss": -0.00740206983294532, "vf_loss": 2.6604712246606748, "vf_explained_var": 0.13468061393747727, "kl": 0.010623065005353998, "entropy": 0.8186260295410951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -29.289032845904845, "predator_policy": -32.71328999075347}, "policy_reward_max": {"prey_policy": 32.71328999075347, "predator_policy": 29.289032845904845}, "policy_reward_mean": {"prey_policy": 10.49815457952157, "predator_policy": -10.49815457952157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [0.592065908471124, 26.055192507994548, 13.073831941960655, 9.299105341733728, 5.961446957030397, 9.980514675176792, 20.304576313057044, 21.756603088176284, 24.956263614837653, 4.234340778117932, 13.539133524158334, 7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967], "policy_predator_policy_reward": [-0.592065908471124, -26.055192507994548, -13.073831941960655, -9.299105341733728, -5.961446957030397, -9.980514675176792, -20.304576313057044, -21.756603088176284, -24.956263614837653, -4.234340778117932, -13.539133524158334, -7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27991376589948547, "mean_inference_ms": 0.9194211469492966, "mean_action_processing_ms": 0.125164052937989, "mean_env_wait_ms": 0.06130956310499156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031698942184448242, "StateBufferConnector_ms": 0.0022345781326293945, "ViewRequirementAgentConnector_ms": 0.04908454418182373}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.6848911028495, "num_env_steps_trained_throughput_per_sec": 791.6848911028495, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 1448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1448000, "timers": {"training_iteration_time_ms": 4997.253, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4997.22, "sample_time_ms": 656.344, "learn_time_ms": 4330.253, "learn_throughput": 923.733, "synch_weights_time_ms": 10.276}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "done": false, "training_iteration": 181, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-39", "timestamp": 1723346139, "time_this_iter_s": 5.055517911911011, "time_total_s": 916.8385112285614, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72c95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 916.8385112285614, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 37.31428571428571, "ram_util_percent": 81.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.442022385634482, "cur_kl_coeff": 6.186787504702805e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6393830691774687, "policy_loss": -0.007165018161564755, "vf_loss": 3.646548097580671, "vf_explained_var": 0.3640398845697443, "kl": 0.008066157801272126, "entropy": 0.5450225190569957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9321025212605796, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1262960017969212, "policy_loss": -0.006709528744007306, "vf_loss": 3.1326360169798138, "vf_explained_var": -0.0765606668467323, "kl": 0.009102818480561622, "entropy": 0.8844851585725944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -29.289032845904845, "predator_policy": -32.71328999075347}, "policy_reward_max": {"prey_policy": 32.71328999075347, "predator_policy": 29.289032845904845}, "policy_reward_mean": {"prey_policy": 10.456975380172585, "predator_policy": -10.456975380172585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [7.6711964672517965, 26.502725014463955, -3.920353983360169, 5.621343088673557, -3.663111202633246, 12.64542510420783, 13.890152701613143, 20.398411816028734, 27.507317335452854, 16.383902686547806, -2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809], "policy_predator_policy_reward": [-7.6711964672517965, -26.502725014463955, 3.920353983360169, -5.621343088673557, 3.663111202633246, -12.64542510420783, -13.890152701613143, -20.398411816028734, -27.507317335452854, -16.383902686547806, 2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2799252090341783, "mean_inference_ms": 0.9189133067078195, "mean_action_processing_ms": 0.12514831568415516, "mean_env_wait_ms": 0.06130310368706818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030989646911621094, "StateBufferConnector_ms": 0.0021904706954956055, "ViewRequirementAgentConnector_ms": 0.0480729341506958}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.8532493495576, "num_env_steps_trained_throughput_per_sec": 789.8532493495576, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 5004.641, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5004.607, "sample_time_ms": 643.247, "learn_time_ms": 4350.712, "learn_throughput": 919.39, "synch_weights_time_ms": 10.304}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 182, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-44", "timestamp": 1723346144, "time_this_iter_s": 5.0671350955963135, "time_total_s": 921.9056463241577, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71faee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 921.9056463241577, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 37.6, "ram_util_percent": 81.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.489200701937079, "cur_kl_coeff": 6.186787504702805e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4528682025770348, "policy_loss": -0.011877005225930286, "vf_loss": 3.464745208372672, "vf_explained_var": 0.3551227554678917, "kl": 0.010489065068927576, "entropy": 0.6102642133831978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8363617487251758, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.065672910461823, "policy_loss": -0.005999212857568636, "vf_loss": 4.071361915270487, "vf_explained_var": 0.020730878971517087, "kl": 0.007642562774537156, "entropy": 0.8974291181191802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -32.71328999075347}, "policy_reward_max": {"prey_policy": 32.71328999075347, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 9.818972955445197, "predator_policy": -9.818972955445197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.0850709468649313, -3.325438829246977, 19.41284319305603, 4.835407140227375, 13.32891632211794, 20.663311601049983, 24.452604838116148, 0.5129438955131675, -0.8960039945512719, 4.472256828058853, 26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454], "policy_predator_policy_reward": [2.0850709468649313, 3.325438829246977, -19.41284319305603, -4.835407140227375, -13.32891632211794, -20.663311601049983, -24.452604838116148, -0.5129438955131675, 0.8960039945512719, -4.472256828058853, -26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27996786120449646, "mean_inference_ms": 0.9187776392749926, "mean_action_processing_ms": 0.1251449923762266, "mean_env_wait_ms": 0.061304413651203725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00309908390045166, "StateBufferConnector_ms": 0.0021849870681762695, "ViewRequirementAgentConnector_ms": 0.04781615734100342}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.3239957358347, "num_env_steps_trained_throughput_per_sec": 803.3239957358347, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 5009.71, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5009.668, "sample_time_ms": 648.477, "learn_time_ms": 4350.575, "learn_throughput": 919.419, "synch_weights_time_ms": 10.272}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 183, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-49", "timestamp": 1723346149, "time_this_iter_s": 4.9820451736450195, "time_total_s": 926.8876914978027, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71fad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 926.8876914978027, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 36.65714285714285, "ram_util_percent": 82.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.710619416212042, "cur_kl_coeff": 6.186787504702805e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.356796302894751, "policy_loss": -0.004137956367048901, "vf_loss": 3.3609342500567436, "vf_explained_var": 0.2509979950884978, "kl": 0.006976108895869513, "entropy": 0.5156662702249984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6215817810967565, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.152802155415217, "policy_loss": -0.010696154099908503, "vf_loss": 3.162675333519777, "vf_explained_var": -0.09451759116103252, "kl": 0.020274741599542415, "entropy": 0.9561025346939762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -32.71328999075347}, "policy_reward_max": {"prey_policy": 32.71328999075347, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 9.711262118808534, "predator_policy": -9.711262118808534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [26.755275224177286, -8.87478739700338, 10.274807981046926, -18.31887376162739, 19.842948138101363, 4.518732385034802, 14.459465958090718, -20.09802565382918, 8.270904449127361, 12.165780146893802, 15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495], "policy_predator_policy_reward": [-26.755275224177286, 8.87478739700338, -10.274807981046926, 18.31887376162739, -19.842948138101363, -4.518732385034802, -14.459465958090718, 20.09802565382918, -8.270904449127361, -12.165780146893802, -15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798654812114837, "mean_inference_ms": 0.9186775344435961, "mean_action_processing_ms": 0.1251472078970987, "mean_env_wait_ms": 0.06128432138104576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030728578567504883, "StateBufferConnector_ms": 0.002177119255065918, "ViewRequirementAgentConnector_ms": 0.0475764274597168}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 807.1694312797919, "num_env_steps_trained_throughput_per_sec": 807.1694312797919, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 5009.301, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5009.259, "sample_time_ms": 646.342, "learn_time_ms": 4352.335, "learn_throughput": 919.047, "synch_weights_time_ms": 10.238}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 184, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-54", "timestamp": 1723346154, "time_this_iter_s": 4.958082914352417, "time_total_s": 931.8457744121552, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49288b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 931.8457744121552, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 35.04285714285715, "ram_util_percent": 81.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.594700595736503, "cur_kl_coeff": 6.186787504702805e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9738282702863215, "policy_loss": -0.005712695624485301, "vf_loss": 3.979540961732467, "vf_explained_var": 0.24052347981681427, "kl": 0.004837614849228391, "entropy": 0.5455995162328084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.978546776250005, "cur_kl_coeff": 0.06088726922753265, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9240515023469924, "policy_loss": -0.0041759606043342504, "vf_loss": 3.9279363103210927, "vf_explained_var": 0.06349478606134654, "kl": 0.004782051623493492, "entropy": 1.0459973185012739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 399.15, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39915, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -32.71328999075347}, "policy_reward_max": {"prey_policy": 32.71328999075347, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 10.138468293184983, "predator_policy": -10.138468293184983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [15.260191101041677, 18.34676562346785, 8.8026696292008, -1.6309435879239729, 17.107280807338615, -3.0508293544572, 3.5129228976580507, 10.758156010319617, 6.241763415545247, 20.525874354712162, 23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737], "policy_predator_policy_reward": [-15.260191101041677, -18.34676562346785, -8.8026696292008, 1.6309435879239729, -17.107280807338615, 3.0508293544572, -3.5129228976580507, -10.758156010319617, -6.241763415545247, -20.525874354712162, -23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798441756845754, "mean_inference_ms": 0.9189935466723658, "mean_action_processing_ms": 0.12511575651561876, "mean_env_wait_ms": 0.06128553660629168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028533935546875, "StateBufferConnector_ms": 0.0021753311157226562, "ViewRequirementAgentConnector_ms": 0.048329710960388184}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 824.2886542404431, "num_env_steps_trained_throughput_per_sec": 824.2886542404431, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 5001.827, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5001.787, "sample_time_ms": 642.147, "learn_time_ms": 4349.098, "learn_throughput": 919.731, "synch_weights_time_ms": 10.197}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 185, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-15-59", "timestamp": 1723346159, "time_this_iter_s": 4.855245113372803, "time_total_s": 936.701019525528, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b71faee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 936.701019525528, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 35.45714285714286, "ram_util_percent": 81.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.394921037678917, "cur_kl_coeff": 3.0933937523514023e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.157453121244908, "policy_loss": -0.002576046040727912, "vf_loss": 4.160029171903928, "vf_explained_var": 0.43616312767068544, "kl": 0.004248184280379815, "entropy": 0.5279538713395595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.946501561254263, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4967568730314573, "policy_loss": -0.008673351525309651, "vf_loss": 3.504748137295246, "vf_explained_var": 0.11724024613698324, "kl": 0.022405055512705715, "entropy": 1.1056097170958916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 399.15, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39915, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 10.558848997684143, "predator_policy": -10.558848997684143}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [23.88121338085233, 31.028285428185526, 17.452430570512053, 5.595395250529755, -7.244468251069755, 16.54756886766753, 9.684455751657786, 3.427529101047064, 22.931831438781597, 3.027061696487081, 18.124867019119964, 20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442], "policy_predator_policy_reward": [-23.88121338085233, -31.028285428185526, -17.452430570512053, -5.595395250529755, 7.244468251069755, -16.54756886766753, -9.684455751657786, -3.427529101047064, -22.931831438781597, -3.027061696487081, -18.124867019119964, -20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798271536837174, "mean_inference_ms": 0.9187022073411757, "mean_action_processing_ms": 0.12507797309898797, "mean_env_wait_ms": 0.06127867378561115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002816319465637207, "StateBufferConnector_ms": 0.002077341079711914, "ViewRequirementAgentConnector_ms": 0.048241615295410156}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.6602371830036, "num_env_steps_trained_throughput_per_sec": 813.6602371830036, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 4997.406, "restore_workers_time_ms": 0.016, "training_step_time_ms": 4997.366, "sample_time_ms": 637.326, "learn_time_ms": 4349.414, "learn_throughput": 919.664, "synch_weights_time_ms": 10.279}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 186, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-04", "timestamp": 1723346164, "time_this_iter_s": 4.9186670780181885, "time_total_s": 941.6196866035461, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d2310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 941.6196866035461, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 37.11666666666667, "ram_util_percent": 81.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5581099357455965, "cur_kl_coeff": 1.5466968761757012e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.546094040820996, "policy_loss": -0.004772314331542778, "vf_loss": 3.5508663589755693, "vf_explained_var": 0.38432796287039916, "kl": 0.007166692657798708, "entropy": 0.5778398794742922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0537683443476755, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.453697402526935, "policy_loss": -0.006040254640295947, "vf_loss": 3.4592623549203076, "vf_explained_var": 0.10443144012242556, "kl": 0.010408145228952318, "entropy": 1.0448567569255829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 399.15, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39915, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 10.1548679220059, "predator_policy": -10.1548679220059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.35637080316511, 19.78160770766491, -1.1973416059100863, -0.7638584470487331, 6.668500212512797, 12.932846317367467, 30.455377832058893, -1.1129809833127382, 6.967480354624712, 16.21478222641528, 30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107], "policy_predator_policy_reward": [-20.35637080316511, -19.78160770766491, 1.1973416059100863, 0.7638584470487331, -6.668500212512797, -12.932846317367467, -30.455377832058893, 1.1129809833127382, -6.967480354624712, -16.21478222641528, -30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27973379765507034, "mean_inference_ms": 0.9185148513902698, "mean_action_processing_ms": 0.1250661037213491, "mean_env_wait_ms": 0.06126220937402751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002771735191345215, "StateBufferConnector_ms": 0.0020216703414916992, "ViewRequirementAgentConnector_ms": 0.04788947105407715}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 813.3539785645178, "num_env_steps_trained_throughput_per_sec": 813.3539785645178, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 1496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1496000, "timers": {"training_iteration_time_ms": 5000.171, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5000.131, "sample_time_ms": 630.31, "learn_time_ms": 4359.149, "learn_throughput": 917.61, "synch_weights_time_ms": 10.323}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "done": false, "training_iteration": 187, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-09", "timestamp": 1723346169, "time_this_iter_s": 4.921088933944702, "time_total_s": 946.5407755374908, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b49288b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 946.5407755374908, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 35.642857142857146, "ram_util_percent": 81.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.361190157321592, "cur_kl_coeff": 1.5466968761757012e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.639638087153435, "policy_loss": -0.00858278604670583, "vf_loss": 3.648220858971278, "vf_explained_var": 0.2102595708022515, "kl": 0.013037338391715754, "entropy": 0.5774707732411722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.295127017175158, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.211412822951873, "policy_loss": -0.004414687245177144, "vf_loss": 3.2150018957753974, "vf_explained_var": 0.20965719825277726, "kl": 0.018079789919956193, "entropy": 1.003126672655344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 399.15, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39915, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 10.036566013692223, "predator_policy": -10.036566013692223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [30.530690505254732, 25.313563640590235, 15.594296057814304, 27.245664434342622, -21.783461501968294, 20.330395869672426, 25.24668056459972, 6.472041872502206, -22.993399302468205, 15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207], "policy_predator_policy_reward": [-30.530690505254732, -25.313563640590235, -15.594296057814304, -27.245664434342622, 21.783461501968294, -20.330395869672426, -25.24668056459972, -6.472041872502206, 22.993399302468205, -15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27973674083748695, "mean_inference_ms": 0.9183024152660867, "mean_action_processing_ms": 0.1250653808888007, "mean_env_wait_ms": 0.061263644271850735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027146339416503906, "StateBufferConnector_ms": 0.0020055770874023438, "ViewRequirementAgentConnector_ms": 0.047162652015686035}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 804.7844170184985, "num_env_steps_trained_throughput_per_sec": 804.7844170184985, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 4998.665, "restore_workers_time_ms": 0.016, "training_step_time_ms": 4998.625, "sample_time_ms": 630.931, "learn_time_ms": 4357.133, "learn_throughput": 918.035, "synch_weights_time_ms": 10.215}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 188, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-14", "timestamp": 1723346174, "time_this_iter_s": 4.972941160202026, "time_total_s": 951.5137166976929, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72fb550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 951.5137166976929, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 34.5, "ram_util_percent": 81.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.136107866093516, "cur_kl_coeff": 1.5466968761757012e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.625783836841583, "policy_loss": -0.005035463522168963, "vf_loss": 4.630819303294023, "vf_explained_var": 0.22082702480256558, "kl": 0.010042678681600442, "entropy": 0.5054142281723519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9389213333527247, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.212171909709771, "policy_loss": -0.0067485606909031045, "vf_loss": 4.218277772267659, "vf_explained_var": -0.11576033979654313, "kl": 0.014073661304494904, "entropy": 0.9262981549526255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 399.15, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39915, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 9.785535085856713, "predator_policy": -9.785535085856713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 315, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [15.741239541440784, 9.259182731979692, 32.71328999075347, 3.943953109586424, 19.20038646972957, 11.99513901420125, -29.289032845904845, -4.886410168007975, -6.261351557559948, 16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998], "policy_predator_policy_reward": [-15.741239541440784, -9.259182731979692, -32.71328999075347, -3.943953109586424, -19.20038646972957, -11.99513901420125, 29.289032845904845, 4.886410168007975, 6.261351557559948, -16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.279645491119387, "mean_inference_ms": 0.9181926357809287, "mean_action_processing_ms": 0.12501956800835237, "mean_env_wait_ms": 0.061248280394522986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002733469009399414, "StateBufferConnector_ms": 0.0020257234573364258, "ViewRequirementAgentConnector_ms": 0.047777652740478516}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 800.9584834146392, "num_env_steps_trained_throughput_per_sec": 800.9584834146392, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 4976.777, "restore_workers_time_ms": 0.017, "training_step_time_ms": 4976.736, "sample_time_ms": 626.578, "learn_time_ms": 4339.584, "learn_throughput": 921.747, "synch_weights_time_ms": 10.232}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 189, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-19", "timestamp": 1723346179, "time_this_iter_s": 4.997308969497681, "time_total_s": 956.5110256671906, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72fba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 956.5110256671906, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 37.99999999999999, "ram_util_percent": 81.97142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8506787002086638, "cur_kl_coeff": 1.5466968761757012e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8907688207924367, "policy_loss": -0.007154085241685, "vf_loss": 3.8979228876531122, "vf_explained_var": 0.2789233392725388, "kl": 0.041455839375208574, "entropy": 0.5248427614259223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4149158326288065, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2192523341625927, "policy_loss": -0.006318700893947001, "vf_loss": 3.224975836649537, "vf_explained_var": 0.31299537712087233, "kl": 0.013034052194071891, "entropy": 0.9125693195809921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 10.055838036804051, "predator_policy": -10.055838036804051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [16.846739334874385, -0.04330904386250012, 7.464753596038204, 20.351446985213055, 16.708141183699997, 17.084943046040625, 16.505340842433377, 16.453700741206646, 17.6912898404842, 8.588656234809967, 11.260825350003206, -5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786], "policy_predator_policy_reward": [-16.846739334874385, 0.04330904386250012, -7.464753596038204, -20.351446985213055, -16.708141183699997, -17.084943046040625, -16.505340842433377, -16.453700741206646, -17.6912898404842, -8.588656234809967, -11.260825350003206, 5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2796105866453679, "mean_inference_ms": 0.9180647809583425, "mean_action_processing_ms": 0.12500828893695548, "mean_env_wait_ms": 0.061240942440834806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027599334716796875, "StateBufferConnector_ms": 0.0020873546600341797, "ViewRequirementAgentConnector_ms": 0.04839134216308594}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 769.1982102491442, "num_env_steps_trained_throughput_per_sec": 769.1982102491442, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 4990.29, "restore_workers_time_ms": 0.017, "training_step_time_ms": 4990.248, "sample_time_ms": 646.819, "learn_time_ms": 4333.148, "learn_throughput": 923.116, "synch_weights_time_ms": 9.952}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 190, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-24", "timestamp": 1723346184, "time_this_iter_s": 5.203413963317871, "time_total_s": 961.7144396305084, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d28b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 961.7144396305084, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 38.871428571428574, "ram_util_percent": 81.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.307776743297776, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.096405121932427, "policy_loss": -0.0015259096447456006, "vf_loss": 4.097931043058634, "vf_explained_var": 0.19736094896992049, "kl": 0.005429932656835604, "entropy": 0.5681574083554248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.186044197902083, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9376482562472424, "policy_loss": -0.013479900390908977, "vf_loss": 2.950157058611512, "vf_explained_var": -0.01052428527424733, "kl": 0.021265271861894537, "entropy": 0.9205200361087919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 10.110881807247557, "predator_policy": -10.110881807247557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-5.420529712788586, 16.648936949907327, 2.1328499321842287, 17.546933199673308, 25.024541088416086, 17.239887090093127, 31.873503548272296, 20.330950423243046, 6.856573327076234, 2.140683519735809, 14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268], "policy_predator_policy_reward": [5.420529712788586, -16.648936949907327, -2.1328499321842287, -17.546933199673308, -25.024541088416086, -17.239887090093127, -31.873503548272296, -20.330950423243046, -6.856573327076234, -2.140683519735809, -14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2795839219507094, "mean_inference_ms": 0.9174382910347828, "mean_action_processing_ms": 0.12497933367709373, "mean_env_wait_ms": 0.061229425779112494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026923418045043945, "StateBufferConnector_ms": 0.002033233642578125, "ViewRequirementAgentConnector_ms": 0.047984957695007324}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 784.9231936554207, "num_env_steps_trained_throughput_per_sec": 784.9231936554207, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 1528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1528000, "timers": {"training_iteration_time_ms": 4994.642, "restore_workers_time_ms": 0.017, "training_step_time_ms": 4994.601, "sample_time_ms": 642.19, "learn_time_ms": 4342.095, "learn_throughput": 921.214, "synch_weights_time_ms": 9.982}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "done": false, "training_iteration": 191, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-29", "timestamp": 1723346189, "time_this_iter_s": 5.101522922515869, "time_total_s": 966.8159625530243, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72fb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 966.8159625530243, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 37.0, "ram_util_percent": 81.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.251331694858769, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9153411063055197, "policy_loss": -0.004718961268372368, "vf_loss": 3.9200600715974967, "vf_explained_var": 0.4399509978791078, "kl": 0.005434688327610904, "entropy": 0.6187859167034427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.975181925855577, "cur_kl_coeff": 0.06849817788097425, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.312961859131853, "policy_loss": -0.014874536295004267, "vf_loss": 3.3266679387539626, "vf_explained_var": 0.19617414803554614, "kl": 0.017058402191644666, "entropy": 0.9326263267546893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -29.798414347795507, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 29.798414347795507}, "policy_reward_mean": {"prey_policy": 9.795347505605829, "predator_policy": -9.795347505605829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [14.882314671067832, -6.735665787236204, 21.55902378505684, 2.635378100065461, -29.798414347795507, 14.168466176975556, 10.844621027646582, 8.485021733255927, 11.650216508924753, 11.545804687546454, -0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394], "policy_predator_policy_reward": [-14.882314671067832, 6.735665787236204, -21.55902378505684, -2.635378100065461, 29.798414347795507, -14.168466176975556, -10.844621027646582, -8.485021733255927, -11.650216508924753, -11.545804687546454, 0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2795455328327081, "mean_inference_ms": 0.9175415960480354, "mean_action_processing_ms": 0.12497423754744982, "mean_env_wait_ms": 0.06121931819610342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002698659896850586, "StateBufferConnector_ms": 0.0020524263381958008, "ViewRequirementAgentConnector_ms": 0.048070549964904785}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.2288086206839, "num_env_steps_trained_throughput_per_sec": 781.2288086206839, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 5000.233, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5000.192, "sample_time_ms": 647.43, "learn_time_ms": 4342.44, "learn_throughput": 921.141, "synch_weights_time_ms": 9.984}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 192, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-34", "timestamp": 1723346194, "time_this_iter_s": 5.1229188442230225, "time_total_s": 971.9388813972473, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 971.9388813972473, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 82.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.935956438817084, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.861783533046643, "policy_loss": -0.0028245313175527067, "vf_loss": 3.8646080705026784, "vf_explained_var": 0.19603744447231292, "kl": 0.008605200905241854, "entropy": 0.60037685384353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8426198141028483, "cur_kl_coeff": 0.06849817788097425, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.678755909204483, "policy_loss": -0.014301056907182403, "vf_loss": 3.690681315710147, "vf_explained_var": -0.13918282048155864, "kl": 0.03468202325772134, "entropy": 1.0011743417630592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.740079314500615, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 23.740079314500615}, "policy_reward_mean": {"prey_policy": 10.974101012187894, "predator_policy": -10.974101012187894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-0.6674772881018747, -0.01826346140949653, 15.965121284377858, 2.603982071573938, 6.2439707385045615, 8.226777715856947, 19.08921911079784, 7.577026348309818, 20.937541080293776, -9.357211216393495, 4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067], "policy_predator_policy_reward": [0.6674772881018747, 0.01826346140949653, -15.965121284377858, -2.603982071573938, -6.2439707385045615, -8.226777715856947, -19.08921911079784, -7.577026348309818, -20.937541080293776, 9.357211216393495, -4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794886969300999, "mean_inference_ms": 0.9174400336148935, "mean_action_processing_ms": 0.12495232862827428, "mean_env_wait_ms": 0.061208891821023396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027681589126586914, "StateBufferConnector_ms": 0.002124190330505371, "ViewRequirementAgentConnector_ms": 0.050145506858825684}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 799.5712671804692, "num_env_steps_trained_throughput_per_sec": 799.5712671804692, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 1544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1544000, "timers": {"training_iteration_time_ms": 5002.568, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5002.531, "sample_time_ms": 647.007, "learn_time_ms": 4345.158, "learn_throughput": 920.565, "synch_weights_time_ms": 10.027}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "done": false, "training_iteration": 193, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-39", "timestamp": 1723346199, "time_this_iter_s": 5.005467176437378, "time_total_s": 976.9443485736847, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d28b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 976.9443485736847, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 37.28571428571429, "ram_util_percent": 82.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.550267081956068, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.1022054217755795, "policy_loss": -0.001082168485057385, "vf_loss": 5.103287589301666, "vf_explained_var": 0.3112357286736369, "kl": 0.00596942429433085, "entropy": 0.6870552251115442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.000869467606147, "cur_kl_coeff": 0.10274726682146135, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.151040117442608, "policy_loss": -0.005427652619740305, "vf_loss": 5.155848833173513, "vf_explained_var": -0.09715213856349389, "kl": 0.006023848411161435, "entropy": 1.2154748934010664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -23.740079314500615, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 23.740079314500615}, "policy_reward_mean": {"prey_policy": 11.52892160497644, "predator_policy": -11.52892160497644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [4.309699932841816, 18.392585603281397, 8.23162229075027, 6.792686895975205, 13.272444667525402, 3.5475169935520867, 16.094090204215476, -0.14966268004158678, 6.2174903339925365, 15.008370665564737, 6.1973336084968516, 2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067, 23.674376377167906, 11.237689610637396, 6.705451854561142, 15.345262908352922, 5.7536252001763195, 18.539686315875038, 10.925593376645118, -5.77050803825956, 16.424154737221514, 23.247413320286533], "policy_predator_policy_reward": [-4.309699932841816, -18.392585603281397, -8.23162229075027, -6.792686895975205, -13.272444667525402, -3.5475169935520867, -16.094090204215476, 0.14966268004158678, -6.2174903339925365, -15.008370665564737, -6.1973336084968516, -2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067, -23.674376377167906, -11.237689610637396, -6.705451854561142, -15.345262908352922, -5.7536252001763195, -18.539686315875038, -10.925593376645118, 5.77050803825956, -16.424154737221514, -23.247413320286533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27943317274220547, "mean_inference_ms": 0.9174319993493352, "mean_action_processing_ms": 0.12494455138077783, "mean_env_wait_ms": 0.06120094205775278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027834177017211914, "StateBufferConnector_ms": 0.0021431446075439453, "ViewRequirementAgentConnector_ms": 0.050466060638427734}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 820.4870990738254, "num_env_steps_trained_throughput_per_sec": 820.4870990738254, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 4994.524, "restore_workers_time_ms": 0.014, "training_step_time_ms": 4994.487, "sample_time_ms": 649.886, "learn_time_ms": 4334.232, "learn_throughput": 922.886, "synch_weights_time_ms": 10.029}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 194, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-44", "timestamp": 1723346204, "time_this_iter_s": 4.877822160720825, "time_total_s": 981.8221707344055, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 981.8221707344055, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 36.02857142857143, "ram_util_percent": 82.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.816049276913206, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.229957989603281, "policy_loss": -0.004585473671128663, "vf_loss": 4.234543490658203, "vf_explained_var": 0.38644333084424337, "kl": 0.009656743457223537, "entropy": 0.48737602128336827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6684462152421475, "cur_kl_coeff": 0.10274726682146135, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0744318692634502, "policy_loss": -0.010359805001644417, "vf_loss": 3.083268834898869, "vf_explained_var": 0.15965601615607738, "kl": 0.014821109174361406, "entropy": 1.1890699705729881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.02, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39602, "policy_reward_min": {"prey_policy": -23.740079314500615, "predator_policy": -38.44549496115499}, "policy_reward_max": {"prey_policy": 38.44549496115499, "predator_policy": 23.740079314500615}, "policy_reward_mean": {"prey_policy": 12.368636112942392, "predator_policy": -12.368636112942392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [2.609931331764436, 22.033412860533428, 12.361719034429292, -3.2698912135181644, 28.598314672386074, 23.497844450730604, 10.08570734524158, 38.44549496115499, -2.647945704400442, -3.3306532219589826, 7.750304175618329, 16.622130496498393, -3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067, 23.674376377167906, 11.237689610637396, 6.705451854561142, 15.345262908352922, 5.7536252001763195, 18.539686315875038, 10.925593376645118, -5.77050803825956, 16.424154737221514, 23.247413320286533, -5.783312925248932, -3.5062471278733582, -2.102604695841153, 34.0259200104965, 13.488906189370837, 31.34525313780361, 19.92384397772549, 35.55605817141755, 16.406523337159967, 7.945171871144943, 34.586117366593825], "policy_predator_policy_reward": [-2.609931331764436, -22.033412860533428, -12.361719034429292, 3.2698912135181644, -28.598314672386074, -23.497844450730604, -10.08570734524158, -38.44549496115499, 2.647945704400442, 3.3306532219589826, -7.750304175618329, -16.622130496498393, 3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067, -23.674376377167906, -11.237689610637396, -6.705451854561142, -15.345262908352922, -5.7536252001763195, -18.539686315875038, -10.925593376645118, 5.77050803825956, -16.424154737221514, -23.247413320286533, 5.783312925248932, 3.5062471278733582, 2.102604695841153, -34.0259200104965, -13.488906189370837, -31.34525313780361, -19.92384397772549, -35.55605817141755, -16.406523337159967, -7.945171871144943, -34.586117366593825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27935585045031014, "mean_inference_ms": 0.9172478789690167, "mean_action_processing_ms": 0.12492890057397847, "mean_env_wait_ms": 0.0611765546564694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002798318862915039, "StateBufferConnector_ms": 0.0021620988845825195, "ViewRequirementAgentConnector_ms": 0.05189073085784912}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.02227025832, "num_env_steps_trained_throughput_per_sec": 774.02227025832, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 5026.039, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5026.0, "sample_time_ms": 653.395, "learn_time_ms": 4360.291, "learn_throughput": 917.37, "synch_weights_time_ms": 11.96}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 195, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-49", "timestamp": 1723346209, "time_this_iter_s": 5.175079345703125, "time_total_s": 986.9972500801086, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72d29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 986.9972500801086, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 39.25714285714286, "ram_util_percent": 82.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.53122765365988, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.235071679204703, "policy_loss": -0.005885915074516864, "vf_loss": 5.240957559645176, "vf_explained_var": 0.20007391267766556, "kl": 0.009579780742863078, "entropy": 0.6180092277005315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3224641691272456, "cur_kl_coeff": 0.10274726682146135, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.491459340850512, "policy_loss": -0.004344791761347248, "vf_loss": 4.4948335009316605, "vf_explained_var": -0.15999286168565352, "kl": 0.009446783866375628, "entropy": 1.1276973702013493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.1, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 39210, "policy_reward_min": {"prey_policy": -23.740079314500615, "predator_policy": -39.76120238050918}, "policy_reward_max": {"prey_policy": 39.76120238050918, "predator_policy": 23.740079314500615}, "policy_reward_mean": {"prey_policy": 11.67724709394792, "predator_policy": -11.67724709394792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-3.0048611307202293, 24.787002714261142, 27.532393794122868, 11.304204518809644, 18.95392878232589, -23.740079314500615, 22.646495565168166, 4.537196306322107, 4.941741429982919, 15.318912686027044, -3.052696590899636, 17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067, 23.674376377167906, 11.237689610637396, 6.705451854561142, 15.345262908352922, 5.7536252001763195, 18.539686315875038, 10.925593376645118, -5.77050803825956, 16.424154737221514, 23.247413320286533, -5.783312925248932, -3.5062471278733582, -2.102604695841153, 34.0259200104965, 13.488906189370837, 31.34525313780361, 19.92384397772549, 35.55605817141755, 16.406523337159967, 7.945171871144943, 34.586117366593825, -6.186123837152181, 11.728139567131088, -9.777044908099333, 4.907717813098468, 39.76120238050918, 33.613257756633466, -10.293220380705662, 24.185318334058017, 12.02217535596742, 11.118439821318326, -18.00417086969328, -9.458223744033102], "policy_predator_policy_reward": [3.0048611307202293, -24.787002714261142, -27.532393794122868, -11.304204518809644, -18.95392878232589, 23.740079314500615, -22.646495565168166, -4.537196306322107, -4.941741429982919, -15.318912686027044, 3.052696590899636, -17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067, -23.674376377167906, -11.237689610637396, -6.705451854561142, -15.345262908352922, -5.7536252001763195, -18.539686315875038, -10.925593376645118, 5.77050803825956, -16.424154737221514, -23.247413320286533, 5.783312925248932, 3.5062471278733582, 2.102604695841153, -34.0259200104965, -13.488906189370837, -31.34525313780361, -19.92384397772549, -35.55605817141755, -16.406523337159967, -7.945171871144943, -34.586117366593825, 6.186123837152181, -11.728139567131088, 9.777044908099333, -4.907717813098468, -39.76120238050918, -33.613257756633466, 10.293220380705662, -24.185318334058017, -12.02217535596742, -11.118439821318326, 18.00417086969328, 9.458223744033102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2793550238172685, "mean_inference_ms": 0.9170768755957092, "mean_action_processing_ms": 0.12491718290753992, "mean_env_wait_ms": 0.061171030747106274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028018951416015625, "StateBufferConnector_ms": 0.00217592716217041, "ViewRequirementAgentConnector_ms": 0.05177438259124756}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 646.2578121382734, "num_env_steps_trained_throughput_per_sec": 646.2578121382734, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 5153.382, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5153.341, "sample_time_ms": 652.861, "learn_time_ms": 4487.98, "learn_throughput": 891.27, "synch_weights_time_ms": 12.123}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 196, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-16-55", "timestamp": 1723346215, "time_this_iter_s": 6.208754777908325, "time_total_s": 993.206004858017, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b72c9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 993.206004858017, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 50.03333333333333, "ram_util_percent": 83.5888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.612799854949117, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.987261973818144, "policy_loss": -0.008458584467734908, "vf_loss": 4.995720562090477, "vf_explained_var": 0.3203932331874967, "kl": 0.013262642714144702, "entropy": 0.6254325998947025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2099482908224064, "cur_kl_coeff": 0.10274726682146135, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.53575902308027, "policy_loss": -0.003885109659555989, "vf_loss": 4.538974540432294, "vf_explained_var": -0.17142850775271654, "kl": 0.006517058936688613, "entropy": 1.1269076490153869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.13, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38813, "policy_reward_min": {"prey_policy": -25.520081399939084, "predator_policy": -39.76120238050918}, "policy_reward_max": {"prey_policy": 39.76120238050918, "predator_policy": 25.520081399939084}, "policy_reward_mean": {"prey_policy": 10.530285145262615, "predator_policy": -10.530285145262615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [17.43627112665483, -0.7545301491166114, 30.457940153563925, -4.0230343414192475, 18.228539390529203, 8.658547143895138, 11.260902736952207, 5.969084573282419, 18.556496819391437, 6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067, 23.674376377167906, 11.237689610637396, 6.705451854561142, 15.345262908352922, 5.7536252001763195, 18.539686315875038, 10.925593376645118, -5.77050803825956, 16.424154737221514, 23.247413320286533, -5.783312925248932, -3.5062471278733582, -2.102604695841153, 34.0259200104965, 13.488906189370837, 31.34525313780361, 19.92384397772549, 35.55605817141755, 16.406523337159967, 7.945171871144943, 34.586117366593825, -6.186123837152181, 11.728139567131088, -9.777044908099333, 4.907717813098468, 39.76120238050918, 33.613257756633466, -10.293220380705662, 24.185318334058017, 12.02217535596742, 11.118439821318326, -18.00417086969328, -9.458223744033102, -8.430013115859218, -7.671597299479544, -20.207450726393084, -2.9974396870273945, 0.9896579338033398, -15.373420554114865, 5.113753617320809, 14.777155833377886, -25.520081399939084, 17.40543804183163, 27.44204124884839], "policy_predator_policy_reward": [-17.43627112665483, 0.7545301491166114, -30.457940153563925, 4.0230343414192475, -18.228539390529203, -8.658547143895138, -11.260902736952207, -5.969084573282419, -18.556496819391437, -6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067, -23.674376377167906, -11.237689610637396, -6.705451854561142, -15.345262908352922, -5.7536252001763195, -18.539686315875038, -10.925593376645118, 5.77050803825956, -16.424154737221514, -23.247413320286533, 5.783312925248932, 3.5062471278733582, 2.102604695841153, -34.0259200104965, -13.488906189370837, -31.34525313780361, -19.92384397772549, -35.55605817141755, -16.406523337159967, -7.945171871144943, -34.586117366593825, 6.186123837152181, -11.728139567131088, 9.777044908099333, -4.907717813098468, -39.76120238050918, -33.613257756633466, 10.293220380705662, -24.185318334058017, -12.02217535596742, -11.118439821318326, 18.00417086969328, 9.458223744033102, 8.430013115859218, 7.671597299479544, 20.207450726393084, 2.9974396870273945, -0.9896579338033398, 15.373420554114865, -5.113753617320809, -14.777155833377886, 25.520081399939084, -17.40543804183163, -27.44204124884839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794094583680617, "mean_inference_ms": 0.9170665019423684, "mean_action_processing_ms": 0.1249462066611531, "mean_env_wait_ms": 0.06118005446505541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002851724624633789, "StateBufferConnector_ms": 0.002230525016784668, "ViewRequirementAgentConnector_ms": 0.05359780788421631}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.7597223323702, "num_env_steps_trained_throughput_per_sec": 710.7597223323702, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 1576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1576000, "timers": {"training_iteration_time_ms": 5224.369, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5224.326, "sample_time_ms": 666.389, "learn_time_ms": 4545.149, "learn_throughput": 880.059, "synch_weights_time_ms": 12.407}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "done": false, "training_iteration": 197, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-17-01", "timestamp": 1723346221, "time_this_iter_s": 5.630579948425293, "time_total_s": 998.8365848064423, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 998.8365848064423, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 49.95, "ram_util_percent": 82.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.541480147155623, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.300810133417447, "policy_loss": -0.006395321618280529, "vf_loss": 4.30720546245575, "vf_explained_var": 0.4090639501189192, "kl": 0.012086733057645915, "entropy": 0.5585633867730697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.655994744040072, "cur_kl_coeff": 0.10274726682146135, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4912196190406877, "policy_loss": -0.004230050729771998, "vf_loss": 3.4948440375427405, "vf_explained_var": 0.04702506239215533, "kl": 0.005894437498537355, "entropy": 1.0008988695219159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.13, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38813, "policy_reward_min": {"prey_policy": -25.520081399939084, "predator_policy": -42.684841598443974}, "policy_reward_max": {"prey_policy": 42.684841598443974, "predator_policy": 25.520081399939084}, "policy_reward_mean": {"prey_policy": 10.274395880565669, "predator_policy": -10.274395880565669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [6.234164967455339, 19.225664611669504, 8.632865621412705, -12.070364850132037, 23.827924578964605, -5.8192177052051335, 16.29676073994998, 13.908776081370618, -16.98915081122014, 15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067, 23.674376377167906, 11.237689610637396, 6.705451854561142, 15.345262908352922, 5.7536252001763195, 18.539686315875038, 10.925593376645118, -5.77050803825956, 16.424154737221514, 23.247413320286533, -5.783312925248932, -3.5062471278733582, -2.102604695841153, 34.0259200104965, 13.488906189370837, 31.34525313780361, 19.92384397772549, 35.55605817141755, 16.406523337159967, 7.945171871144943, 34.586117366593825, -6.186123837152181, 11.728139567131088, -9.777044908099333, 4.907717813098468, 39.76120238050918, 33.613257756633466, -10.293220380705662, 24.185318334058017, 12.02217535596742, 11.118439821318326, -18.00417086969328, -9.458223744033102, -8.430013115859218, -7.671597299479544, -20.207450726393084, -2.9974396870273945, 0.9896579338033398, -15.373420554114865, 5.113753617320809, 14.777155833377886, -25.520081399939084, 17.40543804183163, 27.44204124884839, 12.050418631975212, 12.291564486124884, 12.790024157349855, 22.22384470752171, -14.378827345367323, -5.419175460981329, 9.261787140548336, 42.684841598443974, -11.303186931576498], "policy_predator_policy_reward": [-6.234164967455339, -19.225664611669504, -8.632865621412705, 12.070364850132037, -23.827924578964605, 5.8192177052051335, -16.29676073994998, -13.908776081370618, 16.98915081122014, -15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067, -23.674376377167906, -11.237689610637396, -6.705451854561142, -15.345262908352922, -5.7536252001763195, -18.539686315875038, -10.925593376645118, 5.77050803825956, -16.424154737221514, -23.247413320286533, 5.783312925248932, 3.5062471278733582, 2.102604695841153, -34.0259200104965, -13.488906189370837, -31.34525313780361, -19.92384397772549, -35.55605817141755, -16.406523337159967, -7.945171871144943, -34.586117366593825, 6.186123837152181, -11.728139567131088, 9.777044908099333, -4.907717813098468, -39.76120238050918, -33.613257756633466, 10.293220380705662, -24.185318334058017, -12.02217535596742, -11.118439821318326, 18.00417086969328, 9.458223744033102, 8.430013115859218, 7.671597299479544, 20.207450726393084, 2.9974396870273945, -0.9896579338033398, 15.373420554114865, -5.113753617320809, -14.777155833377886, 25.520081399939084, -17.40543804183163, -27.44204124884839, -12.050418631975212, -12.291564486124884, -12.790024157349855, -22.22384470752171, 14.378827345367323, 5.419175460981329, -9.261787140548336, -42.684841598443974, 11.303186931576498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794028241774573, "mean_inference_ms": 0.9170881350910269, "mean_action_processing_ms": 0.12492448216336849, "mean_env_wait_ms": 0.06117508405033233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028524398803710938, "StateBufferConnector_ms": 0.0022230148315429688, "ViewRequirementAgentConnector_ms": 0.05330491065979004}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.0606076174433, "num_env_steps_trained_throughput_per_sec": 517.0606076174433, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 5500.946, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5500.901, "sample_time_ms": 673.814, "learn_time_ms": 4814.006, "learn_throughput": 830.909, "synch_weights_time_ms": 12.621}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 198, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-17-09", "timestamp": 1723346229, "time_this_iter_s": 7.780501842498779, "time_total_s": 1006.617086648941, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7326ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1006.617086648941, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 64.16363636363637, "ram_util_percent": 81.97272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.158763620940348, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.232249886294206, "policy_loss": -0.0055777506774272, "vf_loss": 4.237827641765277, "vf_explained_var": 0.010533766634762288, "kl": 0.010059485436374442, "entropy": 0.6255597149332365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.458175052019457, "cur_kl_coeff": 0.10274726682146135, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0661495914061865, "policy_loss": -0.0071317463851301, "vf_loss": 3.07187968082726, "vf_explained_var": 0.34951126935581367, "kl": 0.01364192786237115, "entropy": 1.0942044044534365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.13, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38813, "policy_reward_min": {"prey_policy": -25.520081399939084, "predator_policy": -42.684841598443974}, "policy_reward_max": {"prey_policy": 42.684841598443974, "predator_policy": 25.520081399939084}, "policy_reward_mean": {"prey_policy": 10.978531204245876, "predator_policy": -10.978531204245876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [15.86814734436323, 19.531999856483903, 17.62031417376103, -4.2113656876788355, 6.660782461035275, 10.016914663692305, 17.040273299144786, -1.6281168889945477, 15.249834910561649, 10.654501145152828, 21.26090481302645, 13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067, 23.674376377167906, 11.237689610637396, 6.705451854561142, 15.345262908352922, 5.7536252001763195, 18.539686315875038, 10.925593376645118, -5.77050803825956, 16.424154737221514, 23.247413320286533, -5.783312925248932, -3.5062471278733582, -2.102604695841153, 34.0259200104965, 13.488906189370837, 31.34525313780361, 19.92384397772549, 35.55605817141755, 16.406523337159967, 7.945171871144943, 34.586117366593825, -6.186123837152181, 11.728139567131088, -9.777044908099333, 4.907717813098468, 39.76120238050918, 33.613257756633466, -10.293220380705662, 24.185318334058017, 12.02217535596742, 11.118439821318326, -18.00417086969328, -9.458223744033102, -8.430013115859218, -7.671597299479544, -20.207450726393084, -2.9974396870273945, 0.9896579338033398, -15.373420554114865, 5.113753617320809, 14.777155833377886, -25.520081399939084, 17.40543804183163, 27.44204124884839, 12.050418631975212, 12.291564486124884, 12.790024157349855, 22.22384470752171, -14.378827345367323, -5.419175460981329, 9.261787140548336, 42.684841598443974, -11.303186931576498, 32.85726018024369, 16.094287291392916, 7.592967382387393, 14.554481892955888, 5.243813543246361, 9.180153287706585, 12.688182684823573, 25.220037711856307, 0.22977162767355708], "policy_predator_policy_reward": [-15.86814734436323, -19.531999856483903, -17.62031417376103, 4.2113656876788355, -6.660782461035275, -10.016914663692305, -17.040273299144786, 1.6281168889945477, -15.249834910561649, -10.654501145152828, -21.26090481302645, -13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067, -23.674376377167906, -11.237689610637396, -6.705451854561142, -15.345262908352922, -5.7536252001763195, -18.539686315875038, -10.925593376645118, 5.77050803825956, -16.424154737221514, -23.247413320286533, 5.783312925248932, 3.5062471278733582, 2.102604695841153, -34.0259200104965, -13.488906189370837, -31.34525313780361, -19.92384397772549, -35.55605817141755, -16.406523337159967, -7.945171871144943, -34.586117366593825, 6.186123837152181, -11.728139567131088, 9.777044908099333, -4.907717813098468, -39.76120238050918, -33.613257756633466, 10.293220380705662, -24.185318334058017, -12.02217535596742, -11.118439821318326, 18.00417086969328, 9.458223744033102, 8.430013115859218, 7.671597299479544, 20.207450726393084, 2.9974396870273945, -0.9896579338033398, 15.373420554114865, -5.113753617320809, -14.777155833377886, 25.520081399939084, -17.40543804183163, -27.44204124884839, -12.050418631975212, -12.291564486124884, -12.790024157349855, -22.22384470752171, 14.378827345367323, 5.419175460981329, -9.261787140548336, -42.684841598443974, 11.303186931576498, -32.85726018024369, -16.094287291392916, -7.592967382387393, -14.554481892955888, -5.243813543246361, -9.180153287706585, -12.688182684823573, -25.220037711856307, -0.22977162767355708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794245322786843, "mean_inference_ms": 0.9171784533527712, "mean_action_processing_ms": 0.12493553702746253, "mean_env_wait_ms": 0.06118262171137881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002814173698425293, "StateBufferConnector_ms": 0.002184748649597168, "ViewRequirementAgentConnector_ms": 0.05428588390350342}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.3496974710613, "num_env_steps_trained_throughput_per_sec": 742.3496974710613, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 1592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1592000, "timers": {"training_iteration_time_ms": 5540.374, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5540.33, "sample_time_ms": 684.805, "learn_time_ms": 4842.473, "learn_throughput": 826.024, "synch_weights_time_ms": 12.589}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "done": false, "training_iteration": 199, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-17-14", "timestamp": 1723346234, "time_this_iter_s": 5.390824794769287, "time_total_s": 1012.0079114437103, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b7326f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1012.0079114437103, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 41.25714285714286, "ram_util_percent": 80.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.855092216158907, "cur_kl_coeff": 2.3200453142635523e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.711240271727244, "policy_loss": -0.008095047124273454, "vf_loss": 4.719335322330395, "vf_explained_var": 0.39778639320284126, "kl": 0.016210405042623912, "entropy": 0.6473477991918722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.629212732364734, "cur_kl_coeff": 0.10274726682146135, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.490201133241256, "policy_loss": -0.006001306425120371, "vf_loss": 4.495434641341368, "vf_explained_var": -0.3017997868359089, "kl": 0.007472654082427728, "entropy": 1.0743341563269495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.13, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38813, "policy_reward_min": {"prey_policy": -34.74093675800776, "predator_policy": -42.684841598443974}, "policy_reward_max": {"prey_policy": 42.684841598443974, "predator_policy": 34.74093675800776}, "policy_reward_mean": {"prey_policy": 9.96510003804135, "predator_policy": -9.96510003804135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [13.057068588093191, 13.19579262893393, 11.81564564880636, 28.35290130483743, 11.191823741548689, 7.7071759596991996, 23.5593733036268, 9.664775630695985, 28.190570837920085, 8.378192384732692, -6.534388095835624, 28.353088846244916, 10.253153091664178, 10.848074125158316, 11.990562942782645, -11.243970688277287, 12.92084012655394, 30.8007852517068, 20.05118585945831, 20.852190071532416, 0.793806035974292, -6.338368049588176, 15.356177702488509, 24.034072671803834, 21.363357796647506, 20.952457423110186, 29.24645245058067, 23.674376377167906, 11.237689610637396, 6.705451854561142, 15.345262908352922, 5.7536252001763195, 18.539686315875038, 10.925593376645118, -5.77050803825956, 16.424154737221514, 23.247413320286533, -5.783312925248932, -3.5062471278733582, -2.102604695841153, 34.0259200104965, 13.488906189370837, 31.34525313780361, 19.92384397772549, 35.55605817141755, 16.406523337159967, 7.945171871144943, 34.586117366593825, -6.186123837152181, 11.728139567131088, -9.777044908099333, 4.907717813098468, 39.76120238050918, 33.613257756633466, -10.293220380705662, 24.185318334058017, 12.02217535596742, 11.118439821318326, -18.00417086969328, -9.458223744033102, -8.430013115859218, -7.671597299479544, -20.207450726393084, -2.9974396870273945, 0.9896579338033398, -15.373420554114865, 5.113753617320809, 14.777155833377886, -25.520081399939084, 17.40543804183163, 27.44204124884839, 12.050418631975212, 12.291564486124884, 12.790024157349855, 22.22384470752171, -14.378827345367323, -5.419175460981329, 9.261787140548336, 42.684841598443974, -11.303186931576498, 32.85726018024369, 16.094287291392916, 7.592967382387393, 14.554481892955888, 5.243813543246361, 9.180153287706585, 12.688182684823573, 25.220037711856307, 0.22977162767355708, 9.41874562163256, -0.5779143181609427, 0.04389445327274899, 9.633314173151618, 9.454829628668818, 34.10217160763978, -8.00728372565921, 2.8655110241465636, 7.806844427981488, -34.74093675800776, -3.278102664570678], "policy_predator_policy_reward": [-13.057068588093191, -13.19579262893393, -11.81564564880636, -28.35290130483743, -11.191823741548689, -7.7071759596991996, -23.5593733036268, -9.664775630695985, -28.190570837920085, -8.378192384732692, 6.534388095835624, -28.353088846244916, -10.253153091664178, -10.848074125158316, -11.990562942782645, 11.243970688277287, -12.92084012655394, -30.8007852517068, -20.05118585945831, -20.852190071532416, -0.793806035974292, 6.338368049588176, -15.356177702488509, -24.034072671803834, -21.363357796647506, -20.952457423110186, -29.24645245058067, -23.674376377167906, -11.237689610637396, -6.705451854561142, -15.345262908352922, -5.7536252001763195, -18.539686315875038, -10.925593376645118, 5.77050803825956, -16.424154737221514, -23.247413320286533, 5.783312925248932, 3.5062471278733582, 2.102604695841153, -34.0259200104965, -13.488906189370837, -31.34525313780361, -19.92384397772549, -35.55605817141755, -16.406523337159967, -7.945171871144943, -34.586117366593825, 6.186123837152181, -11.728139567131088, 9.777044908099333, -4.907717813098468, -39.76120238050918, -33.613257756633466, 10.293220380705662, -24.185318334058017, -12.02217535596742, -11.118439821318326, 18.00417086969328, 9.458223744033102, 8.430013115859218, 7.671597299479544, 20.207450726393084, 2.9974396870273945, -0.9896579338033398, 15.373420554114865, -5.113753617320809, -14.777155833377886, 25.520081399939084, -17.40543804183163, -27.44204124884839, -12.050418631975212, -12.291564486124884, -12.790024157349855, -22.22384470752171, 14.378827345367323, 5.419175460981329, -9.261787140548336, -42.684841598443974, 11.303186931576498, -32.85726018024369, -16.094287291392916, -7.592967382387393, -14.554481892955888, -5.243813543246361, -9.180153287706585, -12.688182684823573, -25.220037711856307, -0.22977162767355708, -9.41874562163256, 0.5779143181609427, -0.04389445327274899, -9.633314173151618, -9.454829628668818, -34.10217160763978, 8.00728372565921, -2.8655110241465636, -7.806844427981488, 34.74093675800776, 3.278102664570678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.279467477278439, "mean_inference_ms": 0.9168210904263266, "mean_action_processing_ms": 0.12492723166413602, "mean_env_wait_ms": 0.06119730218395196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002791762351989746, "StateBufferConnector_ms": 0.002128124237060547, "ViewRequirementAgentConnector_ms": 0.05372273921966553}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 762.5484927009772, "num_env_steps_trained_throughput_per_sec": 762.5484927009772, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 5544.909, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5544.866, "sample_time_ms": 667.864, "learn_time_ms": 4863.892, "learn_throughput": 822.387, "synch_weights_time_ms": 12.648}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 200, "trial_id": "d0b8b_00000", "date": "2024-08-10_23-17-20", "timestamp": 1723346240, "time_this_iter_s": 5.248914003372192, "time_total_s": 1017.2568254470825, "pid": 23838, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 400, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b713c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1017.2568254470825, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 32.2875, "ram_util_percent": 80.6625}}
