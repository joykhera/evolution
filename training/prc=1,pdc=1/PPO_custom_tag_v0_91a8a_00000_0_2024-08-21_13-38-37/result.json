{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1884674018248915, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.662275818983714, "policy_loss": -0.017522936499153728, "vf_loss": 7.6781841258207955, "vf_explained_var": 0.015396045334637166, "kl": 0.008073098193320524, "entropy": 1.6024828440199295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7757600289924691, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.716085763772329, "policy_loss": -0.013946552354900632, "vf_loss": 5.728760257860025, "vf_explained_var": 0.007537169257799784, "kl": 0.006360315960773732, "entropy": 1.6057499500612418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.98336760722714, "num_env_steps_trained_throughput_per_sec": 138.98336760722714, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 28780.436, "restore_workers_time_ms": 0.042, "training_step_time_ms": 28780.324, "sample_time_ms": 3796.467, "learn_time_ms": 24965.472, "learn_throughput": 160.221, "synch_weights_time_ms": 13.485}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "91a8a_00000", "date": "2024-08-21_13-53-10", "timestamp": 1724228590, "time_this_iter_s": 28.81731414794922, "time_total_s": 28.81731414794922, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb613a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.81731414794922, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.43809523809524, "ram_util_percent": 83.52142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2769071105246743, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.931058950722218, "policy_loss": -0.02158425993839046, "vf_loss": 5.9509843831261, "vf_explained_var": 0.09354912179211776, "kl": 0.008294124810345239, "entropy": 1.593197066957752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8712314277887345, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.4394382017354173, "policy_loss": -0.020264073729049415, "vf_loss": 3.457761385291815, "vf_explained_var": 0.07219808182368675, "kl": 0.009704441114809014, "entropy": 1.5950787893186014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.99427384020407, "num_env_steps_trained_throughput_per_sec": 153.99427384020407, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 27377.737, "restore_workers_time_ms": 0.091, "training_step_time_ms": 27377.372, "sample_time_ms": 2905.0, "learn_time_ms": 24449.264, "learn_throughput": 163.604, "synch_weights_time_ms": 18.964}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "91a8a_00000", "date": "2024-08-21_13-53-39", "timestamp": 1724228619, "time_this_iter_s": 26.01972794532776, "time_total_s": 54.83704209327698, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae885670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.83704209327698, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.675, "ram_util_percent": 83.0675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3611403920377296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.750888676941395, "policy_loss": -0.01795712501188973, "vf_loss": 5.767057580749194, "vf_explained_var": 0.17453752451886734, "kl": 0.008941144534037448, "entropy": 1.5859510655204454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8391394317150116, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.190961308404803, "policy_loss": -0.019853497805888763, "vf_loss": 2.2093656059354543, "vf_explained_var": 0.0804010486851136, "kl": 0.007246005832106069, "entropy": 1.5921093832701445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.52876086126923, "num_env_steps_trained_throughput_per_sec": 154.52876086126923, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 26880.221, "restore_workers_time_ms": 0.07, "training_step_time_ms": 26879.925, "sample_time_ms": 2616.844, "learn_time_ms": 24233.783, "learn_throughput": 165.059, "synch_weights_time_ms": 25.198}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "91a8a_00000", "date": "2024-08-21_13-54-05", "timestamp": 1724228645, "time_this_iter_s": 25.932249069213867, "time_total_s": 80.76929116249084, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb489d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.76929116249084, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 34.62972972972973, "ram_util_percent": 83.2810810810811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.888290344675382, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.863034358123938, "policy_loss": -0.027861431289541844, "vf_loss": 5.888708468278249, "vf_explained_var": 0.22265643669913213, "kl": 0.010936581152054713, "entropy": 1.572849091887474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6189266938095292, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.931443885465463, "policy_loss": -0.02035997535082667, "vf_loss": 1.9503931587561965, "vf_explained_var": 0.10839523275693258, "kl": 0.0070534616124253565, "entropy": 1.5842926546931266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.7615364231938, "num_env_steps_trained_throughput_per_sec": 153.7615364231938, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 26663.752, "restore_workers_time_ms": 0.059, "training_step_time_ms": 26663.508, "sample_time_ms": 2539.105, "learn_time_ms": 24099.048, "learn_throughput": 165.982, "synch_weights_time_ms": 21.976}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "91a8a_00000", "date": "2024-08-21_13-54-31", "timestamp": 1724228671, "time_this_iter_s": 26.059040069580078, "time_total_s": 106.82833123207092, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb990d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.82833123207092, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.727027027027034, "ram_util_percent": 83.16486486486485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.264043297308187, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.609056147933006, "policy_loss": -0.026657786261300012, "vf_loss": 6.632918971280257, "vf_explained_var": 0.2440630798538526, "kl": 0.013974804158109085, "entropy": 1.5718118210633596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.747070709336549, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.3106138267864784, "policy_loss": -0.022222858448124803, "vf_loss": 1.3313376676291226, "vf_explained_var": 0.08388410452753306, "kl": 0.007495087355346186, "entropy": 1.5791629439840713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.5052500179526, "num_env_steps_trained_throughput_per_sec": 156.5052500179526, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 26442.653, "restore_workers_time_ms": 0.05, "training_step_time_ms": 26442.43, "sample_time_ms": 2425.918, "learn_time_ms": 23988.279, "learn_throughput": 166.748, "synch_weights_time_ms": 24.724}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "91a8a_00000", "date": "2024-08-21_13-54-56", "timestamp": 1724228696, "time_this_iter_s": 25.613444805145264, "time_total_s": 132.4417760372162, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb999d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.4417760372162, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.51666666666668, "ram_util_percent": 83.27222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.083541371487081, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.730326487123966, "policy_loss": -0.02511780051572714, "vf_loss": 6.752309294044972, "vf_explained_var": 0.4791796644528707, "kl": 0.015675049785446996, "entropy": 1.5647767819464207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2667156339933474, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.577719443105161, "policy_loss": -0.02474122410300576, "vf_loss": 1.6005287922918796, "vf_explained_var": 0.09470161547263463, "kl": 0.009659368018765236, "entropy": 1.5678663461158673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 274.9, "episode_reward_min": 274.9, "episode_reward_mean": 274.9, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 400, "policy_reward_min": {"prey_policy": 187.83045546480582, "predator_policy": 87.06954453519404}, "policy_reward_max": {"prey_policy": 187.83045546480582, "predator_policy": 87.06954453519404}, "policy_reward_mean": {"prey_policy": 187.83045546480582, "predator_policy": 87.06954453519404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9], "episode_lengths": [400], "policy_prey_policy_reward": [187.83045546480582], "policy_predator_policy_reward": [87.06954453519404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4695587765638995, "mean_inference_ms": 3.595086115940361, "mean_action_processing_ms": 0.6509704954305272, "mean_env_wait_ms": 9.425023558792795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027179718017578125, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.05252361297607422}, "num_episodes": 1, "episode_return_max": 274.9, "episode_return_min": 274.9, "episode_return_mean": 274.9, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.39742076260185, "num_env_steps_trained_throughput_per_sec": 157.39742076260185, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 26271.112, "restore_workers_time_ms": 0.045, "training_step_time_ms": 26270.912, "sample_time_ms": 2350.278, "learn_time_ms": 23893.408, "learn_throughput": 167.41, "synch_weights_time_ms": 23.656}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "91a8a_00000", "date": "2024-08-21_13-55-22", "timestamp": 1724228722, "time_this_iter_s": 25.46395182609558, "time_total_s": 157.90572786331177, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb99670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.90572786331177, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.308333333333337, "ram_util_percent": 83.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.951680470630526, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.0784182275335, "policy_loss": -0.021373634165502153, "vf_loss": 7.097452992200852, "vf_explained_var": 0.3249433241784573, "kl": 0.011694375602140402, "entropy": 1.5566158759097257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2858383540684977, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.655961112988492, "policy_loss": -0.02613169867642379, "vf_loss": 1.6799115990288556, "vf_explained_var": 0.11507116133968036, "kl": 0.010906081773767558, "entropy": 1.5580052354683478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 175.24468085106375, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 18800, "policy_reward_min": {"prey_policy": -514.5017219222912, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 531.7017219222931}, "policy_reward_mean": {"prey_policy": 47.15189774300285, "predator_policy": 128.09278310806093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9, 222.1999999999997, 65.60000000000035, 230.70000000000022, 334.8999999999999, 93.70000000000019, 286.2, 34.800000000000225, 325.4999999999999, 209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.83045546480582, 148.98143408587188, 51.390720774193326, 220.5658881028413, 312.7252919995907, 71.2077536158944, 53.14311815808871, -56.032663442577345, 269.4168810746786, 22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222], "policy_predator_policy_reward": [87.06954453519404, 73.2185659141283, 14.209279225807125, 10.134111897158869, 22.17470800040925, 22.49224638410554, 233.0568818419112, 90.83266344257609, 56.0831189253214, 186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6106807053829, "mean_inference_ms": 3.371260689824862, "mean_action_processing_ms": 0.7812063682515563, "mean_env_wait_ms": 9.429545981336464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026817017413200217, "StateBufferConnector_ms": 0.00403460035932825, "ViewRequirementAgentConnector_ms": 0.10069811597783515}, "num_episodes": 46, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 175.24468085106375, "episodes_this_iter": 46}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.7226069973462, "num_env_steps_trained_throughput_per_sec": 159.7226069973462, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 26095.728, "restore_workers_time_ms": 0.04, "training_step_time_ms": 26095.547, "sample_time_ms": 2274.166, "learn_time_ms": 23793.627, "learn_throughput": 168.112, "synch_weights_time_ms": 24.597}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "91a8a_00000", "date": "2024-08-21_13-55-47", "timestamp": 1724228747, "time_this_iter_s": 25.06167507171631, "time_total_s": 182.96740293502808, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb995e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 182.96740293502808, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.060000000000002, "ram_util_percent": 82.46571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.34209945568194, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.6848932151993115, "policy_loss": -0.02540688034350751, "vf_loss": 7.7079654405514395, "vf_explained_var": 0.41053701378405094, "kl": 0.011673385401566823, "entropy": 1.5190027501434087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999999}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.435902918688953, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.233876171708107, "policy_loss": -0.02863971730500149, "vf_loss": 4.259371401121219, "vf_explained_var": 0.12834700209399064, "kl": 0.015722410545519476, "entropy": 1.5113210614770651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999999}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 189.95972222222218, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -514.5017219222912, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 531.7017219222931}, "policy_reward_mean": {"prey_policy": 70.75594857987727, "predator_policy": 119.20377364234491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9, 222.1999999999997, 65.60000000000035, 230.70000000000022, 334.8999999999999, 93.70000000000019, 286.2, 34.800000000000225, 325.4999999999999, 209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.83045546480582, 148.98143408587188, 51.390720774193326, 220.5658881028413, 312.7252919995907, 71.2077536158944, 53.14311815808871, -56.032663442577345, 269.4168810746786, 22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789], "policy_predator_policy_reward": [87.06954453519404, 73.2185659141283, 14.209279225807125, 10.134111897158869, 22.17470800040925, 22.49224638410554, 233.0568818419112, 90.83266344257609, 56.0831189253214, 186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5812913671089848, "mean_inference_ms": 3.3369213449202113, "mean_action_processing_ms": 0.772141373051013, "mean_env_wait_ms": 9.410891469948055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020503666665818956, "StateBufferConnector_ms": 0.003852281305525038, "ViewRequirementAgentConnector_ms": 0.08919090032577515}, "num_episodes": 25, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 189.95972222222218, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.93239129211574, "num_env_steps_trained_throughput_per_sec": 155.93239129211574, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 26040.282, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26040.117, "sample_time_ms": 2210.853, "learn_time_ms": 23803.29, "learn_throughput": 168.044, "synch_weights_time_ms": 23.086}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "91a8a_00000", "date": "2024-08-21_13-56-13", "timestamp": 1724228773, "time_this_iter_s": 25.695268154144287, "time_total_s": 208.66267108917236, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae885430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 208.66267108917236, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.133333333333333, "ram_util_percent": 83.03333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.365562945976853, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.845824241141478, "policy_loss": -0.027615801995367898, "vf_loss": 7.8710521966218945, "vf_explained_var": 0.30303800329566, "kl": 0.011939191119745373, "entropy": 1.5231151821712652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7417080596089365, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.040712034702301, "policy_loss": -0.02224696708362899, "vf_loss": 4.060465986778339, "vf_explained_var": 0.11526217038432757, "kl": 0.012465072066697757, "entropy": 1.5001085499922435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 189.95972222222218, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -514.5017219222912, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 531.7017219222931}, "policy_reward_mean": {"prey_policy": 70.75594857987727, "predator_policy": 119.20377364234491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9, 222.1999999999997, 65.60000000000035, 230.70000000000022, 334.8999999999999, 93.70000000000019, 286.2, 34.800000000000225, 325.4999999999999, 209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.83045546480582, 148.98143408587188, 51.390720774193326, 220.5658881028413, 312.7252919995907, 71.2077536158944, 53.14311815808871, -56.032663442577345, 269.4168810746786, 22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789], "policy_predator_policy_reward": [87.06954453519404, 73.2185659141283, 14.209279225807125, 10.134111897158869, 22.17470800040925, 22.49224638410554, 233.0568818419112, 90.83266344257609, 56.0831189253214, 186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5812913671089848, "mean_inference_ms": 3.3369213449202113, "mean_action_processing_ms": 0.772141373051013, "mean_env_wait_ms": 9.410891469948055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020503666665818956, "StateBufferConnector_ms": 0.003852281305525038, "ViewRequirementAgentConnector_ms": 0.08919090032577515}, "num_episodes": 0, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 189.95972222222218, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.4518386849834, "num_env_steps_trained_throughput_per_sec": 159.4518386849834, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 25934.251, "restore_workers_time_ms": 0.035, "training_step_time_ms": 25934.045, "sample_time_ms": 2156.187, "learn_time_ms": 23752.005, "learn_throughput": 168.407, "synch_weights_time_ms": 23.055}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "91a8a_00000", "date": "2024-08-21_13-56-38", "timestamp": 1724228798, "time_this_iter_s": 25.098868131637573, "time_total_s": 233.76153922080994, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3067b4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 233.76153922080994, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.68611111111111, "ram_util_percent": 83.16944444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.80738857164979, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.799841662247975, "policy_loss": -0.023213026125449687, "vf_loss": 7.820601776242256, "vf_explained_var": 0.2630719451854626, "kl": 0.012264524233857325, "entropy": 1.5213689683626095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.914452181818585, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.512736969689528, "policy_loss": -0.02485326019814238, "vf_loss": 3.534733037650585, "vf_explained_var": 0.14907217646638551, "kl": 0.014285971546390405, "entropy": 1.4806045425434908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 189.95972222222218, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -514.5017219222912, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 531.7017219222931}, "policy_reward_mean": {"prey_policy": 70.75594857987727, "predator_policy": 119.20377364234491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9, 222.1999999999997, 65.60000000000035, 230.70000000000022, 334.8999999999999, 93.70000000000019, 286.2, 34.800000000000225, 325.4999999999999, 209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.83045546480582, 148.98143408587188, 51.390720774193326, 220.5658881028413, 312.7252919995907, 71.2077536158944, 53.14311815808871, -56.032663442577345, 269.4168810746786, 22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789], "policy_predator_policy_reward": [87.06954453519404, 73.2185659141283, 14.209279225807125, 10.134111897158869, 22.17470800040925, 22.49224638410554, 233.0568818419112, 90.83266344257609, 56.0831189253214, 186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5812913671089848, "mean_inference_ms": 3.3369213449202113, "mean_action_processing_ms": 0.772141373051013, "mean_env_wait_ms": 9.410891469948055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020503666665818956, "StateBufferConnector_ms": 0.003852281305525038, "ViewRequirementAgentConnector_ms": 0.08919090032577515}, "num_episodes": 0, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 189.95972222222218, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.7149206518852, "num_env_steps_trained_throughput_per_sec": 161.7149206518852, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 25814.336, "restore_workers_time_ms": 0.033, "training_step_time_ms": 25814.086, "sample_time_ms": 2119.714, "learn_time_ms": 23668.493, "learn_throughput": 169.001, "synch_weights_time_ms": 23.034}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "91a8a_00000", "date": "2024-08-21_13-57-03", "timestamp": 1724228823, "time_this_iter_s": 24.77683186531067, "time_total_s": 258.5383710861206, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aebba0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 258.5383710861206, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.231428571428573, "ram_util_percent": 83.0657142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.576740903407336, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.938065335154533, "policy_loss": -0.022440675389467892, "vf_loss": 7.95748071372509, "vf_explained_var": 0.3217535565296809, "kl": 0.015126372019100625, "entropy": 1.5136604902644952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.365361580811441, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.9772939744095006, "policy_loss": -0.02402032994480881, "vf_loss": 3.9988596151272455, "vf_explained_var": 0.17599606091777484, "kl": 0.012273398088291287, "entropy": 1.462539754062891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 189.95972222222218, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -514.5017219222912, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 531.7017219222931}, "policy_reward_mean": {"prey_policy": 70.75594857987727, "predator_policy": 119.20377364234491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9, 222.1999999999997, 65.60000000000035, 230.70000000000022, 334.8999999999999, 93.70000000000019, 286.2, 34.800000000000225, 325.4999999999999, 209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.83045546480582, 148.98143408587188, 51.390720774193326, 220.5658881028413, 312.7252919995907, 71.2077536158944, 53.14311815808871, -56.032663442577345, 269.4168810746786, 22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789], "policy_predator_policy_reward": [87.06954453519404, 73.2185659141283, 14.209279225807125, 10.134111897158869, 22.17470800040925, 22.49224638410554, 233.0568818419112, 90.83266344257609, 56.0831189253214, 186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5812913671089848, "mean_inference_ms": 3.3369213449202113, "mean_action_processing_ms": 0.772141373051013, "mean_env_wait_ms": 9.410891469948055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020503666665818956, "StateBufferConnector_ms": 0.003852281305525038, "ViewRequirementAgentConnector_ms": 0.08919090032577515}, "num_episodes": 0, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 189.95972222222218, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.5136308582431, "num_env_steps_trained_throughput_per_sec": 158.5136308582431, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 25459.738, "restore_workers_time_ms": 0.032, "training_step_time_ms": 25459.492, "sample_time_ms": 1924.798, "learn_time_ms": 23509.284, "learn_throughput": 170.146, "synch_weights_time_ms": 22.996}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "91a8a_00000", "date": "2024-08-21_13-57-28", "timestamp": 1724228848, "time_this_iter_s": 25.25794005393982, "time_total_s": 283.7963111400604, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30678aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 283.7963111400604, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.27222222222222, "ram_util_percent": 82.88055555555553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.681942516130706, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.851061543822288, "policy_loss": -0.020343450144961632, "vf_loss": 7.8692425007621445, "vf_explained_var": 0.3446598282704751, "kl": 0.010812459310788352, "entropy": 1.5175929129123689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.886452122280995, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.4329703266421956, "policy_loss": -0.02284600831796221, "vf_loss": 3.4529156371951104, "vf_explained_var": 0.20162136877576511, "kl": 0.014503532884797702, "entropy": 1.4563457536200681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 189.95972222222218, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -514.5017219222912, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 531.7017219222931}, "policy_reward_mean": {"prey_policy": 70.75594857987727, "predator_policy": 119.20377364234491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9, 222.1999999999997, 65.60000000000035, 230.70000000000022, 334.8999999999999, 93.70000000000019, 286.2, 34.800000000000225, 325.4999999999999, 209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.83045546480582, 148.98143408587188, 51.390720774193326, 220.5658881028413, 312.7252919995907, 71.2077536158944, 53.14311815808871, -56.032663442577345, 269.4168810746786, 22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789], "policy_predator_policy_reward": [87.06954453519404, 73.2185659141283, 14.209279225807125, 10.134111897158869, 22.17470800040925, 22.49224638410554, 233.0568818419112, 90.83266344257609, 56.0831189253214, 186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5812913671089848, "mean_inference_ms": 3.3369213449202113, "mean_action_processing_ms": 0.772141373051013, "mean_env_wait_ms": 9.410891469948055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020503666665818956, "StateBufferConnector_ms": 0.003852281305525038, "ViewRequirementAgentConnector_ms": 0.08919090032577515}, "num_episodes": 0, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 189.95972222222218, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.1700533462682, "num_env_steps_trained_throughput_per_sec": 152.1700533462682, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 25490.874, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25490.621, "sample_time_ms": 2006.292, "learn_time_ms": 23458.055, "learn_throughput": 170.517, "synch_weights_time_ms": 23.779}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "91a8a_00000", "date": "2024-08-21_13-57-54", "timestamp": 1724228874, "time_this_iter_s": 26.32352590560913, "time_total_s": 310.11983704566956, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306784f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 310.11983704566956, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 32.13243243243243, "ram_util_percent": 83.14324324324325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.309426895653209, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.356396664679051, "policy_loss": -0.01689935010872432, "vf_loss": 7.371003720164299, "vf_explained_var": 0.40891422194739185, "kl": 0.011461298723103634, "entropy": 1.498600608110428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.951944510949155, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.7845005239049594, "policy_loss": -0.02177029112111389, "vf_loss": 3.8036065394679706, "vf_explained_var": 0.22107562267531952, "kl": 0.013321385930854983, "entropy": 1.4383512318134308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 190.57441860465119, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 34400, "policy_reward_min": {"prey_policy": -661.8422854141577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 696.842285414159}, "policy_reward_mean": {"prey_policy": 47.89417292284796, "predator_policy": 142.68024568180317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.9, 222.1999999999997, 65.60000000000035, 230.70000000000022, 334.8999999999999, 93.70000000000019, 286.2, 34.800000000000225, 325.4999999999999, 209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.83045546480582, 148.98143408587188, 51.390720774193326, 220.5658881028413, 312.7252919995907, 71.2077536158944, 53.14311815808871, -56.032663442577345, 269.4168810746786, 22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658], "policy_predator_policy_reward": [87.06954453519404, 73.2185659141283, 14.209279225807125, 10.134111897158869, 22.17470800040925, 22.49224638410554, 233.0568818419112, 90.83266344257609, 56.0831189253214, 186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.572012498005546, "mean_inference_ms": 3.3088610188545955, "mean_action_processing_ms": 0.7892107930779361, "mean_env_wait_ms": 9.37486068762892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017708955809127454, "StateBufferConnector_ms": 0.0036442002584767897, "ViewRequirementAgentConnector_ms": 0.0829747942991035}, "num_episodes": 14, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 190.57441860465119, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.91663789951457, "num_env_steps_trained_throughput_per_sec": 157.91663789951457, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 25435.34, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25435.095, "sample_time_ms": 2006.139, "learn_time_ms": 23404.664, "learn_throughput": 170.906, "synch_weights_time_ms": 21.923}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "91a8a_00000", "date": "2024-08-21_13-58-20", "timestamp": 1724228900, "time_this_iter_s": 25.37937903404236, "time_total_s": 335.4992160797119, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aebb0430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 335.4992160797119, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 27.38333333333333, "ram_util_percent": 83.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.28390025322636, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.761268949508667, "policy_loss": -0.024524146207234785, "vf_loss": 7.782646803557872, "vf_explained_var": 0.3738888865336776, "kl": 0.015731593136539837, "entropy": 1.459995303923885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.468750706066688, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.617732498794794, "policy_loss": -0.015574637907169139, "vf_loss": 4.6305438235402105, "vf_explained_var": 0.24786047668506703, "kl": 0.013816609025525395, "entropy": 1.4045750223100186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 396.20000000000005, "episode_reward_min": 16.499999999999964, "episode_reward_mean": 199.09699999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -661.8422854141577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.75714820538144, "predator_policy": 726.1781219863992}, "policy_reward_mean": {"prey_policy": 31.513603856280206, "predator_policy": 167.58339614371968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.2, 294.7, 396.20000000000005, 169.10000000000002, 222.00000000000006, 30.500000000000163, 76.40000000000015, 84.39999999999887, 251.80000000000004, 349.6, 306.8, 232.29999999999973, 36.00000000000024, 44.30000000000023, 193.89999999999998, 323.7999999999999, 168.39999999999998, 94.89999999999847, 17.199999999999974, 298.79999999999995, 216.79999999999893, 315.0, 34.60000000000022, 50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [22.329826312617826, 220.05993739209714, 394.75714820538144, 89.47721937127298, -19.723151065004345, -188.9575859070373, 7.409580400581888, -187.01982353581067, 109.94746622171434, 243.6819636158791, 157.7310990605273, 66.97981399364423, -13.027848048317368, -351.2409762027295, -33.074069518729004, 316.09339546444176, -47.8729501509242, 0.48238883458094095, -514.5017219222912, 294.89495109485614, 179.9521342993379, 52.37501135134298, -69.68051212565997, 50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383], "policy_predator_policy_reward": [186.87017368738162, 74.6400626079028, 1.4428517946186055, 79.62278062872667, 241.72315106500395, 219.45758590703556, 68.99041959941808, 271.41982353580937, 141.85253377828502, 105.91803638412071, 149.06890093947257, 165.32018600635524, 49.027848048317644, 395.54097620273154, 226.97406951872887, 7.706604535558126, 216.27295015092338, 94.41761116541922, 531.7017219222931, 3.9050489051438486, 36.84786570066235, 262.62498864865694, 104.280512125658, 0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.549150207817999, "mean_inference_ms": 3.2667734540780136, "mean_action_processing_ms": 0.8098557327993023, "mean_env_wait_ms": 9.3317306912437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01567387580871582, "StateBufferConnector_ms": 0.0030983686447143555, "ViewRequirementAgentConnector_ms": 0.06338191032409668}, "num_episodes": 23, "episode_return_max": 396.20000000000005, "episode_return_min": 16.499999999999964, "episode_return_mean": 199.09699999999992, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.4705647621717, "num_env_steps_trained_throughput_per_sec": 160.4705647621717, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 25326.577, "restore_workers_time_ms": 0.017, "training_step_time_ms": 25326.331, "sample_time_ms": 1952.153, "learn_time_ms": 23348.549, "learn_throughput": 171.317, "synch_weights_time_ms": 23.231}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "91a8a_00000", "date": "2024-08-21_13-58-45", "timestamp": 1724228925, "time_this_iter_s": 24.947070121765137, "time_total_s": 360.44628620147705, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aebad0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 360.44628620147705, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.231428571428577, "ram_util_percent": 83.17714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.65040433096389, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.8362753649552666, "policy_loss": -0.02232427310567194, "vf_loss": 7.855315049489339, "vf_explained_var": 0.3034554600715637, "kl": 0.01642302209123348, "entropy": 1.4154555656015873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000005}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.3983833083262045, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.465984359880289, "policy_loss": -0.018807371219736524, "vf_loss": 5.4818688551584875, "vf_explained_var": 0.2433577025309205, "kl": 0.014614400079396243, "entropy": 1.3350041673829158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000005}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 15.099999999999962, "episode_reward_mean": 206.321, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -661.8422854141577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.7351213330469, "predator_policy": 726.1781219863992}, "policy_reward_mean": {"prey_policy": 27.119187188318307, "predator_policy": 179.20181281168166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.80000000000048, 39.20000000000029, 152.89999999999998, 204.09999999999997, 16.499999999999964, 25.30000000000009, 215.09999999999997, 44.70000000000039, 108.80000000000005, 358.4999999999999, 159.10000000000005, 86.7000000000001, 270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [50.80000000000048, 29.96107500971033, -1.920187512910303, 120.04684328318858, -434.97570545934065, -263.0255449735032, 79.3075903137538, 36.49589852691985, -15.986695214110725, 357.55678671335784, 99.71043928913345, -28.913364686093672, 235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934], "policy_predator_policy_reward": [0.0, 9.23892499028981, 154.82018751290957, 84.05315671681156, 451.47570545934315, 288.32554497350617, 135.7924096862463, 8.20410147308039, 124.78669521410949, 0.9432132866420747, 59.389560710866576, 115.613364686094, 35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5084861376927385, "mean_inference_ms": 3.1983890362448393, "mean_action_processing_ms": 0.8071784345633101, "mean_env_wait_ms": 9.288696168072962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016099214553833008, "StateBufferConnector_ms": 0.003080606460571289, "ViewRequirementAgentConnector_ms": 0.07481837272644043}, "num_episodes": 23, "episode_return_max": 393.6, "episode_return_min": 15.099999999999962, "episode_return_mean": 206.321, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.55996223937083, "num_env_steps_trained_throughput_per_sec": 160.55996223937083, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 25262.034, "restore_workers_time_ms": 0.017, "training_step_time_ms": 25261.789, "sample_time_ms": 1920.743, "learn_time_ms": 23316.941, "learn_throughput": 171.549, "synch_weights_time_ms": 21.969}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "91a8a_00000", "date": "2024-08-21_13-59-10", "timestamp": 1724228950, "time_this_iter_s": 24.96372699737549, "time_total_s": 385.41001319885254, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb48c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 385.41001319885254, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.097142857142856, "ram_util_percent": 83.21142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.639145163819194, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.988164868950844, "policy_loss": -0.029861314047593623, "vf_loss": 8.014148084819317, "vf_explained_var": 0.4127596464628975, "kl": 0.01939058986705883, "entropy": 1.3903740794708332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.441196559121211, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.939549541970094, "policy_loss": -0.018335591676198724, "vf_loss": 5.9550892601410546, "vf_explained_var": 0.23682306880752246, "kl": 0.013979331945301965, "entropy": 1.2677864991128445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 15.099999999999962, "episode_reward_mean": 216.83999999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -714.436764887958, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 800.4367648879576}, "policy_reward_mean": {"prey_policy": 7.288505265263527, "predator_policy": 209.55149473473645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8], "policy_predator_policy_reward": [35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.491103795574295, "mean_inference_ms": 3.1848325101860087, "mean_action_processing_ms": 0.7978873890873355, "mean_env_wait_ms": 9.267439233809583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02380204200744629, "StateBufferConnector_ms": 0.003084897994995117, "ViewRequirementAgentConnector_ms": 0.07488930225372314}, "num_episodes": 12, "episode_return_max": 393.6, "episode_return_min": 15.099999999999962, "episode_return_mean": 216.83999999999992, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.93818624137344, "num_env_steps_trained_throughput_per_sec": 153.93818624137344, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 25319.141, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25318.898, "sample_time_ms": 1897.72, "learn_time_ms": 23397.903, "learn_throughput": 170.955, "synch_weights_time_ms": 21.457}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "91a8a_00000", "date": "2024-08-21_13-59-36", "timestamp": 1724228976, "time_this_iter_s": 26.05357789993286, "time_total_s": 411.4635910987854, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb61c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 411.4635910987854, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 33.48648648648649, "ram_util_percent": 81.70810810810812}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.605208811412254, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.865057032306989, "policy_loss": -0.02609798463139062, "vf_loss": 7.887834266324838, "vf_explained_var": 0.42165748588740826, "kl": 0.016603786138875875, "entropy": 1.415984224031369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.326433106511832, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.1135540229578815, "policy_loss": -0.025426589733494136, "vf_loss": 5.135754176725944, "vf_explained_var": 0.2503840971117218, "kl": 0.016132231986072536, "entropy": 1.271080053349336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 15.099999999999962, "episode_reward_mean": 216.83999999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -714.436764887958, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 800.4367648879576}, "policy_reward_mean": {"prey_policy": 7.288505265263527, "predator_policy": 209.55149473473645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8], "policy_predator_policy_reward": [35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.491103795574295, "mean_inference_ms": 3.1848325101860087, "mean_action_processing_ms": 0.7978873890873355, "mean_env_wait_ms": 9.267439233809583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02380204200744629, "StateBufferConnector_ms": 0.003084897994995117, "ViewRequirementAgentConnector_ms": 0.07488930225372314}, "num_episodes": 0, "episode_return_max": 393.6, "episode_return_min": 15.099999999999962, "episode_return_mean": 216.83999999999992, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.54200030495647, "num_env_steps_trained_throughput_per_sec": 150.54200030495647, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 25471.865, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25471.607, "sample_time_ms": 1899.324, "learn_time_ms": 23548.408, "learn_throughput": 169.863, "synch_weights_time_ms": 21.773}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "91a8a_00000", "date": "2024-08-21_14-00-02", "timestamp": 1724229002, "time_this_iter_s": 26.605310201644897, "time_total_s": 438.0689013004303, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeba3ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 438.0689013004303, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.199999999999996, "ram_util_percent": 79.51315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.56686483422915, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.537771271169186, "policy_loss": -0.023226843077524487, "vf_loss": 7.558139874537786, "vf_explained_var": 0.38895172718912363, "kl": 0.014291331161318036, "entropy": 1.3887215244273345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.705323580900828, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.1494098025063675, "policy_loss": -0.022684692943585105, "vf_loss": 5.16806782434384, "vf_explained_var": 0.24383066122730573, "kl": 0.02013342922242979, "entropy": 1.2375533400724332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 15.099999999999962, "episode_reward_mean": 216.83999999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -714.436764887958, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 800.4367648879576}, "policy_reward_mean": {"prey_policy": 7.288505265263527, "predator_policy": 209.55149473473645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.79999999999995, 128.29999999999833, 140.49999999999997, 277.5, 290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [235.2253106443365, 106.1779233164544, -144.6233523049222, 169.06576468574184, 288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8], "policy_predator_policy_reward": [35.57468935566345, 22.12207668354394, 285.12335230492187, 108.43423531425773, 1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.491103795574295, "mean_inference_ms": 3.1848325101860087, "mean_action_processing_ms": 0.7978873890873355, "mean_env_wait_ms": 9.267439233809583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02380204200744629, "StateBufferConnector_ms": 0.003084897994995117, "ViewRequirementAgentConnector_ms": 0.07488930225372314}, "num_episodes": 0, "episode_return_max": 393.6, "episode_return_min": 15.099999999999962, "episode_return_mean": 216.83999999999992, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 135.34288210235442, "num_env_steps_trained_throughput_per_sec": 135.34288210235442, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 25862.109, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25861.847, "sample_time_ms": 1924.81, "learn_time_ms": 23912.557, "learn_throughput": 167.276, "synch_weights_time_ms": 22.172}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "91a8a_00000", "date": "2024-08-21_14-00-32", "timestamp": 1724229032, "time_this_iter_s": 29.609147787094116, "time_total_s": 467.6780490875244, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aebadee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 467.6780490875244, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 48.9904761904762, "ram_util_percent": 82.33809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.330614699299137, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.482923271258672, "policy_loss": -0.023627998763307307, "vf_loss": 7.503323496381442, "vf_explained_var": 0.3915810327976942, "kl": 0.01613878041243879, "entropy": 1.384640808776021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.161674918544789, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.761406031250954, "policy_loss": -0.022192026669411766, "vf_loss": 5.779431293159723, "vf_explained_var": 0.2424022993693749, "kl": 0.013889177314316234, "entropy": 1.1998846395562093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 15.099999999999962, "episode_reward_mean": 216.67400000000006, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -714.436764887958, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 800.4367648879576}, "policy_reward_mean": {"prey_policy": 0.948177505398395, "predator_policy": 215.7258224946016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.0, 34.40000000000022, 31.500000000000178, 192.09999999999997, 245.29999999999995, 189.99999999999997, 31.300000000000196, 270.59999999999997, 320.5999999999998, 383.0, 315.5, 34.800000000000225, 175.8, 108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [288.01353654700915, -44.471067376387886, -101.68764395283348, 83.75134180314777, 181.84812644946754, -104.74938998757816, -292.2024869793265, 205.676575610459, 272.6431458085587, 366.6921972112438, 223.35994401313332, -51.804058364234464, 109.05406867890711, 65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127], "policy_predator_policy_reward": [1.9864634529909173, 78.87106737638835, 133.18764395283347, 108.34865819685228, 63.45187355053248, 294.74938998757807, 323.5024869793298, 64.92342438954111, 47.956854191441124, 16.307802788756195, 92.14005598686656, 86.60405836423367, 66.74593132109318, 42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4822548561070987, "mean_inference_ms": 3.1822421176123856, "mean_action_processing_ms": 0.8057472003083511, "mean_env_wait_ms": 9.24496189024624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03191876411437988, "StateBufferConnector_ms": 0.0031222105026245117, "ViewRequirementAgentConnector_ms": 0.10466241836547852}, "num_episodes": 4, "episode_return_max": 393.6, "episode_return_min": 15.099999999999962, "episode_return_mean": 216.67400000000006, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.11646754945218, "num_env_steps_trained_throughput_per_sec": 129.11646754945218, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 26451.488, "restore_workers_time_ms": 0.018, "training_step_time_ms": 26451.272, "sample_time_ms": 2110.787, "learn_time_ms": 24313.34, "learn_throughput": 164.519, "synch_weights_time_ms": 23.969}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "91a8a_00000", "date": "2024-08-21_14-01-03", "timestamp": 1724229063, "time_this_iter_s": 31.026219606399536, "time_total_s": 498.70426869392395, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeba3ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 498.70426869392395, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 52.58181818181817, "ram_util_percent": 82.99318181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.14292047234873, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.723309515416622, "policy_loss": -0.017148640426360846, "vf_loss": 7.737206174433231, "vf_explained_var": 0.4169101361806194, "kl": 0.016259957801473015, "entropy": 1.3665034011006356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 492.7000000000007}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.251609676455457, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.651092940568924, "policy_loss": -0.02149417403852567, "vf_loss": 5.667786681155364, "vf_explained_var": 0.3068484670172135, "kl": 0.016001409957243595, "entropy": 1.1698188547044992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 492.7000000000007}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 15.099999999999962, "episode_reward_mean": 211.09399999999997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -837.9802105494282, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 885.3891460514836}, "policy_reward_mean": {"prey_policy": -58.26092013203301, "predator_policy": 269.35492013203293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.40000000000013, 154.40000000000003, 262.0, 367.1, 357.1, 315.19999999999993, 374.4999999999999, 303.2, 212.10000000000002, 32.50000000000019, 161.69999999999882, 33.1000000000002, 179.79999999999995, 31.800000000000185, 227.4, 154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [65.57928382863989, 43.2266045608782, 110.50443833595668, 333.04538397574765, 311.3645221534417, 279.74170239606565, 357.1683645422306, 151.33030060275945, -14.04494798124827, -196.07121323192982, 131.2546105001789, -90.8776311664104, -245.5702899688845, -223.100385538006, -71.67485880209125, 154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085], "policy_predator_policy_reward": [42.820716171360104, 111.17339543912058, 151.49556166404315, 34.054616024252255, 45.73547784655827, 35.45829760393436, 17.331635457769274, 151.86969939724054, 226.14494798124835, 228.57121323192797, 30.44538949982135, 123.97763116640856, 425.37028996888426, 254.90038553800426, 299.07485880209157, 0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5202894938489293, "mean_inference_ms": 3.2244872655791545, "mean_action_processing_ms": 0.8077609863385955, "mean_env_wait_ms": 9.307354605920704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019304871559143066, "StateBufferConnector_ms": 0.004498720169067383, "ViewRequirementAgentConnector_ms": 0.11456179618835449}, "num_episodes": 13, "episode_return_max": 393.6, "episode_return_min": 15.099999999999962, "episode_return_mean": 211.09399999999997, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 135.11359490785588, "num_env_steps_trained_throughput_per_sec": 135.11359490785588, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 26938.455, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26938.286, "sample_time_ms": 2376.713, "learn_time_ms": 24533.953, "learn_throughput": 163.039, "synch_weights_time_ms": 24.458}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "91a8a_00000", "date": "2024-08-21_14-01-33", "timestamp": 1724229093, "time_this_iter_s": 29.625788927078247, "time_total_s": 528.3300576210022, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeb48c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 528.3300576210022, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.22857142857143, "ram_util_percent": 82.32619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.7007852293551, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.607462995747725, "policy_loss": -0.020502845988812624, "vf_loss": 7.624481873214245, "vf_explained_var": 0.38263555417458217, "kl": 0.017419980177752828, "entropy": 1.3448233287781477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.957803563959897, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.211196561157704, "policy_loss": -0.018726966433556907, "vf_loss": 6.2254431918263435, "vf_explained_var": 0.2489078895499309, "kl": 0.014934441271664885, "entropy": 1.1003287484869362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 3.0999999999999996, "episode_reward_mean": 206.29500000000004, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1040.2943302920075, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1043.394330292008}, "policy_reward_mean": {"prey_policy": -98.0004708387895, "predator_policy": 304.29547083878964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.30000000000013, 35.000000000000085, 197.0, 365.0, 172.6, 286.40000000000055, 178.79999999999995, 287.0, 264.1, 300.0, 259.0000000000004, 132.49999999999918, 229.8999999999998, 239.0, 246.0, 289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [154.30000000000013, -661.8422854141577, -279.13339384784507, 314.1337930135468, -198.61623604199383, 130.8159416261623, 33.41792033079505, 84.22361199421402, -53.86706290122643, 132.261450329658, 132.11172892089817, -86.26708143344354, 28.84483503904715, 69.2746934779579, -33.048164910109755, 231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914], "policy_predator_policy_reward": [0.0, 696.842285414159, 476.13339384784507, 50.86620698645317, 371.2162360419935, 155.58405837383754, 145.38207966920504, 202.77638800578578, 317.9670629012265, 167.73854967034202, 126.88827107910147, 218.7670814334425, 201.05516496095254, 169.72530652204168, 279.04816491010973, 57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5483566159565068, "mean_inference_ms": 3.3063891493772157, "mean_action_processing_ms": 0.8113287853997572, "mean_env_wait_ms": 9.375120104502114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0195009708404541, "StateBufferConnector_ms": 0.004469871520996094, "ViewRequirementAgentConnector_ms": 0.11448454856872559}, "num_episodes": 15, "episode_return_max": 393.6, "episode_return_min": 3.0999999999999996, "episode_return_mean": 206.29500000000004, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.51971149684096, "num_env_steps_trained_throughput_per_sec": 141.51971149684096, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 27241.475, "restore_workers_time_ms": 0.021, "training_step_time_ms": 27241.303, "sample_time_ms": 2408.841, "learn_time_ms": 24804.183, "learn_throughput": 161.263, "synch_weights_time_ms": 24.977}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "91a8a_00000", "date": "2024-08-21_14-02-01", "timestamp": 1724229121, "time_this_iter_s": 28.32088303565979, "time_total_s": 556.650940656662, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306859430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 556.650940656662, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 43.595000000000006, "ram_util_percent": 82.10249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.54988392479718, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.594112093249957, "policy_loss": -0.02124060033917582, "vf_loss": 7.61232221176227, "vf_explained_var": 0.3613431377336383, "kl": 0.015152307163225487, "entropy": 1.338598037386934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.562036935426295, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.540139583746592, "policy_loss": -0.017979576209715256, "vf_loss": 6.5538447226087255, "vf_explained_var": 0.28463656511157753, "kl": 0.014248204432078637, "entropy": 1.0345306592682997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 3.0999999999999996, "episode_reward_mean": 204.84199999999998, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1040.2943302920075, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1043.394330292008}, "policy_reward_mean": {"prey_policy": -125.39690174746016, "predator_policy": 330.2389017474602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [289.09999999999997, 243.2, 182.39999999999998, 342.0, 32.000000000000185, 294.0, 293.0, 102.0, 38.70000000000028, 377.5, 328.1, 242.8, 391.0, 103.79999999999998, 263.9, 330.3, 94.1, 334.5, 328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003, 173.69999999999894, 320.3, 237.8, 29.900000000000027, 252.0, 136.2, 378.5, 218.3, 78.0, 32.00000000000003, 184.59999999999997, 283.0, 130.7, 393.3, 353.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [231.49907726119838, 15.722187545089948, -179.03275605186695, 255.13917594613994, -106.64858097656413, 84.11442649614713, 39.61085057665448, -600.772136466428, 23.802758487625812, 366.1586449421837, 281.63371694636857, -5.928236313656498, 373.7705627291408, -462.964011685343, 13.388430944952631, 217.5634359602521, -632.0781219863991, 265.7949586466383, 236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914, 59.60815714353188, 157.7304173829245, -157.05872616419413, -990.8777827650736, -90.3743352052506, -501.8073963434165, 360.1134891795921, -172.06834438274268, -563.0641161234764, -904.5733021219314, -347.0824313192901, -35.76226286511693, -388.4327640098618, 389.0856086807998, 211.53044822994764], "policy_predator_policy_reward": [57.60092273880177, 227.47781245491007, 361.43275605186625, 86.86082405385997, 138.64858097656233, 209.88557350385292, 253.38914942334537, 702.7721364664282, 14.897241512374222, 11.341355057816294, 46.46628305363152, 248.72823631365637, 17.229437270859165, 566.7640116853431, 250.51156905504732, 112.73656403974789, 726.1781219863992, 68.70504135336176, 91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919, 114.09184285646833, 162.5695826170755, 394.8587261641945, 1020.777782765074, 342.3743352052509, 638.0073963434161, 18.38651082040799, 390.36834438274275, 641.0641161234771, 936.573302121932, 531.6824313192901, 318.762262865117, 519.1327640098617, 4.214391319200217, 141.4695517700526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5980119689234495, "mean_inference_ms": 3.4003188884349864, "mean_action_processing_ms": 0.787871880706701, "mean_env_wait_ms": 9.473796932017484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019934773445129395, "StateBufferConnector_ms": 0.0046492815017700195, "ViewRequirementAgentConnector_ms": 0.12230980396270752}, "num_episodes": 15, "episode_return_max": 393.6, "episode_return_min": 3.0999999999999996, "episode_return_mean": 204.84199999999998, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.1972040704567, "num_env_steps_trained_throughput_per_sec": 141.1972040704567, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 27445.754, "restore_workers_time_ms": 0.021, "training_step_time_ms": 27445.613, "sample_time_ms": 2374.516, "learn_time_ms": 25042.9, "learn_throughput": 159.726, "synch_weights_time_ms": 24.734}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "91a8a_00000", "date": "2024-08-21_14-02-29", "timestamp": 1724229149, "time_this_iter_s": 28.363749980926514, "time_total_s": 585.0146906375885, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306859ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 585.0146906375885, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 42.90243902439025, "ram_util_percent": 83.01951219512195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.148806506146988, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.585715770721436, "policy_loss": -0.024237069240189157, "vf_loss": 8.606129240989684, "vf_explained_var": 0.20994099869082372, "kl": 0.019117897924055192, "entropy": 1.2728750873357058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.03017043483754, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.64854014068842, "policy_loss": -0.014825965683849062, "vf_loss": 7.659835507472356, "vf_explained_var": 0.22232412919402122, "kl": 0.011768655742829044, "entropy": 0.9735898885255059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 3.0999999999999996, "episode_reward_mean": 186.39399999999998, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1133.6161216360197, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1151.8161216360197}, "policy_reward_mean": {"prey_policy": -200.11971369819537, "predator_policy": 386.51371369819555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.1, 28.500000000000135, 234.9, 235.0, 384.3, 308.0, 254.2, 341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003, 173.69999999999894, 320.3, 237.8, 29.900000000000027, 252.0, 136.2, 378.5, 218.3, 78.0, 32.00000000000003, 184.59999999999997, 283.0, 130.7, 393.3, 353.0, 166.1, 254.0, 89.20000000000009, 96.30000000000001, 280.5, 22.299999999999997, 67.29999999999998, 76.39999999999964, 18.200000000000003, 214.0, 50.700000000000045, 34.800000000000225, 149.0, 349.0, 49.70000000000035, 58.10000000000001, 260.00000000000057, 202.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [236.77494399041967, -197.84452041171963, -33.495358884380266, -87.39136298489798, 367.3518558918797, 119.14507802094563, -67.94878016563052, 282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914, 59.60815714353188, 157.7304173829245, -157.05872616419413, -990.8777827650736, -90.3743352052506, -501.8073963434165, 360.1134891795921, -172.06834438274268, -563.0641161234764, -904.5733021219314, -347.0824313192901, -35.76226286511693, -388.4327640098618, 389.0856086807998, 211.53044822994764, -313.24349654922116, -111.96943969638104, -486.9328648425643, -551.9325464377763, 39.63239722767137, -962.2324195976793, -541.4067160738693, -465.0881232055332, -1133.6161216360197, -227.48367241835226, -691.4573564141671, -114.40575304874758, -467.4340807768232, 187.23236074626283, -223.11931169102076, -857.0260451843849, -85.71890645751499, -285.30471601526847], "policy_predator_policy_reward": [91.3250560095803, 226.344520411718, 268.39535888438013, 322.3913629848981, 16.948144108120278, 188.85492197905432, 322.1487801656307, 58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919, 114.09184285646833, 162.5695826170755, 394.8587261641945, 1020.777782765074, 342.3743352052509, 638.0073963434161, 18.38651082040799, 390.36834438274275, 641.0641161234771, 936.573302121932, 531.6824313192901, 318.762262865117, 519.1327640098617, 4.214391319200217, 141.4695517700526, 479.34349654922113, 365.96943969638113, 576.1328648425663, 648.2325464377763, 240.86760277232858, 984.5324195976791, 608.7067160738696, 541.488123205535, 1151.8161216360197, 441.4836724183525, 742.1573564141665, 149.2057530487456, 616.4340807768232, 161.76763925373717, 272.8193116910191, 915.1260451843847, 345.71890645751483, 487.3047160152687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6682490401182632, "mean_inference_ms": 3.503503566657009, "mean_action_processing_ms": 0.7891674614322584, "mean_env_wait_ms": 9.567741567720924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021871328353881836, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.14256513118743896}, "num_episodes": 18, "episode_return_max": 393.6, "episode_return_min": 3.0999999999999996, "episode_return_mean": 186.39399999999998, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.77962410071297, "num_env_steps_trained_throughput_per_sec": 139.77962410071297, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 27774.42, "restore_workers_time_ms": 0.022, "training_step_time_ms": 27774.277, "sample_time_ms": 2396.728, "learn_time_ms": 25349.674, "learn_throughput": 157.793, "synch_weights_time_ms": 24.43}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "91a8a_00000", "date": "2024-08-21_14-02-58", "timestamp": 1724229178, "time_this_iter_s": 28.677507162094116, "time_total_s": 613.6921977996826, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aebb0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 613.6921977996826, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 43.67317073170732, "ram_util_percent": 83.0219512195122}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.554570520669222, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.176708573599656, "policy_loss": -0.02472485299561716, "vf_loss": 8.19811476568381, "vf_explained_var": 0.13700992738207182, "kl": 0.016593371689668856, "entropy": 1.2865961616237958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 492.9399999999987}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.610506377307077, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.578916519880295, "policy_loss": -0.017560380098681588, "vf_loss": 7.5929971386988955, "vf_explained_var": 0.24173430080215136, "kl": 0.011599126896665741, "entropy": 0.909953253592054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 492.9399999999987}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 1.0, "episode_reward_mean": 171.692, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1212.4972998155938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1230.7972998155938}, "policy_reward_mean": {"prey_policy": -266.718150954187, "predator_policy": 438.41015095418715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003, 173.69999999999894, 320.3, 237.8, 29.900000000000027, 252.0, 136.2, 378.5, 218.3, 78.0, 32.00000000000003, 184.59999999999997, 283.0, 130.7, 393.3, 353.0, 166.1, 254.0, 89.20000000000009, 96.30000000000001, 280.5, 22.299999999999997, 67.29999999999998, 76.39999999999964, 18.200000000000003, 214.0, 50.700000000000045, 34.800000000000225, 149.0, 349.0, 49.70000000000035, 58.10000000000001, 260.00000000000057, 202.0, 23.5, 98.79999999999995, 18.299999999999997, 1.0, 104.89999999999984, 42.3, 14.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914, 59.60815714353188, 157.7304173829245, -157.05872616419413, -990.8777827650736, -90.3743352052506, -501.8073963434165, 360.1134891795921, -172.06834438274268, -563.0641161234764, -904.5733021219314, -347.0824313192901, -35.76226286511693, -388.4327640098618, 389.0856086807998, 211.53044822994764, -313.24349654922116, -111.96943969638104, -486.9328648425643, -551.9325464377763, 39.63239722767137, -962.2324195976793, -541.4067160738693, -465.0881232055332, -1133.6161216360197, -227.48367241835226, -691.4573564141671, -114.40575304874758, -467.4340807768232, 187.23236074626283, -223.11931169102076, -857.0260451843849, -85.71890645751499, -285.30471601526847, -897.0411203042585, -597.1319900901159, -1212.4972998155938, -1076.2387457546838, -446.7433789787299, -934.1459838363986, -1159.453351362764], "policy_predator_policy_reward": [58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919, 114.09184285646833, 162.5695826170755, 394.8587261641945, 1020.777782765074, 342.3743352052509, 638.0073963434161, 18.38651082040799, 390.36834438274275, 641.0641161234771, 936.573302121932, 531.6824313192901, 318.762262865117, 519.1327640098617, 4.214391319200217, 141.4695517700526, 479.34349654922113, 365.96943969638113, 576.1328648425663, 648.2325464377763, 240.86760277232858, 984.5324195976791, 608.7067160738696, 541.488123205535, 1151.8161216360197, 441.4836724183525, 742.1573564141665, 149.2057530487456, 616.4340807768232, 161.76763925373717, 272.8193116910191, 915.1260451843847, 345.71890645751483, 487.3047160152687, 920.5411203042584, 695.931990090116, 1230.7972998155938, 1077.2387457546838, 551.643378978729, 976.4459838363987, 1173.4533513627637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6865448162097323, "mean_inference_ms": 3.548766113304924, "mean_action_processing_ms": 0.7902251563556232, "mean_env_wait_ms": 9.611033141919599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021605610847473145, "StateBufferConnector_ms": 0.0050275325775146484, "ViewRequirementAgentConnector_ms": 0.13602161407470703}, "num_episodes": 7, "episode_return_max": 393.6, "episode_return_min": 1.0, "episode_return_mean": 171.692, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 134.42917325977038, "num_env_steps_trained_throughput_per_sec": 134.42917325977038, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 28257.295, "restore_workers_time_ms": 0.022, "training_step_time_ms": 28257.152, "sample_time_ms": 2454.194, "learn_time_ms": 25773.501, "learn_throughput": 155.198, "synch_weights_time_ms": 25.871}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "91a8a_00000", "date": "2024-08-21_14-03-28", "timestamp": 1724229208, "time_this_iter_s": 29.825861930847168, "time_total_s": 643.5180597305298, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae885280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 643.5180597305298, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 47.96904761904762, "ram_util_percent": 83.17619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.068124463905891, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.291620660821597, "policy_loss": -0.021097202759119683, "vf_loss": 8.309599270423254, "vf_explained_var": -0.08374136804292599, "kl": 0.015592787615120566, "entropy": 1.2786990777899823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.668031469670435, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 8.037556333839893, "policy_loss": -0.019833535694730623, "vf_loss": 8.053564218680064, "vf_explained_var": 0.1916423173621297, "kl": 0.012752236709396432, "entropy": 0.8558618110915025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 393.6, "episode_reward_min": 1.0, "episode_reward_mean": 171.692, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1212.4972998155938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1230.7972998155938}, "policy_reward_mean": {"prey_policy": -266.718150954187, "predator_policy": 438.41015095418715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.1, 27.200000000000117, 159.5, 393.6, 39.000000000000284, 279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003, 173.69999999999894, 320.3, 237.8, 29.900000000000027, 252.0, 136.2, 378.5, 218.3, 78.0, 32.00000000000003, 184.59999999999997, 283.0, 130.7, 393.3, 353.0, 166.1, 254.0, 89.20000000000009, 96.30000000000001, 280.5, 22.299999999999997, 67.29999999999998, 76.39999999999964, 18.200000000000003, 214.0, 50.700000000000045, 34.800000000000225, 149.0, 349.0, 49.70000000000035, 58.10000000000001, 260.00000000000057, 202.0, 23.5, 98.79999999999995, 18.299999999999997, 1.0, 104.89999999999984, 42.3, 14.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [282.6816726389177, -225.63955618899695, -58.15279935439055, 392.7351213330469, 25.986733739286958, 37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914, 59.60815714353188, 157.7304173829245, -157.05872616419413, -990.8777827650736, -90.3743352052506, -501.8073963434165, 360.1134891795921, -172.06834438274268, -563.0641161234764, -904.5733021219314, -347.0824313192901, -35.76226286511693, -388.4327640098618, 389.0856086807998, 211.53044822994764, -313.24349654922116, -111.96943969638104, -486.9328648425643, -551.9325464377763, 39.63239722767137, -962.2324195976793, -541.4067160738693, -465.0881232055332, -1133.6161216360197, -227.48367241835226, -691.4573564141671, -114.40575304874758, -467.4340807768232, 187.23236074626283, -223.11931169102076, -857.0260451843849, -85.71890645751499, -285.30471601526847, -897.0411203042585, -597.1319900901159, -1212.4972998155938, -1076.2387457546838, -446.7433789787299, -934.1459838363986, -1159.453351362764], "policy_predator_policy_reward": [58.418327361082326, 252.83955618899574, 217.6527993543906, 0.8648786669530829, 13.013266260713113, 241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919, 114.09184285646833, 162.5695826170755, 394.8587261641945, 1020.777782765074, 342.3743352052509, 638.0073963434161, 18.38651082040799, 390.36834438274275, 641.0641161234771, 936.573302121932, 531.6824313192901, 318.762262865117, 519.1327640098617, 4.214391319200217, 141.4695517700526, 479.34349654922113, 365.96943969638113, 576.1328648425663, 648.2325464377763, 240.86760277232858, 984.5324195976791, 608.7067160738696, 541.488123205535, 1151.8161216360197, 441.4836724183525, 742.1573564141665, 149.2057530487456, 616.4340807768232, 161.76763925373717, 272.8193116910191, 915.1260451843847, 345.71890645751483, 487.3047160152687, 920.5411203042584, 695.931990090116, 1230.7972998155938, 1077.2387457546838, 551.643378978729, 976.4459838363987, 1173.4533513627637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6865448162097323, "mean_inference_ms": 3.548766113304924, "mean_action_processing_ms": 0.7902251563556232, "mean_env_wait_ms": 9.611033141919599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021605610847473145, "StateBufferConnector_ms": 0.0050275325775146484, "ViewRequirementAgentConnector_ms": 0.13602161407470703}, "num_episodes": 0, "episode_return_max": 393.6, "episode_return_min": 1.0, "episode_return_mean": 171.692, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.5320391254451, "num_env_steps_trained_throughput_per_sec": 129.5320391254451, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 28854.059, "restore_workers_time_ms": 0.023, "training_step_time_ms": 28853.897, "sample_time_ms": 2574.411, "learn_time_ms": 26248.455, "learn_throughput": 152.39, "synch_weights_time_ms": 26.723}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "91a8a_00000", "date": "2024-08-21_14-03-59", "timestamp": 1724229239, "time_this_iter_s": 30.931461811065674, "time_total_s": 674.4495215415955, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aebade50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 674.4495215415955, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 48.76590909090908, "ram_util_percent": 82.26590909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.458887106801074, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.07693575869004, "policy_loss": -0.02500007655811108, "vf_loss": 8.098316354552905, "vf_explained_var": 0.061051569133996966, "kl": 0.018097362434491514, "entropy": 1.2257619168609382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 492.9399999999987}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.224423739686609, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.581660239398479, "policy_loss": -0.01656238146800509, "vf_loss": 7.594851039350033, "vf_explained_var": 0.2730899851769209, "kl": 0.01123857696269018, "entropy": 0.8618799448013306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 492.9399999999987}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 393.3, "episode_reward_min": 0.10000000000000142, "episode_reward_mean": 166.72299999999998, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1355.798546278885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1355.8985462788849}, "policy_reward_mean": {"prey_policy": -296.56040295897145, "predator_policy": 463.28340295897164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0, 136.70000000000005, 386.3, 181.09999999999937, 265.4, 319.1, 341.0, 15.099999999999962, 93.10000000000005, 299.4, 39.50000000000029, 88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003, 173.69999999999894, 320.3, 237.8, 29.900000000000027, 252.0, 136.2, 378.5, 218.3, 78.0, 32.00000000000003, 184.59999999999997, 283.0, 130.7, 393.3, 353.0, 166.1, 254.0, 89.20000000000009, 96.30000000000001, 280.5, 22.299999999999997, 67.29999999999998, 76.39999999999964, 18.200000000000003, 214.0, 50.700000000000045, 34.800000000000225, 149.0, 349.0, 49.70000000000035, 58.10000000000001, 260.00000000000057, 202.0, 23.5, 98.79999999999995, 18.299999999999997, 1.0, 104.89999999999984, 42.3, 14.0, 0.10000000000000142, 76.0, 38.90000000000028, 315.2, 33.3000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [37.38950294719501, -365.5100725121289, 370.6491921088068, -15.573149134717786, -17.03776372957526, 107.14376943942587, 258.54728475648807, -507.0701555850751, -481.54632546206676, 115.99765658035973, 34.438663312389934, -341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914, 59.60815714353188, 157.7304173829245, -157.05872616419413, -990.8777827650736, -90.3743352052506, -501.8073963434165, 360.1134891795921, -172.06834438274268, -563.0641161234764, -904.5733021219314, -347.0824313192901, -35.76226286511693, -388.4327640098618, 389.0856086807998, 211.53044822994764, -313.24349654922116, -111.96943969638104, -486.9328648425643, -551.9325464377763, 39.63239722767137, -962.2324195976793, -541.4067160738693, -465.0881232055332, -1133.6161216360197, -227.48367241835226, -691.4573564141671, -114.40575304874758, -467.4340807768232, 187.23236074626283, -223.11931169102076, -857.0260451843849, -85.71890645751499, -285.30471601526847, -897.0411203042585, -597.1319900901159, -1212.4972998155938, -1076.2387457546838, -446.7433789787299, -934.1459838363986, -1159.453351362764, -1355.798546278885, -784.8146835485832, 27.710112591571175, 62.07944389999839, -515.7903549746851], "policy_predator_policy_reward": [241.61049705280487, 502.2100725121294, 15.650807891193187, 196.6731491347179, 282.4377637295754, 211.95623056057417, 82.45271524351196, 522.170155585078, 574.646325462067, 183.40234341964035, 5.061336687610284, 430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919, 114.09184285646833, 162.5695826170755, 394.8587261641945, 1020.777782765074, 342.3743352052509, 638.0073963434161, 18.38651082040799, 390.36834438274275, 641.0641161234771, 936.573302121932, 531.6824313192901, 318.762262865117, 519.1327640098617, 4.214391319200217, 141.4695517700526, 479.34349654922113, 365.96943969638113, 576.1328648425663, 648.2325464377763, 240.86760277232858, 984.5324195976791, 608.7067160738696, 541.488123205535, 1151.8161216360197, 441.4836724183525, 742.1573564141665, 149.2057530487456, 616.4340807768232, 161.76763925373717, 272.8193116910191, 915.1260451843847, 345.71890645751483, 487.3047160152687, 920.5411203042584, 695.931990090116, 1230.7972998155938, 1077.2387457546838, 551.643378978729, 976.4459838363987, 1173.4533513627637, 1355.8985462788849, 860.8146835485832, 11.18988740842893, 253.12055610000152, 549.0903549746884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.702086900871228, "mean_inference_ms": 3.5929569430063153, "mean_action_processing_ms": 0.7923366681456656, "mean_env_wait_ms": 9.639815589498518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021653413772583008, "StateBufferConnector_ms": 0.005041003227233887, "ViewRequirementAgentConnector_ms": 0.13346326351165771}, "num_episodes": 5, "episode_return_max": 393.3, "episode_return_min": 0.10000000000000142, "episode_return_mean": 166.72299999999998, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.0080303549793, "num_env_steps_trained_throughput_per_sec": 139.0080303549793, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 29133.149, "restore_workers_time_ms": 0.024, "training_step_time_ms": 29132.934, "sample_time_ms": 2622.236, "learn_time_ms": 26478.495, "learn_throughput": 151.066, "synch_weights_time_ms": 26.87}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "91a8a_00000", "date": "2024-08-21_14-04-28", "timestamp": 1724229268, "time_this_iter_s": 28.80756711959839, "time_total_s": 703.2570886611938, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306885c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 703.2570886611938, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 46.948780487804875, "ram_util_percent": 82.01951219512195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.774062400249144, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.399472345411778, "policy_loss": -0.019821644885329684, "vf_loss": 7.416145858168602, "vf_explained_var": -0.014691077979902427, "kl": 0.015740609417359035, "entropy": 1.2336423398305973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 506.1399999999994}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.418870469679435, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.9642089560627936, "policy_loss": -0.014042967227093564, "vf_loss": 6.974820762872696, "vf_explained_var": 0.28567466586828233, "kl": 0.01143723325173293, "entropy": 0.8635818190872669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 506.1399999999994}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 393.3, "episode_reward_min": 0.0, "episode_reward_mean": 153.739, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1415.7551784563736, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1415.7551784563736}, "policy_reward_mean": {"prey_policy": -365.61248290682175, "predator_policy": 519.3514829068222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.8999999999995, 350.7, 45.999999999999986, 173.0, 321.0, 138.39999999999998, 86.0, 172.19999999999993, 310.6, 121.4, 312.6, 392.8, 59.900000000000006, 64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003, 173.69999999999894, 320.3, 237.8, 29.900000000000027, 252.0, 136.2, 378.5, 218.3, 78.0, 32.00000000000003, 184.59999999999997, 283.0, 130.7, 393.3, 353.0, 166.1, 254.0, 89.20000000000009, 96.30000000000001, 280.5, 22.299999999999997, 67.29999999999998, 76.39999999999964, 18.200000000000003, 214.0, 50.700000000000045, 34.800000000000225, 149.0, 349.0, 49.70000000000035, 58.10000000000001, 260.00000000000057, 202.0, 23.5, 98.79999999999995, 18.299999999999997, 1.0, 104.89999999999984, 42.3, 14.0, 0.10000000000000142, 76.0, 38.90000000000028, 315.2, 33.3000000000002, 29.800000000000097, 34.900000000000226, 0.0, 190.0, 1.0, 126.0, 3.3000000000000007, 242.2, 383.6, 27.700000000000127, 18.799999999999997], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-341.8418161749253, 326.87106857626816, -682.8029799827694, -318.4199902658474, 152.07445506456722, -539.9014317062283, -714.436764887958, -213.17488819760263, 191.16853698893556, -361.1626067839145, 154.81536035410244, 392.8, -666.7001408501942, -137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914, 59.60815714353188, 157.7304173829245, -157.05872616419413, -990.8777827650736, -90.3743352052506, -501.8073963434165, 360.1134891795921, -172.06834438274268, -563.0641161234764, -904.5733021219314, -347.0824313192901, -35.76226286511693, -388.4327640098618, 389.0856086807998, 211.53044822994764, -313.24349654922116, -111.96943969638104, -486.9328648425643, -551.9325464377763, 39.63239722767137, -962.2324195976793, -541.4067160738693, -465.0881232055332, -1133.6161216360197, -227.48367241835226, -691.4573564141671, -114.40575304874758, -467.4340807768232, 187.23236074626283, -223.11931169102076, -857.0260451843849, -85.71890645751499, -285.30471601526847, -897.0411203042585, -597.1319900901159, -1212.4972998155938, -1076.2387457546838, -446.7433789787299, -934.1459838363986, -1159.453351362764, -1355.798546278885, -784.8146835485832, 27.710112591571175, 62.07944389999839, -515.7903549746851, -990.701652985149, -628.5872650552122, -1415.7551784563736, -410.3506183496174, -1217.350220543994, -631.5324500405744, -1334.628027355443, -279.7301580182468, 382.1580082267242, -274.87495035294285, -566.4268791331054], "policy_predator_policy_reward": [430.7418161749277, 23.82893142373187, 728.8029799827692, 491.41999026584773, 168.92554493543295, 678.3014317062288, 800.4367648879576, 385.3748881976027, 119.43146301106454, 482.5626067839147, 157.78463964589744, 0.0, 726.600140850195, 202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919, 114.09184285646833, 162.5695826170755, 394.8587261641945, 1020.777782765074, 342.3743352052509, 638.0073963434161, 18.38651082040799, 390.36834438274275, 641.0641161234771, 936.573302121932, 531.6824313192901, 318.762262865117, 519.1327640098617, 4.214391319200217, 141.4695517700526, 479.34349654922113, 365.96943969638113, 576.1328648425663, 648.2325464377763, 240.86760277232858, 984.5324195976791, 608.7067160738696, 541.488123205535, 1151.8161216360197, 441.4836724183525, 742.1573564141665, 149.2057530487456, 616.4340807768232, 161.76763925373717, 272.8193116910191, 915.1260451843847, 345.71890645751483, 487.3047160152687, 920.5411203042584, 695.931990090116, 1230.7972998155938, 1077.2387457546838, 551.643378978729, 976.4459838363987, 1173.4533513627637, 1355.8985462788849, 860.8146835485832, 11.18988740842893, 253.12055610000152, 549.0903549746884, 1020.5016529851501, 663.4872650552156, 1415.7551784563736, 600.3506183496183, 1218.350220543994, 757.5324500405746, 1337.928027355443, 521.9301580182469, 1.4419917732758012, 302.5749503529481, 585.2268791331078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.776223143023037, "mean_inference_ms": 3.6923944753686175, "mean_action_processing_ms": 0.8096587147692698, "mean_env_wait_ms": 9.734809368937944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021994709968566895, "StateBufferConnector_ms": 0.01057744026184082, "ViewRequirementAgentConnector_ms": 0.15642118453979492}, "num_episodes": 11, "episode_return_max": 393.3, "episode_return_min": 0.0, "episode_return_mean": 153.739, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 121.88132359742424, "num_env_steps_trained_throughput_per_sec": 121.88132359742424, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 29757.965, "restore_workers_time_ms": 0.024, "training_step_time_ms": 29757.755, "sample_time_ms": 3031.425, "learn_time_ms": 26689.969, "learn_throughput": 149.869, "synch_weights_time_ms": 30.368}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "91a8a_00000", "date": "2024-08-21_14-05-01", "timestamp": 1724229301, "time_this_iter_s": 32.875641107559204, "time_total_s": 736.132729768753, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeba3ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 736.132729768753, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 53.88478260869566, "ram_util_percent": 82.70217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.274300880605976, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.420796194175879, "policy_loss": -0.022163898416329174, "vf_loss": 7.439977153142293, "vf_explained_var": -0.07788316911707321, "kl": 0.014914768475864548, "entropy": 1.2026869454731544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.640909156699975, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.966224068403244, "policy_loss": -0.016686604447992675, "vf_loss": 6.979724872112274, "vf_explained_var": 0.3111074741308888, "kl": 0.010619260957901134, "entropy": 0.8583564337342977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 393.3, "episode_reward_min": 0.0, "episode_reward_mean": 130.57800000000003, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1621.6723885917274, "predator_policy": 1.4419917732758012}, "policy_reward_max": {"prey_policy": 389.0856086807998, "predator_policy": 1621.8723885917275}, "policy_reward_mean": {"prey_policy": -484.59419003445015, "predator_policy": 615.1721900344504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.50000000000006, 340.2, 335.9, 217.2, 71.0, 43.0, 206.39999999999998, 258.0, 55.90000000000024, 213.50000000000003, 172.1, 228.1, 23.200000000000003, 265.0, 115.5, 87.99999999999937, 66.19999999999996, 51.40000000000033, 190.6, 53.50000000000026, 388.20000000000005, 358.1, 247.0, 98.20000000000019, 3.0999999999999996, 173.59999999999997, 381.3, 157.5, 331.2, 101.8, 38.70000000000003, 173.69999999999894, 320.3, 237.8, 29.900000000000027, 252.0, 136.2, 378.5, 218.3, 78.0, 32.00000000000003, 184.59999999999997, 283.0, 130.7, 393.3, 353.0, 166.1, 254.0, 89.20000000000009, 96.30000000000001, 280.5, 22.299999999999997, 67.29999999999998, 76.39999999999964, 18.200000000000003, 214.0, 50.700000000000045, 34.800000000000225, 149.0, 349.0, 49.70000000000035, 58.10000000000001, 260.00000000000057, 202.0, 23.5, 98.79999999999995, 18.299999999999997, 1.0, 104.89999999999984, 42.3, 14.0, 0.10000000000000142, 76.0, 38.90000000000028, 315.2, 33.3000000000002, 29.800000000000097, 34.900000000000226, 0.0, 190.0, 1.0, 126.0, 3.3000000000000007, 242.2, 383.6, 27.700000000000127, 18.799999999999997, 7.299999999999991, 58.10000000000005, 0.0, 3.3000000000000016, 33.6, 24.00000000000007, 10.799999999999978, 0.40000000000000036, 12.099999999999973, 0.1999999999999993, 7.099999999999998, 4.0, 96.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-137.7321371059284, 202.20913194111927, 334.03601637010127, -324.4691319210958, -814.3891460514839, -801.2387939773361, -277.27761449504874, -88.276303870596, 28.48843908183347, -98.4458960372531, -288.32208393912356, -169.80462087628638, -837.9802105494282, -119.69379115657921, -611.3807347532681, -381.9955857359085, -343.54235259895626, -281.76581078381287, -306.02231559581264, -306.0845827245871, 377.61184276212066, 297.79698468853604, -66.9301052798773, 80.97169719764828, -1040.2943302920075, -334.17145672026453, 362.37621862693265, -353.968600721428, 266.1618198506894, -595.6468581011121, -788.5713367763914, 59.60815714353188, 157.7304173829245, -157.05872616419413, -990.8777827650736, -90.3743352052506, -501.8073963434165, 360.1134891795921, -172.06834438274268, -563.0641161234764, -904.5733021219314, -347.0824313192901, -35.76226286511693, -388.4327640098618, 389.0856086807998, 211.53044822994764, -313.24349654922116, -111.96943969638104, -486.9328648425643, -551.9325464377763, 39.63239722767137, -962.2324195976793, -541.4067160738693, -465.0881232055332, -1133.6161216360197, -227.48367241835226, -691.4573564141671, -114.40575304874758, -467.4340807768232, 187.23236074626283, -223.11931169102076, -857.0260451843849, -85.71890645751499, -285.30471601526847, -897.0411203042585, -597.1319900901159, -1212.4972998155938, -1076.2387457546838, -446.7433789787299, -934.1459838363986, -1159.453351362764, -1355.798546278885, -784.8146835485832, 27.710112591571175, 62.07944389999839, -515.7903549746851, -990.701652985149, -628.5872650552122, -1415.7551784563736, -410.3506183496174, -1217.350220543994, -631.5324500405744, -1334.628027355443, -279.7301580182468, 382.1580082267242, -274.87495035294285, -566.4268791331054, -1061.6435509600676, -884.6224663741532, -1505.3513846060773, -1167.4026708357926, -975.9593464798163, -549.129799164247, -868.2919781875011, -1390.6566222038223, -954.3421494392785, -1621.6723885917274, -990.6378740856077, -1608.7089428874156, -940.4627368128846], "policy_predator_policy_reward": [202.23213710592802, 137.99086805888064, 1.8639836298987218, 541.669131921096, 885.3891460514836, 844.2387939773362, 483.67761449504883, 346.27630387059617, 27.411560918166607, 311.9458960372528, 460.42208393912335, 397.90462087628583, 861.1802105494277, 384.69379115657927, 726.8807347532675, 469.9955857359108, 409.7423525989554, 333.1658107838182, 496.62231559581244, 359.5845827245913, 10.588157237879336, 60.30301531146395, 313.9301052798773, 17.228302802351656, 1043.394330292008, 507.77145672026455, 18.92378137306737, 511.46860072142766, 65.03818014931053, 697.4468581011117, 827.2713367763919, 114.09184285646833, 162.5695826170755, 394.8587261641945, 1020.777782765074, 342.3743352052509, 638.0073963434161, 18.38651082040799, 390.36834438274275, 641.0641161234771, 936.573302121932, 531.6824313192901, 318.762262865117, 519.1327640098617, 4.214391319200217, 141.4695517700526, 479.34349654922113, 365.96943969638113, 576.1328648425663, 648.2325464377763, 240.86760277232858, 984.5324195976791, 608.7067160738696, 541.488123205535, 1151.8161216360197, 441.4836724183525, 742.1573564141665, 149.2057530487456, 616.4340807768232, 161.76763925373717, 272.8193116910191, 915.1260451843847, 345.71890645751483, 487.3047160152687, 920.5411203042584, 695.931990090116, 1230.7972998155938, 1077.2387457546838, 551.643378978729, 976.4459838363987, 1173.4533513627637, 1355.8985462788849, 860.8146835485832, 11.18988740842893, 253.12055610000152, 549.0903549746884, 1020.5016529851501, 663.4872650552156, 1415.7551784563736, 600.3506183496183, 1218.350220543994, 757.5324500405746, 1337.928027355443, 521.9301580182469, 1.4419917732758012, 302.5749503529481, 585.2268791331078, 1068.9435509600614, 942.7224663741538, 1505.3513846060773, 1170.7026708357926, 1009.5593464798161, 573.1297991642516, 879.0919781875035, 1391.0566222038224, 966.4421494392813, 1621.8723885917275, 997.7378740856077, 1612.7089428874156, 1036.962736812884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8474715650797537, "mean_inference_ms": 3.8218936408504685, "mean_action_processing_ms": 0.8183556360403378, "mean_env_wait_ms": 9.855928159612402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014483094215393066, "StateBufferConnector_ms": 0.010447978973388672, "ViewRequirementAgentConnector_ms": 0.15292084217071533}, "num_episodes": 13, "episode_return_max": 393.3, "episode_return_min": 0.0, "episode_return_mean": 130.57800000000003, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.35204137385864, "num_env_steps_trained_throughput_per_sec": 142.35204137385864, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 29612.444, "restore_workers_time_ms": 0.024, "training_step_time_ms": 29612.235, "sample_time_ms": 3104.15, "learn_time_ms": 26471.809, "learn_throughput": 151.104, "synch_weights_time_ms": 30.277}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "91a8a_00000", "date": "2024-08-21_14-05-29", "timestamp": 1724229329, "time_this_iter_s": 28.12575101852417, "time_total_s": 764.2584807872772, "pid": 7262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3068590d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 764.2584807872772, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 72.2225, "ram_util_percent": 82.6525}}
