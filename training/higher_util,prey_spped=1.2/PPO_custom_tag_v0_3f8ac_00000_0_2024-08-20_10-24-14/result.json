{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5566056898031285, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.528774112620681, "policy_loss": -0.0109311491489982, "vf_loss": 8.538342076256162, "vf_explained_var": 0.006052925031651895, "kl": 0.0068158397922248, "entropy": 1.6030484625271388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3916487800302329, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.288126388680998, "policy_loss": -0.009799998975974857, "vf_loss": 6.296902446141319, "vf_explained_var": 0.02752623154372765, "kl": 0.005119698081737158, "entropy": 1.6047768965600029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 259.5999999999994, "episode_reward_min": -34.37132585035781, "episode_reward_mean": 95.3726857370439, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -499.0939991461288, "predator_policy": 2.049523790135794}, "policy_reward_max": {"prey_policy": 145.80000389711003, "predator_policy": 502.69399914612893}, "policy_reward_mean": {"prey_policy": -75.32279562476813, "predator_policy": 123.00913849329017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.39999999999989, 202.79999999999976, 55.50297370273382, 92.29999999999998, 140.10674151793498, 96.19999999999939, 34.700000000000124, 21.400000000000063, 186.1999999999999, 113.73628926153468, 126.92651322659268, 172.31407935360497, 154.1999999999995, 61.40000000000026, 14.799999999999962, 121.09999999999908, 174.33010014094384, 81.10000000000022, 84.20501075252304, 40.30000000000022, 193.92180891389003, 73.75468259096615, 118.71373406055093, 117.49999999999923, 49.90000000000018, 166.75136470385232, 93.30375790957777, 86.70000000000007, 89.39999999999958, 44.320440078889774, 33.90000000000004, 44.700000000000294, 4.9574505130980455, 42.10000000000015, 153.69864449355777, 40.58983687042253, 88.1000000000002, 52.100000000000065, 8.897888038315562, 60.336444789140046, 95.05240189573527, 33.827928702228135, 36.00000000000013, 196.5, 62.90000000000019, 31.412009318411457, 30.00000000000017, 79.69999999999995, 11.99413435430488, 72.79999999999959, 83.89999999999958, 94.98289704245738, -34.37132585035781, 181.09648600222346, 59.80000000000009, 50.764076675070335, 165.48077001434783, 158.41113523999744, 96.06387421194466, 98.59999999999923, 96.82914931115666, 42.50000000000036, 109.70493358981818, 126.79999999999956, 73.8542926203914, 138.89999999999898, 131.49999999999972, 259.5999999999994, 169.39999999999918, 148.999999999999, 123.66284902131028, 178.4999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.142836936911756, -205.87818502745927, 91.13974561546162, 44.53949272490599, -34.305164504128236, -150.2955331403577, 9.571974823453987, -388.4421423376999, 26.6524534605363, -115.08228440504195, 74.67780823843665, -23.530758354186336, -29.937078457052444, -123.55155804762907, -154.23301886111489, -228.37880923324653, -212.9134428969157, 145.80000389711003, -8.905843348738278, -124.84814950215505, 54.932961106359095, -131.42912352154647, -43.98671433612631, -64.21349072839746, 99.08540885761487, -77.28948582869843, -21.240325207467112, -26.183952601673354, -255.24401256279828, -338.6648049722317, 104.00742272899704, -105.24206335361313, 28.81414932519027, -35.4474065507876, 10.268783895493124, -56.5480186923201, -43.363461647488066, -131.55893391692626, -62.679655046220255, 17.649273672004846, 101.75951466551778, -377.7617572365757, -109.2600994251292, -50.44544277054659, -53.30267401929997, 33.61798845041301, 15.99403808267776, 50.64621379716735, -48.48667485511965, 2.588590848192687, -112.50478073255496, -11.52032950329431, -122.3336647288952, 17.39493461088306, 32.746779963858415, -383.8411458146576, -205.7476762326729, 38.74784987182862, -24.40484580389711, -253.15926230988072, -244.9690392420414, -163.71877764860585, -60.20438489578228, 16.862418582394618, -21.043402695194843, -227.58873081512712, -102.92403190232996, -42.29785715531582, 77.82917902295947, -283.1714842005684, -94.36417447756027, -284.2924744391119, -210.8686307937475, 64.30929891272336, -100.76023263226466, -69.85009675172361, -176.69454812733449, -211.02919295764843, -307.6862107769711, -59.36769165706076, -75.51838263678894, -89.28419609205186, -152.06952531722882, -34.731128507887334, -130.26043305149295, -28.5288478921776, 92.76896619118415, -43.38049648847319, -164.00264263511798, 8.240898050344068, -203.3961453266797, -72.11526800138357, -54.591588772577246, -230.61212438595751, -185.26425755699034, -499.0939991461288, -44.35386268282289, -31.43021813384034, -277.8070710195386, -74.85185174520639, -100.71298802118474, 59.15047620986426, -8.103715417865862, -305.8729540472675, -318.06471872762074, -108.34673035435227, -227.74100942293833, 3.011796027656061, -195.4888067920826, -230.2951763677864, -77.40610976533593, -43.09131293482113, 67.31493902057056, -86.01868029274596, -72.0484429879867, 55.96666137120968, -50.621933857819066, -103.66339057401088, 41.125449801598286, -104.8211261628313, -136.9800715829866, -37.4480408334599, -30.029468836564348, -76.74989766325402, -50.224410386796954, -28.160382455167294, 12.879341531339996, 99.01888731626926, -66.54175424399632, -305.91636423915986, 117.59065320807822, -61.11371568696064, -104.40963812261589, -46.900443947460154, 136.3342008835867, 105.99023816959638, 118.51300411281024, -1.7377602942958297, 1.3489989996453033, 56.70725645088416, -16.96528405496998, -123.00507402974557, 3.3201775596362766, 101.22053621738354], "policy_predator_policy_reward": [85.7571630630883, 214.37818502745878, 47.36025438453838, 19.76050727509405, 140.9084704600416, 99.19520088717813, 78.6280251765456, 392.54214233769983, 195.28865228400605, 33.24792017843521, 4.322191761563046, 40.73075835418655, 46.837078457052684, 141.35155804762917, 167.83301886111482, 236.17880923324623, 240.61344289691544, 12.69999610288997, 96.93719451931028, 150.55308759311848, 51.839684387983105, 151.58299125379776, 53.541399758510806, 226.97288465961785, 101.28910145833274, 31.114975512750863, 38.8403252074672, 69.98395260167355, 263.34401256279887, 345.3648049722329, 3.7925772710025902, 118.5420633536132, 79.29240851896998, 101.67094884757175, 94.7185465049134, 32.66068829191354, 119.58115822189852, 139.54624809503906, 82.37965504622034, 2.950726327995139, 143.46387081135344, 326.46018067359483, 117.30499665114456, 116.15522813549651, 81.41930459128041, 56.9791150381583, 7.105961917322191, 43.75378620283253, 79.78667485511987, 16.011409151807317, 190.1083981494805, 100.66807679022119, 108.53913818378126, 89.70334984380924, 48.65322003614164, 389.1411458146588, 215.9476762326727, 40.452150128171475, 304.2683143052414, 17.616233887427015, 230.24436434194183, 212.34345254870448, 67.17139162608527, 20.870574687302486, 6.7458727101438765, 246.8437113132758, 40.57253541711919, 146.74935364052698, 213.81176825978739, 145.2291814113793, 270.3941781470364, 148.85230764005846, 229.96863079374745, 4.690701087276621, 114.56023263226486, 108.15009675172354, 288.56258045473584, 108.05904866856213, 320.18333796447365, 107.2070092586987, 21.432909893456046, 238.42207073112013, 181.4829025747419, 39.145679952602244, 150.26043305149227, 44.52884789217772, 39.31084806688395, 107.80068223040479, 191.90264263511747, 26.759101949655975, 73.6147498914737, 233.30867275500006, 71.66827608655015, 243.535437071984, 261.36425755699037, 502.69399914612893, 6.781599224283131, 80.9966159466854, 286.9070710195397, 138.55185174520642, 123.41298802118422, 2.049523790135794, 239.70700566215226, 169.25256084543935, 79.00802434205299, 313.032098889562, 200.19252437779696, 205.63317501970815, 235.28880679208243, 250.29517636778618, 161.58215129305458, 9.679348082172337, 74.44830238024743, 109.73620890627667, 78.30890605637552, 96.18401080039999, 68.26291097476145, 182.08628766901333, 30.174550198401853, 132.12112616283073, 149.9897666617022, 121.26749506590136, 57.029468836564575, 92.2498976632535, 171.09551710869093, 16.99420932309225, 6.520658468659978, 8.381112683730583, 88.014609071948, 358.29780203160067, 7.109346791921355, 75.31371568696086, 198.40963812261583, 84.40044394745975, 3.7907461077031073, 13.484814839113367, 34.45023590351049, 18.17452027797506, 57.451001000354786, 33.49274354911597, 181.96122241631156, 81.67198468971438, 59.97982244036379, 13.979463782616108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.777711144638943, "mean_inference_ms": 5.097961983376017, "mean_action_processing_ms": 1.53442385432861, "mean_env_wait_ms": 13.143357740851323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008000267876519097, "StateBufferConnector_ms": 0.006985333230760362, "ViewRequirementAgentConnector_ms": 0.22642678684658474}, "num_episodes": 72, "episode_return_max": 259.5999999999994, "episode_return_min": -34.37132585035781, "episode_return_mean": 95.3726857370439, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 78.51542482573097, "num_env_steps_trained_throughput_per_sec": 78.51542482573097, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 203781.721, "restore_workers_time_ms": 0.135, "training_step_time_ms": 203781.405, "sample_time_ms": 14221.681, "learn_time_ms": 189533.654, "learn_throughput": 84.418, "synch_weights_time_ms": 13.293}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 1, "trial_id": "3f8ac_00000", "date": "2024-08-20_10-31-43", "timestamp": 1724130103, "time_this_iter_s": 203.837730884552, "time_total_s": 203.837730884552, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326f788b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 203.837730884552, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.25719178082191, "ram_util_percent": 83.21027397260275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0229892753577106, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.335174974310336, "policy_loss": -0.01377541961514258, "vf_loss": 8.347159969743597, "vf_explained_var": 0.031445201931807096, "kl": 0.008952103016273458, "entropy": 1.5837673640125012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7320575890165788, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.096389765461916, "policy_loss": -0.010472333224036942, "vf_loss": 6.105409119873451, "vf_explained_var": 0.058946208506034166, "kl": 0.007264923000746411, "entropy": 1.5919265415933397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 259.5999999999994, "episode_reward_min": -34.37132585035781, "episode_reward_mean": 102.30628383661315, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -499.0939991461288, "predator_policy": 0.8177904986367072}, "policy_reward_max": {"prey_policy": 151.4088521201246, "predator_policy": 502.69399914612893}, "policy_reward_mean": {"prey_policy": -67.16568412053755, "predator_policy": 118.31882603884416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.90000000000019, 31.412009318411457, 30.00000000000017, 79.69999999999995, 11.99413435430488, 72.79999999999959, 83.89999999999958, 94.98289704245738, -34.37132585035781, 181.09648600222346, 59.80000000000009, 50.764076675070335, 165.48077001434783, 158.41113523999744, 96.06387421194466, 98.59999999999923, 96.82914931115666, 42.50000000000036, 109.70493358981818, 126.79999999999956, 73.8542926203914, 138.89999999999898, 131.49999999999972, 259.5999999999994, 169.39999999999918, 148.999999999999, 123.66284902131028, 178.4999999999992, 81.09999999999998, 247.4100262055243, 172.699999999999, 73.20000000000024, 95.44264609116172, 39.000000000000306, 70.50000000000011, 80.06986721169477, 153.70000000000007, 160.59999999999945, 102.41855033669725, 94.99999999999952, 168.35382649194986, 71.40000000000006, 105.30000000000003, 90.10000000000026, 107.02285141495682, 48.16673083582952, 59.30000000000042, 37.70000000000029, 153.99999999999986, 224.21105564969352, 142.79999999999964, 186.6594134413074, 71.30000000000004, 239.33957908705815, 14.81707676712401, 125.12259788806149, 27.30000000000011, 33.80000000000022, 120.1688456674111, 74.80000000000005, 89.98871647848131, 50.8672913180043, 158.3999999999996, 83.10960264919993, 118.17608007813331, 105.54417547859698, 92.36003108442262, 53.515134073856444, 82.80000000000007, 88.99999999999969, 45.40000000000016, 195.10411948616445, 51.1000000000001, 104.70653685313724, 186.99999999999946, 28.000000000000142, 46.86917669303149, 140.1999999999998, 68.00000000000003, 108.69999999999953, 192.12242938377253, 98.90425482505523, 152.6227385848148, 55.663877266011376, 23.60000000000005, 24.29316560080336, 58.10000000000029, 205.6999999999995, 102.49235200710979, 182.79999999999944, 19.862808093933488, 108.23259198045238, 94.56995312487808, 41.4000000000003, 174.5771867676409, 69.57445307766373, 125.81776059361712, 163.22610955428095, 94.53948996871189, 27.100000000000115], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-164.00264263511798, 8.240898050344068, -203.3961453266797, -72.11526800138357, -54.591588772577246, -230.61212438595751, -185.26425755699034, -499.0939991461288, -44.35386268282289, -31.43021813384034, -277.8070710195386, -74.85185174520639, -100.71298802118474, 59.15047620986426, -8.103715417865862, -305.8729540472675, -318.06471872762074, -108.34673035435227, -227.74100942293833, 3.011796027656061, -195.4888067920826, -230.2951763677864, -77.40610976533593, -43.09131293482113, 67.31493902057056, -86.01868029274596, -72.0484429879867, 55.96666137120968, -50.621933857819066, -103.66339057401088, 41.125449801598286, -104.8211261628313, -136.9800715829866, -37.4480408334599, -30.029468836564348, -76.74989766325402, -50.224410386796954, -28.160382455167294, 12.879341531339996, 99.01888731626926, -66.54175424399632, -305.91636423915986, 117.59065320807822, -61.11371568696064, -104.40963812261589, -46.900443947460154, 136.3342008835867, 105.99023816959638, 118.51300411281024, -1.7377602942958297, 1.3489989996453033, 56.70725645088416, -16.96528405496998, -123.00507402974557, 3.3201775596362766, 101.22053621738354, -126.21969886797376, 30.37872814756593, 10.603085027798716, 32.277304906442254, -19.947345080705205, 138.69601730538974, -52.01010204483294, -113.4331610400342, 55.68877511366641, -106.17744410924007, -44.782636803425135, -24.27272994671481, -48.383610420445585, -97.88787988925755, -44.42633231298905, -143.44926342246976, 5.630585642780655, 31.71982006924253, -81.30088665506139, 65.70184861306141, 31.597340699347136, -259.434699297782, -168.85687833455898, -1.9443779867826938, -35.25466978582253, -52.615578268114994, -126.66756924742259, -86.5991114950272, -14.916184279868714, -8.284769202087613, 17.67534997191249, -97.18707736050881, -142.47956441245668, -5.878608569016292, -18.453908915921062, -158.44486163529035, -35.20619704352184, -1.813878973963103, 17.46429376838018, -158.51245246461056, -24.224650514804985, 110.23607919027431, -227.90742981967918, 96.89148423236902, -143.82748968736433, 42.4667727365932, 45.390648530516536, 48.119069781068575, -78.4167873343494, -24.860219490837828, 60.91561331691869, 9.826897142582055, -245.52478422532116, -354.5796550217902, -179.95690912866232, 15.095757222773564, -50.84373102817433, -169.84817763354397, -13.42487538513155, -16.74106089016719, 27.018629207449422, -286.6833930726611, 13.665645134286915, -220.79202704941204, -179.23164937125716, -101.64269301224459, -194.3437183573769, -22.940322073486755, 63.514491907002245, -83.86885278816905, 33.46349839826343, -144.88391038776066, -188.2883173331235, 87.61630692630018, 9.703842011615444, -65.78160920895087, -18.984450211335208, -147.0442543506262, -116.44412361204833, -202.62089407630285, -290.62294563695303, -30.445682088391393, -84.09127251804011, 15.123071765984106, 14.626043624058733, -83.47227025134292, -4.9191829951983586, -37.705271227827474, 30.49459264564321, -284.7282250474149, -286.5844333581835, 28.630042591624907, 10.077134904755455, 151.4088521201246, 4.812578465595999, -254.2511103705632, -284.2585826990935, -286.4936269833251, -73.57558519679051, 55.049365425343915, -321.72779602733056, -128.15603222994676, 18.953532652020513, -117.56824147726694, -135.30936527018068, -220.57960161876537, 23.002879497957633, -138.75727558240078, 29.021916933642686, 32.16605306831709, -90.48621870983148, -118.76833453304536, -170.97333284147413, -228.7438786810616, -133.1776821135167, -162.923946901987, -34.49531936572782, -96.09191384636618, 115.15375028801553, 37.949422685125576, -48.85696025006321, -102.8013673505522, 12.025236662134397, 16.59076204077474, -115.32723267351531, -192.79421090977462, 11.286355979345526, -161.61682467231222, -101.21000968748447, 20.809896426902416, -42.077076710218776, 2.931207489015885, 24.51622098572803, -6.127206742407882, -208.14914537830694, -63.64380950093239, -126.91527915248386, -98.76005147750942, 67.82880755443333, 18.997112546046324, 57.47843784353997, 10.452208686623202, -137.50586576937218, -92.3756446365665], "policy_predator_policy_reward": [191.90264263511747, 26.759101949655975, 73.6147498914737, 233.30867275500006, 71.66827608655015, 243.535437071984, 261.36425755699037, 502.69399914612893, 6.781599224283131, 80.9966159466854, 286.9070710195397, 138.55185174520642, 123.41298802118422, 2.049523790135794, 239.70700566215226, 169.25256084543935, 79.00802434205299, 313.032098889562, 200.19252437779696, 205.63317501970815, 235.28880679208243, 250.29517636778618, 161.58215129305458, 9.679348082172337, 74.44830238024743, 109.73620890627667, 78.30890605637552, 96.18401080039999, 68.26291097476145, 182.08628766901333, 30.174550198401853, 132.12112616283073, 149.9897666617022, 121.26749506590136, 57.029468836564575, 92.2498976632535, 171.09551710869093, 16.99420932309225, 6.520658468659978, 8.381112683730583, 88.014609071948, 358.29780203160067, 7.109346791921355, 75.31371568696086, 198.40963812261583, 84.40044394745975, 3.7907461077031073, 13.484814839113367, 34.45023590351049, 18.17452027797506, 57.451001000354786, 33.49274354911597, 181.96122241631156, 81.67198468971438, 59.97982244036379, 13.979463782616108, 70.33889363976427, 106.60207708064347, 100.96510529242458, 103.56453097885917, 45.74734508070544, 8.203982694609962, 114.41010204483244, 124.23316104003429, 123.62161570189824, 22.309699384838, 60.382636803425356, 47.67272994671506, 64.7836104204458, 151.98787988925744, 199.27757948223294, 68.6678834649206, 53.147055182701955, 63.20253910527504, 121.10088665506152, 55.098151386938525, 124.85184985544566, 205.40405907968744, 263.7034561128138, 2.097800208527246, 109.08922944957355, 147.13484509631385, 181.86756924742235, 102.79911149502725, 35.216184279868955, 93.28476920208745, 30.729072568164902, 138.8826548204315, 61.292271070482855, 194.08875332594712, 170.36287491253375, 54.70262647450651, 73.60619704352202, 22.713878973963055, 10.0357062316198, 168.71245246461032, 54.35362420678546, 13.634947117745378, 246.57358994808547, 108.65341128891829, 156.22748968736366, 87.93322726340685, 15.86561340024357, 77.2840817294794, 123.71678733434875, 50.86021949083807, 66.16003314290785, 102.43703548465031, 349.2610449511351, 265.66047106309975, 26.84601001124483, 263.13773978270564, 68.64373102817454, 179.34817763354351, 28.456525446050087, 35.509410829248935, 18.473425146245518, 361.3601843863786, 80.13876555037804, 201.78761636474684, 199.2214886613007, 171.64157020068234, 182.17060905369735, 85.98072269517017, 73.68550809299776, 105.06885278816839, 22.14383326713899, 172.386181371559, 15.969259865327372, 202.8788306196297, 117.16358660243645, 44.458356073495274, 76.1923867081658, 182.19634893821834, 254.30208448891773, 118.27806727328945, 316.5229456369528, 87.34568208839097, 128.7580621914777, 29.210138560577967, 9.073956375941234, 105.17227025134264, 95.92035371594109, 141.80821999324934, 14.205407354356822, 291.12822504741564, 214.65650895963788, 148.0044186600588, 24.6962224764832, 0.8177904986367072, 13.987421534403968, 263.451110370563, 257.7166387152699, 359.9047476601809, 124.67558519679054, 34.05063457465623, 375.62779602733065, 142.2560322299464, 77.84646734797956, 129.4682414772664, 237.23693429584293, 310.77446197687567, 34.83215985376606, 179.8264910557324, 13.896028244142915, 77.53874033871308, 145.33408780440462, 119.58434270448292, 182.27333284147403, 241.04387868106093, 229.38002060452595, 91.01477401178039, 51.295319365727934, 137.39191384636607, 1.6121417640965747, 50.98468526276239, 124.81081464632159, 129.3398649614036, 61.83697711019776, 92.34702418689326, 140.75067365724624, 187.23357801997597, 40.446236001107074, 218.1168246723122, 107.07335983180741, 67.89670655365363, 9.603207105948428, 70.94266211525449, 46.00170828203719, 110.18646424228372, 211.5671798133971, 129.8002281435052, 195.8561553239701, 155.63693589963984, 16.631751420921738, 59.76843803288046, 23.34736942360001, 3.2614740149502595, 150.1058657693715, 106.87564463656605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.015674454486739, "mean_inference_ms": 5.503608160012565, "mean_action_processing_ms": 2.2066292799420375, "mean_env_wait_ms": 12.736460936956908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01712346076965332, "StateBufferConnector_ms": 0.016992926597595215, "ViewRequirementAgentConnector_ms": 0.2547168731689453}, "num_episodes": 72, "episode_return_max": 259.5999999999994, "episode_return_min": -34.37132585035781, "episode_return_mean": 102.30628383661315, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 77.28505630148702, "num_env_steps_trained_throughput_per_sec": 77.28505630148702, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 205403.77, "restore_workers_time_ms": 0.102, "training_step_time_ms": 205403.541, "sample_time_ms": 14896.009, "learn_time_ms": 190475.434, "learn_throughput": 84.0, "synch_weights_time_ms": 17.235}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 2, "trial_id": "3f8ac_00000", "date": "2024-08-20_10-35-13", "timestamp": 1724130313, "time_this_iter_s": 207.09996676445007, "time_total_s": 410.9376976490021, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 410.9376976490021, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.30402684563758, "ram_util_percent": 83.03825503355705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7234195422085505, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.8391840286355805, "policy_loss": -0.012621047835496486, "vf_loss": 7.850084564168617, "vf_explained_var": 0.07936489440145947, "kl": 0.008602521356340577, "entropy": 1.5686219291712242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8863621382565094, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.215689076822271, "policy_loss": -0.012352251019033174, "vf_loss": 5.226473340534029, "vf_explained_var": 0.08202128441876204, "kl": 0.007839933669172405, "entropy": 1.5783921227884041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 263.91436472516097, "episode_reward_min": 10.925777908913517, "episode_reward_mean": 117.64661819266159, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -321.72779602733056, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.4088521201246, "predator_policy": 375.62779602733065}, "policy_reward_mean": {"prey_policy": -41.58762053204539, "predator_policy": 100.41092962837621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.1000000000001, 104.70653685313724, 186.99999999999946, 28.000000000000142, 46.86917669303149, 140.1999999999998, 68.00000000000003, 108.69999999999953, 192.12242938377253, 98.90425482505523, 152.6227385848148, 55.663877266011376, 23.60000000000005, 24.29316560080336, 58.10000000000029, 205.6999999999995, 102.49235200710979, 182.79999999999944, 19.862808093933488, 108.23259198045238, 94.56995312487808, 41.4000000000003, 174.5771867676409, 69.57445307766373, 125.81776059361712, 163.22610955428095, 94.53948996871189, 27.100000000000115, 87.32533576580254, 32.62113428675061, 94.09999999999955, 170.99999999999955, 110.89249179699908, 98.79999999999946, 177.99999999999963, 153.31381476135334, 141.1064588771892, 132.0131991472565, 80.50000000000014, 154.00000000000003, 31.640349834619293, 242.46091342128926, 111.49999999999977, 102.89984904105798, 180.95341528697818, 43.70000000000028, 153.49999999999943, 69.0608390787103, 163.51657437382985, 97.24465005685693, 158.4300907192836, 157.26993885875032, 165.56964420795435, 209.6055831279617, 97.14015287147639, 69.62843071085774, 52.524768921832035, 71.09999999999988, 76.21722442609494, 77.61532139429288, 155.2999999999996, 10.925777908913517, 135.69999999999968, 50.14635103061888, 70.20000000000024, 41.90000000000001, 193.97611655385273, 117.39992577279143, 205.46545363418235, 166.80000000000004, 65.31728403127015, 112.30000000000001, 172.49420344736595, 85.99999999999993, 86.39999999999989, 98.49999999999946, 137.10103406291634, 84.24740070181757, 83.92188104683365, 139.49999999999966, 165.29999999999998, 162.9743615616206, 92.99999999999892, 95.36437675029937, 179.94437469477788, 38.20000000000017, 259.5789249877045, 56.10000000000011, 260.74640086102954, 257.2999999999995, 153.06677273972076, 115.39999999999935, 243.62204177572147, 123.13288160734933, 90.99050751905868, 43.17493880317429, 263.91436472516097, 79.00157586005797, 117.12613479718073, 238.10366905063523], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.49459264564321, -284.7282250474149, -286.5844333581835, 28.630042591624907, 10.077134904755455, 151.4088521201246, 4.812578465595999, -254.2511103705632, -284.2585826990935, -286.4936269833251, -73.57558519679051, 55.049365425343915, -321.72779602733056, -128.15603222994676, 18.953532652020513, -117.56824147726694, -135.30936527018068, -220.57960161876537, 23.002879497957633, -138.75727558240078, 29.021916933642686, 32.16605306831709, -90.48621870983148, -118.76833453304536, -170.97333284147413, -228.7438786810616, -133.1776821135167, -162.923946901987, -34.49531936572782, -96.09191384636618, 115.15375028801553, 37.949422685125576, -48.85696025006321, -102.8013673505522, 12.025236662134397, 16.59076204077474, -115.32723267351531, -192.79421090977462, 11.286355979345526, -161.61682467231222, -101.21000968748447, 20.809896426902416, -42.077076710218776, 2.931207489015885, 24.51622098572803, -6.127206742407882, -208.14914537830694, -63.64380950093239, -126.91527915248386, -98.76005147750942, 67.82880755443333, 18.997112546046324, 57.47843784353997, 10.452208686623202, -137.50586576937218, -92.3756446365665, -14.46051188236428, -126.06519373855912, -177.56457458745652, -24.102709321121047, 1.6755600974192018, -113.72043799293802, 70.94991916772028, 12.130708801190913, -126.22956938189954, 2.6459235653108557, 47.31423393183275, 15.237842518780479, -89.05821126245476, 125.61741541901648, 22.248363059471338, -17.22480467744402, 35.83625643390408, -134.72280346079887, -203.77238150335592, -91.47675410192832, -40.98515526842861, 4.048850782638215, -19.27101639553937, 21.35174051438416, -143.610743682004, -92.09220481870322, 117.24130901424743, -18.82688496666071, -77.95942284296389, 15.31689750322763, 30.46855601990222, -107.29748924429367, 36.60924587020693, -25.751371662927163, -5.427109272912585, 6.7105948985288215, -203.29700741691747, 94.56467671514345, -41.530281827956266, -114.5318720962341, 11.45618597382485, 67.20941260685935, -71.97598423070313, 32.78564890770028, 60.76453470730985, -2.552011699334782, -9.529533170521638, 60.7420371619479, -12.02885570809347, 41.26544425186875, 52.37996978290645, 69.60407164939352, -91.4617064930561, 40.472093219565615, 4.629412720038435, -50.200004078539095, -104.10095284007863, -33.840317746604974, -94.49571358247225, 52.6341659454659, -97.35737500099813, 19.088080452055134, -90.51900668178419, -21.25357741655941, -99.60055124575746, -0.5500397417359011, -147.46630519188784, -138.6493908147437, 28.485587613015294, 70.9966140744632, 29.045138384447675, -111.57910398875262, 17.98650073356996, -26.270964540286545, -201.62350297524117, -165.25576945790291, 36.87892846636869, -126.78679186637001, -29.656278992213753, -147.62676558624614, 93.27348510229808, 40.94969427784555, 43.68301094133579, -93.12213233534786, -70.37931413162953, -75.88978954153525, -41.258378559559425, -38.869793741232876, -10.299398601234042, 40.950938765113605, 39.09505115739388, -145.04396777148867, -162.41094376021644, -47.066126591353324, -108.13115058096032, 33.29668057003784, 72.23961508264986, -147.39633096089483, -112.28903516659271, 27.824837447617636, 25.11479714285417, -121.3567757519308, 46.734649574117036, -2.7289663120290846, -54.28395535591581, 19.67857215774598, -11.129531754627834, -46.039007226368454, 18.54997873893644, 53.976714490379415, 31.663479030714058, 13.872731057672683, -39.20752268839104, -30.028875427035395, -189.23248663019803, -2.3685016547903763, -14.942150778557114, 111.96087499104092, -59.29012377032993, -30.453994421505463, -0.012375087124880224, 101.9509654402843, 99.91503441228672, 127.99999999999999, -130.54314028930213, 123.5430635705528, 2.631288391720551, 3.075336793804759, 126.02449328082852, 65.89999999999993, 72.55354309372908, -83.28113933700335, -20.01575558501037, -89.09515635480452, -289.8552248448791, -157.1308801617574, -94.97711337161772, 140.47879872473425, -182.36962055451593, -22.077472303764672, -60.92663105815762, -233.80827196361992, 140.7413337130055, -204.75012616741628], "policy_predator_policy_reward": [14.205407354356822, 291.12822504741564, 214.65650895963788, 148.0044186600588, 24.6962224764832, 0.8177904986367072, 13.987421534403968, 263.451110370563, 257.7166387152699, 359.9047476601809, 124.67558519679054, 34.05063457465623, 375.62779602733065, 142.2560322299464, 77.84646734797956, 129.4682414772664, 237.23693429584293, 310.77446197687567, 34.83215985376606, 179.8264910557324, 13.896028244142915, 77.53874033871308, 145.33408780440462, 119.58434270448292, 182.27333284147403, 241.04387868106093, 229.38002060452595, 91.01477401178039, 51.295319365727934, 137.39191384636607, 1.6121417640965747, 50.98468526276239, 124.81081464632159, 129.3398649614036, 61.83697711019776, 92.34702418689326, 140.75067365724624, 187.23357801997597, 40.446236001107074, 218.1168246723122, 107.07335983180741, 67.89670655365363, 9.603207105948428, 70.94266211525449, 46.00170828203719, 110.18646424228372, 211.5671798133971, 129.8002281435052, 195.8561553239701, 155.63693589963984, 16.631751420921738, 59.76843803288046, 23.34736942360001, 3.2614740149502595, 150.1058657693715, 106.87564463656605, 57.89027069993425, 169.96077068679216, 55.83575403954775, 178.45266415578016, 56.62443990258081, 149.52043799293793, 55.6594301599053, 32.25994187118348, 88.60662276729008, 145.86951484629773, 31.985766068167298, 4.262157481219486, 112.41229344896958, 29.02850239446844, 84.7516369405284, 63.538619438797724, 58.87020244328526, 181.12280346079888, 126.13640277396584, 301.1259319785747, 79.24810900623481, 38.188195479555525, 68.07101639553952, 83.84825948561566, 170.70491498117323, 96.63838335415254, 101.37254403351832, 42.67394534018454, 167.55942284296393, 6.583102496772347, 69.0288640276164, 110.69991823783343, 41.54776228978411, 128.5477787899145, 23.72710927291252, 18.689405101471138, 232.1391952456499, 30.093135456123502, 124.93142448827832, 100.19156851462229, 50.4319280803182, 34.41904771282801, 131.05369013081216, 5.381295249048491, 51.41155339223586, 48.806014319073235, 25.44965127818222, 80.60778358914298, 58.37448674273679, 77.95856892144269, 86.49761798670983, 1.1239237089519913, 62.36741368083303, 85.76235246413309, 23.73232404515444, 91.4666980242042, 106.48093711776085, 83.98510239075443, 106.69571358247221, 6.265834054534302, 130.94147365863313, 23.54504531640517, 141.48639156995245, 47.901513922683, 111.46677467969218, 143.9838163078006, 130.05665381975808, 166.9848200957858, 6.114412386984874, 30.103385925536724, 0.0, 132.68031663492317, 19.57139936559559, 58.91306444112121, 211.62350297524125, 197.15576945790252, 112.0256993817417, 171.85828057211202, 179.14386450139438, 115.53910584985715, 47.99675536164219, 23.245518892396557, 68.5169890586642, 147.72213233534734, 70.20256629501985, 141.383821409415, 67.0761243445509, 125.35204795624101, 60.99133811134848, 80.85132517213867, 40.7962184980445, 151.1526981160502, 175.4109437602158, 120.46612659135307, 120.63115058095967, 52.703319429962306, 88.71805327949379, 123.53969666166712, 157.72821764385276, 10.98338077693949, 23.317674968280652, 156.84618468762937, 66.06535042588298, 29.4289663120292, 148.38395535591562, 51.52142784225401, 93.04755239006762, 127.09534815254932, 8.064488457013043, 12.408818313671206, 11.94346344886916, 37.884703213043636, 160.0610939612463, 89.11967884895799, 199.92461380730396, 29.876374477683832, 121.13515710180185, 41.42504367341901, 122.07279653006864, 23.771321661766986, 50.05584888034709, 108.75196162752299, 29.38496558771303, 0.0, 146.35062276316887, 13.716226695301275, 88.77586882285193, 20.91750599162282, 2.6220417757218857, 49.075506719171486, 45.54374662079443, 88.31673122982923, 174.64360820127482, 25.457811257599435, 319.7756236706759, 170.38542013913482, 123.56351276559418, 94.8491666064499, 112.84345045707211, 170.60521826126666, 235.6505692188002, 176.21046860015807, 179.13941021324914, 122.97305129179693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.11221342725994, "mean_inference_ms": 6.515669302358547, "mean_action_processing_ms": 2.4120701070467185, "mean_env_wait_ms": 13.33772859579565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02222895622253418, "StateBufferConnector_ms": 0.007174134254455566, "ViewRequirementAgentConnector_ms": 0.2804471254348755}, "num_episodes": 72, "episode_return_max": 263.91436472516097, "episode_return_min": 10.925777908913517, "episode_return_mean": 117.64661819266159, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 75.9261901533057, "num_env_steps_trained_throughput_per_sec": 75.9261901533057, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 207179.512, "restore_workers_time_ms": 0.072, "training_step_time_ms": 207179.338, "sample_time_ms": 16208.05, "learn_time_ms": 190943.546, "learn_throughput": 83.794, "synch_weights_time_ms": 14.923}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 3, "trial_id": "3f8ac_00000", "date": "2024-08-20_10-38-44", "timestamp": 1724130524, "time_this_iter_s": 210.7879650592804, "time_total_s": 621.7256627082825, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326e7c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 621.7256627082825, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.968227424749166, "ram_util_percent": 83.05083612040133}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6500513153259087, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.566475552604312, "policy_loss": -0.014365271420806902, "vf_loss": 7.579135108624817, "vf_explained_var": 0.09770278656293475, "kl": 0.008528671064106107, "entropy": 1.5480727215292593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9003235464058225, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.306897577406868, "policy_loss": -0.011429446782835478, "vf_loss": 5.316677173231014, "vf_explained_var": 0.090014624406421, "kl": 0.008249265262080977, "entropy": 1.5634254080277903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 337.5000000000001, "episode_reward_min": 5.180814062358941, "episode_reward_mean": 136.1212610608829, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -321.0451849900533, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 174.79986937002246, "predator_policy": 319.7756236706759}, "policy_reward_mean": {"prey_policy": -19.830550234983523, "predator_policy": 87.89118076542502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.74640086102954, 257.2999999999995, 153.06677273972076, 115.39999999999935, 243.62204177572147, 123.13288160734933, 90.99050751905868, 43.17493880317429, 263.91436472516097, 79.00157586005797, 117.12613479718073, 238.10366905063523, 42.55230131284952, 156.69999999999956, 171.93379968754923, 249.6454020789113, 53.20000000000018, 59.70000000000047, 5.180814062358941, 38.60000000000018, 109.17622479598904, 103.5131346899461, 34.6791820401121, 87.41168121066242, 148.89906906341378, 166.99999999999946, 51.59122658764635, 133.63504336521666, 125.69999999999966, 26.0794695035296, 29.700000000000138, 291.3786158726017, 162.98123833801046, 240.79999999999956, 100.98864598846326, 78.55282850579758, 196.32284271727428, 247.7492341712824, 85.7661735036931, 30.33801076543555, 108.42683546505685, 158.3481953914764, 76.30000000000004, 141.4000000000001, 99.89621359274722, 38.15443045433764, 113.52059706987967, 199.46371045690088, 194.7999999999997, 174.8016974787903, 178.2999999999992, 33.70000000000021, 152.03562779201758, 59.69999999999999, 64.70000000000016, 127.49999999999983, 126.20000000000006, 36.56993798504604, 166.9281304654815, 150.97568084904015, 296.10000000000025, 175.22349847965023, 38.80000000000022, 337.5000000000001, 143.58128196368884, 206.09999999999968, 203.00709299727254, 140.6077257540926, 30.61003348958117, 142.29999999999887, 238.11049609150413, 99.3999999999998, 261.3293647084621, 156.89999999999986, 100.99999999999937, 64.10000000000021, 100.68830091741356, 118.59999999999994, 233.4349373982346, 91.90000000000006, 222.19036682540167, 105.16446009885186, 107.40073196330681, 197.7365570673369, 54.24666183660525, 183.49999999999957, 166.3999999999996, 271.22095018353707, 131.17474196230543, 213.50219934594543, 164.79999999999978, 59.70000000000009, 62.500000000000206, 44.462415954114675, 118.68075318140308, 122.5074239143324, 161.49691721705977, 65.56548789859573, 161.4084238389927, 202.0999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.012375087124880224, 101.9509654402843, 99.91503441228672, 127.99999999999999, -130.54314028930213, 123.5430635705528, 2.631288391720551, 3.075336793804759, 126.02449328082852, 65.89999999999993, 72.55354309372908, -83.28113933700335, -20.01575558501037, -89.09515635480452, -289.8552248448791, -157.1308801617574, -94.97711337161772, 140.47879872473425, -182.36962055451593, -22.077472303764672, -60.92663105815762, -233.80827196361992, 140.7413337130055, -204.75012616741628, -19.299811052309863, -50.10461351469376, 90.06880694799426, -97.6057845998667, 68.874305725025, -28.139179855769704, 94.55669101044177, 87.09429378295856, -48.06972125297925, -88.13513838478137, 20.850155130053974, 30.141154647247394, -100.53155094908915, -183.37211573990203, -43.44600745984583, -19.970381482716675, -5.285763614966241, -37.584872936122736, -112.94888881883205, -19.786692585836867, -4.506675720871279, -98.28634079241594, -1.9766652600231982, -25.73325431921525, 32.410121100307876, -214.21373351752376, -16.942353971874354, 61.25903908928471, -228.47515294584957, -4.474903880796444, -48.54007313107049, -12.204420381073016, 58.07981313847702, -7.311409140709747, -60.14876193245158, -168.67178973274608, -176.76021183393604, -9.195497696401299, 43.96114681725974, 165.4912650400552, -151.6285842475749, 49.149146943801874, 21.44893638955401, 123.923063364129, -133.4665964589822, -56.25815274505643, -118.62466957323487, -5.415383186762455, 83.99965867728241, -65.5523971446833, -109.46974148444764, 172.2164222675593, 31.4561182434689, -176.66525548011805, -15.346373253941314, -38.826210851580946, -69.63221664958769, 58.88622583322887, 99.5091733885339, -4.1269432874055685, -46.26079385973228, -95.92231242048035, 56.308905801034946, -43.80293872314769, 13.540514004033586, -15.860386182836816, -88.17564939238747, 11.006605138087535, -151.5935304721526, -6.358623257317062, 23.123094102297664, 88.84155319975815, 166.69587580709475, -200.81003475103137, 111.51158994809715, -58.23758503271286, 155.66344871663097, -88.77147605739434, -16.94688414640811, -28.743510249759474, -117.1141531452419, 96.33694967866309, -237.7634285982171, -66.47474628843239, 9.49040652592984, -18.337616385674146, 28.88509906969692, -32.822454130349456, 52.02967546944788, -100.43845127947313, -38.90808095196713, -132.1700921501145, -25.539618963546502, 119.19420631593238, 34.97156185126774, -4.395909309172643, 121.70671287045184, 87.15246073874647, -54.99765816855931, 105.47450885478892, -67.66627351464919, -44.72896400398119, 174.79986937002246, 158.4055612760571, 20.778021888529977, -54.36011891956782, 80.53303224979965, 97.974233920741, 46.8824698735693, 115.39678283425992, 66.62274794672585, -32.62181834952083, -8.92614693182807, -172.3340046273825, 27.492797358851842, 68.25380095025395, 146.5206648607486, -136.71314921145694, -57.73365752189873, -79.85233996380106, 125.93012176960482, -321.0451849900533, -30.099378557203167, 78.71740253371986, -32.56336054669886, -21.305809604715073, -125.69201556495508, 0.7963044655578937, -99.3161966354286, 5.653471827955003, -231.7743909804395, -8.170223945042764, -46.407183200097236, 114.69251600381685, 44.691787653956474, -273.696692367797, 122.58409429548794, -33.033928031567854, -74.55576639673588, -82.66563042286411, -0.4523475715510028, -66.62155634734744, 82.25287226247798, -7.719748007570557, -167.72054498597333, -3.08326709651252, 112.77654237226756, -8.142585709013977, 12.724490454933994, 10.852484804065284, 30.463456292105747, 47.20840018277622, -90.3942422270022, -41.36074245571845, 72.32913723653644, -2.5015635065929036, 18.917353903421585, -110.06242617408786, -59.92449762852093, -195.57533415136052, -5.328771923100064, -57.92312353817828, -9.400101073352833, -44.35959530998922, -105.40922981982264, -153.25913213322926, -0.9498728703287102, -71.1352480489546, 29.42933730199474, -192.92058907414375, -207.28682995846768, 3.923364842154528, 81.82054642408058, -28.765193752508807, 140.1122878579822, -4.1866555465899005], "policy_predator_policy_reward": [50.05584888034709, 108.75196162752299, 29.38496558771303, 0.0, 146.35062276316887, 13.716226695301275, 88.77586882285193, 20.91750599162282, 2.6220417757218857, 49.075506719171486, 45.54374662079443, 88.31673122982923, 174.64360820127482, 25.457811257599435, 319.7756236706759, 170.38542013913482, 123.56351276559418, 94.8491666064499, 112.84345045707211, 170.60521826126666, 235.6505692188002, 176.21046860015807, 179.13941021324914, 122.97305129179693, 21.369398866301314, 90.58732701355189, 51.00924746425015, 113.22773018762146, 96.15821494668624, 35.04045887160775, 12.231759002181256, 55.76265828332968, 69.1697212529794, 120.23513838478074, 2.4498448699460695, 6.258845352752796, 235.70651548404913, 53.37796526729999, 58.046007459845995, 43.97038148271689, 112.15937781656481, 39.88748353051381, 166.36093876462195, 69.88777732999336, 48.93791056967639, 88.5342879837226, 16.972532305159458, 98.14906848474101, 154.25418172723766, 176.4484997533924, 119.2423539718744, 3.4409609107154857, 116.08031477874526, 168.46096863554675, 151.8400731310705, 42.53946374629024, 34.03031865216731, 40.90127735006552, 55.827768408059065, 199.07225276066836, 188.96021183393572, 26.695497696401283, 51.00900390609117, 30.917200109195047, 178.6168046970165, 86.84387094476683, 74.65109247248621, 20.77690777383046, 172.55673060228034, 118.15666459022144, 195.3932544595052, 7.19962680628985, 83.40010814307556, 94.4754730415996, 122.11668473816319, 62.88586865000768, 57.9589791164769, 173.0163316238648, 33.19867068678012, 51.31192418417795, 11.60985698345368, 107.56296929796304, 41.13176309846042, 21.834202191888348, 61.46079385973249, 157.02231242048003, 31.778359448350024, 97.11567347376217, 78.37007815309981, 23.84600761845134, 102.07564939238682, 13.247825316249795, 96.75742401649478, 174.71532678285493, 56.17560515908943, 31.323457995756417, 8.404124192905257, 220.51003475103104, 70.18695820281822, 51.34073436058806, 8.536551283368844, 102.87147605739354, 34.24688414640836, 45.143510249759686, 90.54779920058147, 82.26503205801482, 89.02116583797144, 274.9170090486777, 30.709593474070235, 42.83761638567428, 71.31490093030311, 60.122454130349674, 16.07032453055209, 158.53845127947315, 88.80935857611817, 118.83875251100898, 33.596976994035295, 39.67656611906101, 56.84438604826005, 63.555642258685324, 25.3932871295481, 61.847539261253544, 82.31418265158817, 42.43246514183255, 116.88274157652113, 34.31249594210854, 0.8001306299774965, 3.4944387239428862, 38.797010976012714, 138.36636801871407, 1.9532763287705208, 25.639457500689005, 24.004380067122433, 16.723460222321794, 76.93135759298204, 29.67543856390602, 128.2250963631656, 83.6450886856258, 17.73640527314037, 28.816996417754027, 36.0735400183462, 192.2294404238662, 80.02143611893848, 156.9645613667607, 302.35522583329123, 154.08920209561984, 75.77160955705986, 32.51036646642306, 60.48374248321399, 94.38542766820024, 170.69201556495491, 18.3036955344421, 115.57516030453455, 78.77586542035291, 236.97439098043935, 121.57022394504274, 33.20203263311495, 131.94757196140003, 39.208212346043524, 281.69669236779765, 29.7943594049189, 102.84584115656281, 177.7178056054433, 84.66805131300862, 80.90371853429703, 93.57091734790855, 117.50961311823507, 5.693819694194658, 190.27365148021624, 34.7768224388741, 58.048380094083555, 20.817663242662828, 83.42435201784897, 59.398672723151776, 151.83179490875932, 41.71729879989585, 50.32474593567159, 212.60498070935438, 81.34304591179486, 62.3315797042071, 63.38264609657853, 192.56242617408793, 76.1244976285203, 239.07533415136004, 51.72877192310007, 74.0231235381785, 46.38001440277457, 51.84209793468215, 160.2990581220092, 217.05005701244573, 117.43899334604123, 77.15355148757497, 216.39306427038488, 108.5951047188238, 112.1554244778881, 156.77352853702016, 24.87811770332175, 83.47495346409994, 33.08771214201779, 33.08665554659008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.176836031350883, "mean_inference_ms": 6.052560704603963, "mean_action_processing_ms": 2.3417810981229463, "mean_env_wait_ms": 13.21393905947898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007158994674682617, "StateBufferConnector_ms": 0.00496983528137207, "ViewRequirementAgentConnector_ms": 0.31930673122406006}, "num_episodes": 88, "episode_return_max": 337.5000000000001, "episode_return_min": 5.180814062358941, "episode_return_mean": 136.1212610608829, "episodes_this_iter": 88}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 80.9523439826507, "num_env_steps_trained_throughput_per_sec": 80.9523439826507, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 204796.425, "restore_workers_time_ms": 0.062, "training_step_time_ms": 204796.275, "sample_time_ms": 15383.114, "learn_time_ms": 189382.246, "learn_throughput": 84.485, "synch_weights_time_ms": 13.91}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 4, "trial_id": "3f8ac_00000", "date": "2024-08-20_10-42-02", "timestamp": 1724130722, "time_this_iter_s": 197.7210671901703, "time_total_s": 819.4467298984528, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 819.4467298984528, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.654804270462634, "ram_util_percent": 82.67188612099645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9596149451991238, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.7989190429606765, "policy_loss": -0.013829752794964604, "vf_loss": 7.810646439607812, "vf_explained_var": 0.13131612936655682, "kl": 0.010511745718522146, "entropy": 1.5297591601099287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.103341171255818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.1939959301519645, "policy_loss": -0.013779143822470571, "vf_loss": 5.205684139110424, "vf_explained_var": 0.10204680912078373, "kl": 0.010454649936220554, "entropy": 1.5418592928578614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 304.80000000000064, "episode_reward_min": 27.50000000000012, "episode_reward_mean": 141.69893383750733, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -207.28682995846768, "predator_policy": 0.7098394717713442}, "policy_reward_max": {"prey_policy": 166.86675703467117, "predator_policy": 247.1503036849125}, "policy_reward_mean": {"prey_policy": -8.73306131842148, "predator_policy": 79.58252823717524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [271.22095018353707, 131.17474196230543, 213.50219934594543, 164.79999999999978, 59.70000000000009, 62.500000000000206, 44.462415954114675, 118.68075318140308, 122.5074239143324, 161.49691721705977, 65.56548789859573, 161.4084238389927, 202.0999999999994, 160.44979666338733, 229.81726070973403, 120.19443847623987, 223.30010322601166, 181.49999999999937, 160.709873068602, 167.70642911174346, 227.6788819532587, 86.6483113748172, 198.1655082108132, 124.3236899755112, 135.92803994744273, 152.59942504492957, 105.29999999999993, 108.99013228842666, 27.50000000000012, 184.59999999999977, 184.51302747295568, 109.59999999999904, 163.29999999999967, 111.99024061008339, 149.48248457663124, 100.89999999999907, 93.38708260267725, 95.80762052145772, 179.1440692866132, 196.99999999999932, 145.44751457166387, 269.0000000000001, 98.86146623381828, 111.29999999999981, 159.35852315868365, 173.84627842875935, 58.555103285367686, 199.1999999999997, 207.05689117074255, 303.3550219647228, 113.81908514214662, 36.25821132744509, 58.3853427804609, 35.300000000000225, 137.1183185917948, 46.90550276527933, 62.35215629707566, 110.63579976026541, 135.90023087734963, 250.3818132187787, 220.62369508508527, 153.54080883375673, 188.40140783273773, 143.9999999999996, 209.49999999999932, 50.40200411191798, 139.59830673506843, 143.49999999999915, 138.59915242354353, 177.2999999999993, 94.69999999999997, 184.6999999999995, 304.80000000000064, 46.46339358981965, 45.74257869003063, 59.644781637186654, 134.74542928669592, 161.4, 107.19999999999979, 227.57457864527842, 108.59999999999974, 153.8309950292111, 180.1999999999997, 104.05626372249344, 171.923445722189, 106.73734392555748, 67.99999999999991, 150.7248378830029, 85.45245211594968, 156.29775290681175, 112.32783569264231, 183.29999999999953, 124.79999999999936, 113.19999999999999, 57.30000000000039, 189.56021081571186, 122.09999999999985, 209.7643997440757, 198.2887211300009, 168.29999999999976], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.463456292105747, 47.20840018277622, -90.3942422270022, -41.36074245571845, 72.32913723653644, -2.5015635065929036, 18.917353903421585, -110.06242617408786, -59.92449762852093, -195.57533415136052, -5.328771923100064, -57.92312353817828, -9.400101073352833, -44.35959530998922, -105.40922981982264, -153.25913213322926, -0.9498728703287102, -71.1352480489546, 29.42933730199474, -192.92058907414375, -207.28682995846768, 3.923364842154528, 81.82054642408058, -28.765193752508807, 140.1122878579822, -4.1866555465899005, -48.15349176877441, 5.8598087393928395, 52.27348231978733, 46.063314661879815, -110.1322948865012, 44.36161094340025, 157.87488179933516, 0.07899757314717526, 132.65445088067833, 15.784482115832121, -21.7560619668826, 77.57028599511341, 45.31259682018843, 23.761425994919115, 110.79478928975101, -8.750329182936566, 56.54144019334204, -53.70854469281603, 29.806383985341064, 54.293783889660695, -135.67179118943582, 57.61810051485486, -125.47781683270983, 54.094798518200655, 62.751652600701405, -26.597280113936975, 18.291583456046823, 83.74898375673192, -6.205234769808261, -31.617550392178227, -18.196178533679834, -134.87383210143074, 119.50603979939376, 12.206515220697142, 80.3080456335082, -12.972083937022472, 39.66639574622221, 40.95941008536498, 30.14435755416269, 19.77107253050844, -147.20035295194594, -38.43788801499881, 66.90810855811874, -4.943637890096708, 58.70943826079893, -1.965903084674856, -62.091684662977215, -69.5279894478784, -21.8100446844725, -128.26357064499214, -72.24304886188332, 44.91568007465172, 52.543351028962064, 52.24426031535367, -70.54191433217939, -48.07318929347184, 148.1837567031321, 65.18989437307798, -71.3981503581412, -33.873606069837145, 8.546490486843686, -183.6512180594148, 11.678177445213187, 67.11252874230507, 78.41112663499058, 44.91986452809621, -80.23676221887705, -94.51128114918112, 27.12868470598035, 112.7510450651877, 32.16258093967281, 41.75829875414249, -66.27814521013312, 166.86675703467117, 42.063817279249854, -6.2439121201633965, -122.21714107331182, 8.458532267280791, -43.66265933433434, -141.3163377478182, -8.015412232292185, -20.381782451303923, -42.623309159361554, 69.2666592027264, -204.77139080404365, -38.69300268961265, 15.176600834372735, -124.91403718681282, 54.353661051376434, -1.716401388954882, -32.646741512346544, -7.613472601737737, 45.42729355050953, 98.49615914403101, 73.93533467849585, 31.778663243946085, 62.0104166019461, -96.7096438427424, 44.47248048342087, 55.17504733470732, -39.990447278543705, 50.148780587637674, 1.7164210589042252, 139.29936568859858, -41.64746721775484, -86.74273542358141, -69.3681855237476, -24.438045543111016, 8.049006299741153, 75.16543879951489, 27.12932232333167, -71.12467468180766, 10.843433311712921, 116.11949930610805, -126.82881770369235, -11.60386098206001, -89.02740508630288, 94.70547146332316, 144.64832835733588, 72.10467731699262, -32.32538985295664, -158.0799366520792, -81.23830520227511, -34.2204590039571, -139.62998105946852, -82.64124191818247, 10.559708046488621, -108.76571577639504, -126.1680707815471, -71.12103358016033, -23.635587092049533, -16.943809977030448, 31.83563315885231, 131.38298508800366, 1.2683576505746905, -141.64636998058947, -46.11152275136423, 64.82540032634049, 132.6328642222461, -153.45428178676792, -113.67636920917231, 10.023637889582929, -148.6402734250617, 67.47314875018307, -53.07998165138439, 30.250515437338283, -87.90248537554736, -64.51888082971482, 49.629002673866104, -83.50402984086413, -78.84858907647775, 70.17781464946643, -84.09138694174375, 53.21693063551409, -81.73798667546164, 14.120963571360477, 73.12342411732718, -17.342435471632072, 11.617623065892882, -17.165714940476164, -116.13703877024216, 35.81858282529884, -2.718840122831121, -27.07213548356676, -28.89870708270005, 140.60586587321228, -25.611671765207348, -102.26174160405928, 66.22964509148038, 7.739304901702194, -41.7528351200087, 152.47538796282925, -42.77476136635916, -22.577607869544295], "policy_predator_policy_reward": [151.83179490875932, 41.71729879989585, 50.32474593567159, 212.60498070935438, 81.34304591179486, 62.3315797042071, 63.38264609657853, 192.56242617408793, 76.1244976285203, 239.07533415136004, 51.72877192310007, 74.0231235381785, 46.38001440277457, 51.84209793468215, 160.2990581220092, 217.05005701244573, 117.43899334604123, 77.15355148757497, 216.39306427038488, 108.5951047188238, 112.1554244778881, 156.77352853702016, 24.87811770332175, 83.47495346409994, 33.08771214201779, 33.08665554659008, 95.13538763938286, 107.6080920533865, 25.27735557120042, 106.20310815686685, 98.03003182057925, 87.93509059876155, 12.840471635228992, 52.50575221830102, 26.184919609141534, 6.876147394347934, 88.46956947308286, 16.426079567288184, 38.642707140551074, 59.98969915608568, 8.48720955911633, 117.14721228732812, 7.25683937314644, 76.55857650114493, 23.6042262927248, 90.46111404308685, 141.38772969057393, 60.98965095951823, 159.22198454520617, 48.089073716745496, 55.73594923845949, 60.70910331970604, 2.484016521122827, 0.7754162660984293, 51.51517888931844, 95.2977385610954, 31.87607767035732, 148.69393296475323, 9.5939602006062, 43.293484779302965, 88.6455325117684, 28.53153326470202, 6.226824751468964, 22.74736941694399, 21.15564244583731, 92.22892746949158, 94.42291773111332, 203.20556384591478, 47.29189144188136, 40.22612246672882, 23.99056173920123, 20.165903084674845, 87.47129135046465, 137.53546536306837, 196.0163025646626, 49.86493328625989, 123.44469751613634, 83.02674055770859, 35.25664897103809, 56.95573968464634, 189.09141079556252, 74.9712074017518, 21.467069236358512, 34.15927968743138, 55.606128414115524, 148.52709424768182, 94.65350951315638, 191.75121805941447, 60.00923934401384, 20.558577627151426, 25.18549003997388, 25.329797225699622, 76.0968340255942, 157.2063126278312, 34.033381133946015, 25.286889094886124, 31.631175522069558, 101.50483595485805, 87.52111862530481, 115.24529151487937, 27.201572779453848, 50.797607203607576, 9.511431648216059, 140.50538848525943, 115.7934753285309, 127.57086453408189, 26.229363391849652, 37.46783129174654, 84.61821666638204, 25.856751882048123, 247.1503036849125, 43.21959257402315, 63.57199720825915, 108.51759544125653, 34.78088372634105, 23.21765637150338, 42.5042615308751, 133.65618346055928, 41.321847890469506, 65.1365126337686, 24.69434200212701, 90.21535516051665, 57.645454263874726, 130.59458181067848, 55.614713006518556, 33.13916700809115, 107.09044727854372, 26.75121941236244, 25.783578941095726, 42.70063431140143, 50.791235515260595, 128.00097123799296, 69.20629030907718, 164.19824749285, 59.37540829165345, 0.9101466090905385, 6.579256502311885, 176.01524827970778, 10.256566688287045, 40.08050069389198, 147.4288177036922, 85.7038609820601, 135.83789966381522, 43.18403395916402, 33.37138047332832, 54.67561385234296, 18.60234910354196, 218.26637099131364, 39.44491452601484, 121.75642837024776, 173.8576031024632, 108.05840151237369, 31.185721240207478, 201.76571577639504, 197.96807078154697, 160.72103358016025, 112.77900691024959, 35.000390158830356, 27.110082808979346, 37.245877589443495, 95.33164234942535, 153.64636998058904, 96.13994975261966, 38.97716770161519, 17.067135777753915, 183.95428178676738, 130.73980150635768, 76.96919353572471, 82.22961971437888, 170.86095068268878, 102.28011638091341, 27.28669375868995, 112.26474875782806, 108.15661744743325, 96.17664470448871, 88.42322034551226, 93.4133870711891, 0.7098394717713442, 81.69116624466155, 105.48104296838012, 120.14928765969522, 59.795571137049336, 98.88154519777113, 28.63746615653381, 64.8823769341071, 65.46571494047635, 163.23703877024218, 30.281417174701286, 23.21010960953308, 63.880865996864955, 39.38997043748486, 38.46308158771539, 67.52177267468139, 182.45164069458528, 69.61075387447978, 66.18469587641407, 74.00776549665763, 13.558402790523195, 111.77476136635919, 121.87760786954432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.769784652533207, "mean_inference_ms": 7.075993403318271, "mean_action_processing_ms": 2.8274010213639955, "mean_env_wait_ms": 14.67929218993796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015546202659606934, "StateBufferConnector_ms": 0.01759040355682373, "ViewRequirementAgentConnector_ms": 0.7136576175689697}, "num_episodes": 87, "episode_return_max": 304.80000000000064, "episode_return_min": 27.50000000000012, "episode_return_mean": 141.69893383750733, "episodes_this_iter": 87}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 24.123021136495275, "num_env_steps_trained_throughput_per_sec": 24.123021136495275, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 296490.512, "restore_workers_time_ms": 0.055, "training_step_time_ms": 296490.376, "sample_time_ms": 18364.706, "learn_time_ms": 278088.974, "learn_throughput": 57.536, "synch_weights_time_ms": 14.895}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 5, "trial_id": "3f8ac_00000", "date": "2024-08-20_10-53-06", "timestamp": 1724131386, "time_this_iter_s": 663.9414210319519, "time_total_s": 1483.3881509304047, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb9430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1483.3881509304047, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 85.84867549668874, "ram_util_percent": 84.80695364238412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 315.3014416807979, "episode_reward_min": -16.634920831100644, "episode_reward_mean": 156.65203727177655, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -255.69311882093115, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.57290539637233, "predator_policy": 267.1773235327156}, "policy_reward_mean": {"prey_policy": -11.456598408700613, "predator_policy": 89.78261704458897}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.923445722189, 106.73734392555748, 67.99999999999991, 150.7248378830029, 85.45245211594968, 156.29775290681175, 112.32783569264231, 183.29999999999953, 124.79999999999936, 113.19999999999999, 57.30000000000039, 189.56021081571186, 122.09999999999985, 209.7643997440757, 198.2887211300009, 168.29999999999976, -16.634920831100644, 125.9820500411819, 143.19999999999902, 196.637875225752, 313.30000000000024, 174.4211666760565, 108.99999999999994, 130.67533205225828, 97.51449332143468, 162.09747434442522, 75.6639966085125, 57.25645418428505, 128.49999999999991, 103.51792911288635, 198.53232214378437, 200.60024723356332, 138.4786337175828, 302.0999999999999, 188.450449215277, 181.13502859476253, 215.71658588401144, 223.74021964070295, 304.39888438057636, 136.71252345055737, 101.80745007392579, 311.19999999999993, 111.649970448544, 150.73215836758652, 122.79999999999983, 138.09999999999965, 79.82579270401635, 87.12434552054047, 211.92525684750842, 173.58170315130465, 89.89999999999972, 259.54017942490725, 203.73478735493433, 101.2999999999999, 109.76157058646882, 126.28136240009303, 108.89999999999915, 247.5082099743814, 149.99999999999991, 213.9457656719288, 315.3014416807979, 136.40551867967952, 225.69999999999965, 50.20000000000029, 150.89999999999966, 283.9000000000003, 186.6734548637729, 141.78300543039802, 162.624100626336, 82.3862816114447, 113.98188019464436, 238.94474993700564, 137.59999999999974, 244.89999999999978, 236.29999999999924, 54.124708337192985, 125.43217330651152, 28.385779660271545, 104.17591314966955, 119.73683426425966, 193.49373912319874, 207.062279216148, 124.02647033257969, 111.89999999999992, 176.22274759951372, 141.83647531405202, 186.96498001692729, 164.87588986775322, 55.502881835380656, 78.88937099015962, 245.11561299905753, 186.00034936089293, 122.41000025558176, 63.400000000000055, 227.19999999999996, 267.7, 167.23234786456908, 183.44705013629058, 173.71381562664166, 240.06157743834243], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-148.6402734250617, 67.47314875018307, -53.07998165138439, 30.250515437338283, -87.90248537554736, -64.51888082971482, 49.629002673866104, -83.50402984086413, -78.84858907647775, 70.17781464946643, -84.09138694174375, 53.21693063551409, -81.73798667546164, 14.120963571360477, 73.12342411732718, -17.342435471632072, 11.617623065892882, -17.165714940476164, -116.13703877024216, 35.81858282529884, -2.718840122831121, -27.07213548356676, -28.89870708270005, 140.60586587321228, -25.611671765207348, -102.26174160405928, 66.22964509148038, 7.739304901702194, -41.7528351200087, 152.47538796282925, -42.77476136635916, -22.577607869544295, -60.92182711945397, -225.47231653431749, 6.455358103793657, 13.201122898561406, 55.69309274267557, 3.9145481154793296, 127.50120604103687, -243.51093789295186, 85.86105771138102, 144.47667443827893, 111.79102993846604, -90.00505943870213, -79.30885570523678, 45.451635085281325, -82.1930206169956, -55.536188577835965, -37.812143581533846, -255.69311882093115, 44.82562868364488, -64.59232069348442, 46.490948167400404, -9.89905676819834, -116.49021225105683, -118.06918630280984, -99.61757269584837, 9.334844044133925, -113.10629181572781, -61.610566584276185, 101.38316469259966, -106.75807859899999, 128.65805312549242, -117.27743201974351, -58.21242411613159, -44.89230521863662, 130.71481595543307, 76.38688954067354, -78.76347736418603, 9.1503998473747, -65.35612664568302, 12.765717786809681, -37.56071229647315, 143.00816561043345, -165.7768412717038, 104.85597679350137, 116.40998300011414, 124.81624753011154, -92.49091976021361, 33.94624675901703, -85.26779578693265, -22.008042773215642, 116.3228726315905, 129.25513004884522, 20.000000000000014, -40.20096981599043, 29.987322939572522, -121.16831053309917, 86.11740987676887, -26.53100993028194, 18.922714419624082, 50.47732160314009, -2.683181025074872, -168.08280027889336, -170.64503169941744, -19.250852715675656, 115.83252530752797, -102.9145828794005, -4.5182111345704215, 22.9451401630121, -148.26738304885498, -38.666775548251216, 81.13430832769575, 87.4875969381493, -58.13814131520661, 87.4099571563188, 14.795134067435171, -33.65667184409122, 10.919267869091211, 44.298236423848444, -249.65944494759302, -89.17246131781212, -27.18566226902368, 81.924452185127, -10.57235655289818, 154.1630607730731, 69.16200941745748, -127.6630348756694, 46.282770008210534, 72.91361511638159, 93.08071319544196, 129.39267075206635, -43.07851540548566, 37.89148047474602, -10.900330610608037, 172.08703681762853, -49.990451058234626, -10.89801102278454, 20.04878074947958, 36.64978620995998, 113.32815804925895, 128.79322611931408, 134.13761883588646, -154.00782577961934, 42.9193083427456, -80.59511876980744, -87.91315736253165, 64.40865322968953, -138.5983109646873, -195.48884712361266, -109.91473120862531, -92.12862138401834, -209.39133023851886, 114.71081361891362, 44.30174564650874, -28.994604268540023, 98.94808132477641, 130.6115527374896, 112.30164144906426, 68.35188230478451, -191.22669422051078, -110.55521250421488, -1.715484401350361, -86.65024538165663, -120.75394677362699, -70.55357129828218, -34.562484058277036, -7.9548274145687285, -81.61562991640781, -43.8138087458531, 122.23147192480691, 10.913069431029296, -67.56304559075362, 71.07527949386079, -16.94190148952325, 65.6194233653715, -62.293043414244785, -83.27911155318841, 65.35087059703389, 6.040025673507042, -68.17492712277264, 0.4788015192164643, -85.25544790867482, 98.68986937308665, 124.92129391757771, -145.0292610548969, 9.405708288110372, -225.40862844729764, 13.415750055446077, -140.43920720827714, 186.57290539637233, -166.75886484340026, -98.17852783016973, 64.5183751051482, 53.81129760207962, -109.06888238552415, -72.71631847802463, -82.40308919986322, 87.0991177055422, 13.57245895342785, 43.73288126590552, 150.5183682759327, 134.6248020793918, -192.9735018455364, -222.63033949381807, 136.81404694171658, 0.13108660135624917, -47.354924146041256, -185.24978072693833, 104.09578244290292], "policy_predator_policy_reward": [82.22961971437888, 170.86095068268878, 102.28011638091341, 27.28669375868995, 112.26474875782806, 108.15661744743325, 96.17664470448871, 88.42322034551226, 93.4133870711891, 0.7098394717713442, 81.69116624466155, 105.48104296838012, 120.14928765969522, 59.795571137049336, 98.88154519777113, 28.63746615653381, 64.8823769341071, 65.46571494047635, 163.23703877024218, 30.281417174701286, 23.21010960953308, 63.880865996864955, 39.38997043748486, 38.46308158771539, 67.52177267468139, 182.45164069458528, 69.61075387447978, 66.18469587641407, 74.00776549665763, 13.558402790523195, 111.77476136635919, 121.87760786954432, 2.581899289954666, 267.1773235327156, 45.06587437733165, 61.259694661495665, 69.9876480503742, 13.604711091471069, 118.73919312183743, 193.90841395582956, 68.03077453156148, 14.931493318778521, 52.256906007765465, 100.3782901685273, 62.74398487679196, 80.11323574316334, 137.75494492411664, 130.6495963229739, 205.74849875670563, 185.27125696719395, 46.8999016147278, 134.96426473953696, 36.423403679769145, 2.6487015295414857, 178.07268484968296, 113.74316788846774, 113.11757269584825, 105.66515595586608, 220.4783241681518, 57.75646334473872, 62.45469510586955, 141.45254094431587, 66.9976474250629, 122.2219787027515, 133.51901338155076, 108.06434967080101, 42.823539539416636, 52.17475496447677, 184.36654924045908, 73.69697749162916, 188.81661548696545, 44.90882196667053, 97.5216094353205, 12.747523134731194, 176.3758577288149, 108.28522639009049, 23.72046979212526, 39.452184058224844, 94.6972301496755, 100.55996630207817, 169.81517857689855, 39.268110057175505, 24.331891305961275, 41.29010601360305, 117.67024556750943, 14.180694697025203, 104.51827099349826, 137.3948749676148, 19.282590123231124, 43.93100993028219, 0.0, 68.69996397723587, 192.70192562795842, 57.88984838002628, 206.5051737968791, 70.51505613875453, 105.49340537555926, 93.51390904382161, 85.6317031717303, 69.523070951133, 32.887689530332615, 243.94646906677363, 66.7755225337058, 24.142751625356226, 114.31363378338, 60.14933773044252, 69.80486593256477, 50.35667184409145, 14.485445804427009, 40.058620489103184, 219.59507834154562, 245.5181903239524, 51.51187136857165, 2.649338715324542, 90.10034720150719, 13.817158552699599, 43.537990582542534, 164.9630348756695, 18.550027191648066, 76.19935335568914, 14.65263164996452, 78.17542608332506, 66.60876536509619, 74.98378824532344, 55.40033061060821, 9.112963182371475, 32.53013765981576, 78.55832442120379, 78.95121925052045, 15.250213790040094, 28.121099491339532, 13.657516340087403, 23.734513860099735, 182.80914794740607, 56.8583796770361, 122.60043618042457, 20.989468217638212, 165.1391365415401, 182.98459257613183, 233.4888471236125, 258.36951242946503, 57.65572035782325, 142.12584951755878, 191.49941703905193, 85.70383505073944, 36.58902357129207, 1.8519186752234702, 13.488447262510364, 38.3728376469136, 17.273638599237223, 198.2965590361432, 157.61005602577467, 195.45278537892383, 18.34511771059417, 83.93787924145316, 135.7554184907262, 100.24582164964508, 46.44740297287074, 224.3877979720586, 20.77847495446225, 19.127724158323446, 41.221473609039876, 54.82025871936914, 148.72978659367172, 12.461581323803506, 62.88736713292821, 36.33736866574761, 221.13478630168572, 44.83627831103055, 59.995573017942604, 90.04602009220244, 119.48658082540611, 115.98615021426636, 57.54440833824868, 23.59977514866356, 161.38408185640859, 178.26674599496943, 93.2390559995984, 17.574986849080446, 188.33784129390963, 108.87632084398399, 116.42525160210145, 169.0807162820035, 50.57978580391104, 8.932253397405617, 168.73533164162063, 122.034554352094, 96.48485332579295, 55.80088229445777, 70.72754104657224, 71.86711873409453, 1.5816317240672848, 185.8913719171019, 39.689675713612125, 214.33072760327204, 54.93261508512009, 171.2880036264934, 49.64964954483371, 215.05085925471906, 106.1647164676588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.698140211278973, "mean_inference_ms": 10.728754144634854, "mean_action_processing_ms": 3.2323219518416444, "mean_env_wait_ms": 18.905660387714228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08696699142456055, "StateBufferConnector_ms": 0.061383843421936035, "ViewRequirementAgentConnector_ms": 1.3546854257583618}, "num_episodes": 84, "episode_return_max": 315.3014416807979, "episode_return_min": -16.634920831100644, "episode_return_mean": 156.65203727177655, "episodes_this_iter": 84}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 257345.416, "restore_workers_time_ms": 0.051, "training_step_time_ms": 257333.718, "sample_time_ms": 25562.289, "learn_time_ms": 278088.974, "learn_throughput": 57.536, "synch_weights_time_ms": 14.895}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 6, "trial_id": "3f8ac_00000", "date": "2024-08-20_10-54-13", "timestamp": 1724131453, "time_this_iter_s": 67.60149192810059, "time_total_s": 1550.9896428585052, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326ee4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1550.9896428585052, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 98.65164835164836, "ram_util_percent": 83.68131868131869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0120670883901535, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.3722585173511, "policy_loss": -0.01372737511475053, "vf_loss": 8.384242614362606, "vf_explained_var": 0.1633557920733457, "kl": 0.008716498823726647, "entropy": 1.4861334260809358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1371552578198216, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.719326749932829, "policy_loss": -0.013065353024593263, "vf_loss": 5.730455647069941, "vf_explained_var": 0.11150446158868295, "kl": 0.009682218031448515, "entropy": 1.503473829087757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 340.518157021694, "episode_reward_min": 28.385779660271545, "episode_reward_mean": 173.34416528232305, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -263.586779967467, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.57290539637233, "predator_policy": 331.6977345907213}, "policy_reward_mean": {"prey_policy": -6.465877068098864, "predator_policy": 93.13795970926043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.385779660271545, 104.17591314966955, 119.73683426425966, 193.49373912319874, 207.062279216148, 124.02647033257969, 111.89999999999992, 176.22274759951372, 141.83647531405202, 186.96498001692729, 164.87588986775322, 55.502881835380656, 78.88937099015962, 245.11561299905753, 186.00034936089293, 122.41000025558176, 63.400000000000055, 227.19999999999996, 267.7, 167.23234786456908, 183.44705013629058, 173.71381562664166, 240.06157743834243, 232.60000000000002, 199.0278588702228, 168.9184872182132, 122.12383977453422, 159.69999999999982, 210.3267151440816, 227.66110102687006, 134.6359980786931, 105.99999999999986, 219.59999999999948, 62.60000000000029, 254.09999999999994, 137.77201461481386, 184.8021053335909, 262.7960120571502, 161.03795396530188, 224.39999999999995, 92.10000000000005, 64.10000000000007, 271.0, 191.9338139051856, 340.518157021694, 204.12927144684835, 310.4000000000001, 129.49999999999997, 113.51615715180517, 191.16475539247273, 143.3363773917805, 97.03396213363307, 189.72519765951714, 187.92348637044915, 236.84896268439758, 198.65670559462032, 199.34030587423067, 236.47595514303123, 142.64888691818393, 82.39739217387992, 154.8011916680188, 122.24351591579257, 232.8183669702467, 135.2584570093245, 194.50001678241583, 230.09999999999997, 113.29999999999997, 131.84477409601462, 161.63826306013019, 143.37994109474988, 171.59999999999943, 157.30309494040176, 251.19999999999996, 50.700000000000394, 213.89999999999972, 100.1015640175053, 140.26595038617486, 212.9424274691326, 254.09999999999997, 167.59999999999977, 178.92936916384554, 214.1577271379349, 222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-120.75394677362699, -70.55357129828218, -34.562484058277036, -7.9548274145687285, -81.61562991640781, -43.8138087458531, 122.23147192480691, 10.913069431029296, -67.56304559075362, 71.07527949386079, -16.94190148952325, 65.6194233653715, -62.293043414244785, -83.27911155318841, 65.35087059703389, 6.040025673507042, -68.17492712277264, 0.4788015192164643, -85.25544790867482, 98.68986937308665, 124.92129391757771, -145.0292610548969, 9.405708288110372, -225.40862844729764, 13.415750055446077, -140.43920720827714, 186.57290539637233, -166.75886484340026, -98.17852783016973, 64.5183751051482, 53.81129760207962, -109.06888238552415, -72.71631847802463, -82.40308919986322, 87.0991177055422, 13.57245895342785, 43.73288126590552, 150.5183682759327, 134.6248020793918, -192.9735018455364, -222.63033949381807, 136.81404694171658, 0.13108660135624917, -47.354924146041256, -185.24978072693833, 104.09578244290292, 91.09999999999991, 133.3606406618409, 62.48946500600482, -113.95607241806226, -83.5797055606172, 11.156055829320133, -57.643591658704096, -29.31480039280423, -52.29043811549128, 13.726496052100632, -152.61196187338425, 87.46877963650408, 149.18519280275405, -13.409606498767921, -48.0424046024345, -33.40436158071097, -30.058946324743147, -63.95097356412239, 102.89233816189893, 30.41215220713781, -13.270414056340197, -74.53753730955337, -21.717776495032098, 89.6958879793657, 53.66356046206356, -54.244981793950785, 61.74822688379303, -89.37328143125151, -31.485020730123047, 115.93820828491037, -10.360057407200458, -10.126249121721116, 7.995466507875057, -36.86422029735189, -215.4307391524606, 37.61227905222151, -153.78677115058517, 12.850376600454492, 125.99735332196985, 53.933392543237304, 81.30367803813816, 30.084141396376317, 148.7978778543855, 97.43842335714783, 152.67658940794388, -220.92729025159534, 145.8326434418384, 54.468886919444444, -7.335799071643393, -33.31299943310147, 5.440955956150962, -137.61642366017105, -73.14263045643825, 133.73935050427923, 16.659117639814735, -60.142261172540245, -263.586779967467, -74.43308049081477, 49.014126192782015, -2.910581774723787, -71.94960107974337, 36.95179667562054, 9.710380897580105, 81.45975791386286, -105.35554336535594, 62.176360113870324, 84.74496307538884, -106.21001643098924, 139.13088611843054, -88.43601057621245, -43.177256492078726, 19.564680851799903, -14.455402216364142, -148.73199228928246, 25.524065511429963, -27.700531686258373, -3.0032643736947477, -180.18135326089703, -35.70232743819588, 65.630667903987, -38.464657753725184, -126.07755676534927, -58.42803344824357, 130.25504498372118, 143.56924946466648, -74.17331958622047, -126.7255176066427, -10.034306700927086, 48.85796802047153, -175.632915075054, -25.68995532376029, 9.525944429067769, -52.20506531855199, 18.904790308691005, 6.450809612510222, 126.21788550223822, -158.50477294668926, -59.96230610154171, -30.730034402152683, 124.75667752370748, 15.349614193580544, -29.468684898564476, 111.4225330361437, 48.54310888887491, -4.652352104008688, -56.34282087404753, -79.73301580218508, -205.24491925808957, 127.54583409051564, -54.43497843183559, 94.06267790584894, 121.190804044258, -164.90375571776616, 126.5001156892856, -179.74669377164588, 34.845539533951396, -44.41775133398491, 83.58951699681123, 25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384], "policy_predator_policy_reward": [83.93787924145316, 135.7554184907262, 100.24582164964508, 46.44740297287074, 224.3877979720586, 20.77847495446225, 19.127724158323446, 41.221473609039876, 54.82025871936914, 148.72978659367172, 12.461581323803506, 62.88736713292821, 36.33736866574761, 221.13478630168572, 44.83627831103055, 59.995573017942604, 90.04602009220244, 119.48658082540611, 115.98615021426636, 57.54440833824868, 23.59977514866356, 161.38408185640859, 178.26674599496943, 93.2390559995984, 17.574986849080446, 188.33784129390963, 108.87632084398399, 116.42525160210145, 169.0807162820035, 50.57978580391104, 8.932253397405617, 168.73533164162063, 122.034554352094, 96.48485332579295, 55.80088229445777, 70.72754104657224, 71.86711873409453, 1.5816317240672848, 185.8913719171019, 39.689675713612125, 214.33072760327204, 54.93261508512009, 171.2880036264934, 49.64964954483371, 215.05085925471906, 106.1647164676588, 3.7883233971889503, 4.351035940970121, 157.99009823233655, 92.50436804994372, 132.50998036210632, 108.83215658740394, 100.74313077405229, 108.33910105199152, 107.86118401000452, 90.40275805338622, 224.19682792959054, 51.27306945137125, 50.361881679271924, 41.523633043612634, 120.09496133904963, 95.98780292278958, 52.80128861701654, 147.2086312718486, 76.06319902902038, 10.232310601943064, 79.01947047897694, 71.38848088691616, 129.31777649503204, 56.80411202063427, 64.18299052331216, 74.1704454233898, 140.54610485296334, 71.88105502808618, 40.87004235547061, 137.47278214689294, 27.558058969093654, 153.96620152512986, 89.30453349212485, 163.96422029735177, 230.13073915246022, 39.78772094777864, 198.48677115058496, 6.549623399545474, 14.30264667802985, 76.76660745676271, 30.885616155687334, 49.66037831498402, 46.691077136172815, 47.59077867398781, 2.807144736452179, 269.57282755404765, 29.56735655816158, 80.5311130805556, 92.23579907164327, 77.91299943310115, 157.3058347735278, 88.3857900822972, 86.88451700454348, 43.6835183400886, 124.99104493565467, 61.82847598885199, 252.76366306143086, 182.2901595304837, 105.80115917438916, 37.82049406707031, 156.1777888156313, 66.74350195894056, 94.94512920659228, 50.7336946663624, 163.2063174594831, 78.62957138662318, 188.88952819614073, 31.915831033690477, 65.29079470328823, 120.49028489752493, 80.63821786291227, 85.62324469555128, 65.7130386240811, 179.8717480554448, 84.26953659421872, 72.70812124862933, 100.559752980816, 204.8683805695686, 139.50154327249598, 63.38848323195963, 116.03062596172849, 183.77004556667094, 64.34966107431444, 58.323344172624054, 4.082215899779228, 156.6218542217746, 137.22551760664274, 112.83430670092703, 166.2152716757851, 92.40444947481264, 10.097266958657812, 167.70500699616514, 68.99352869245807, 107.68668741215313, 5.820903465372426, 33.110401419879175, 138.7507054604128, 237.01946852821965, 119.6300344021526, 37.543322476292495, 4.150385806419418, 60.66868489856451, 16.877466963856083, 37.05689111112513, 31.325102771403195, 129.77163422415896, 93.54615085572827, 331.6977345907213, 67.21523606272841, 72.61633574772407, 9.737322094151034, 29.109195955741974, 70.55821207335687, 135.44542795512342, 173.17517258237677, 150.6553508191632, 136.74884226482123, 38.23711921028737, 12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.955576263639095, "mean_inference_ms": 12.063296069242835, "mean_action_processing_ms": 3.1371172689184927, "mean_env_wait_ms": 20.798544276284456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07387495040893555, "StateBufferConnector_ms": 0.06575143337249756, "ViewRequirementAgentConnector_ms": 1.1323084831237793}, "num_episodes": 77, "episode_return_max": 340.518157021694, "episode_return_min": 28.385779660271545, "episode_return_mean": 173.34416528232305, "episodes_this_iter": 77}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 49.753414463895, "num_env_steps_trained_throughput_per_sec": 49.753414463895, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 266522.733, "restore_workers_time_ms": 0.089, "training_step_time_ms": 266512.514, "sample_time_ms": 27166.18, "learn_time_ms": 279198.089, "learn_throughput": 57.307, "synch_weights_time_ms": 14.872}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 7, "trial_id": "3f8ac_00000", "date": "2024-08-20_10-59-35", "timestamp": 1724131775, "time_this_iter_s": 322.0041329860687, "time_total_s": 1872.993775844574, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fada60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1872.993775844574, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.22229580573952, "ram_util_percent": 83.50441501103752}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2457581149364905, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.782646505164092, "policy_loss": -0.011346877227591538, "vf_loss": 8.792120493530597, "vf_explained_var": 0.15385512381634384, "kl": 0.009364514657242036, "entropy": 1.4623271192823137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0932719421134425, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.814289032214533, "policy_loss": -0.01104784591268827, "vf_loss": 6.8231956171611, "vf_explained_var": 0.09278050686316515, "kl": 0.01070628032635247, "entropy": 1.4715955179835123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 82, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 82}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 52.06241631747129, "num_env_steps_trained_throughput_per_sec": 52.06241631747129, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 271622.823, "restore_workers_time_ms": 0.08, "training_step_time_ms": 271613.872, "sample_time_ms": 29927.285, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 8, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-04-44", "timestamp": 1724132084, "time_this_iter_s": 308.72631072998047, "time_total_s": 2181.7200865745544, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fad310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2181.7200865745544, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 81.65414746543779, "ram_util_percent": 83.42304147465437}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 248157.726, "restore_workers_time_ms": 0.142, "training_step_time_ms": 248149.597, "sample_time_ms": 33317.055, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 9, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-06-47", "timestamp": 1724132207, "time_this_iter_s": 120.96242308616638, "time_total_s": 2302.682509660721, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb9820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2302.682509660721, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 96.83515151515152, "ram_util_percent": 83.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 229390.448, "restore_workers_time_ms": 0.22, "training_step_time_ms": 229382.435, "sample_time_ms": 36032.945, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 10, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-08-51", "timestamp": 1724132331, "time_this_iter_s": 120.95119595527649, "time_total_s": 2423.6337056159973, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdb0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2423.6337056159973, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 97.66686390532544, "ram_util_percent": 83.72130177514794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 215068.337, "restore_workers_time_ms": 0.544, "training_step_time_ms": 215056.897, "sample_time_ms": 40661.589, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 11, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-10-55", "timestamp": 1724132455, "time_this_iter_s": 121.28144931793213, "time_total_s": 2544.9151549339294, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fd13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2544.9151549339294, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 97.48764705882354, "ram_util_percent": 83.65058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 200440.696, "restore_workers_time_ms": 0.666, "training_step_time_ms": 200428.393, "sample_time_ms": 45178.218, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 12, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-12-59", "timestamp": 1724132579, "time_this_iter_s": 121.63812184333801, "time_total_s": 2666.5532767772675, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2666.5532767772675, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 96.34578313253013, "ram_util_percent": 83.69277108433735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 185454.261, "restore_workers_time_ms": 0.948, "training_step_time_ms": 185441.37, "sample_time_ms": 49381.003, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 13, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-15-03", "timestamp": 1724132703, "time_this_iter_s": 121.66875410079956, "time_total_s": 2788.222030878067, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326ead5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2788.222030878067, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 96.50179640718564, "ram_util_percent": 83.69820359281438}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 171779.738, "restore_workers_time_ms": 1.194, "training_step_time_ms": 171766.059, "sample_time_ms": 54179.446, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 14, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-17-07", "timestamp": 1724132827, "time_this_iter_s": 121.97451496124268, "time_total_s": 2910.1965458393097, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fd1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2910.1965458393097, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 96.96848484848485, "ram_util_percent": 83.73757575757577}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 111582.016, "restore_workers_time_ms": 3.798, "training_step_time_ms": 111562.38, "sample_time_ms": 57271.477, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 15, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-19-13", "timestamp": 1724132953, "time_this_iter_s": 122.76294994354248, "time_total_s": 3032.959495782852, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3032.959495782852, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 96.99578313253012, "ram_util_percent": 83.6921686746988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 111500.99, "restore_workers_time_ms": 5.204, "training_step_time_ms": 111483.601, "sample_time_ms": 57191.815, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 16, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-21-18", "timestamp": 1724133078, "time_this_iter_s": 122.17927694320679, "time_total_s": 3155.138772726059, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326ead550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3155.138772726059, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 97.05119047619047, "ram_util_percent": 83.69404761904761}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 85419.71, "restore_workers_time_ms": 6.069, "training_step_time_ms": 85400.516, "sample_time_ms": 59587.918, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 17, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-23-23", "timestamp": 1724133203, "time_this_iter_s": 122.33817791938782, "time_total_s": 3277.476950645447, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdbd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3277.476950645447, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 96.10414201183433, "ram_util_percent": 84.00946745562129}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60767.156, "restore_workers_time_ms": 6.371, "training_step_time_ms": 60747.049, "sample_time_ms": 60740.849, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 18, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-25-27", "timestamp": 1724133327, "time_this_iter_s": 122.01673603057861, "time_total_s": 3399.4936866760254, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3399.4936866760254, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 96.6245508982036, "ram_util_percent": 83.8179640718563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60809.031, "restore_workers_time_ms": 8.749, "training_step_time_ms": 60784.359, "sample_time_ms": 60776.738, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 19, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-27-34", "timestamp": 1724133454, "time_this_iter_s": 121.68794322013855, "time_total_s": 3521.181629896164, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fad310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3521.181629896164, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 97.69882352941178, "ram_util_percent": 83.7564705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60871.214, "restore_workers_time_ms": 8.898, "training_step_time_ms": 60841.722, "sample_time_ms": 60832.936, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 20, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-29-39", "timestamp": 1724133579, "time_this_iter_s": 122.15419888496399, "time_total_s": 3643.335828781128, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3643.335828781128, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 95.19823529411764, "ram_util_percent": 83.78058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60887.804, "restore_workers_time_ms": 8.715, "training_step_time_ms": 60860.382, "sample_time_ms": 60853.298, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 21, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-31-43", "timestamp": 1724133703, "time_this_iter_s": 121.78486514091492, "time_total_s": 3765.120693922043, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fad9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3765.120693922043, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 97.32797619047619, "ram_util_percent": 83.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60908.392, "restore_workers_time_ms": 9.29, "training_step_time_ms": 60880.541, "sample_time_ms": 60873.273, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 22, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-33-48", "timestamp": 1724133828, "time_this_iter_s": 122.00994420051575, "time_total_s": 3887.1306381225586, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb20d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3887.1306381225586, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 96.92559523809526, "ram_util_percent": 83.78035714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60930.611, "restore_workers_time_ms": 10.484, "training_step_time_ms": 60899.201, "sample_time_ms": 60891.479, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 23, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-35-53", "timestamp": 1724133953, "time_this_iter_s": 121.8844039440155, "time_total_s": 4009.015042066574, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326eaddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4009.015042066574, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 96.62248520710058, "ram_util_percent": 83.69053254437871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60953.7, "restore_workers_time_ms": 10.421, "training_step_time_ms": 60920.325, "sample_time_ms": 60911.313, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 24, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-37-58", "timestamp": 1724134078, "time_this_iter_s": 122.3926932811737, "time_total_s": 4131.407735347748, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdb160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4131.407735347748, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 96.45833333333333, "ram_util_percent": 83.63750000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60898.154, "restore_workers_time_ms": 9.931, "training_step_time_ms": 60867.846, "sample_time_ms": 60860.506, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 25, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-40-01", "timestamp": 1724134201, "time_this_iter_s": 121.46541404724121, "time_total_s": 4252.873149394989, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327aca040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4252.873149394989, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 96.13652694610778, "ram_util_percent": 83.60059880239523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60897.618, "restore_workers_time_ms": 10.219, "training_step_time_ms": 60864.904, "sample_time_ms": 60858.301, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 26, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-42-06", "timestamp": 1724134326, "time_this_iter_s": 122.26977181434631, "time_total_s": 4375.142921209335, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4375.142921209335, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 96.14431137724551, "ram_util_percent": 83.58443113772456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60927.647, "restore_workers_time_ms": 9.433, "training_step_time_ms": 60894.636, "sample_time_ms": 60887.932, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 27, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-44-10", "timestamp": 1724134450, "time_this_iter_s": 122.08051991462708, "time_total_s": 4497.223441123962, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdb310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4497.223441123962, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 96.60421686746987, "ram_util_percent": 83.61506024096387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60931.989, "restore_workers_time_ms": 10.554, "training_step_time_ms": 60897.064, "sample_time_ms": 60890.69, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-46-13", "timestamp": 1724134573, "time_this_iter_s": 121.6671199798584, "time_total_s": 4618.890561103821, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327acadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4618.890561103821, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 96.22545454545455, "ram_util_percent": 83.56848484848487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60922.603, "restore_workers_time_ms": 8.841, "training_step_time_ms": 60890.038, "sample_time_ms": 60884.92, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 29, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-48-18", "timestamp": 1724134698, "time_this_iter_s": 122.27302193641663, "time_total_s": 4741.163583040237, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4741.163583040237, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 97.846783625731, "ram_util_percent": 83.5953216374269}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60901.007, "restore_workers_time_ms": 10.536, "training_step_time_ms": 60867.529, "sample_time_ms": 60863.511, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 30, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-50-26", "timestamp": 1724134826, "time_this_iter_s": 122.15171790122986, "time_total_s": 4863.315300941467, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fd1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4863.315300941467, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 96.54104046242773, "ram_util_percent": 83.61387283236995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60951.897, "restore_workers_time_ms": 11.29, "training_step_time_ms": 60915.521, "sample_time_ms": 60910.356, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 31, "trial_id": "3f8ac_00000", "date": "2024-08-20_11-52-33", "timestamp": 1724134953, "time_this_iter_s": 124.9482991695404, "time_total_s": 4988.263600111008, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327aca940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4988.263600111008, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 96.67325581395349, "ram_util_percent": 84.03546511627906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61065.892, "restore_workers_time_ms": 12.484, "training_step_time_ms": 61015.46, "sample_time_ms": 61006.397, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 32, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-01-44", "timestamp": 1724135504, "time_this_iter_s": 543.065526008606, "time_total_s": 5531.329126119614, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326cbb040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5531.329126119614, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 94.21005586592177, "ram_util_percent": 84.27765363128492}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61273.187, "restore_workers_time_ms": 20.173, "training_step_time_ms": 61197.718, "sample_time_ms": 61184.878, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 33, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-03-57", "timestamp": 1724135637, "time_this_iter_s": 124.85783910751343, "time_total_s": 5656.186965227127, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fad940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5656.186965227127, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 95.3335195530726, "ram_util_percent": 83.78212290502795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61264.034, "restore_workers_time_ms": 26.184, "training_step_time_ms": 61180.635, "sample_time_ms": 61167.072, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 34, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-06-06", "timestamp": 1724135766, "time_this_iter_s": 121.81307578086853, "time_total_s": 5778.000041007996, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb2af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5778.000041007996, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 98.35058139534881, "ram_util_percent": 83.6529069767442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61266.205, "restore_workers_time_ms": 29.981, "training_step_time_ms": 61178.125, "sample_time_ms": 61164.539, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 35, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-08-11", "timestamp": 1724135891, "time_this_iter_s": 121.59684085845947, "time_total_s": 5899.596881866455, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5899.596881866455, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 97.91272727272728, "ram_util_percent": 83.58242424242425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61279.707, "restore_workers_time_ms": 28.846, "training_step_time_ms": 61197.624, "sample_time_ms": 61183.783, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 36, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-10-17", "timestamp": 1724136017, "time_this_iter_s": 122.14231610298157, "time_total_s": 6021.739197969437, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327aca550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6021.739197969437, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 97.93173652694612, "ram_util_percent": 83.62035928143713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61275.173, "restore_workers_time_ms": 33.089, "training_step_time_ms": 61187.837, "sample_time_ms": 61174.237, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 37, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-12-24", "timestamp": 1724136144, "time_this_iter_s": 122.1707992553711, "time_total_s": 6143.909997224808, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326e480d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6143.909997224808, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 97.81058823529413, "ram_util_percent": 83.59117647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61427.134, "restore_workers_time_ms": 32.313, "training_step_time_ms": 61331.144, "sample_time_ms": 61314.904, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 38, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-14-40", "timestamp": 1724136280, "time_this_iter_s": 131.6179530620575, "time_total_s": 6275.527950286865, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6275.527950286865, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 79.30497237569061, "ram_util_percent": 87.14364640883979}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61866.513, "restore_workers_time_ms": 65.969, "training_step_time_ms": 61694.158, "sample_time_ms": 61673.742, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 39, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-17-27", "timestamp": 1724136447, "time_this_iter_s": 137.7202250957489, "time_total_s": 6413.248175382614, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326e48160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6413.248175382614, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.98884120171674, "ram_util_percent": 84.40085836909871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62618.337, "restore_workers_time_ms": 75.488, "training_step_time_ms": 62375.734, "sample_time_ms": 62331.434, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 40, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-20-07", "timestamp": 1724136607, "time_this_iter_s": 138.93606805801392, "time_total_s": 6552.184243440628, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb14c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6552.184243440628, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 48.60093023255814, "ram_util_percent": 87.03348837209303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 63073.751, "restore_workers_time_ms": 105.096, "training_step_time_ms": 62759.782, "sample_time_ms": 62696.031, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 41, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-22-43", "timestamp": 1724136763, "time_this_iter_s": 132.30048894882202, "time_total_s": 6684.48473238945, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6684.48473238945, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 76.10576923076924, "ram_util_percent": 86.77403846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62969.074, "restore_workers_time_ms": 105.913, "training_step_time_ms": 62663.022, "sample_time_ms": 62601.479, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 42, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-24-55", "timestamp": 1724136895, "time_this_iter_s": 122.04368281364441, "time_total_s": 6806.5284152030945, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6806.5284152030945, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 97.04494382022472, "ram_util_percent": 83.73370786516854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62747.898, "restore_workers_time_ms": 97.291, "training_step_time_ms": 62468.743, "sample_time_ms": 62410.53, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 43, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-26-59", "timestamp": 1724137019, "time_this_iter_s": 122.02261400222778, "time_total_s": 6928.551029205322, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326e48d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6928.551029205322, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 96.53076923076924, "ram_util_percent": 83.60769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62729.743, "restore_workers_time_ms": 92.741, "training_step_time_ms": 62457.837, "sample_time_ms": 62401.341, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 44, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-29-03", "timestamp": 1724137143, "time_this_iter_s": 121.70313715934753, "time_total_s": 7050.25416636467, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7050.25416636467, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 96.20416666666667, "ram_util_percent": 83.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62754.332, "restore_workers_time_ms": 87.794, "training_step_time_ms": 62487.872, "sample_time_ms": 62431.47, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 45, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-31-07", "timestamp": 1724137267, "time_this_iter_s": 121.94409918785095, "time_total_s": 7172.198265552521, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327aca310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7172.198265552521, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 95.53254437869822, "ram_util_percent": 83.59704142011836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62722.491, "restore_workers_time_ms": 87.331, "training_step_time_ms": 62456.778, "sample_time_ms": 62400.718, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 46, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-33-11", "timestamp": 1724137391, "time_this_iter_s": 121.5492959022522, "time_total_s": 7293.747561454773, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7293.747561454773, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 96.1443113772455, "ram_util_percent": 83.64071856287427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62717.274, "restore_workers_time_ms": 84.697, "training_step_time_ms": 62455.016, "sample_time_ms": 62398.675, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 47, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-35-16", "timestamp": 1724137516, "time_this_iter_s": 121.9769401550293, "time_total_s": 7415.724501609802, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7415.724501609802, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 95.75823529411764, "ram_util_percent": 83.61588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62558.885, "restore_workers_time_ms": 84.123, "training_step_time_ms": 62307.041, "sample_time_ms": 62252.881, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 48, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-37-20", "timestamp": 1724137640, "time_this_iter_s": 121.52287793159485, "time_total_s": 7537.247379541397, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327acaaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7537.247379541397, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 94.29705882352941, "ram_util_percent": 83.63058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 62139.522, "restore_workers_time_ms": 50.278, "training_step_time_ms": 61964.902, "sample_time_ms": 61914.514, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 49, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-39-25", "timestamp": 1724137765, "time_this_iter_s": 121.91272497177124, "time_total_s": 7659.160104513168, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7659.160104513168, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 96.52823529411766, "ram_util_percent": 83.56764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61385.155, "restore_workers_time_ms": 39.372, "training_step_time_ms": 61284.781, "sample_time_ms": 61258.389, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 50, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-41-29", "timestamp": 1724137889, "time_this_iter_s": 121.55481910705566, "time_total_s": 7780.714923620224, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7780.714923620224, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 96.08809523809525, "ram_util_percent": 83.58333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60884.926, "restore_workers_time_ms": 9.179, "training_step_time_ms": 60858.913, "sample_time_ms": 60852.986, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 51, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-43-32", "timestamp": 1724138012, "time_this_iter_s": 121.52469825744629, "time_total_s": 7902.23962187767, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7902.23962187767, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 96.57202380952381, "ram_util_percent": 83.5702380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60877.701, "restore_workers_time_ms": 6.801, "training_step_time_ms": 60857.41, "sample_time_ms": 60853.455, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 52, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-45-36", "timestamp": 1724138136, "time_this_iter_s": 121.7139630317688, "time_total_s": 8023.953584909439, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8023.953584909439, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 95.51785714285714, "ram_util_percent": 83.55595238095239}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60853.378, "restore_workers_time_ms": 7.086, "training_step_time_ms": 60833.944, "sample_time_ms": 60830.846, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 53, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-47-40", "timestamp": 1724138260, "time_this_iter_s": 121.45595121383667, "time_total_s": 8145.409536123276, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8145.409536123276, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 95.86249999999998, "ram_util_percent": 83.56904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60839.823, "restore_workers_time_ms": 5.585, "training_step_time_ms": 60822.851, "sample_time_ms": 60819.847, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 54, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-49-44", "timestamp": 1724138384, "time_this_iter_s": 121.62743186950684, "time_total_s": 8267.036967992783, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8267.036967992783, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 96.02738095238097, "ram_util_percent": 83.5672619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60811.376, "restore_workers_time_ms": 5.253, "training_step_time_ms": 60794.229, "sample_time_ms": 60790.957, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 55, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-51-48", "timestamp": 1724138508, "time_this_iter_s": 121.45567321777344, "time_total_s": 8388.492641210556, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8388.492641210556, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 96.66508875739645, "ram_util_percent": 83.61124260355031}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60826.56, "restore_workers_time_ms": 5.254, "training_step_time_ms": 60809.396, "sample_time_ms": 60806.138, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-53-52", "timestamp": 1724138632, "time_this_iter_s": 121.96544218063354, "time_total_s": 8510.45808339119, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326e48f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8510.45808339119, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 96.88352941176471, "ram_util_percent": 83.61588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60877.231, "restore_workers_time_ms": 6.806, "training_step_time_ms": 60850.936, "sample_time_ms": 60845.702, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 57, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-56-05", "timestamp": 1724138765, "time_this_iter_s": 122.36906409263611, "time_total_s": 8632.827147483826, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac43a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8632.827147483826, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 94.3142857142857, "ram_util_percent": 83.72197802197803}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60871.284, "restore_workers_time_ms": 6.948, "training_step_time_ms": 60845.562, "sample_time_ms": 60840.706, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 58, "trial_id": "3f8ac_00000", "date": "2024-08-20_12-58-09", "timestamp": 1724138889, "time_this_iter_s": 121.75029492378235, "time_total_s": 8754.577442407608, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8754.577442407608, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 96.77470588235292, "ram_util_percent": 83.63411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60855.762, "restore_workers_time_ms": 6.649, "training_step_time_ms": 60829.304, "sample_time_ms": 60824.778, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 59, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-00-14", "timestamp": 1724139014, "time_this_iter_s": 121.48337888717651, "time_total_s": 8876.060821294785, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fdb0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8876.060821294785, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 96.84093567251459, "ram_util_percent": 83.64619883040936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60835.908, "restore_workers_time_ms": 6.604, "training_step_time_ms": 60810.638, "sample_time_ms": 60805.772, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 60, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-02-17", "timestamp": 1724139137, "time_this_iter_s": 121.39949798583984, "time_total_s": 8997.460319280624, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8997.460319280624, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 97.29470588235293, "ram_util_percent": 83.63941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 60886.711, "restore_workers_time_ms": 6.591, "training_step_time_ms": 60853.922, "sample_time_ms": 60843.299, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 61, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-04-23", "timestamp": 1724139263, "time_this_iter_s": 123.71537709236145, "time_total_s": 9121.175696372986, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac44c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9121.175696372986, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 95.51445086705202, "ram_util_percent": 83.87745664739886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61035.932, "restore_workers_time_ms": 8.483, "training_step_time_ms": 60982.725, "sample_time_ms": 60962.609, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 62, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-06-33", "timestamp": 1724139393, "time_this_iter_s": 124.49045705795288, "time_total_s": 9245.666153430939, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ab7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9245.666153430939, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 86.86132596685083, "ram_util_percent": 83.71491712707183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61043.027, "restore_workers_time_ms": 8.833, "training_step_time_ms": 60987.664, "sample_time_ms": 60967.119, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 63, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-08-38", "timestamp": 1724139518, "time_this_iter_s": 121.8054039478302, "time_total_s": 9367.471557378769, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fd1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9367.471557378769, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 96.37988165680473, "ram_util_percent": 83.70295857988167}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61152.683, "restore_workers_time_ms": 11.524, "training_step_time_ms": 61091.675, "sample_time_ms": 61069.943, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 64, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-10-45", "timestamp": 1724139645, "time_this_iter_s": 123.60436606407166, "time_total_s": 9491.07592344284, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ab7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9491.07592344284, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 90.71379310344825, "ram_util_percent": 83.73160919540231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61173.39, "restore_workers_time_ms": 14.543, "training_step_time_ms": 61107.376, "sample_time_ms": 61084.742, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 65, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-12-52", "timestamp": 1724139772, "time_this_iter_s": 121.7330551147461, "time_total_s": 9612.808978557587, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9612.808978557587, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 96.17657142857144, "ram_util_percent": 83.55885714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61175.465, "restore_workers_time_ms": 14.75, "training_step_time_ms": 61108.649, "sample_time_ms": 61085.814, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 66, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-14-57", "timestamp": 1724139897, "time_this_iter_s": 121.68700098991394, "time_total_s": 9734.4959795475, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9734.4959795475, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 96.6358823529412, "ram_util_percent": 83.5729411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61150.275, "restore_workers_time_ms": 11.614, "training_step_time_ms": 61091.589, "sample_time_ms": 61071.235, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 67, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-17-02", "timestamp": 1724140022, "time_this_iter_s": 122.33643794059753, "time_total_s": 9856.832417488098, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326faa790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9856.832417488098, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 96.00520231213874, "ram_util_percent": 83.58208092485549}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61206.243, "restore_workers_time_ms": 11.602, "training_step_time_ms": 61143.473, "sample_time_ms": 61119.429, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 68, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-19-07", "timestamp": 1724140147, "time_this_iter_s": 122.59323382377625, "time_total_s": 9979.425651311874, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9979.425651311874, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 97.16023391812867, "ram_util_percent": 83.59766081871345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61211.217, "restore_workers_time_ms": 11.982, "training_step_time_ms": 61148.485, "sample_time_ms": 61123.1, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 69, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-21-11", "timestamp": 1724140271, "time_this_iter_s": 121.79785394668579, "time_total_s": 10101.22350525856, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fb9700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10101.22350525856, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 96.60764705882355, "ram_util_percent": 83.59470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 61312.171, "restore_workers_time_ms": 12.147, "training_step_time_ms": 61239.811, "sample_time_ms": 61213.269, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 70, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-23-18", "timestamp": 1724140398, "time_this_iter_s": 123.80477690696716, "time_total_s": 10225.028282165527, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10225.028282165527, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 89.81363636363636, "ram_util_percent": 83.85738636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 124489.939, "restore_workers_time_ms": 12.285, "training_step_time_ms": 124424.735, "sample_time_ms": 124403.691, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 71, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-35-54", "timestamp": 1724141154, "time_this_iter_s": 753.9488739967346, "time_total_s": 10978.977156162262, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326fadf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10978.977156162262, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 95.62882352941176, "ram_util_percent": 83.72764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 124328.618, "restore_workers_time_ms": 12.115, "training_step_time_ms": 124279.688, "sample_time_ms": 124268.12, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 72, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-37-59", "timestamp": 1724141279, "time_this_iter_s": 122.14860677719116, "time_total_s": 11101.125762939453, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327fd3940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11101.125762939453, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 96.71637426900585, "ram_util_percent": 83.59181286549709}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 124373.646, "restore_workers_time_ms": 13.471, "training_step_time_ms": 124320.518, "sample_time_ms": 124308.856, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 73, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-40-06", "timestamp": 1724141406, "time_this_iter_s": 121.97707390785217, "time_total_s": 11223.102836847305, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326e480d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11223.102836847305, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 96.33410404624279, "ram_util_percent": 83.60462427745667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 124257.257, "restore_workers_time_ms": 10.805, "training_step_time_ms": 124210.273, "sample_time_ms": 124199.946, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 74, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-42-10", "timestamp": 1724141530, "time_this_iter_s": 121.35113000869751, "time_total_s": 11344.453966856003, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x326faac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11344.453966856003, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 96.15798816568048, "ram_util_percent": 83.6414201183432}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 329.5, "episode_reward_min": 53.65839004222867, "episode_reward_mean": 174.2249680089957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -279.59127127420146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.82106822706024, "predator_policy": 276.0719790602095}, "policy_reward_mean": {"prey_policy": -5.644563080667046, "predator_policy": 92.75704708516497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.9999999999994, 266.7, 192.284623122251, 106.7999999999997, 92.12824599947385, 217.6719253696882, 177.2999999999996, 189.2514525328752, 190.5035615790677, 139.48508645250925, 205.67832131494578, 115.60033428027849, 136.00552178476926, 186.79999999999978, 264.3645005073477, 266.6569558913932, 246.75576812220768, 124.53998356732134, 98.97382054722263, 175.99999999999963, 196.59999999999945, 77.60812223967548, 168.89999999999966, 187.39999999999947, 194.39999999999998, 190.80399207725233, 118.85066540224973, 105.80000000000001, 196.23569548271757, 236.04688756691664, 260.3999999999998, 184.42182611474598, 221.13190081002313, 149.1415638712862, 130.22064916169435, 217.53593632504345, 212.04280572728817, 329.5, 140.74854096832914, 129.8653869554391, 204.6098114129268, 244.8857152814353, 238.80276057387962, 110.69999999999942, 199.52772086065562, 156.5362383536372, 240.58216679038165, 135.5970728374075, 172.9505197683169, 193.22942530839794, 97.32521565440004, 153.72269141867756, 164.50706398818093, 180.3230735023708, 86.22040206284436, 106.05491647948409, 254.47459782336296, 75.00000000000013, 99.82793786878244, 198.46170757627928, 132.63724434251992, 203.95192555846808, 221.30075437072918, 163.5409223202913, 258.9316300562068, 53.65839004222867, 197.04178101200876, 150.29999999999993, 193.880887826036, 143.27381939580067, 120.80930848790281, 93.29999999999943, 259.64686951402405, 289.7901794456185, 250.3999999999999, 159.97748913182724, 81.79861483925868, 86.19404992595558, 218.65429776774826, 164.82957295280733, 147.67697936399324, 176.88077197144577, 143.5416604629895, 184.29664095662156, 164.2282008416116, 193.02332672044335, 117.05967803452589, 209.6022216048488, 193.9211543272659, 193.1359409360362, 178.60761788263608, 220.95818297084278, 144.85328451644304, 187.27737072743943, 101.88669685605714, 218.3999999999996, 104.25152182569347, 134.84752795770143, 177.51159852726167, 209.1255760908528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.823783279807298, 158.84404336466764, 105.84179753020385, 112.69999999999976, -121.54302483873107, 88.94330618648561, 20.215348713428988, -168.57341798821875, -39.64332897961519, -146.45495266421324, 105.78847734719646, 24.318055231623887, -71.10845589910903, 90.93202917391847, 52.039110365085236, 38.267058200014816, 64.78370433346758, 43.673239589649846, -59.308970558331495, -11.301089765230039, 112.40595032209666, -220.93438754963336, 7.667641199159101, -121.91739386905567, -29.145802225317553, 39.99764466074751, 100.41249119033851, -170.9043903512804, 79.18896921876735, 36.87103089726904, 68.88006713329179, 121.32984395857119, 171.38786783216483, -84.9860998348867, -126.1151376228326, 65.97109799176384, -54.891020528817975, -126.99600316005616, 56.23058097317292, 30.078521062015, 131.6855343189012, 17.551183774301585, -185.27165115633363, -51.5108121899997, 103.7714148534286, -6.372488248565615, 121.07206708584363, -142.23434097060473, -9.231835295859042, -2.109031981364595, -31.088358030660025, 134.69505205025644, -120.87056161163761, -18.9546347334897, -29.61821629486379, 10.359923598211545, 14.97338027018664, 51.19099724399716, 56.867869774301475, 49.64387575434883, 41.15879540304502, 120.54796765740669, 0.5165242362735132, 67.4853265421329, -87.62284956166958, 83.03655885637365, -80.36029921310367, 57.636975113570955, -76.41595868913052, -74.77273358517557, 22.360390029308583, -49.27902910999618, 86.22373904678183, -66.73233826270433, 135.4551733086803, 109.45410665634765, -35.17931359584302, -18.937102006103544, 6.528765797951981, -10.87154242905637, -21.99121211679106, 16.07135760854885, 63.96223749654621, 87.99698719707027, 105.15711314590521, 10.826765902566432, -72.47310007878637, -20.24404052765683, -0.38942205621411574, 100.1365645123141, -132.80891883208517, 80.7915132291291, -35.64479497492012, 163.8512809102719, -7.069477852433298, -29.172888118442287, -85.01091883231435, 129.79999999999998, -11.035248717933039, 62.00743281212729, 17.17757148096282, -58.09703186927314, -16.292337855224673, -23.080021424746477, 32.98306504872994, -238.294182972019, 26.53210672839874, -110.75592523228028, -42.26275683327324, -8.053743882901049, 9.70734405454759, -65.57353894710391, 69.482190286569, 117.23022344091135, -88.77721433437587, -51.33529381634727, -166.44441905040009, 49.130876288926096, -121.98250452669639, 41.731237768867764, -16.249073781476987, -105.70432053731648, 112.18308501349023, -121.67871864692152, 84.20526645393412, -34.90580432068771, -56.5288092756354, -57.989714943435004, 6.492236482931943, 147.36411547092803, -54.78470413363873, 14.857990781899893, -47.600153595973566, 43.24259324591899, 31.336083113353247, 44.935265134547194, -218.89414927362654, 105.54068725438461, -231.08887373982168, 22.55153908139093, -24.756320664485255, -3.2376449701730126, -88.03145133867135, 23.523537804657238, 126.44466436507476, -67.84569447238366, 171.82106822706024, -21.057730095965496, 82.11651353409687, 121.10700784474511, -42.76880207485165, -55.97948487585691, -53.57182071712685, -148.21987698797867, -9.826763326082535, -10.470457026612346, 78.35706725127918, -37.25812854059545, 119.68618275152119, -41.500995996052865, 57.75792329207801, -216.83833481600433, -33.123213178535494, 119.48177309334459, -238.63902685992602, 57.63233792494503, -53.47211414201776, 37.755361662734956, 82.48233323930671, -236.87549413194182, -35.21720982074179, -6.593391931445353, -31.612294992880898, -180.75949885286425, 99.84666964837265, -178.78312195812646, -279.59127127420146, 121.23561997065666, -177.078087385721, 100.995031715201, -50.67262462864662, -18.5367944729257, -254.05321438474385, 160.1458158427906, -13.388337684179417, 44.15076312000443, 44.52908882962599, 17.66928805529586, 37.641429728752954, -104.60929200502247, 55.05404329678792, 75.47488406509413, -19.15145069229039, -90.00344446790403, -93.77786703211387, -109.67990208018655, -43.73856264718747, 14.458893707371029, -96.23730674713104, 150.05498899988078], "policy_predator_policy_reward": [12.076216720192786, 26.255956635332367, 48.158202469796166, 0.0, 215.33086967411816, 9.553472100378272, 6.588173754443339, 248.56989552034665, 121.19472544549818, 157.03180219780342, 50.719795174498344, 36.84559761637016, 85.40845589910893, 72.06797082608153, 9.795505071565495, 89.1497788962097, 41.45302878734649, 40.593588868603824, 62.459018147008386, 147.636128629063, 59.84897292611576, 254.35778561636675, 54.07840936716398, 175.77167758301078, 100.0891196093647, 25.06455973997549, 61.0875088096615, 196.20439035128015, 106.21988895021096, 42.08461144110041, 31.002744047378716, 45.44430075215152, 30.032548990088078, 130.3214511348415, 25.739238498350876, 158.944784700039, 167.3377536391746, 113.52309059692236, 87.36941902682705, 2.3214789379849785, 15.08247687445654, 32.280805032340666, 217.04390919389206, 97.34667639211574, 47.42858514657143, 24.072488248565588, 26.49379992285612, 182.06847396190443, 117.03183529585904, 88.7090319813646, 39.38203830193412, 47.815259755722316, 127.97903004497843, 130.69683170239855, 44.9486838524192, 80.10960884423295, 97.79161251756477, 32.27970545096964, 96.54152641012607, 32.993615628140645, 96.84120459695501, 1.8520323425932097, 69.08344103816822, 47.33653429817173, 37.15322349757045, 188.5649680177487, 24.97280047801555, 146.89208749280385, 99.10867327657571, 182.30066815942453, 239.7858562785364, 4.66871912719489, 117.34467127135223, 75.20673367185839, 6.016255656279752, 78.57446437869228, 62.511186898526844, 132.35376967174932, 95.14407997956067, 39.06408360698334, 86.87964821624169, 123.6500177049274, 67.4602310631905, 25.466259524628413, 36.757701446131684, 86.06118007927635, 113.27310007878631, 90.14404052765693, 39.74901080146549, 60.03156760309015, 140.43776373418046, 68.11588022241258, 26.767485764695, 85.6081950903351, 93.07085376031257, 78.76858504797093, 89.93401377023797, 38.227424830392955, 116.70355609069517, 25.553685123509194, 127.71969320269633, 10.524982840014841, 123.11001951954464, 69.98503117910427, 223.3168842005576, 146.50129771091187, 21.83270409032657, 242.71418791592617, 70.78969238820602, 65.74721039081287, 91.24425231573659, 70.67685905630397, 48.84280811669026, 18.919375979192473, 140.5634092777328, 74.5490988729905, 64.36207487854425, 152.7794057517118, 118.67376096183881, 160.0392133722691, 75.96284981691713, 178.62778884439695, 182.08818973314735, 31.359369458751953, 118.00204650339008, 53.99924573409271, 183.69701222867934, 94.36243431068313, 77.53614712891569, 27.539130973431302, 90.2033216122954, 3.3817817816716405, 30.819068624661774, 170.58027273740174, 50.246062053481204, 23.782589698618438, 60.18075909288444, 247.05359075239357, 126.1543134785418, 225.65684057568944, 58.49513792975031, 90.30813619281133, 76.729427979886, 81.07848555412816, 68.95236669597996, 132.09553292535298, 10.396895230628964, 128.6299460838949, 37.4342012724878, 9.742277348670145, 37.934585489931976, 220.79119059260412, 142.11534658556295, 141.47496595880094, 50.5673517040994, 55.923918574551394, 108.38904320102961, 69.16631585603507, 62.929170782975426, 23.715215414363705, 30.685411827710066, 276.0719790602095, 50.72629012692592, 39.79592192971186, 151.52767591148967, 173.0206734864808, 50.62248179651286, 149.3909116393919, 190.0361790516544, 128.5851826825922, 114.97667663940678, 119.85725183322397, 135.7604150738078, 193.67105680646333, 95.88249340953011, 192.65618050507263, 267.1953054343557, 85.08150019645502, 92.36882386393827, 176.85017274261776, 139.24671647903187, 108.57032050517681, 75.19454325832311, 239.67103825447285, 53.56886824431513, 60.52199083630342, 80.4235354683324, 44.655458374185486, 49.81613098201495, 119.03842815031199, 23.950377183746347, 63.92069545437178, 178.09459032754847, 35.311826658339776, 229.315442072758, 108.98985499724367, 58.63554277530833, 148.15572469177013, 133.43730674713058, 21.87058709097256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.779295028749708, "mean_inference_ms": 13.153642885792815, "mean_action_processing_ms": 3.2774537232163516, "mean_env_wait_ms": 22.85860617522714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08920252323150635, "StateBufferConnector_ms": 0.06586623191833496, "ViewRequirementAgentConnector_ms": 1.2891672849655151}, "num_episodes": 0, "episode_return_max": 329.5, "episode_return_min": 53.65839004222867, "episode_return_mean": 174.2249680089957, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 124450.105, "restore_workers_time_ms": 7.399, "training_step_time_ms": 124390.613, "sample_time_ms": 124367.03, "learn_time_ms": 276163.847, "learn_throughput": 57.937, "synch_weights_time_ms": 25.822}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 75, "trial_id": "3f8ac_00000", "date": "2024-08-20_13-44-23", "timestamp": 1724141663, "time_this_iter_s": 130.74154710769653, "time_total_s": 11475.1955139637, "pid": 18650, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.2, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11475.1955139637, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 68.74054054054054, "ram_util_percent": 85.7545945945946}}
