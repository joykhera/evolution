{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.202383542123926, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.568212859592741, "policy_loss": -0.017450357829195955, "vf_loss": 8.583761029773289, "vf_explained_var": 0.03674828154700143, "kl": 0.009510866264817576, "entropy": 1.603072629529963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0357570676103471, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.001618413067368, "policy_loss": -0.01253790665854005, "vf_loss": 7.012803725338487, "vf_explained_var": 0.0026312815133856717, "kl": 0.0067630843750925524, "entropy": 1.6039976605031856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 362.4000000000008, "episode_reward_min": 48.84575870810973, "episode_reward_mean": 223.2724397363092, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 4000, "policy_reward_min": {"prey_policy": -444.93816635705434, "predator_policy": 0.9017586377539794}, "policy_reward_max": {"prey_policy": 214.2571260692386, "predator_policy": 469.8381663570559}, "policy_reward_mean": {"prey_policy": -82.0327638030582, "predator_policy": 193.66898367121289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.2099795841841, 158.89999999999915, 349.80000000000314, 196.13115836319136, 249.74590258453696, 48.84575870810973, 148.79999999999956, 362.4000000000008, 296.29159812306784, 269.5999999999992], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1724698762988, -63.38307699860826, 35.20355758710402, -1.0779791027064478, 214.2571260692386, -191.58442778662294, -166.68590110738722, -119.76859038169563, -126.74032181464622, 26.498140225653856, -253.3750935382435, -131.0364660230666, -444.93816635705434, -188.14906159764013, 39.3320708690058, 213.67424100768528, -134.3599547485266, 71.01200846080083, -124.52882283238418, 31.167911884227934], "policy_predator_policy_reward": [352.7138254208744, 189.05170103822402, 61.18994889094171, 63.58447262466111, 219.11077087445048, 108.01653084293245, 251.21800029490782, 231.36764955736558, 184.47719785243808, 165.51088632109077, 108.50083966972069, 324.7564785996975, 469.8381663570559, 312.04906159764005, 108.49192948555506, 0.9017586377539794, 113.70652131024855, 245.9330231005456, 193.70758087903687, 169.25333006911688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44089487229270496, "mean_inference_ms": 1.012223473434029, "mean_action_processing_ms": 0.1866416535575291, "mean_env_wait_ms": 0.13303381392265903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004694461822509766, "StateBufferConnector_ms": 0.0025534629821777344, "ViewRequirementAgentConnector_ms": 0.07506608963012695}, "num_episodes": 10, "episode_return_max": 362.4000000000008, "episode_return_min": 48.84575870810973, "episode_return_mean": 223.2724397363092, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.80851872401384, "num_env_steps_trained_throughput_per_sec": 79.80851872401384, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 50119.972, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50119.93, "sample_time_ms": 3613.418, "learn_time_ms": 46502.568, "learn_throughput": 86.017, "synch_weights_time_ms": 3.085}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "a22b9_00000", "date": "2024-08-22_10-25-35", "timestamp": 1724302535, "time_this_iter_s": 50.1216938495636, "time_total_s": 50.1216938495636, "pid": 87928, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad6309d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.1216938495636, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.84722222222222, "ram_util_percent": 74.13194444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1685513128521583, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.795547363745472, "policy_loss": -0.02253107508476922, "vf_loss": 8.815186197290975, "vf_explained_var": 0.0893953371615637, "kl": 0.014461288150284968, "entropy": 1.5751983877843019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.930708262466249, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.171767504631527, "policy_loss": -0.016797384880138218, "vf_loss": 4.187346650431396, "vf_explained_var": 0.022873254080928822, "kl": 0.006091206940141246, "entropy": 1.5949921928385578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 591.4897593721159, "episode_reward_min": 48.84575870810973, "episode_reward_mean": 321.01061553679494, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 8000, "policy_reward_min": {"prey_policy": -444.93816635705434, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.3339528208403, "predator_policy": 469.8381663570559}, "policy_reward_mean": {"prey_policy": 9.81031121707297, "predator_policy": 150.69499655132404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.2099795841841, 158.89999999999915, 349.80000000000314, 196.13115836319136, 249.74590258453696, 48.84575870810973, 148.79999999999956, 362.4000000000008, 296.29159812306784, 269.5999999999992, 350.00000000000097, 560.2000000000005, 162.30000000000015, 311.0000000000031, 436.7999999999987, 502.2000000000026, 371.50000000000233, 500.9000000000008, 591.4897593721159, 401.0981540006812], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1724698762988, -63.38307699860826, 35.20355758710402, -1.0779791027064478, 214.2571260692386, -191.58442778662294, -166.68590110738722, -119.76859038169563, -126.74032181464622, 26.498140225653856, -253.3750935382435, -131.0364660230666, -444.93816635705434, -188.14906159764013, 39.3320708690058, 213.67424100768528, -134.3599547485266, 71.01200846080083, -124.52882283238418, 31.167911884227934, -76.76068133459506, 196.27828162910257, 153.92501907750406, 377.3339528208403, -250.17207150304802, -62.96493240126517, 267.92663233103735, -56.65103285155644, -45.271342348839525, 336.99999999999966, 112.63887570621749, 221.6703213773101, 99.03195210864328, 86.98345777724428, 114.15834260555815, -9.213587857512543, 288.0222807856994, 90.02596480471018, -76.69917612525637, 265.8054681422895], "policy_predator_policy_reward": [352.7138254208744, 189.05170103822402, 61.18994889094171, 63.58447262466111, 219.11077087445048, 108.01653084293245, 251.21800029490782, 231.36764955736558, 184.47719785243808, 165.51088632109077, 108.50083966972069, 324.7564785996975, 469.8381663570559, 312.04906159764005, 108.49192948555506, 0.9017586377539794, 113.70652131024855, 245.9330231005456, 193.70758087903687, 169.25333006911688, 170.52229965514329, 59.960100050347975, 27.974980922496062, 0.9660471791600649, 275.57207150304765, 199.86493240126424, 6.373367668962173, 93.35103285155488, 145.07134234883964, 0.0, 101.86112429378248, 66.02967862268952, 91.13243513971966, 94.35215497439235, 361.5028933154923, 34.45235193646245, 178.87261530184463, 34.56889847986008, 184.69917612525668, 27.29268585838851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43373062779484384, "mean_inference_ms": 0.9940703976197971, "mean_action_processing_ms": 0.18378564603404132, "mean_env_wait_ms": 0.12956869944076094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048035383224487305, "StateBufferConnector_ms": 0.002499222755432129, "ViewRequirementAgentConnector_ms": 0.07285714149475098}, "num_episodes": 10, "episode_return_max": 591.4897593721159, "episode_return_min": 48.84575870810973, "episode_return_mean": 321.01061553679494, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.54670426913657, "num_env_steps_trained_throughput_per_sec": 79.54670426913657, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 50202.451, "restore_workers_time_ms": 0.018, "training_step_time_ms": 50202.406, "sample_time_ms": 3505.313, "learn_time_ms": 46692.462, "learn_throughput": 85.667, "synch_weights_time_ms": 3.27}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "a22b9_00000", "date": "2024-08-22_10-26-27", "timestamp": 1724302587, "time_this_iter_s": 50.28797101974487, "time_total_s": 100.40966486930847, "pid": 87928, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad6cd3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.40966486930847, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.70666666666666, "ram_util_percent": 76.04266666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3894021242699295, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.205508469273805, "policy_loss": -0.01984365562336746, "vf_loss": 7.223027441236708, "vf_explained_var": 0.1845658346143349, "kl": 0.011623532665030056, "entropy": 1.5649904434643094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3524134162557189, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.1843725413241715, "policy_loss": -0.017923042516928736, "vf_loss": 2.2013434383919632, "vf_explained_var": 0.04308026874506915, "kl": 0.004760733106999271, "entropy": 1.5895969713806475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 702.5419221267526, "episode_reward_min": 48.84575870810973, "episode_reward_mean": 357.5355365679983, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 12000, "policy_reward_min": {"prey_policy": -444.93816635705434, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.3339528208403, "predator_policy": 469.8381663570559}, "policy_reward_mean": {"prey_policy": 63.41784780315176, "predator_policy": 115.34992048084702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.2099795841841, 158.89999999999915, 349.80000000000314, 196.13115836319136, 249.74590258453696, 48.84575870810973, 148.79999999999956, 362.4000000000008, 296.29159812306784, 269.5999999999992, 350.00000000000097, 560.2000000000005, 162.30000000000015, 311.0000000000031, 436.7999999999987, 502.2000000000026, 371.50000000000233, 500.9000000000008, 591.4897593721159, 401.0981540006812, 65.60000000000055, 523.9999999999997, 530.5000000000023, 622.6000000000005, 353.6000000000025, 225.7999999999994, 526.900000000001, 105.91186417729264, 702.5419221267526, 648.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1724698762988, -63.38307699860826, 35.20355758710402, -1.0779791027064478, 214.2571260692386, -191.58442778662294, -166.68590110738722, -119.76859038169563, -126.74032181464622, 26.498140225653856, -253.3750935382435, -131.0364660230666, -444.93816635705434, -188.14906159764013, 39.3320708690058, 213.67424100768528, -134.3599547485266, 71.01200846080083, -124.52882283238418, 31.167911884227934, -76.76068133459506, 196.27828162910257, 153.92501907750406, 377.3339528208403, -250.17207150304802, -62.96493240126517, 267.92663233103735, -56.65103285155644, -45.271342348839525, 336.99999999999966, 112.63887570621749, 221.6703213773101, 99.03195210864328, 86.98345777724428, 114.15834260555815, -9.213587857512543, 288.0222807856994, 90.02596480471018, -76.69917612525637, 265.8054681422895, -28.4741001850025, -125.59363795129204, 346.5656096902658, 162.53054887912478, 116.16727356967387, 313.1261775586559, 182.7005051514035, 323.0149500334051, 247.58735106495797, 36.89678175918799, 18.81960488202257, 152.22194008878537, 319.6098910208792, 101.64280388511824, 39.104412581900235, 19.474898094835698, 267.071240808316, 335.6547327375222, 231.85679374290282, 352.68064209352406], "policy_predator_policy_reward": [352.7138254208744, 189.05170103822402, 61.18994889094171, 63.58447262466111, 219.11077087445048, 108.01653084293245, 251.21800029490782, 231.36764955736558, 184.47719785243808, 165.51088632109077, 108.50083966972069, 324.7564785996975, 469.8381663570559, 312.04906159764005, 108.49192948555506, 0.9017586377539794, 113.70652131024855, 245.9330231005456, 193.70758087903687, 169.25333006911688, 170.52229965514329, 59.960100050347975, 27.974980922496062, 0.9660471791600649, 275.57207150304765, 199.86493240126424, 6.373367668962173, 93.35103285155488, 145.07134234883964, 0.0, 101.86112429378248, 66.02967862268952, 91.13243513971966, 94.35215497439235, 361.5028933154923, 34.45235193646245, 178.87261530184463, 34.56889847986008, 184.69917612525668, 27.29268585838851, 63.974100185003, 155.69363795129075, 8.40405516725174, 6.499786263357776, 37.67517006414135, 63.53137880752849, 101.25222651073486, 15.632318304456584, 66.31264893504189, 2.8032182408122686, 19.880395117977443, 34.87805991121479, 16.89010897912064, 88.7571961148812, 24.390231954760303, 22.942321545798627, 61.04213923959361, 38.77380934131962, 40.84320625709721, 23.01935790647615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42911132456419304, "mean_inference_ms": 0.9827065454208432, "mean_action_processing_ms": 0.1821724294255877, "mean_env_wait_ms": 0.12725412641133974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985166549682617, "StateBufferConnector_ms": 0.0024481614430745444, "ViewRequirementAgentConnector_ms": 0.07124861081441243}, "num_episodes": 10, "episode_return_max": 702.5419221267526, "episode_return_min": 48.84575870810973, "episode_return_mean": 357.5355365679983, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.30643626331768, "num_env_steps_trained_throughput_per_sec": 80.30643626331768, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 50071.372, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50071.332, "sample_time_ms": 3444.761, "learn_time_ms": 46621.977, "learn_throughput": 85.796, "synch_weights_time_ms": 3.243}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "a22b9_00000", "date": "2024-08-22_10-27-17", "timestamp": 1724302637, "time_this_iter_s": 49.811444997787476, "time_total_s": 150.22110986709595, "pid": 87928, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad6dd820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 150.22110986709595, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.871830985915494, "ram_util_percent": 76.0464788732394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.782713929906724, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.187918719538937, "policy_loss": -0.024613058442870775, "vf_loss": 8.210476201678079, "vf_explained_var": 0.07715877032784557, "kl": 0.010277854319387597, "entropy": 1.5464277208797514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6810054274778516, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.005169021515619, "policy_loss": -0.028926139935929938, "vf_loss": 5.032534723054795, "vf_explained_var": 0.042434584589862316, "kl": 0.015604523494941567, "entropy": 1.5585908382657974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 702.5419221267526, "episode_reward_min": -19.315173578203115, "episode_reward_mean": 360.8260434820812, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"prey_policy": -444.93816635705434, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.3339528208403, "predator_policy": 489.62303402180675}, "policy_reward_mean": {"prey_policy": 47.994158851836445, "predator_policy": 132.41886288920404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.2099795841841, 158.89999999999915, 349.80000000000314, 196.13115836319136, 249.74590258453696, 48.84575870810973, 148.79999999999956, 362.4000000000008, 296.29159812306784, 269.5999999999992, 350.00000000000097, 560.2000000000005, 162.30000000000015, 311.0000000000031, 436.7999999999987, 502.2000000000026, 371.50000000000233, 500.9000000000008, 591.4897593721159, 401.0981540006812, 65.60000000000055, 523.9999999999997, 530.5000000000023, 622.6000000000005, 353.6000000000025, 225.7999999999994, 526.900000000001, 105.91186417729264, 702.5419221267526, 648.4, 552.4469119176175, 650.6427005341154, 259.44350487046734, 160.62350875875853, -19.315173578203115, 594.359588835465, 411.58009979792087, 431.89450110715876, 599.1000000000001, 66.20000000000051], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1724698762988, -63.38307699860826, 35.20355758710402, -1.0779791027064478, 214.2571260692386, -191.58442778662294, -166.68590110738722, -119.76859038169563, -126.74032181464622, 26.498140225653856, -253.3750935382435, -131.0364660230666, -444.93816635705434, -188.14906159764013, 39.3320708690058, 213.67424100768528, -134.3599547485266, 71.01200846080083, -124.52882283238418, 31.167911884227934, -76.76068133459506, 196.27828162910257, 153.92501907750406, 377.3339528208403, -250.17207150304802, -62.96493240126517, 267.92663233103735, -56.65103285155644, -45.271342348839525, 336.99999999999966, 112.63887570621749, 221.6703213773101, 99.03195210864328, 86.98345777724428, 114.15834260555815, -9.213587857512543, 288.0222807856994, 90.02596480471018, -76.69917612525637, 265.8054681422895, -28.4741001850025, -125.59363795129204, 346.5656096902658, 162.53054887912478, 116.16727356967387, 313.1261775586559, 182.7005051514035, 323.0149500334051, 247.58735106495797, 36.89678175918799, 18.81960488202257, 152.22194008878537, 319.6098910208792, 101.64280388511824, 39.104412581900235, 19.474898094835698, 267.071240808316, 335.6547327375222, 231.85679374290282, 352.68064209352406, -56.87135232116249, 275.45288617620986, 367.3887076438267, 106.56709086979532, -1.0624924583423594, -61.32190103162068, -9.030405115876192, -342.22575406476943, -430.2026715637512, -361.1007256622931, 212.0063790434769, 167.65906285434508, 10.632659327816583, -109.25261435788602, -134.75712985218456, 234.99855994890873, 176.87172710707628, 225.37913551346708, 30.76577085327662, -267.43509295250294], "policy_predator_policy_reward": [352.7138254208744, 189.05170103822402, 61.18994889094171, 63.58447262466111, 219.11077087445048, 108.01653084293245, 251.21800029490782, 231.36764955736558, 184.47719785243808, 165.51088632109077, 108.50083966972069, 324.7564785996975, 469.8381663570559, 312.04906159764005, 108.49192948555506, 0.9017586377539794, 113.70652131024855, 245.9330231005456, 193.70758087903687, 169.25333006911688, 170.52229965514329, 59.960100050347975, 27.974980922496062, 0.9660471791600649, 275.57207150304765, 199.86493240126424, 6.373367668962173, 93.35103285155488, 145.07134234883964, 0.0, 101.86112429378248, 66.02967862268952, 91.13243513971966, 94.35215497439235, 361.5028933154923, 34.45235193646245, 178.87261530184463, 34.56889847986008, 184.69917612525668, 27.29268585838851, 63.974100185003, 155.69363795129075, 8.40405516725174, 6.499786263357776, 37.67517006414135, 63.53137880752849, 101.25222651073486, 15.632318304456584, 66.31264893504189, 2.8032182408122686, 19.880395117977443, 34.87805991121479, 16.89010897912064, 88.7571961148812, 24.390231954760303, 22.942321545798627, 61.04213923959361, 38.77380934131962, 40.84320625709721, 23.01935790647615, 92.72034862654068, 241.14502943602835, 1.0539928902887614, 175.6329091302046, 38.40599732881145, 283.4219010316207, 147.808734087235, 364.07093385217667, 298.1222221280017, 473.86600151983976, 199.2196511003114, 15.474495837331451, 489.62303402180675, 20.577020806183217, 261.5553161328762, 70.09775487755809, 85.01086494697878, 111.83827243247785, 3.316650950496288, 299.5526711487343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4257542102131617, "mean_inference_ms": 0.9751005709165235, "mean_action_processing_ms": 0.18115138061429611, "mean_env_wait_ms": 0.1258655551674543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036457180976867676, "StateBufferConnector_ms": 0.0024437904357910156, "ViewRequirementAgentConnector_ms": 0.0709572434425354}, "num_episodes": 10, "episode_return_max": 702.5419221267526, "episode_return_min": -19.315173578203115, "episode_return_mean": 360.8260434820812, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.45641204374151, "num_env_steps_trained_throughput_per_sec": 79.45641204374151, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 50139.048, "restore_workers_time_ms": 0.015, "training_step_time_ms": 50139.009, "sample_time_ms": 3417.149, "learn_time_ms": 46717.23, "learn_throughput": 85.622, "synch_weights_time_ms": 3.401}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "a22b9_00000", "date": "2024-08-22_10-28-08", "timestamp": 1724302688, "time_this_iter_s": 50.34986901283264, "time_total_s": 200.5709788799286, "pid": 87928, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad6dc0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 200.5709788799286, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.543055555555554, "ram_util_percent": 76.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.651619172190863, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.37570192296669, "policy_loss": -0.025464751806957696, "vf_loss": 8.398662816658222, "vf_explained_var": 0.03592613588565241, "kl": 0.012519391892004107, "entropy": 1.5258216375396365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.010330534864355, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.396218195920268, "policy_loss": -0.028046031052089006, "vf_loss": 7.422847152134729, "vf_explained_var": 0.0420755579042687, "kl": 0.014170892126765474, "entropy": 1.5245772216685864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 702.5419221267526, "episode_reward_min": -19.315173578203115, "episode_reward_mean": 360.14441899049467, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -633.7201909388904, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.3339528208403, "predator_policy": 719.9455854325386}, "policy_reward_mean": {"prey_policy": 12.705927748654084, "predator_policy": 167.36628174659316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.2099795841841, 158.89999999999915, 349.80000000000314, 196.13115836319136, 249.74590258453696, 48.84575870810973, 148.79999999999956, 362.4000000000008, 296.29159812306784, 269.5999999999992, 350.00000000000097, 560.2000000000005, 162.30000000000015, 311.0000000000031, 436.7999999999987, 502.2000000000026, 371.50000000000233, 500.9000000000008, 591.4897593721159, 401.0981540006812, 65.60000000000055, 523.9999999999997, 530.5000000000023, 622.6000000000005, 353.6000000000025, 225.7999999999994, 526.900000000001, 105.91186417729264, 702.5419221267526, 648.4, 552.4469119176175, 650.6427005341154, 259.44350487046734, 160.62350875875853, -19.315173578203115, 594.359588835465, 411.58009979792087, 431.89450110715876, 599.1000000000001, 66.20000000000051, 483.01960364380903, 168.51449436042805, 285.7607648677397, 471.59999999999957, 91.72391024466717, 286.2999999999995, 569.4112850314931, 530.8791414701934, 288.8502814775131, 398.11972914564035], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1724698762988, -63.38307699860826, 35.20355758710402, -1.0779791027064478, 214.2571260692386, -191.58442778662294, -166.68590110738722, -119.76859038169563, -126.74032181464622, 26.498140225653856, -253.3750935382435, -131.0364660230666, -444.93816635705434, -188.14906159764013, 39.3320708690058, 213.67424100768528, -134.3599547485266, 71.01200846080083, -124.52882283238418, 31.167911884227934, -76.76068133459506, 196.27828162910257, 153.92501907750406, 377.3339528208403, -250.17207150304802, -62.96493240126517, 267.92663233103735, -56.65103285155644, -45.271342348839525, 336.99999999999966, 112.63887570621749, 221.6703213773101, 99.03195210864328, 86.98345777724428, 114.15834260555815, -9.213587857512543, 288.0222807856994, 90.02596480471018, -76.69917612525637, 265.8054681422895, -28.4741001850025, -125.59363795129204, 346.5656096902658, 162.53054887912478, 116.16727356967387, 313.1261775586559, 182.7005051514035, 323.0149500334051, 247.58735106495797, 36.89678175918799, 18.81960488202257, 152.22194008878537, 319.6098910208792, 101.64280388511824, 39.104412581900235, 19.474898094835698, 267.071240808316, 335.6547327375222, 231.85679374290282, 352.68064209352406, -56.87135232116249, 275.45288617620986, 367.3887076438267, 106.56709086979532, -1.0624924583423594, -61.32190103162068, -9.030405115876192, -342.22575406476943, -430.2026715637512, -361.1007256622931, 212.0063790434769, 167.65906285434508, 10.632659327816583, -109.25261435788602, -134.75712985218456, 234.99855994890873, 176.87172710707628, 225.37913551346708, 30.76577085327662, -267.43509295250294, -231.14957048129617, -633.7201909388904, -54.1619909041242, -390.13594122085925, -367.4696527607875, -300.8275049201746, -321.293997247083, 344.0221629414519, -145.42563427744253, -442.70999369648354, 0.2807834295580403, 13.16626914202044, 141.63473595682197, 192.42541806387638, 82.70441015834747, 108.64009555423138, -553.1776032857917, -59.18225407100146, 318.80219855876265, -271.36167328264355], "policy_predator_policy_reward": [352.7138254208744, 189.05170103822402, 61.18994889094171, 63.58447262466111, 219.11077087445048, 108.01653084293245, 251.21800029490782, 231.36764955736558, 184.47719785243808, 165.51088632109077, 108.50083966972069, 324.7564785996975, 469.8381663570559, 312.04906159764005, 108.49192948555506, 0.9017586377539794, 113.70652131024855, 245.9330231005456, 193.70758087903687, 169.25333006911688, 170.52229965514329, 59.960100050347975, 27.974980922496062, 0.9660471791600649, 275.57207150304765, 199.86493240126424, 6.373367668962173, 93.35103285155488, 145.07134234883964, 0.0, 101.86112429378248, 66.02967862268952, 91.13243513971966, 94.35215497439235, 361.5028933154923, 34.45235193646245, 178.87261530184463, 34.56889847986008, 184.69917612525668, 27.29268585838851, 63.974100185003, 155.69363795129075, 8.40405516725174, 6.499786263357776, 37.67517006414135, 63.53137880752849, 101.25222651073486, 15.632318304456584, 66.31264893504189, 2.8032182408122686, 19.880395117977443, 34.87805991121479, 16.89010897912064, 88.7571961148812, 24.390231954760303, 22.942321545798627, 61.04213923959361, 38.77380934131962, 40.84320625709721, 23.01935790647615, 92.72034862654068, 241.14502943602835, 1.0539928902887614, 175.6329091302046, 38.40599732881145, 283.4219010316207, 147.808734087235, 364.07093385217667, 298.1222221280017, 473.86600151983976, 199.2196511003114, 15.474495837331451, 489.62303402180675, 20.577020806183217, 261.5553161328762, 70.09775487755809, 85.01086494697878, 111.83827243247785, 3.316650950496288, 299.5526711487343, 719.9455854325386, 627.9437796314569, 111.65312582570073, 501.15930065971014, 456.23126407913287, 497.8266584695693, 433.14087452042213, 15.730959785210313, 355.07381545048145, 324.7857227681098, 38.01921657044223, 234.83373085797936, 166.56498087358136, 68.78615013721308, 56.975660736115145, 282.5589750214991, 220.39902470948286, 680.811114124824, 156.01570707183257, 194.66349679768965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4233415023427993, "mean_inference_ms": 0.969685948774957, "mean_action_processing_ms": 0.1803589283352427, "mean_env_wait_ms": 0.12502383372220802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003391265869140625, "StateBufferConnector_ms": 0.0024347305297851562, "ViewRequirementAgentConnector_ms": 0.0703275203704834}, "num_episodes": 10, "episode_return_max": 702.5419221267526, "episode_return_min": -19.315173578203115, "episode_return_mean": 360.14441899049467, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.1355637268015, "num_env_steps_trained_throughput_per_sec": 80.1355637268015, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 50094.323, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50094.285, "sample_time_ms": 3395.995, "learn_time_ms": 46693.77, "learn_throughput": 85.665, "synch_weights_time_ms": 3.348}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "a22b9_00000", "date": "2024-08-22_10-28-58", "timestamp": 1724302738, "time_this_iter_s": 49.91747784614563, "time_total_s": 250.48845672607422, "pid": 87928, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad6d7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 250.48845672607422, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.29285714285715, "ram_util_percent": 75.90285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.181343832880101, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.232613908676874, "policy_loss": -0.02609864600130884, "vf_loss": 5.256451572186101, "vf_explained_var": -0.06716472036624081, "kl": 0.011304899083099052, "entropy": 1.489661986361105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.937180278572456, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.853332547535972, "policy_loss": -0.0231394498212332, "vf_loss": 5.875152797043008, "vf_explained_var": 0.037155995514027026, "kl": 0.013191903048495901, "entropy": 1.5211791730431652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 702.5419221267526, "episode_reward_min": -19.315173578203115, "episode_reward_mean": 334.9437984303796, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 24000, "policy_reward_min": {"prey_policy": -1029.6312975835597, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.3339528208403, "predator_policy": 886.2486807586903}, "policy_reward_mean": {"prey_policy": -21.521641289418973, "predator_policy": 188.99354050460872}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.2099795841841, 158.89999999999915, 349.80000000000314, 196.13115836319136, 249.74590258453696, 48.84575870810973, 148.79999999999956, 362.4000000000008, 296.29159812306784, 269.5999999999992, 350.00000000000097, 560.2000000000005, 162.30000000000015, 311.0000000000031, 436.7999999999987, 502.2000000000026, 371.50000000000233, 500.9000000000008, 591.4897593721159, 401.0981540006812, 65.60000000000055, 523.9999999999997, 530.5000000000023, 622.6000000000005, 353.6000000000025, 225.7999999999994, 526.900000000001, 105.91186417729264, 702.5419221267526, 648.4, 552.4469119176175, 650.6427005341154, 259.44350487046734, 160.62350875875853, -19.315173578203115, 594.359588835465, 411.58009979792087, 431.89450110715876, 599.1000000000001, 66.20000000000051, 483.01960364380903, 168.51449436042805, 285.7607648677397, 471.59999999999957, 91.72391024466717, 286.2999999999995, 569.4112850314931, 530.8791414701934, 288.8502814775131, 398.11972914564035, 38.711811513437674, 72.70000000000014, 483.30493340845817, 289.99999999999994, 146.26579460163154, 78.89999999999979, 228.29244241266275, 290.75861470618383, 186.42726893253803, 274.0460907231335], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1724698762988, -63.38307699860826, 35.20355758710402, -1.0779791027064478, 214.2571260692386, -191.58442778662294, -166.68590110738722, -119.76859038169563, -126.74032181464622, 26.498140225653856, -253.3750935382435, -131.0364660230666, -444.93816635705434, -188.14906159764013, 39.3320708690058, 213.67424100768528, -134.3599547485266, 71.01200846080083, -124.52882283238418, 31.167911884227934, -76.76068133459506, 196.27828162910257, 153.92501907750406, 377.3339528208403, -250.17207150304802, -62.96493240126517, 267.92663233103735, -56.65103285155644, -45.271342348839525, 336.99999999999966, 112.63887570621749, 221.6703213773101, 99.03195210864328, 86.98345777724428, 114.15834260555815, -9.213587857512543, 288.0222807856994, 90.02596480471018, -76.69917612525637, 265.8054681422895, -28.4741001850025, -125.59363795129204, 346.5656096902658, 162.53054887912478, 116.16727356967387, 313.1261775586559, 182.7005051514035, 323.0149500334051, 247.58735106495797, 36.89678175918799, 18.81960488202257, 152.22194008878537, 319.6098910208792, 101.64280388511824, 39.104412581900235, 19.474898094835698, 267.071240808316, 335.6547327375222, 231.85679374290282, 352.68064209352406, -56.87135232116249, 275.45288617620986, 367.3887076438267, 106.56709086979532, -1.0624924583423594, -61.32190103162068, -9.030405115876192, -342.22575406476943, -430.2026715637512, -361.1007256622931, 212.0063790434769, 167.65906285434508, 10.632659327816583, -109.25261435788602, -134.75712985218456, 234.99855994890873, 176.87172710707628, 225.37913551346708, 30.76577085327662, -267.43509295250294, -231.14957048129617, -633.7201909388904, -54.1619909041242, -390.13594122085925, -367.4696527607875, -300.8275049201746, -321.293997247083, 344.0221629414519, -145.42563427744253, -442.70999369648354, 0.2807834295580403, 13.16626914202044, 141.63473595682197, 192.42541806387638, 82.70441015834747, 108.64009555423138, -553.1776032857917, -59.18225407100146, 318.80219855876265, -271.36167328264355, -22.108848711679578, -46.73247806718911, -15.670423569583086, -24.07296359013303, -20.38981986972236, -1029.6312975835597, -4.055594716007754, -16.077546770890628, -538.6401559412864, 33.927094685387935, 40.0000000000003, 17.780302422643633, 27.339212462576505, -315.8904955782461, -182.4794748951461, -394.47490819057896, -714.6441421613938, -646.8437425918025, 4.1480520317081195, -4.672498960782374], "policy_predator_policy_reward": [352.7138254208744, 189.05170103822402, 61.18994889094171, 63.58447262466111, 219.11077087445048, 108.01653084293245, 251.21800029490782, 231.36764955736558, 184.47719785243808, 165.51088632109077, 108.50083966972069, 324.7564785996975, 469.8381663570559, 312.04906159764005, 108.49192948555506, 0.9017586377539794, 113.70652131024855, 245.9330231005456, 193.70758087903687, 169.25333006911688, 170.52229965514329, 59.960100050347975, 27.974980922496062, 0.9660471791600649, 275.57207150304765, 199.86493240126424, 6.373367668962173, 93.35103285155488, 145.07134234883964, 0.0, 101.86112429378248, 66.02967862268952, 91.13243513971966, 94.35215497439235, 361.5028933154923, 34.45235193646245, 178.87261530184463, 34.56889847986008, 184.69917612525668, 27.29268585838851, 63.974100185003, 155.69363795129075, 8.40405516725174, 6.499786263357776, 37.67517006414135, 63.53137880752849, 101.25222651073486, 15.632318304456584, 66.31264893504189, 2.8032182408122686, 19.880395117977443, 34.87805991121479, 16.89010897912064, 88.7571961148812, 24.390231954760303, 22.942321545798627, 61.04213923959361, 38.77380934131962, 40.84320625709721, 23.01935790647615, 92.72034862654068, 241.14502943602835, 1.0539928902887614, 175.6329091302046, 38.40599732881145, 283.4219010316207, 147.808734087235, 364.07093385217667, 298.1222221280017, 473.86600151983976, 199.2196511003114, 15.474495837331451, 489.62303402180675, 20.577020806183217, 261.5553161328762, 70.09775487755809, 85.01086494697878, 111.83827243247785, 3.316650950496288, 299.5526711487343, 719.9455854325386, 627.9437796314569, 111.65312582570073, 501.15930065971014, 456.23126407913287, 497.8266584695693, 433.14087452042213, 15.730959785210313, 355.07381545048145, 324.7857227681098, 38.01921657044223, 234.83373085797936, 166.56498087358136, 68.78615013721308, 56.975660736115145, 282.5589750214991, 220.39902470948286, 680.811114124824, 156.01570707183257, 194.66349679768965, 12.91237107342425, 94.64076721888144, 51.57042356958359, 60.87296359013355, 730.271214181016, 803.0548366807249, 43.055594716008095, 267.0775467708907, 277.24137426590374, 373.73748159162767, 0.0, 21.119697577356355, 237.37448095971925, 279.46924456861433, 686.9018099885561, 180.81118780335234, 661.6664729270459, 886.2486807586903, 42.43034950285577, 232.14018814934917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4214996335497631, "mean_inference_ms": 0.9655231016386235, "mean_action_processing_ms": 0.17971348509546695, "mean_env_wait_ms": 0.12438108106460138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003232757250467936, "StateBufferConnector_ms": 0.0024253129959106445, "ViewRequirementAgentConnector_ms": 0.07012387116750081}, "num_episodes": 10, "episode_return_max": 702.5419221267526, "episode_return_min": -19.315173578203115, "episode_return_mean": 334.9437984303796, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.12142650412007, "num_env_steps_trained_throughput_per_sec": 78.12142650412007, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 50278.994, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50278.956, "sample_time_ms": 3385.128, "learn_time_ms": 46889.306, "learn_throughput": 85.307, "synch_weights_time_ms": 3.4}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "a22b9_00000", "date": "2024-08-22_10-29-49", "timestamp": 1724302789, "time_this_iter_s": 51.21123719215393, "time_total_s": 301.69969391822815, "pid": 87928, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad6ec700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 301.69969391822815, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.82876712328767, "ram_util_percent": 78.45205479452055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.538520304582737, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.824825069387123, "policy_loss": -0.024989527510479094, "vf_loss": 6.8471281864024975, "vf_explained_var": -0.020599951819768026, "kl": 0.013432084248110907, "entropy": 1.4766651899726302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3968180397515573, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.589211386978311, "policy_loss": -0.023236823827521038, "vf_loss": 7.611228463258692, "vf_explained_var": 0.048200102079482304, "kl": 0.012197408938545134, "entropy": 1.5078490812942464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 702.5419221267526, "episode_reward_min": -19.315173578203115, "episode_reward_mean": 335.59713634565213, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28000, "policy_reward_min": {"prey_policy": -1029.6312975835597, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.3339528208403, "predator_policy": 886.2486807586903}, "policy_reward_mean": {"prey_policy": -36.22341446246216, "predator_policy": 204.02198263528808}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.2099795841841, 158.89999999999915, 349.80000000000314, 196.13115836319136, 249.74590258453696, 48.84575870810973, 148.79999999999956, 362.4000000000008, 296.29159812306784, 269.5999999999992, 350.00000000000097, 560.2000000000005, 162.30000000000015, 311.0000000000031, 436.7999999999987, 502.2000000000026, 371.50000000000233, 500.9000000000008, 591.4897593721159, 401.0981540006812, 65.60000000000055, 523.9999999999997, 530.5000000000023, 622.6000000000005, 353.6000000000025, 225.7999999999994, 526.900000000001, 105.91186417729264, 702.5419221267526, 648.4, 552.4469119176175, 650.6427005341154, 259.44350487046734, 160.62350875875853, -19.315173578203115, 594.359588835465, 411.58009979792087, 431.89450110715876, 599.1000000000001, 66.20000000000051, 483.01960364380903, 168.51449436042805, 285.7607648677397, 471.59999999999957, 91.72391024466717, 286.2999999999995, 569.4112850314931, 530.8791414701934, 288.8502814775131, 398.11972914564035, 38.711811513437674, 72.70000000000014, 483.30493340845817, 289.99999999999994, 146.26579460163154, 78.89999999999979, 228.29244241266275, 290.75861470618383, 186.42726893253803, 274.0460907231335, 480.5725238534659, 480.58189297841193, 352.1000000000023, 316.91166087926274, 491.0880760371139, 129.3999999999977, 69.14182125391979, 491.40605723085093, 330.60000000000105, 253.36960613983683], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1724698762988, -63.38307699860826, 35.20355758710402, -1.0779791027064478, 214.2571260692386, -191.58442778662294, -166.68590110738722, -119.76859038169563, -126.74032181464622, 26.498140225653856, -253.3750935382435, -131.0364660230666, -444.93816635705434, -188.14906159764013, 39.3320708690058, 213.67424100768528, -134.3599547485266, 71.01200846080083, -124.52882283238418, 31.167911884227934, -76.76068133459506, 196.27828162910257, 153.92501907750406, 377.3339528208403, -250.17207150304802, -62.96493240126517, 267.92663233103735, -56.65103285155644, -45.271342348839525, 336.99999999999966, 112.63887570621749, 221.6703213773101, 99.03195210864328, 86.98345777724428, 114.15834260555815, -9.213587857512543, 288.0222807856994, 90.02596480471018, -76.69917612525637, 265.8054681422895, -28.4741001850025, -125.59363795129204, 346.5656096902658, 162.53054887912478, 116.16727356967387, 313.1261775586559, 182.7005051514035, 323.0149500334051, 247.58735106495797, 36.89678175918799, 18.81960488202257, 152.22194008878537, 319.6098910208792, 101.64280388511824, 39.104412581900235, 19.474898094835698, 267.071240808316, 335.6547327375222, 231.85679374290282, 352.68064209352406, -56.87135232116249, 275.45288617620986, 367.3887076438267, 106.56709086979532, -1.0624924583423594, -61.32190103162068, -9.030405115876192, -342.22575406476943, -430.2026715637512, -361.1007256622931, 212.0063790434769, 167.65906285434508, 10.632659327816583, -109.25261435788602, -134.75712985218456, 234.99855994890873, 176.87172710707628, 225.37913551346708, 30.76577085327662, -267.43509295250294, -231.14957048129617, -633.7201909388904, -54.1619909041242, -390.13594122085925, -367.4696527607875, -300.8275049201746, -321.293997247083, 344.0221629414519, -145.42563427744253, -442.70999369648354, 0.2807834295580403, 13.16626914202044, 141.63473595682197, 192.42541806387638, 82.70441015834747, 108.64009555423138, -553.1776032857917, -59.18225407100146, 318.80219855876265, -271.36167328264355, -22.108848711679578, -46.73247806718911, -15.670423569583086, -24.07296359013303, -20.38981986972236, -1029.6312975835597, -4.055594716007754, -16.077546770890628, -538.6401559412864, 33.927094685387935, 40.0000000000003, 17.780302422643633, 27.339212462576505, -315.8904955782461, -182.4794748951461, -394.47490819057896, -714.6441421613938, -646.8437425918025, 4.1480520317081195, -4.672498960782374, -373.09648164394696, -130.46173249499083, 159.60135942300113, -577.7673544437201, 98.89517469376554, -18.621349044039732, -199.37107115433622, -489.407793328352, 52.86619860603071, -155.16530522706057, -8.51873649327043, -212.88335768294644, -32.64805690896888, -102.94964549382837, 231.53868607594654, -615.9899417798104, 121.10371595950906, 32.800230156145176, -278.1016810720689, 9.496071838516045], "policy_predator_policy_reward": [352.7138254208744, 189.05170103822402, 61.18994889094171, 63.58447262466111, 219.11077087445048, 108.01653084293245, 251.21800029490782, 231.36764955736558, 184.47719785243808, 165.51088632109077, 108.50083966972069, 324.7564785996975, 469.8381663570559, 312.04906159764005, 108.49192948555506, 0.9017586377539794, 113.70652131024855, 245.9330231005456, 193.70758087903687, 169.25333006911688, 170.52229965514329, 59.960100050347975, 27.974980922496062, 0.9660471791600649, 275.57207150304765, 199.86493240126424, 6.373367668962173, 93.35103285155488, 145.07134234883964, 0.0, 101.86112429378248, 66.02967862268952, 91.13243513971966, 94.35215497439235, 361.5028933154923, 34.45235193646245, 178.87261530184463, 34.56889847986008, 184.69917612525668, 27.29268585838851, 63.974100185003, 155.69363795129075, 8.40405516725174, 6.499786263357776, 37.67517006414135, 63.53137880752849, 101.25222651073486, 15.632318304456584, 66.31264893504189, 2.8032182408122686, 19.880395117977443, 34.87805991121479, 16.89010897912064, 88.7571961148812, 24.390231954760303, 22.942321545798627, 61.04213923959361, 38.77380934131962, 40.84320625709721, 23.01935790647615, 92.72034862654068, 241.14502943602835, 1.0539928902887614, 175.6329091302046, 38.40599732881145, 283.4219010316207, 147.808734087235, 364.07093385217667, 298.1222221280017, 473.86600151983976, 199.2196511003114, 15.474495837331451, 489.62303402180675, 20.577020806183217, 261.5553161328762, 70.09775487755809, 85.01086494697878, 111.83827243247785, 3.316650950496288, 299.5526711487343, 719.9455854325386, 627.9437796314569, 111.65312582570073, 501.15930065971014, 456.23126407913287, 497.8266584695693, 433.14087452042213, 15.730959785210313, 355.07381545048145, 324.7857227681098, 38.01921657044223, 234.83373085797936, 166.56498087358136, 68.78615013721308, 56.975660736115145, 282.5589750214991, 220.39902470948286, 680.811114124824, 156.01570707183257, 194.66349679768965, 12.91237107342425, 94.64076721888144, 51.57042356958359, 60.87296359013355, 730.271214181016, 803.0548366807249, 43.055594716008095, 267.0775467708907, 277.24137426590374, 373.73748159162767, 0.0, 21.119697577356355, 237.37448095971925, 279.46924456861433, 686.9018099885561, 180.81118780335234, 661.6664729270459, 886.2486807586903, 42.43034950285577, 232.14018814934917, 441.9222860169414, 542.2084519754619, 298.26874358399783, 600.4791444151334, 152.97045843925525, 118.85571591101952, 279.66526129413546, 726.0252640678151, 407.90001287600523, 185.48716978213776, 250.39088448500746, 100.41120969120887, 110.51421918366282, 94.22530447305202, 526.0415117425279, 349.81580119218677, 170.0962840404909, 6.599769843855017, 281.53177086321847, 240.44344451017275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42008642495913345, "mean_inference_ms": 0.9623524573528491, "mean_action_processing_ms": 0.17921169574980353, "mean_env_wait_ms": 0.12391144311327201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003114257540021624, "StateBufferConnector_ms": 0.0024238654545375277, "ViewRequirementAgentConnector_ms": 0.06996750831604004}, "num_episodes": 10, "episode_return_max": 702.5419221267526, "episode_return_min": -19.315173578203115, "episode_return_mean": 335.59713634565213, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.16546471379205, "num_env_steps_trained_throughput_per_sec": 79.16546471379205, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 50314.436, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50314.399, "sample_time_ms": 3379.275, "learn_time_ms": 46930.593, "learn_throughput": 85.232, "synch_weights_time_ms": 3.428}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "a22b9_00000", "date": "2024-08-22_10-30-39", "timestamp": 1724302839, "time_this_iter_s": 50.54283285140991, "time_total_s": 352.24252676963806, "pid": 87928, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad6dd040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 352.24252676963806, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.55, "ram_util_percent": 77.80138888888888}}
