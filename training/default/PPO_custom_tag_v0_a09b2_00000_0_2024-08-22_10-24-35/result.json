{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6802078237845784, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.184880866701641, "policy_loss": -0.012084459419800806, "vf_loss": 5.196098090101171, "vf_explained_var": 0.007105600140082142, "kl": 0.004336171865120786, "entropy": 1.6057817966849715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6213073027827751, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.588001898356847, "policy_loss": -0.016247039187265926, "vf_loss": 8.6021443530996, "vf_explained_var": 0.08562684185290463, "kl": 0.010522867322569249, "entropy": 1.5999519029622356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 427.1000000000054, "episode_reward_min": 89.99999999999946, "episode_reward_mean": 223.11439957357, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 4000, "policy_reward_min": {"prey_policy": -282.5160772369481, "predator_policy": 3.929303069945143}, "policy_reward_max": {"prey_policy": 230.79234367805077, "predator_policy": 467.3092726697084}, "policy_reward_mean": {"prey_policy": -28.565528473622926, "predator_policy": 140.12272826040802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.1999999999996, 101.1972898860349, 132.16527180997457, 427.1000000000054, 343.8730052182487, 89.99999999999946, 187.79999999999814, 333.6000000000027, 222.09999999999954, 174.1084288214369], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [36.729534820743595, -217.79369756736907, -282.5160772369481, -57.86769340318035, 2.1475339128901045, -155.66365052687726, 227.17157119367286, 184.17069693005374, 56.2513788190244, -48.20119532470841, -0.3715438721088574, -77.18381178834517, -13.687704896682355, -29.46308063955815, 230.79234367805077, -41.46107519173774, -33.57761455158433, 110.99768801051951, -186.39417385492263, -275.38999798339125], "policy_predator_policy_reward": [155.97046517925637, 244.29369756736767, 174.7798031698262, 266.8012573563389, 244.0961291708602, 41.58525925310341, 11.828428806326713, 3.929303069945143, 149.87121734674827, 185.95160437718283, 51.54408701255498, 116.01126864789912, 50.98770489668284, 179.96308063955814, 62.407656321949005, 81.86107519173811, 46.54516364201937, 98.13476289904598, 168.58332799004893, 467.3092726697084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4513882089411837, "mean_inference_ms": 1.0799688437412762, "mean_action_processing_ms": 0.19546040054084896, "mean_env_wait_ms": 0.1371962496306168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054645538330078125, "StateBufferConnector_ms": 0.002709627151489258, "ViewRequirementAgentConnector_ms": 0.07798194885253906}, "num_episodes": 10, "episode_return_max": 427.1000000000054, "episode_return_min": 89.99999999999946, "episode_return_mean": 223.11439957357, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.96450660214327, "num_env_steps_trained_throughput_per_sec": 73.96450660214327, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 54080.0, "restore_workers_time_ms": 0.016, "training_step_time_ms": 54079.959, "sample_time_ms": 3807.828, "learn_time_ms": 50267.698, "learn_throughput": 79.574, "synch_weights_time_ms": 3.583}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "a09b2_00000", "date": "2024-08-22_10-25-36", "timestamp": 1724302536, "time_this_iter_s": 54.08730506896973, "time_total_s": 54.08730506896973, "pid": 87889, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa101820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.08730506896973, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.23116883116883, "ram_util_percent": 73.9922077922078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8475266365620194, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.801987206746661, "policy_loss": -0.01944543644625733, "vf_loss": 4.820445854575546, "vf_explained_var": 0.016631920217836976, "kl": 0.009867941307221515, "entropy": 1.5912033223601245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.624895152906892, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.253284702351484, "policy_loss": -0.018396310668892014, "vf_loss": 8.269885951501351, "vf_explained_var": 0.08310755907543121, "kl": 0.00897523556380692, "entropy": 1.5838223782165972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 532.0615411814323, "episode_reward_min": 89.99999999999946, "episode_reward_mean": 290.63370112529117, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 8000, "policy_reward_min": {"prey_policy": -282.5160772369481, "predator_policy": 3.929303069945143}, "policy_reward_max": {"prey_policy": 272.91767447873866, "predator_policy": 467.3092726697084}, "policy_reward_mean": {"prey_policy": 8.662681856266266, "predator_policy": 136.65416870637878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.1999999999996, 101.1972898860349, 132.16527180997457, 427.1000000000054, 343.8730052182487, 89.99999999999946, 187.79999999999814, 333.6000000000027, 222.09999999999954, 174.1084288214369, 532.0615411814323, 413.54684046062863, 236.40000000000015, 476.5000000000048, 344.2000000000012, 357.8000000000012, 321.3305240247171, 341.63478927342123, 405.1228338850717, 152.93349794484607], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [36.729534820743595, -217.79369756736907, -282.5160772369481, -57.86769340318035, 2.1475339128901045, -155.66365052687726, 227.17157119367286, 184.17069693005374, 56.2513788190244, -48.20119532470841, -0.3715438721088574, -77.18381178834517, -13.687704896682355, -29.46308063955815, 230.79234367805077, -41.46107519173774, -33.57761455158433, 110.99768801051951, -186.39417385492263, -275.38999798339125, 96.48725707995186, 249.3985146850545, 87.54489322443996, -36.10218426726245, -178.12831448060768, -84.99269385480581, 87.10782905301969, 252.05535389861606, -17.60357189592931, 124.4661200744249, 17.073443725125117, 272.91767447873866, 240.07566584331363, -56.473326652526865, -70.1616063808803, -129.91126469487804, 249.24752732831178, -103.01787214118015, -12.63260295795697, -69.53299834185947], "policy_predator_policy_reward": [155.97046517925637, 244.29369756736767, 174.7798031698262, 266.8012573563389, 244.0961291708602, 41.58525925310341, 11.828428806326713, 3.929303069945143, 149.87121734674827, 185.95160437718283, 51.54408701255498, 116.01126864789912, 50.98770489668284, 179.96308063955814, 62.407656321949005, 81.86107519173811, 46.54516364201937, 98.13476289904598, 168.58332799004893, 467.3092726697084, 24.820736396108277, 161.3550330203154, 184.47893705821696, 177.62519444523136, 79.73310047912089, 419.7879078562917, 58.89217094697917, 78.44464610138382, 70.59050596170748, 166.74694585979717, 21.5265562748748, 46.282325521261434, 8.82694367929802, 128.9012411546296, 325.09213771288074, 216.61552263629565, 165.4173138756784, 93.47586482225778, 39.81297947370947, 195.28611977095326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44400541940976324, "mean_inference_ms": 1.0513968326591612, "mean_action_processing_ms": 0.1918427910115942, "mean_env_wait_ms": 0.1336707099090481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053375959396362305, "StateBufferConnector_ms": 0.002670884132385254, "ViewRequirementAgentConnector_ms": 0.07470786571502686}, "num_episodes": 10, "episode_return_max": 532.0615411814323, "episode_return_min": 89.99999999999946, "episode_return_mean": 290.63370112529117, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.19093870595759, "num_env_steps_trained_throughput_per_sec": 74.19093870595759, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 53997.473, "restore_workers_time_ms": 0.015, "training_step_time_ms": 53997.433, "sample_time_ms": 3627.005, "learn_time_ms": 50366.114, "learn_throughput": 79.418, "synch_weights_time_ms": 3.477}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "a09b2_00000", "date": "2024-08-22_10-26-32", "timestamp": 1724302592, "time_this_iter_s": 53.91692090034485, "time_total_s": 108.00422596931458, "pid": 87889, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa1653a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.00422596931458, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.99625, "ram_util_percent": 76.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4923766390671807, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.2887889705007036, "policy_loss": -0.022940761672342738, "vf_loss": 2.310808838612188, "vf_explained_var": 0.057727082444246486, "kl": 0.00920894287167616, "entropy": 1.5748066180597537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8913604517777762, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.8356351118239145, "policy_loss": -0.017779420024503476, "vf_loss": 7.851471290134248, "vf_explained_var": 0.16508003290368137, "kl": 0.009716192729107696, "entropy": 1.562736140230976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 692.4000000000002, "episode_reward_min": 78.10000000000001, "episode_reward_mean": 349.45670349403287, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 12000, "policy_reward_min": {"prey_policy": -282.5160772369481, "predator_policy": 1.915310349719996}, "policy_reward_max": {"prey_policy": 370.3, "predator_policy": 467.3092726697084}, "policy_reward_mean": {"prey_policy": 58.2638226649417, "predator_policy": 116.46452908207425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.1999999999996, 101.1972898860349, 132.16527180997457, 427.1000000000054, 343.8730052182487, 89.99999999999946, 187.79999999999814, 333.6000000000027, 222.09999999999954, 174.1084288214369, 532.0615411814323, 413.54684046062863, 236.40000000000015, 476.5000000000048, 344.2000000000012, 357.8000000000012, 321.3305240247171, 341.63478927342123, 405.1228338850717, 152.93349794484607, 579.1000000000007, 382.92686140806904, 687.905391923208, 641.4948289838806, 461.3999999999992, 692.4000000000002, 387.0000000000002, 396.20000000000226, 364.5000000000023, 78.10000000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [36.729534820743595, -217.79369756736907, -282.5160772369481, -57.86769340318035, 2.1475339128901045, -155.66365052687726, 227.17157119367286, 184.17069693005374, 56.2513788190244, -48.20119532470841, -0.3715438721088574, -77.18381178834517, -13.687704896682355, -29.46308063955815, 230.79234367805077, -41.46107519173774, -33.57761455158433, 110.99768801051951, -186.39417385492263, -275.38999798339125, 96.48725707995186, 249.3985146850545, 87.54489322443996, -36.10218426726245, -178.12831448060768, -84.99269385480581, 87.10782905301969, 252.05535389861606, -17.60357189592931, 124.4661200744249, 17.073443725125117, 272.91767447873866, 240.07566584331363, -56.473326652526865, -70.1616063808803, -129.91126469487804, 249.24752732831178, -103.01787214118015, -12.63260295795697, -69.53299834185947, 288.3963639569947, 43.48174190684267, 31.61518349714502, 194.3342693993896, 201.2923111047309, 361.0835278554576, 286.50854249584245, 96.47545045962241, -14.434959610163318, 269.10488282336655, 308.0881025647458, 370.3, 118.3872654951453, 187.00821542500796, 308.2428978702922, -124.37402372112743, 221.84717450045983, 34.348753047303106, -2.869752066570431, -29.513861358633882], "policy_predator_policy_reward": [155.97046517925637, 244.29369756736767, 174.7798031698262, 266.8012573563389, 244.0961291708602, 41.58525925310341, 11.828428806326713, 3.929303069945143, 149.87121734674827, 185.95160437718283, 51.54408701255498, 116.01126864789912, 50.98770489668284, 179.96308063955814, 62.407656321949005, 81.86107519173811, 46.54516364201937, 98.13476289904598, 168.58332799004893, 467.3092726697084, 24.820736396108277, 161.3550330203154, 184.47893705821696, 177.62519444523136, 79.73310047912089, 419.7879078562917, 58.89217094697917, 78.44464610138382, 70.59050596170748, 166.74694585979717, 21.5265562748748, 46.282325521261434, 8.82694367929802, 128.9012411546296, 325.09213771288074, 216.61552263629565, 165.4173138756784, 93.47586482225778, 39.81297947370947, 195.28611977095326, 32.90363604300535, 214.31825809315734, 10.911677910922585, 146.0657306006104, 120.50768889526891, 5.0218640677493385, 213.44901373331987, 45.061822295095894, 123.27198299692199, 83.45809378987354, 12.096587085534015, 1.915310349719996, 7.413035896896944, 74.1914831829501, 57.75710212970776, 154.57402372112617, 96.22307733304602, 12.080995119191277, 44.66975206657075, 65.81386135863431]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43969193382167143, "mean_inference_ms": 1.0337480172219082, "mean_action_processing_ms": 0.18983379947491655, "mean_env_wait_ms": 0.13156517952233734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044794877370198565, "StateBufferConnector_ms": 0.0026166439056396484, "ViewRequirementAgentConnector_ms": 0.07375637690226237}, "num_episodes": 10, "episode_return_max": 692.4000000000002, "episode_return_min": 78.10000000000001, "episode_return_mean": 349.45670349403287, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.64044429805332, "num_env_steps_trained_throughput_per_sec": 74.64044429805332, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 53861.734, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53861.697, "sample_time_ms": 3550.345, "learn_time_ms": 50307.152, "learn_throughput": 79.512, "synch_weights_time_ms": 3.371}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "a09b2_00000", "date": "2024-08-22_10-27-26", "timestamp": 1724302646, "time_this_iter_s": 53.59259223937988, "time_total_s": 161.59681820869446, "pid": 87889, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa1a8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 161.59681820869446, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.681578947368422, "ram_util_percent": 76.03684210526313}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7208776513104715, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.017014993309344, "policy_loss": -0.020298935644200475, "vf_loss": 4.036253888644869, "vf_explained_var": 0.04288494287344514, "kl": 0.010600412027864176, "entropy": 1.55835091001773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.976524492909038, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.551570234853755, "policy_loss": -0.01990217832853357, "vf_loss": 7.569302072474565, "vf_explained_var": 0.13398753130246724, "kl": 0.010851712583434092, "entropy": 1.5585979121702689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 692.4000000000002, "episode_reward_min": 78.10000000000001, "episode_reward_mean": 372.7908426380676, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"prey_policy": -282.5160772369481, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 370.3, "predator_policy": 467.3092726697084}, "policy_reward_mean": {"prey_policy": 75.62206694048162, "predator_policy": 110.77335437855182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.1999999999996, 101.1972898860349, 132.16527180997457, 427.1000000000054, 343.8730052182487, 89.99999999999946, 187.79999999999814, 333.6000000000027, 222.09999999999954, 174.1084288214369, 532.0615411814323, 413.54684046062863, 236.40000000000015, 476.5000000000048, 344.2000000000012, 357.8000000000012, 321.3305240247171, 341.63478927342123, 405.1228338850717, 152.93349794484607, 579.1000000000007, 382.92686140806904, 687.905391923208, 641.4948289838806, 461.3999999999992, 692.4000000000002, 387.0000000000002, 396.20000000000226, 364.5000000000023, 78.10000000000001, 382.6000000000024, 569.3000000000005, 404.10000000000264, 284.49999999999915, 655.8733179909808, 290.199999999999, 255.99999999999804, 436.89999999999975, 627.3592827107371, 521.1], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [36.729534820743595, -217.79369756736907, -282.5160772369481, -57.86769340318035, 2.1475339128901045, -155.66365052687726, 227.17157119367286, 184.17069693005374, 56.2513788190244, -48.20119532470841, -0.3715438721088574, -77.18381178834517, -13.687704896682355, -29.46308063955815, 230.79234367805077, -41.46107519173774, -33.57761455158433, 110.99768801051951, -186.39417385492263, -275.38999798339125, 96.48725707995186, 249.3985146850545, 87.54489322443996, -36.10218426726245, -178.12831448060768, -84.99269385480581, 87.10782905301969, 252.05535389861606, -17.60357189592931, 124.4661200744249, 17.073443725125117, 272.91767447873866, 240.07566584331363, -56.473326652526865, -70.1616063808803, -129.91126469487804, 249.24752732831178, -103.01787214118015, -12.63260295795697, -69.53299834185947, 288.3963639569947, 43.48174190684267, 31.61518349714502, 194.3342693993896, 201.2923111047309, 361.0835278554576, 286.50854249584245, 96.47545045962241, -14.434959610163318, 269.10488282336655, 308.0881025647458, 370.3, 118.3872654951453, 187.00821542500796, 308.2428978702922, -124.37402372112743, 221.84717450045983, 34.348753047303106, -2.869752066570431, -29.513861358633882, 16.92126591877081, 264.40932362716376, 231.203670033263, 123.32064093195488, 10.326932938380033, 358.23563154058974, 25.87902602276451, 3.5588965969463078, 260.61123804118176, 227.13803425319074, 40.0000000000003, 20.391656583365, 20.069092825793128, 48.297324701879184, 101.11035107177527, 283.0785411020666, 283.0696113192082, 176.45966307816443, -39.02859034214324, 98.88368509771169], "policy_predator_policy_reward": [155.97046517925637, 244.29369756736767, 174.7798031698262, 266.8012573563389, 244.0961291708602, 41.58525925310341, 11.828428806326713, 3.929303069945143, 149.87121734674827, 185.95160437718283, 51.54408701255498, 116.01126864789912, 50.98770489668284, 179.96308063955814, 62.407656321949005, 81.86107519173811, 46.54516364201937, 98.13476289904598, 168.58332799004893, 467.3092726697084, 24.820736396108277, 161.3550330203154, 184.47893705821696, 177.62519444523136, 79.73310047912089, 419.7879078562917, 58.89217094697917, 78.44464610138382, 70.59050596170748, 166.74694585979717, 21.5265562748748, 46.282325521261434, 8.82694367929802, 128.9012411546296, 325.09213771288074, 216.61552263629565, 165.4173138756784, 93.47586482225778, 39.81297947370947, 195.28611977095326, 32.90363604300535, 214.31825809315734, 10.911677910922585, 146.0657306006104, 120.50768889526891, 5.0218640677493385, 213.44901373331987, 45.061822295095894, 123.27198299692199, 83.45809378987354, 12.096587085534015, 1.915310349719996, 7.413035896896944, 74.1914831829501, 57.75710212970776, 154.57402372112617, 96.22307733304602, 12.080995119191277, 44.66975206657075, 65.81386135863431, 21.4787340812292, 79.79067637283629, 65.0476625688818, 149.72802646590043, 27.173067061619903, 8.364368459410187, 205.5123319999162, 49.549745380373174, 39.962079949798685, 128.1619657468092, 99.00386525265893, 130.80447816397609, 187.63358247232767, 0.0, 4.189648928224868, 48.52145889793345, 138.69428903029018, 29.135719283073612, 296.4285903421433, 164.8163149022881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43629503676252224, "mean_inference_ms": 1.0229921433865805, "mean_action_processing_ms": 0.18873394414182149, "mean_env_wait_ms": 0.1301327855644694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004030466079711914, "StateBufferConnector_ms": 0.0025898218154907227, "ViewRequirementAgentConnector_ms": 0.07267773151397705}, "num_episodes": 10, "episode_return_max": 692.4000000000002, "episode_return_min": 78.10000000000001, "episode_return_mean": 372.7908426380676, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.96708600075476, "num_env_steps_trained_throughput_per_sec": 73.96708600075476, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 53915.829, "restore_workers_time_ms": 0.013, "training_step_time_ms": 53915.791, "sample_time_ms": 3530.203, "learn_time_ms": 50381.307, "learn_throughput": 79.395, "synch_weights_time_ms": 3.312}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "a09b2_00000", "date": "2024-08-22_10-28-20", "timestamp": 1724302700, "time_this_iter_s": 54.08265495300293, "time_total_s": 215.6794731616974, "pid": 87889, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa1993a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 215.6794731616974, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.38831168831169, "ram_util_percent": 76.06233766233768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2353797634758017, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.42532759469653, "policy_loss": -0.02719479386445884, "vf_loss": 6.450924213096578, "vf_explained_var": 0.06633519776283749, "kl": 0.01598184213959129, "entropy": 1.5190746802501578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0263502706610965, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 9.114320700761503, "policy_loss": -0.017333262387870085, "vf_loss": 9.12994181466481, "vf_explained_var": 0.06937262289738529, "kl": 0.00856072005865291, "entropy": 1.5350448708685618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 701.2000000000006, "episode_reward_min": 78.10000000000001, "episode_reward_mean": 377.91153582670523, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -284.94370556640627, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 370.3, "predator_policy": 467.3092726697084}, "policy_reward_mean": {"prey_policy": 66.05121121479444, "predator_policy": 122.90455669855777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.1999999999996, 101.1972898860349, 132.16527180997457, 427.1000000000054, 343.8730052182487, 89.99999999999946, 187.79999999999814, 333.6000000000027, 222.09999999999954, 174.1084288214369, 532.0615411814323, 413.54684046062863, 236.40000000000015, 476.5000000000048, 344.2000000000012, 357.8000000000012, 321.3305240247171, 341.63478927342123, 405.1228338850717, 152.93349794484607, 579.1000000000007, 382.92686140806904, 687.905391923208, 641.4948289838806, 461.3999999999992, 692.4000000000002, 387.0000000000002, 396.20000000000226, 364.5000000000023, 78.10000000000001, 382.6000000000024, 569.3000000000005, 404.10000000000264, 284.49999999999915, 655.8733179909808, 290.199999999999, 255.99999999999804, 436.89999999999975, 627.3592827107371, 521.1, 344.30319873712216, 273.92988643029025, 493.15816726815973, 338.8236759238059, 346.7910343223258, 447.86517683688385, 617.5000000000009, 110.61833934935296, 701.2000000000006, 309.7536069446146], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [36.729534820743595, -217.79369756736907, -282.5160772369481, -57.86769340318035, 2.1475339128901045, -155.66365052687726, 227.17157119367286, 184.17069693005374, 56.2513788190244, -48.20119532470841, -0.3715438721088574, -77.18381178834517, -13.687704896682355, -29.46308063955815, 230.79234367805077, -41.46107519173774, -33.57761455158433, 110.99768801051951, -186.39417385492263, -275.38999798339125, 96.48725707995186, 249.3985146850545, 87.54489322443996, -36.10218426726245, -178.12831448060768, -84.99269385480581, 87.10782905301969, 252.05535389861606, -17.60357189592931, 124.4661200744249, 17.073443725125117, 272.91767447873866, 240.07566584331363, -56.473326652526865, -70.1616063808803, -129.91126469487804, 249.24752732831178, -103.01787214118015, -12.63260295795697, -69.53299834185947, 288.3963639569947, 43.48174190684267, 31.61518349714502, 194.3342693993896, 201.2923111047309, 361.0835278554576, 286.50854249584245, 96.47545045962241, -14.434959610163318, 269.10488282336655, 308.0881025647458, 370.3, 118.3872654951453, 187.00821542500796, 308.2428978702922, -124.37402372112743, 221.84717450045983, 34.348753047303106, -2.869752066570431, -29.513861358633882, 16.92126591877081, 264.40932362716376, 231.203670033263, 123.32064093195488, 10.326932938380033, 358.23563154058974, 25.87902602276451, 3.5588965969463078, 260.61123804118176, 227.13803425319074, 40.0000000000003, 20.391656583365, 20.069092825793128, 48.297324701879184, 101.11035107177527, 283.0785411020666, 283.0696113192082, 176.45966307816443, -39.02859034214324, 98.88368509771169, -85.33604815910027, 38.79967123063716, -52.177223062377315, -48.800974578662085, 139.70422670391721, 138.35822715546468, -138.49748471625742, 196.02130295518714, 163.08555866840885, -123.94125299307578, 14.429281560405993, 28.047531990863323, 290.4561188326867, 167.7887887515039, -38.42209913859348, -280.3895072407093, 260.7022132256509, 357.0193494379497, -284.94370556640627, -186.54820881657741], "policy_predator_policy_reward": [155.97046517925637, 244.29369756736767, 174.7798031698262, 266.8012573563389, 244.0961291708602, 41.58525925310341, 11.828428806326713, 3.929303069945143, 149.87121734674827, 185.95160437718283, 51.54408701255498, 116.01126864789912, 50.98770489668284, 179.96308063955814, 62.407656321949005, 81.86107519173811, 46.54516364201937, 98.13476289904598, 168.58332799004893, 467.3092726697084, 24.820736396108277, 161.3550330203154, 184.47893705821696, 177.62519444523136, 79.73310047912089, 419.7879078562917, 58.89217094697917, 78.44464610138382, 70.59050596170748, 166.74694585979717, 21.5265562748748, 46.282325521261434, 8.82694367929802, 128.9012411546296, 325.09213771288074, 216.61552263629565, 165.4173138756784, 93.47586482225778, 39.81297947370947, 195.28611977095326, 32.90363604300535, 214.31825809315734, 10.911677910922585, 146.0657306006104, 120.50768889526891, 5.0218640677493385, 213.44901373331987, 45.061822295095894, 123.27198299692199, 83.45809378987354, 12.096587085534015, 1.915310349719996, 7.413035896896944, 74.1914831829501, 57.75710212970776, 154.57402372112617, 96.22307733304602, 12.080995119191277, 44.66975206657075, 65.81386135863431, 21.4787340812292, 79.79067637283629, 65.0476625688818, 149.72802646590043, 27.173067061619903, 8.364368459410187, 205.5123319999162, 49.549745380373174, 39.962079949798685, 128.1619657468092, 99.00386525265893, 130.80447816397609, 187.63358247232767, 0.0, 4.189648928224868, 48.52145889793345, 138.69428903029018, 29.135719283073612, 296.4285903421433, 164.8163149022881, 301.4172321047291, 89.42234356085658, 313.08817042499606, 61.81991364633072, 70.6856518719276, 144.41006153684845, 107.56707510201029, 173.73278258286507, 2.8383643314400224, 304.8083643155525, 202.292960844865, 203.09540244074728, 130.94963593412027, 28.30545648169014, 109.50265532637093, 319.92729040228534, 67.99778677434902, 15.480650562050252, 349.8144974372835, 431.43102389031515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43359015935087497, "mean_inference_ms": 1.014355156181847, "mean_action_processing_ms": 0.18771295203310165, "mean_env_wait_ms": 0.12902666998591328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037581920623779297, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.07196593284606934}, "num_episodes": 10, "episode_return_max": 701.2000000000006, "episode_return_min": 78.10000000000001, "episode_return_mean": 377.91153582670523, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.7452578666863, "num_env_steps_trained_throughput_per_sec": 73.7452578666863, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 53980.82, "restore_workers_time_ms": 0.013, "training_step_time_ms": 53980.78, "sample_time_ms": 3493.435, "learn_time_ms": 50482.439, "learn_throughput": 79.235, "synch_weights_time_ms": 3.729}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "a09b2_00000", "date": "2024-08-22_10-29-14", "timestamp": 1724302754, "time_this_iter_s": 54.254648208618164, "time_total_s": 269.93412137031555, "pid": 87889, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa1a74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 269.93412137031555, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.66153846153846, "ram_util_percent": 76.0769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.323710719050554, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.241310132495941, "policy_loss": -0.023939048473614825, "vf_loss": 7.26391391628003, "vf_explained_var": 0.07288454206532272, "kl": 0.013352630154421575, "entropy": 1.4903743066484967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0852771610179275, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.467335570804657, "policy_loss": -0.022960251395186537, "vf_loss": 8.487750919533784, "vf_explained_var": 0.05091219803012868, "kl": 0.012724329627239071, "entropy": 1.5133604602208213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 701.2000000000006, "episode_reward_min": 78.10000000000001, "episode_reward_mean": 378.16909093582865, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 24000, "policy_reward_min": {"prey_policy": -330.3606744729486, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 370.3, "predator_policy": 467.3092726697084}, "policy_reward_mean": {"prey_policy": 54.37557563289794, "predator_policy": 134.708969835016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.1999999999996, 101.1972898860349, 132.16527180997457, 427.1000000000054, 343.8730052182487, 89.99999999999946, 187.79999999999814, 333.6000000000027, 222.09999999999954, 174.1084288214369, 532.0615411814323, 413.54684046062863, 236.40000000000015, 476.5000000000048, 344.2000000000012, 357.8000000000012, 321.3305240247171, 341.63478927342123, 405.1228338850717, 152.93349794484607, 579.1000000000007, 382.92686140806904, 687.905391923208, 641.4948289838806, 461.3999999999992, 692.4000000000002, 387.0000000000002, 396.20000000000226, 364.5000000000023, 78.10000000000001, 382.6000000000024, 569.3000000000005, 404.10000000000264, 284.49999999999915, 655.8733179909808, 290.199999999999, 255.99999999999804, 436.89999999999975, 627.3592827107371, 521.1, 344.30319873712216, 273.92988643029025, 493.15816726815973, 338.8236759238059, 346.7910343223258, 447.86517683688385, 617.5000000000009, 110.61833934935296, 701.2000000000006, 309.7536069446146, 293.26687016239447, 366.30981126176744, 434.29999999999995, 482.4774116895858, 247.20365541433492, 473.6000000000007, 322.98731783056314, 386.9355729452008, 429.3880255106073, 358.1000000000011], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [36.729534820743595, -217.79369756736907, -282.5160772369481, -57.86769340318035, 2.1475339128901045, -155.66365052687726, 227.17157119367286, 184.17069693005374, 56.2513788190244, -48.20119532470841, -0.3715438721088574, -77.18381178834517, -13.687704896682355, -29.46308063955815, 230.79234367805077, -41.46107519173774, -33.57761455158433, 110.99768801051951, -186.39417385492263, -275.38999798339125, 96.48725707995186, 249.3985146850545, 87.54489322443996, -36.10218426726245, -178.12831448060768, -84.99269385480581, 87.10782905301969, 252.05535389861606, -17.60357189592931, 124.4661200744249, 17.073443725125117, 272.91767447873866, 240.07566584331363, -56.473326652526865, -70.1616063808803, -129.91126469487804, 249.24752732831178, -103.01787214118015, -12.63260295795697, -69.53299834185947, 288.3963639569947, 43.48174190684267, 31.61518349714502, 194.3342693993896, 201.2923111047309, 361.0835278554576, 286.50854249584245, 96.47545045962241, -14.434959610163318, 269.10488282336655, 308.0881025647458, 370.3, 118.3872654951453, 187.00821542500796, 308.2428978702922, -124.37402372112743, 221.84717450045983, 34.348753047303106, -2.869752066570431, -29.513861358633882, 16.92126591877081, 264.40932362716376, 231.203670033263, 123.32064093195488, 10.326932938380033, 358.23563154058974, 25.87902602276451, 3.5588965969463078, 260.61123804118176, 227.13803425319074, 40.0000000000003, 20.391656583365, 20.069092825793128, 48.297324701879184, 101.11035107177527, 283.0785411020666, 283.0696113192082, 176.45966307816443, -39.02859034214324, 98.88368509771169, -85.33604815910027, 38.79967123063716, -52.177223062377315, -48.800974578662085, 139.70422670391721, 138.35822715546468, -138.49748471625742, 196.02130295518714, 163.08555866840885, -123.94125299307578, 14.429281560405993, 28.047531990863323, 290.4561188326867, 167.7887887515039, -38.42209913859348, -280.3895072407093, 260.7022132256509, 357.0193494379497, -284.94370556640627, -186.54820881657741, -330.3606744729486, 151.4686863106972, 74.7828644325769, -110.49914099971315, -41.13858884685652, 91.07674888771594, -111.07045517089422, 197.30784372119865, 40.0000000000003, -102.14256556970793, 237.7062509847572, -52.72591811127646, -107.89090768999517, -88.1314770408672, -56.74697804774202, 113.06692056177295, -176.56802576204666, -71.48395832120163, 40.0000000000003, 223.29732960284056], "policy_predator_policy_reward": [155.97046517925637, 244.29369756736767, 174.7798031698262, 266.8012573563389, 244.0961291708602, 41.58525925310341, 11.828428806326713, 3.929303069945143, 149.87121734674827, 185.95160437718283, 51.54408701255498, 116.01126864789912, 50.98770489668284, 179.96308063955814, 62.407656321949005, 81.86107519173811, 46.54516364201937, 98.13476289904598, 168.58332799004893, 467.3092726697084, 24.820736396108277, 161.3550330203154, 184.47893705821696, 177.62519444523136, 79.73310047912089, 419.7879078562917, 58.89217094697917, 78.44464610138382, 70.59050596170748, 166.74694585979717, 21.5265562748748, 46.282325521261434, 8.82694367929802, 128.9012411546296, 325.09213771288074, 216.61552263629565, 165.4173138756784, 93.47586482225778, 39.81297947370947, 195.28611977095326, 32.90363604300535, 214.31825809315734, 10.911677910922585, 146.0657306006104, 120.50768889526891, 5.0218640677493385, 213.44901373331987, 45.061822295095894, 123.27198299692199, 83.45809378987354, 12.096587085534015, 1.915310349719996, 7.413035896896944, 74.1914831829501, 57.75710212970776, 154.57402372112617, 96.22307733304602, 12.080995119191277, 44.66975206657075, 65.81386135863431, 21.4787340812292, 79.79067637283629, 65.0476625688818, 149.72802646590043, 27.173067061619903, 8.364368459410187, 205.5123319999162, 49.549745380373174, 39.962079949798685, 128.1619657468092, 99.00386525265893, 130.80447816397609, 187.63358247232767, 0.0, 4.189648928224868, 48.52145889793345, 138.69428903029018, 29.135719283073612, 296.4285903421433, 164.8163149022881, 301.4172321047291, 89.42234356085658, 313.08817042499606, 61.81991364633072, 70.6856518719276, 144.41006153684845, 107.56707510201029, 173.73278258286507, 2.8383643314400224, 304.8083643155525, 202.292960844865, 203.09540244074728, 130.94963593412027, 28.30545648169014, 109.50265532637093, 319.92729040228534, 67.99778677434902, 15.480650562050252, 349.8144974372835, 431.43102389031515, 58.12375231199077, 414.0351060126558, 223.7353380624034, 178.29074976650026, 356.2923667852332, 28.069473173906566, 80.36051936057899, 315.87950377870214, 205.96907447317872, 103.37714651086594, 22.158956159206998, 266.46071096731174, 262.08105182137064, 256.9286507400541, 258.68185062907367, 71.9337798020964, 244.87248896791868, 432.56752062593466, 0.0, 94.80267039715937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43461725422717523, "mean_inference_ms": 1.0170867197504032, "mean_action_processing_ms": 0.18805403254130534, "mean_env_wait_ms": 0.1297004108607552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003850261370340983, "StateBufferConnector_ms": 0.0027010838190714517, "ViewRequirementAgentConnector_ms": 0.07552683353424072}, "num_episodes": 10, "episode_return_max": 701.2000000000006, "episode_return_min": 78.10000000000001, "episode_return_mean": 378.16909093582865, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.75249788346382, "num_env_steps_trained_throughput_per_sec": 72.75249788346382, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 54147.506, "restore_workers_time_ms": 0.013, "training_step_time_ms": 54147.467, "sample_time_ms": 3673.428, "learn_time_ms": 50469.166, "learn_throughput": 79.256, "synch_weights_time_ms": 3.676}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "a09b2_00000", "date": "2024-08-22_10-30-09", "timestamp": 1724302809, "time_this_iter_s": 54.98974299430847, "time_total_s": 324.923864364624, "pid": 87889, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aa1a7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 324.923864364624, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.364102564102566, "ram_util_percent": 79.00000000000001}}
